<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>iccDEV: IccProfLib/IccCmm.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">iccDEV<span id="projectnumber">&#160;2.2.61</span>
   </div>
   <div id="projectbrief">iccDEV Tools</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d3/df8/a00155.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">IccCmm.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../">IccXformFactory.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../">IccTag.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../">IccMpeBasic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../">IccArrayBasic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../">IccStructBasic.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../">IccIO.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../">IccApplyBPC.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../">IccSparseMatrix.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../">IccEncoding.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../">IccMatrixMath.h</a>&quot;</code><br />
</div><div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="../../closed.png" alt="+"/> Include dependency graph for IccCmm.cpp:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d2/d34/a00156.png" border="0" usemap="#aIccProfLib_2IccCmm_8cpp" alt=""/></div>
<map name="aIccProfLib_2IccCmm_8cpp" id="aIccProfLib_2IccCmm_8cpp">
<area shape="rect" title=" " alt="" coords="751,5,920,31"/>
<area shape="rect" href="../../df/d98/a00107.html" title=" " alt="" coords="843,79,980,104"/>
<area shape="poly" title=" " alt="" coords="849,29,891,67,887,71,846,33"/>
<area shape="rect" href="../../d2/df5/a00137.html" title=" " alt="" coords="1095,225,1170,251"/>
<area shape="poly" title=" " alt="" coords="884,28,939,47,994,76,1034,109,1069,146,1120,212,1116,215,1065,149,1030,113,991,81,937,52,882,33"/>
<area shape="rect" href="../../df/d6a/a00119.html" title=" " alt="" coords="2035,299,2102,324"/>
<area shape="poly" title=" " alt="" coords="921,16,1068,19,1262,27,1479,45,1589,59,1697,76,1827,96,1882,114,1945,150,1982,181,2014,218,2058,285,2054,288,2010,221,1979,185,1942,154,1880,119,1826,102,1696,81,1589,64,1478,51,1261,33,1068,24,920,22"/>
<area shape="rect" href="../../dc/dfe/a00125.html" title=" " alt="" coords="75,225,201,251"/>
<area shape="poly" title=" " alt="" coords="784,33,596,81,361,158,182,223,180,218,359,153,595,76,783,28"/>
<area shape="rect" href="../../d2/de7/a00014.html" title=" " alt="" coords="1790,152,1905,177"/>
<area shape="poly" title=" " alt="" coords="917,28,1772,149,1777,150,1776,155,1771,155,916,33"/>
<area shape="rect" href="../../d7/d06/a00131.html" title=" " alt="" coords="309,225,431,251"/>
<area shape="poly" title=" " alt="" coords="793,33,727,54,654,81,581,116,510,154,401,220,398,215,507,150,578,111,652,76,725,49,792,28"/>
<area shape="rect" href="../../da/d1e/a00149.html" title=" " alt="" coords="462,225,587,251"/>
<area shape="poly" title=" " alt="" coords="798,33,747,53,693,81,648,114,607,151,545,217,541,213,603,147,645,110,690,76,744,48,796,28"/>
<area shape="rect" href="../../d4/dee/a00008.html" title=" " alt="" coords="703,79,818,104"/>
<area shape="poly" title=" " alt="" coords="825,33,785,71,781,67,822,29"/>
<area shape="rect" href="../../dd/d52/a00221.html" title=" " alt="" coords="1873,299,2011,324"/>
<area shape="poly" title=" " alt="" coords="920,21,1168,37,1483,65,1634,82,1766,102,1864,125,1898,137,1919,150,1939,181,1949,218,1951,254,1949,285,1944,285,1946,254,1944,219,1934,184,1915,154,1895,142,1863,130,1765,107,1634,87,1482,70,1168,43,920,27"/>
<area shape="rect" href="../../d3/dd5/a00215.html" title=" " alt="" coords="5,152,116,177"/>
<area shape="poly" title=" " alt="" coords="750,27,554,45,439,60,324,81,203,115,103,150,102,145,201,110,323,76,438,55,554,39,750,21"/>
<area shape="rect" href="../../d6/d5b/a00026.html" title=" " alt="" coords="717,152,804,177"/>
<area shape="poly" title=" " alt="" coords="888,106,799,148,797,144,886,102"/>
<area shape="rect" title=" " alt="" coords="781,445,823,471"/>
<area shape="poly" title=" " alt="" coords="909,105,855,235,825,314,807,372,803,432,798,431,802,372,820,312,850,233,904,103"/>
<area shape="rect" title=" " alt="" coords="1131,445,1190,471"/>
<area shape="poly" title=" " alt="" coords="980,89,1104,97,1179,109,1257,127,1335,153,1410,189,1477,237,1506,265,1532,297,1538,311,1532,325,1511,347,1490,359,1468,364,1445,365,1396,364,1369,367,1340,375,1315,386,1290,400,1199,442,1197,437,1287,395,1312,381,1338,369,1368,361,1396,359,1445,360,1467,359,1488,354,1508,342,1528,323,1532,311,1528,300,1502,269,1473,241,1407,194,1333,158,1256,132,1178,114,1103,103,980,94"/>
<area shape="rect" title=" " alt="" coords="1545,445,1622,471"/>
<area shape="poly" title=" " alt="" coords="980,95,1168,115,1285,132,1406,153,1523,180,1627,212,1671,231,1709,251,1740,273,1762,297,1771,321,1769,344,1756,365,1736,385,1684,418,1630,443,1628,438,1682,414,1733,381,1752,362,1764,342,1766,322,1757,300,1736,277,1706,256,1669,236,1625,217,1522,185,1405,158,1284,137,1167,121,980,101"/>
<area shape="rect" href="../../d4/d51/a00017.html" title=" " alt="" coords="351,372,445,397"/>
<area shape="poly" title=" " alt="" coords="717,171,497,189,380,206,333,216,298,228,269,241,248,255,231,273,216,300,213,317,217,331,228,344,245,354,289,368,338,377,337,382,288,374,242,359,224,348,212,334,207,317,212,298,227,270,244,251,266,237,296,223,331,211,379,200,497,184,717,166"/>
<area shape="poly" title=" " alt="" coords="725,180,690,198,675,211,663,227,652,238,639,247,626,255,617,265,613,282,619,307,636,344,668,396,689,417,714,432,742,443,768,449,767,455,740,448,712,437,685,421,664,399,631,346,614,308,608,281,612,263,623,251,636,242,649,234,659,224,671,207,687,194,723,175"/>
<area shape="poly" title=" " alt="" coords="805,172,1082,224,1081,230,804,177"/>
<area shape="rect" href="../../d7/dce/a00143.html" title=" " alt="" coords="1798,372,1873,397"/>
<area shape="poly" title=" " alt="" coords="804,165,1001,176,1282,200,1427,217,1563,239,1677,265,1723,280,1761,296,1780,309,1797,325,1823,358,1819,362,1793,329,1777,313,1758,301,1721,285,1676,270,1562,244,1427,222,1281,205,1001,181,804,170"/>
<area shape="poly" title=" " alt="" coords="718,173,221,228,216,229,215,223,220,223,717,168"/>
<area shape="rect" title=" " alt="" coords="762,225,829,251"/>
<area shape="poly" title=" " alt="" coords="769,176,786,212,781,214,764,179"/>
<area shape="rect" title=" " alt="" coords="672,225,737,251"/>
<area shape="poly" title=" " alt="" coords="754,179,724,216,720,213,749,176"/>
<area shape="rect" href="../../d4/d81/a00110.html" title=" " alt="" coords="1369,519,1451,544"/>
<area shape="poly" title=" " alt="" coords="420,395,498,433,548,452,600,468,667,480,756,491,972,508,1355,526,1355,531,972,513,756,496,666,486,599,473,546,457,496,437,418,400"/>
<area shape="rect" href="../../d4/d3a/a00101.html" title=" " alt="" coords="611,445,686,471"/>
<area shape="poly" title=" " alt="" coords="439,395,598,440,597,445,438,400"/>
<area shape="poly" title=" " alt="" coords="445,392,768,448,767,453,444,397"/>
<area shape="poly" title=" " alt="" coords="445,388,1118,450,1117,455,445,393"/>
<area shape="rect" title=" " alt="" coords="1373,592,1447,617"/>
<area shape="poly" title=" " alt="" coords="1413,544,1413,578,1407,578,1407,544"/>
<area shape="rect" href="../../d5/d16/a00029.html" title=" " alt="" coords="1999,592,2125,617"/>
<area shape="poly" title=" " alt="" coords="1452,535,1985,592,1985,598,1451,540"/>
<area shape="rect" href="../../d7/d46/a00002.html" title=" " alt="" coords="1657,592,1789,617"/>
<area shape="poly" title=" " alt="" coords="1452,539,1660,586,1659,592,1451,545"/>
<area shape="rect" title=" " alt="" coords="2027,665,2097,691"/>
<area shape="poly" title=" " alt="" coords="2065,618,2065,652,2059,652,2059,618"/>
<area shape="poly" title=" " alt="" coords="687,460,769,468,1355,522,1355,528,768,473,686,466"/>
<area shape="poly" title=" " alt="" coords="1171,239,1360,258,1460,274,1501,285,1531,296,1556,312,1572,328,1601,370,1640,421,1647,445,1644,458,1636,472,1609,491,1565,506,1465,526,1464,521,1563,501,1606,486,1632,469,1639,456,1642,445,1635,423,1597,374,1568,331,1552,316,1529,301,1499,290,1459,280,1359,263,1170,244"/>
<area shape="poly" title=" " alt="" coords="1095,246,967,265,905,281,880,290,864,301,839,330,822,366,812,401,807,432,802,431,807,400,817,364,835,327,860,297,878,286,903,276,966,260,1094,241"/>
<area shape="poly" title=" " alt="" coords="1171,241,1276,261,1325,276,1344,286,1356,297,1369,317,1370,331,1360,339,1344,343,1298,351,1271,359,1244,374,1208,405,1180,436,1176,433,1204,401,1240,370,1269,354,1297,345,1343,337,1358,334,1365,329,1364,319,1352,300,1341,291,1323,281,1274,266,1170,247"/>
<area shape="poly" title=" " alt="" coords="1170,237,1307,239,1516,247,1764,265,1894,279,2022,296,2021,301,1893,284,1764,270,1515,253,1307,244,1170,242"/>
<area shape="rect" href="../../da/dec/a00080.html" title=" " alt="" coords="963,372,1073,397"/>
<area shape="poly" title=" " alt="" coords="1122,253,1076,300,1034,362,1030,358,1072,297,1118,249"/>
<area shape="rect" href="../../da/d24/a00068.html" title=" " alt="" coords="1085,299,1180,324"/>
<area shape="poly" title=" " alt="" coords="1135,251,1135,285,1130,285,1130,251"/>
<area shape="rect" href="../../d7/d25/a00182.html" title=" " alt="" coords="1644,299,1747,324"/>
<area shape="poly" title=" " alt="" coords="1170,241,1360,264,1613,296,1631,299,1630,304,1612,301,1360,269,1170,247"/>
<area shape="rect" href="../../d5/df1/a00206.html" title=" " alt="" coords="874,299,1010,324"/>
<area shape="poly" title=" " alt="" coords="1096,253,980,296,978,291,1094,248"/>
<area shape="rect" href="../../df/d03/a00062.html" title=" " alt="" coords="1417,299,1517,324"/>
<area shape="poly" title=" " alt="" coords="1171,246,1405,295,1403,301,1170,251"/>
<area shape="rect" href="../../d1/da8/a00230.html" title=" " alt="" coords="453,299,597,324"/>
<area shape="poly" title=" " alt="" coords="1095,246,610,302,610,297,1095,241"/>
<area shape="rect" href="../../dc/d9a/a00218.html" title=" " alt="" coords="1204,299,1341,324"/>
<area shape="poly" title=" " alt="" coords="1156,248,1239,290,1237,295,1154,253"/>
<area shape="poly" title=" " alt="" coords="2064,326,2042,357,2009,398,1966,439,1915,473,1878,487,1827,498,1703,515,1572,525,1465,531,1465,525,1572,520,1703,509,1826,493,1876,481,1913,468,1963,435,2005,394,2038,354,2059,323"/>
<area shape="rect" title=" " alt="" coords="2150,372,2217,397"/>
<area shape="poly" title=" " alt="" coords="2088,322,2154,362,2152,367,2086,326"/>
<area shape="poly" title=" " alt="" coords="1030,395,1067,432,1093,452,1121,468,1181,492,1244,508,1304,518,1355,524,1355,529,1303,524,1243,513,1179,497,1118,473,1090,456,1064,436,1026,399"/>
<area shape="poly" title=" " alt="" coords="984,400,837,448,836,443,982,395"/>
<area shape="poly" title=" " alt="" coords="1042,395,1126,437,1124,441,1040,400"/>
<area shape="poly" title=" " alt="" coords="1116,326,1050,367,1047,362,1113,322"/>
<area shape="poly" title=" " alt="" coords="1747,314,1786,320,1829,331,1872,347,1912,370,1939,393,1963,419,2005,477,2035,533,2055,578,2050,580,2031,535,2000,480,1959,422,1935,397,1908,374,1870,352,1827,336,1785,325,1747,319"/>
<area shape="poly" title=" " alt="" coords="1747,310,1783,315,1822,325,1858,343,1887,370,1901,396,1904,420,1899,444,1887,472,1862,510,1829,542,1794,568,1762,588,1759,583,1791,564,1826,538,1858,507,1882,469,1894,443,1899,420,1896,398,1883,374,1855,347,1820,330,1782,320,1747,316"/>
<area shape="poly" title=" " alt="" coords="1644,324,838,454,837,448,1643,318"/>
<area shape="poly" title=" " alt="" coords="1643,302,1636,301,1383,269,1184,247,1184,241,1383,264,1637,296,1644,297"/>
<area shape="rect" href="../../d8/d41/a00038.html" title=" " alt="" coords="1351,372,1469,397"/>
<area shape="poly" title=" " alt="" coords="1650,327,1470,371,1469,366,1649,321"/>
<area shape="poly" title=" " alt="" coords="1688,326,1603,436,1598,433,1684,323"/>
<area shape="poly" title=" " alt="" coords="1413,398,1413,505,1407,505,1407,398"/>
<area shape="poly" title=" " alt="" coords="1351,396,837,455,837,450,1350,390"/>
<area shape="poly" title=" " alt="" coords="1371,400,1204,447,1202,442,1369,395"/>
<area shape="poly" title=" " alt="" coords="1439,395,1543,438,1541,442,1437,400"/>
<area shape="poly" title=" " alt="" coords="874,324,459,378,458,373,873,319"/>
<area shape="poly" title=" " alt="" coords="932,326,825,437,821,434,929,323"/>
<area shape="poly" title=" " alt="" coords="979,296,1096,253,1097,258,981,301"/>
<area shape="poly" title=" " alt="" coords="1011,316,1321,346,1527,370,1544,383,1557,398,1576,431,1572,434,1553,402,1540,386,1525,374,1321,351,1010,322"/>
<area shape="poly" title=" " alt="" coords="1417,321,1354,327,836,362,458,383,458,378,836,357,1354,321,1417,315"/>
<area shape="poly" title=" " alt="" coords="1418,327,1085,400,838,452,836,447,1084,395,1417,321"/>
<area shape="poly" title=" " alt="" coords="1426,327,1363,347,1295,374,1237,407,1188,440,1185,435,1234,403,1293,370,1361,342,1424,321"/>
<area shape="poly" title=" " alt="" coords="1420,301,1183,251,1184,246,1421,296"/>
<area shape="poly" title=" " alt="" coords="1460,326,1430,363,1426,359,1456,323"/>
<area shape="poly" title=" " alt="" coords="1510,322,1547,340,1565,354,1579,371,1589,401,1590,432,1585,432,1584,402,1574,373,1561,358,1544,345,1507,327"/>
<area shape="poly" title=" " alt="" coords="506,326,432,367,429,363,503,322"/>
<area shape="poly" title=" " alt="" coords="453,322,404,332,361,347,346,357,337,368,335,381,342,396,359,418,377,434,396,444,416,451,463,458,520,468,595,481,694,492,934,509,1355,526,1355,531,934,514,694,497,594,486,519,473,462,464,415,456,394,449,374,438,356,422,337,399,330,381,332,366,342,353,359,342,402,327,452,317"/>
<area shape="poly" title=" " alt="" coords="536,322,569,358,617,395,655,414,696,429,768,448,767,453,694,434,653,419,614,400,566,362,532,326"/>
<area shape="poly" title=" " alt="" coords="597,300,1081,243,1082,249,597,305"/>
<area shape="poly" title=" " alt="" coords="597,313,1105,339,1357,355,1441,363,1483,369,1508,382,1531,399,1567,433,1563,437,1528,403,1505,387,1481,375,1441,368,1357,360,1105,344,597,319"/>
<area shape="poly" title=" " alt="" coords="1232,327,1073,371,1071,366,1231,321"/>
<area shape="poly" title=" " alt="" coords="1829,399,1796,436,1772,456,1746,473,1673,501,1597,519,1525,528,1465,532,1465,527,1525,523,1596,514,1672,496,1743,468,1769,452,1792,432,1825,396"/>
<area shape="poly" title=" " alt="" coords="1849,396,2041,580,2038,584,1846,400"/>
<area shape="poly" title=" " alt="" coords="1798,393,1204,455,1204,449,1797,387"/>
<area shape="rect" title=" " alt="" coords="1814,445,1873,471"/>
<area shape="poly" title=" " alt="" coords="1839,397,1843,432,1838,432,1834,398"/>
<area shape="poly" title=" " alt="" coords="142,250,150,286,159,306,172,322,210,348,253,365,297,375,338,380,337,385,296,380,251,370,207,352,168,326,154,308,145,288,136,252"/>
<area shape="poly" title=" " alt="" coords="1837,180,1719,291,1716,287,1833,176"/>
<area shape="poly" title=" " alt="" coords="309,248,258,266,235,281,216,300,195,326,178,345,167,358,168,369,181,383,214,402,351,468,411,483,517,495,809,512,1124,522,1354,527,1354,532,1123,528,809,518,516,500,410,488,349,473,212,407,178,387,163,371,162,356,174,341,191,323,212,297,231,276,255,261,308,243"/>
<area shape="poly" title=" " alt="" coords="378,250,396,280,425,321,463,362,509,395,558,412,629,427,767,449,766,455,628,433,557,417,506,400,459,366,421,324,392,283,374,252"/>
<area shape="poly" title=" " alt="" coords="422,248,609,296,689,322,750,346,811,369,891,395,1014,425,1118,446,1117,452,1013,430,889,400,809,375,748,351,687,328,608,301,421,253"/>
<area shape="poly" title=" " alt="" coords="396,248,488,290,486,295,394,253"/>
<area shape="rect" title=" " alt="" coords="226,299,277,324"/>
<area shape="poly" title=" " alt="" coords="352,253,284,294,281,289,350,248"/>
<area shape="poly" title=" " alt="" coords="491,253,451,270,405,296,362,330,344,350,330,373,325,390,328,406,337,422,349,436,375,459,388,468,446,483,547,495,829,513,1131,523,1355,527,1355,532,1131,528,828,518,547,501,445,488,386,473,371,463,345,440,332,425,323,408,320,390,325,371,340,347,359,326,402,291,448,266,489,248"/>
<area shape="poly" title=" " alt="" coords="499,253,475,266,453,283,440,303,439,312,443,323,463,343,496,363,538,382,587,400,687,428,768,447,767,452,685,433,585,405,536,387,493,368,460,348,438,325,434,313,435,301,449,280,472,262,496,248"/>
<area shape="poly" title=" " alt="" coords="583,248,665,268,755,296,812,321,854,345,896,369,952,395,1041,424,1119,445,1118,450,1039,429,950,400,894,374,851,350,810,326,753,301,664,273,582,253"/>
<area shape="poly" title=" " alt="" coords="527,251,527,285,522,285,522,251"/>
<area shape="poly" title=" " alt="" coords="763,104,763,138,758,138,758,104"/>
<area shape="poly" title=" " alt="" coords="1944,324,1941,355,1933,395,1916,437,1903,457,1886,473,1854,490,1808,504,1693,522,1568,530,1465,533,1465,527,1568,525,1692,516,1807,499,1852,485,1883,469,1898,453,1911,435,1928,394,1936,354,1939,324"/>
<area shape="poly" title=" " alt="" coords="1926,326,1866,367,1863,362,1923,322"/>
<area shape="poly" title=" " alt="" coords="61,178,57,212,59,231,64,250,80,277,98,294,150,322,197,342,247,357,338,374,337,380,246,362,195,347,148,326,95,298,76,280,60,252,54,232,52,212,55,177"/>
</map>
</div>
</div>
<p><a href="">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:abb796a32bb9b930ceb2efcbb87f4a909" id="r_abb796a32bb9b930ceb2efcbb87f4a909"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#abb796a32bb9b930ceb2efcbb87f4a909">ICCDUMPPIXEL</a>(n,  pix)</td></tr>
<tr class="separator:abb796a32bb9b930ceb2efcbb87f4a909"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09ef76f73cd16ef7b7c77358b527e816" id="r_a09ef76f73cd16ef7b7c77358b527e816"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#a09ef76f73cd16ef7b7c77358b527e816">ICCPCSSTEPDUMPFMT</a>&#160;&#160;&#160;<a class="el" href="../../dc/dfe/a00125.html#acbf74e170d642cd542691248a78c573e">ICCMTXSTEPDUMPFMT</a></td></tr>
<tr class="separator:a09ef76f73cd16ef7b7c77358b527e816"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1376d1bc8bb70237fde226cb6f49872c" id="r_a1376d1bc8bb70237fde226cb6f49872c"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#a1376d1bc8bb70237fde226cb6f49872c">IsCompatSpace</a>(x,  y)&#160;&#160;&#160;((x)==(y) || (<a class="el" href="../../d1/dc1/a00092.html#af2bf8c7d947cb795089de5f391f91d4d">IsSpacePCS</a>(x) &amp;&amp; <a class="el" href="../../d1/dc1/a00092.html#af2bf8c7d947cb795089de5f391f91d4d">IsSpacePCS</a>(y)) || (<a class="el" href="../../d3/df8/a00155.html#ac420df5122347019d9a312b07100d8de">IsSpaceMCS</a>(x) &amp;&amp; <a class="el" href="../../d3/df8/a00155.html#ac420df5122347019d9a312b07100d8de">IsSpaceMCS</a>(y))/* || (<a class="el" href="../../d3/df8/a00155.html#afc0e6f40540589cbdcd61411462e0aad">IsSpaceCMYK</a>(x) &amp;&amp; <a class="el" href="../../d3/df8/a00155.html#afc0e6f40540589cbdcd61411462e0aad">IsSpaceCMYK</a>(y))*/)</td></tr>
<tr class="separator:a1376d1bc8bb70237fde226cb6f49872c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95cfb076604d7bea59905ba50253b1d2" id="r_a95cfb076604d7bea59905ba50253b1d2"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#a95cfb076604d7bea59905ba50253b1d2">IsCompatSpacePCS</a>(x,  y)</td></tr>
<tr class="separator:a95cfb076604d7bea59905ba50253b1d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab304d4f0fe0c22e5b3e078e9ab1e7085" id="r_ab304d4f0fe0c22e5b3e078e9ab1e7085"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#ab304d4f0fe0c22e5b3e078e9ab1e7085">IsNChannelCompat</a>(x,  y)&#160;&#160;&#160;((<a class="el" href="../../d3/df8/a00155.html#ab99e08f792259e1107c118b20cacd1ce">IsSpaceNChannel</a>(x) &amp;&amp; <a class="el" href="../../d7/d46/a00002.html#a186dd5a24f08dc94beb7142e3872b426">icNumColorSpaceChannels</a>(x)==<a class="el" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(y)) || (<a class="el" href="../../d3/df8/a00155.html#ab99e08f792259e1107c118b20cacd1ce">IsSpaceNChannel</a>(y) &amp;&amp; <a class="el" href="../../d7/d46/a00002.html#a186dd5a24f08dc94beb7142e3872b426">icNumColorSpaceChannels</a>(y)==<a class="el" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(x)))</td></tr>
<tr class="separator:ab304d4f0fe0c22e5b3e078e9ab1e7085"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc0e6f40540589cbdcd61411462e0aad" id="r_afc0e6f40540589cbdcd61411462e0aad"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#afc0e6f40540589cbdcd61411462e0aad">IsSpaceCMYK</a>(x)&#160;&#160;&#160;((x)==<a class="el" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661">icSigCmykData</a> || (x)==<a class="el" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917addb4c9db388eda46c3ec7fdaa8824cf5">icSig4colorData</a>)</td></tr>
<tr class="separator:afc0e6f40540589cbdcd61411462e0aad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaacd6d45813e2697ad238b12befa5719" id="r_aaacd6d45813e2697ad238b12befa5719"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#aaacd6d45813e2697ad238b12befa5719">IsSpaceColorimetricPCS</a>(x)&#160;&#160;&#160;((x)==<a class="el" href="../../d7/d46/a00002.html#a3cc88012894a42474b7609adbe314918">icSigXYZPcsData</a> || (x)==<a class="el" href="../../d7/d46/a00002.html#a043048bd0c63d3bd54d35e8b5743d226">icSigLabPcsData</a>)</td></tr>
<tr class="separator:aaacd6d45813e2697ad238b12befa5719"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8685fe2c409e3323ec4a11938664df34" id="r_a8685fe2c409e3323ec4a11938664df34"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#a8685fe2c409e3323ec4a11938664df34">IsSpaceDevicePCS</a>(x)&#160;&#160;&#160;((x)==<a class="el" href="../../d4/d81/a00110.html#a550e980dd884839e33548afbd55b4277">icSigDevXYZData</a> || (x)==<a class="el" href="../../d4/d81/a00110.html#a92d563abc2c24efa8ccad672a9dfd14f">icSigDevLabData</a>)</td></tr>
<tr class="separator:a8685fe2c409e3323ec4a11938664df34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac420df5122347019d9a312b07100d8de" id="r_ac420df5122347019d9a312b07100d8de"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#ac420df5122347019d9a312b07100d8de">IsSpaceMCS</a>(x)&#160;&#160;&#160;(<a class="el" href="../../d7/d46/a00002.html#a47e4f847bd0bc609907b5fea4daf3e75">icGetColorSpaceType</a>(x)==<a class="el" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a79b72a0338fa6fbae9f707dd48b57f13">icSigSrcMCSChannelData</a>)</td></tr>
<tr class="separator:ac420df5122347019d9a312b07100d8de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab99e08f792259e1107c118b20cacd1ce" id="r_ab99e08f792259e1107c118b20cacd1ce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#ab99e08f792259e1107c118b20cacd1ce">IsSpaceNChannel</a>(x)&#160;&#160;&#160;(<a class="el" href="../../d7/d46/a00002.html#a47e4f847bd0bc609907b5fea4daf3e75">icGetColorSpaceType</a>(x)==<a class="el" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ac8919c5ac8fc3849f57bf7fd2fc1d70a">icSigNChannelData</a>)</td></tr>
<tr class="separator:ab99e08f792259e1107c118b20cacd1ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af2bf8c7d947cb795089de5f391f91d4d" id="r_af2bf8c7d947cb795089de5f391f91d4d"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#af2bf8c7d947cb795089de5f391f91d4d">IsSpacePCS</a>(x)&#160;&#160;&#160;(<a class="el" href="../../d3/df8/a00155.html#aaacd6d45813e2697ad238b12befa5719">IsSpaceColorimetricPCS</a>(x) || <a class="el" href="../../d3/df8/a00155.html#a05df9b9a2f56c907e676a0efc3e9219d">IsSpaceSpectralPCS</a>(x))</td></tr>
<tr class="separator:af2bf8c7d947cb795089de5f391f91d4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a05df9b9a2f56c907e676a0efc3e9219d" id="r_a05df9b9a2f56c907e676a0efc3e9219d"><td class="memItemLeft" align="right" valign="top">static __inline bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#a05df9b9a2f56c907e676a0efc3e9219d">IsSpaceSpectralPCS</a> (<a class="el" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> sig)</td></tr>
<tr class="separator:a05df9b9a2f56c907e676a0efc3e9219d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36a692db621ce2ccea49767209ab8294" id="r_a36a692db621ce2ccea49767209ab8294"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#a36a692db621ce2ccea49767209ab8294">RGBClip</a> (<a class="el" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> v, <a class="el" href="../../dd/de4/a01121.html">CIccCurve</a> *pCurve)</td></tr>
<tr class="separator:a36a692db621ce2ccea49767209ab8294"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5a787099f4191e4c234ca3301c9cc0a" id="r_ae5a787099f4191e4c234ca3301c9cc0a"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#ae5a787099f4191e4c234ca3301c9cc0a">XYZDescale</a> (<a class="el" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> v)</td></tr>
<tr class="separator:ae5a787099f4191e4c234ca3301c9cc0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7c8bbc66b122b6419782fbfb02d51ac" id="r_aa7c8bbc66b122b6419782fbfb02d51ac"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#aa7c8bbc66b122b6419782fbfb02d51ac">XYZScale</a> (<a class="el" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> v)</td></tr>
<tr class="separator:aa7c8bbc66b122b6419782fbfb02d51ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a961f0b709819f36204e7da4148c1505e" id="r_a961f0b709819f36204e7da4148c1505e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/df8/a00155.html#a961f0b709819f36204e7da4148c1505e">icD50XYZ</a> [3]</td></tr>
<tr class="separator:a961f0b709819f36204e7da4148c1505e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>File: <a class="el" href="../../d3/df8/a00155.html">IccCmm.cpp</a></p>
<p>Contains: Implementation of the CIccCmm class.</p>
<p>Version: V1</p>
<p>Copyright: � see ICC Software License </p>

<p class="definition">Definition in file <a class="el" href="../../">IccCmm.cpp</a>.</p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="abb796a32bb9b930ceb2efcbb87f4a909" name="abb796a32bb9b930ceb2efcbb87f4a909"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb796a32bb9b930ceb2efcbb87f4a909">&#9670;&#160;</a></span>ICCDUMPPIXEL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ICCDUMPPIXEL</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">n, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">pix&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a09ef76f73cd16ef7b7c77358b527e816" name="a09ef76f73cd16ef7b7c77358b527e816"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09ef76f73cd16ef7b7c77358b527e816">&#9670;&#160;</a></span>ICCPCSSTEPDUMPFMT</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ICCPCSSTEPDUMPFMT&#160;&#160;&#160;<a class="el" href="../../dc/dfe/a00125.html#acbf74e170d642cd542691248a78c573e">ICCMTXSTEPDUMPFMT</a></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a1376d1bc8bb70237fde226cb6f49872c" name="a1376d1bc8bb70237fde226cb6f49872c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1376d1bc8bb70237fde226cb6f49872c">&#9670;&#160;</a></span>IsCompatSpace</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IsCompatSpace</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((x)==(y) || (<a class="el" href="../../d1/dc1/a00092.html#af2bf8c7d947cb795089de5f391f91d4d">IsSpacePCS</a>(x) &amp;&amp; <a class="el" href="../../d1/dc1/a00092.html#af2bf8c7d947cb795089de5f391f91d4d">IsSpacePCS</a>(y)) || (<a class="el" href="../../d3/df8/a00155.html#ac420df5122347019d9a312b07100d8de">IsSpaceMCS</a>(x) &amp;&amp; <a class="el" href="../../d3/df8/a00155.html#ac420df5122347019d9a312b07100d8de">IsSpaceMCS</a>(y))/* || (<a class="el" href="../../d3/df8/a00155.html#afc0e6f40540589cbdcd61411462e0aad">IsSpaceCMYK</a>(x) &amp;&amp; <a class="el" href="../../d3/df8/a00155.html#afc0e6f40540589cbdcd61411462e0aad">IsSpaceCMYK</a>(y))*/)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a95cfb076604d7bea59905ba50253b1d2" name="a95cfb076604d7bea59905ba50253b1d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95cfb076604d7bea59905ba50253b1d2">&#9670;&#160;</a></span>IsCompatSpacePCS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IsCompatSpacePCS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<b>Value:</b><div class="fragment"><div class="line">                                (((x)==<a class="code hl_define" href="../../d4/d81/a00110.html#a550e980dd884839e33548afbd55b4277">icSigDevXYZData</a> &amp;&amp; (y)==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>) || ((x)==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a> &amp;&amp; (y)==<a class="code hl_define" href="../../d4/d81/a00110.html#a550e980dd884839e33548afbd55b4277">icSigDevXYZData</a>) || \</div>
<div class="line">                                ((x)==<a class="code hl_define" href="../../d4/d81/a00110.html#a92d563abc2c24efa8ccad672a9dfd14f">icSigDevLabData</a> &amp;&amp; (y)==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>) || ((x)==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a> &amp;&amp; (y)==<a class="code hl_define" href="../../d4/d81/a00110.html#a92d563abc2c24efa8ccad672a9dfd14f">icSigDevLabData</a>))</div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a></div><div class="ttdeci">@ icSigLabData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:847</div></div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a></div><div class="ttdeci">@ icSigXYZData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:846</div></div>
<div class="ttc" id="aa00110_html_a550e980dd884839e33548afbd55b4277"><div class="ttname"><a href="../../d4/d81/a00110.html#a550e980dd884839e33548afbd55b4277">icSigDevXYZData</a></div><div class="ttdeci">#define icSigDevXYZData</div><div class="ttdef"><b>Definition</b> IccDefs.h:92</div></div>
<div class="ttc" id="aa00110_html_a92d563abc2c24efa8ccad672a9dfd14f"><div class="ttname"><a href="../../d4/d81/a00110.html#a92d563abc2c24efa8ccad672a9dfd14f">icSigDevLabData</a></div><div class="ttdeci">#define icSigDevLabData</div><div class="ttdef"><b>Definition</b> IccDefs.h:91</div></div>
</div><!-- fragment --><div class="fragment"><div class="line"><span class="lineno">  133</span>{</div>
<div class="line"><span class="lineno">  134</span>  <span class="keywordflow">if</span> (v&lt;0)</div>
<div class="line"><span class="lineno">  135</span>    v = 0;</div>
<div class="line"><span class="lineno">  136</span>  <span class="keywordflow">if</span> (v&gt;1.0)</div>
<div class="line"><span class="lineno">  137</span>    v = 1.0;</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>  <span class="keywordflow">return</span> v;</div>
<div class="line"><span class="lineno">  140</span>}</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  150</span><a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> CIccPCSUtil::NegClip(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> v)</div>
<div class="line"><span class="lineno">  151</span>{</div>
<div class="line"><span class="lineno">  152</span>  <span class="keywordflow">if</span> (v&lt;0)</div>
<div class="line"><span class="lineno">  153</span>    v=0;</div>
<div class="line"><span class="lineno">  154</span>  </div>
<div class="line"><span class="lineno">  155</span>  <span class="keywordflow">return</span> v;</div>
<div class="line"><span class="lineno">  156</span>}</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  166</span><span class="keywordtype">void</span> CIccPCSUtil::LabToXyz(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Dst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Src, <span class="keywordtype">bool</span> bNoClip)</div>
<div class="line"><span class="lineno">  167</span>{</div>
<div class="line"><span class="lineno">  168</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> Lab[3];</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>  memcpy(&amp;Lab,Src,<span class="keyword">sizeof</span>(Lab));</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>  <a class="code hl_function" href="../../d7/dce/a00143.html#ac5de02865f572ea243f6da8c144c02fa">icLabFromPcs</a>(Lab);</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>  <a class="code hl_function" href="../../d7/dce/a00143.html#aaf617b49cf0d56a218cd52c840228705">icLabtoXYZ</a>(Lab);</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>  <a class="code hl_function" href="../../d7/dce/a00143.html#a4b4cfb7788c3a780f19f2f104677a5b8">icXyzToPcs</a>(Lab);</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>  <span class="keywordflow">if</span> (!bNoClip) {</div>
<div class="line"><span class="lineno">  179</span>    Dst[0] = <a class="code hl_function" href="../../d6/de1/a00356.html#a6c0519738b01f52ba7341b517d3da7e4">UnitClip</a>(Lab[0]);</div>
<div class="line"><span class="lineno">  180</span>    Dst[1] = <a class="code hl_function" href="../../d6/de1/a00356.html#a6c0519738b01f52ba7341b517d3da7e4">UnitClip</a>(Lab[1]);</div>
<div class="line"><span class="lineno">  181</span>    Dst[2] = <a class="code hl_function" href="../../d6/de1/a00356.html#a6c0519738b01f52ba7341b517d3da7e4">UnitClip</a>(Lab[2]);</div>
<div class="line"><span class="lineno">  182</span>  }</div>
<div class="line"><span class="lineno">  183</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  184</span>    Dst[0] = Lab[0];</div>
<div class="line"><span class="lineno">  185</span>    Dst[1] = Lab[1];</div>
<div class="line"><span class="lineno">  186</span>    Dst[2] = Lab[2];</div>
<div class="line"><span class="lineno">  187</span>  }</div>
<div class="line"><span class="lineno">  188</span>}</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  199</span><span class="keywordtype">void</span> CIccPCSUtil::XyzToLab(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Dst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Src, <span class="keywordtype">bool</span> bNoClip)</div>
<div class="line"><span class="lineno">  200</span>{</div>
<div class="line"><span class="lineno">  201</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> XYZ[3];</div>
<div class="line"><span class="lineno">  202</span> </div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>  <span class="keywordflow">if</span> (!bNoClip) {</div>
<div class="line"><span class="lineno">  205</span>    XYZ[0] = <a class="code hl_function" href="../../d6/de1/a00356.html#a6c0519738b01f52ba7341b517d3da7e4">UnitClip</a>(Src[0]);</div>
<div class="line"><span class="lineno">  206</span>    XYZ[1] = <a class="code hl_function" href="../../d6/de1/a00356.html#a6c0519738b01f52ba7341b517d3da7e4">UnitClip</a>(Src[1]);</div>
<div class="line"><span class="lineno">  207</span>    XYZ[2] = <a class="code hl_function" href="../../d6/de1/a00356.html#a6c0519738b01f52ba7341b517d3da7e4">UnitClip</a>(Src[2]);</div>
<div class="line"><span class="lineno">  208</span>  }</div>
<div class="line"><span class="lineno">  209</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  210</span>    XYZ[0] = Src[0];</div>
<div class="line"><span class="lineno">  211</span>    XYZ[1] = Src[1];</div>
<div class="line"><span class="lineno">  212</span>    XYZ[2] = Src[2];</div>
<div class="line"><span class="lineno">  213</span>  }</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>  <a class="code hl_function" href="../../d7/dce/a00143.html#a78841df2e0aea059520ce71944c4c3bb">icXyzFromPcs</a>(XYZ);</div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>  <a class="code hl_function" href="../../d7/dce/a00143.html#a4ff45349385af6c19d5b3f68150a27b5">icXYZtoLab</a>(XYZ);</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>  <a class="code hl_function" href="../../d7/dce/a00143.html#a5768271d491af79a433e52722ed0a189">icLabToPcs</a>(XYZ);</div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>  <span class="keywordflow">if</span> (!bNoClip) {</div>
<div class="line"><span class="lineno">  222</span>    Dst[0] = <a class="code hl_function" href="../../d6/de1/a00356.html#a6c0519738b01f52ba7341b517d3da7e4">UnitClip</a>(XYZ[0]);</div>
<div class="line"><span class="lineno">  223</span>    Dst[1] = <a class="code hl_function" href="../../d6/de1/a00356.html#a6c0519738b01f52ba7341b517d3da7e4">UnitClip</a>(XYZ[1]);</div>
<div class="line"><span class="lineno">  224</span>    Dst[2] = <a class="code hl_function" href="../../d6/de1/a00356.html#a6c0519738b01f52ba7341b517d3da7e4">UnitClip</a>(XYZ[2]);</div>
<div class="line"><span class="lineno">  225</span>  }</div>
<div class="line"><span class="lineno">  226</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  227</span>    Dst[0] = XYZ[0];</div>
<div class="line"><span class="lineno">  228</span>    Dst[1] = XYZ[1];</div>
<div class="line"><span class="lineno">  229</span>    Dst[2] = XYZ[2];</div>
<div class="line"><span class="lineno">  230</span>  }</div>
<div class="line"><span class="lineno">  231</span>}</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  242</span><span class="keywordtype">void</span> CIccPCSUtil::Lab2ToXyz(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Dst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Src, <span class="keywordtype">bool</span> bNoClip)</div>
<div class="line"><span class="lineno">  243</span>{</div>
<div class="line"><span class="lineno">  244</span>  Lab2ToLab4(Dst, Src, bNoClip);</div>
<div class="line"><span class="lineno">  245</span>  LabToXyz(Dst, Dst, bNoClip);</div>
<div class="line"><span class="lineno">  246</span>}</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  257</span><span class="keywordtype">void</span> CIccPCSUtil::XyzToLab2(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Dst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Src, <span class="keywordtype">bool</span> bNoClip)</div>
<div class="line"><span class="lineno">  258</span>{</div>
<div class="line"><span class="lineno">  259</span>  XyzToLab(Dst, Src, bNoClip);</div>
<div class="line"><span class="lineno">  260</span>  Lab4ToLab2(Dst, Dst);</div>
<div class="line"><span class="lineno">  261</span>}</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  272</span><span class="keywordtype">void</span> CIccPCSUtil::Lab2ToLab4(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Dst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Src, <span class="keywordtype">bool</span> bNoClip)</div>
<div class="line"><span class="lineno">  273</span>{</div>
<div class="line"><span class="lineno">  274</span>  <span class="keywordflow">if</span> (bNoClip) {</div>
<div class="line"><span class="lineno">  275</span>    Dst[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(Src[0] * 65535.0f / 65280.0f);</div>
<div class="line"><span class="lineno">  276</span>    Dst[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(Src[1] * 65535.0f / 65280.0f);</div>
<div class="line"><span class="lineno">  277</span>    Dst[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(Src[2] * 65535.0f / 65280.0f);</div>
<div class="line"><span class="lineno">  278</span>  }</div>
<div class="line"><span class="lineno">  279</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  280</span>    Dst[0] = <a class="code hl_function" href="../../d6/de1/a00356.html#a6c0519738b01f52ba7341b517d3da7e4">UnitClip</a>((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(Src[0] * 65535.0f / 65280.0f));</div>
<div class="line"><span class="lineno">  281</span>    Dst[1] = <a class="code hl_function" href="../../d6/de1/a00356.html#a6c0519738b01f52ba7341b517d3da7e4">UnitClip</a>((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(Src[1] * 65535.0f / 65280.0f));</div>
<div class="line"><span class="lineno">  282</span>    Dst[2] = <a class="code hl_function" href="../../d6/de1/a00356.html#a6c0519738b01f52ba7341b517d3da7e4">UnitClip</a>((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(Src[2] * 65535.0f / 65280.0f));</div>
<div class="line"><span class="lineno">  283</span>  }</div>
<div class="line"><span class="lineno">  284</span>}</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  294</span><span class="keywordtype">void</span> CIccPCSUtil::Lab4ToLab2(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Dst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Src)</div>
<div class="line"><span class="lineno">  295</span>{</div>
<div class="line"><span class="lineno">  296</span>  Dst[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(Src[0] * 65280.0f / 65535.0f);</div>
<div class="line"><span class="lineno">  297</span>  Dst[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(Src[1] * 65280.0f / 65535.0f);</div>
<div class="line"><span class="lineno">  298</span>  Dst[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(Src[2] * 65280.0f / 65535.0f);</div>
<div class="line"><span class="lineno">  299</span>}</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span> </div>
<div class="line"><span class="lineno">  310</span>CIccCreateXformHintManager::~CIccCreateXformHintManager()</div>
<div class="line"><span class="lineno">  311</span>{</div>
<div class="line"><span class="lineno">  312</span>    <span class="keywordflow">if</span> (m_pList) {</div>
<div class="line"><span class="lineno">  313</span>        IIccCreateXformHintList::iterator i;</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>        <span class="keywordflow">for</span> (i=m_pList-&gt;begin(); i!=m_pList-&gt;end(); i++) {</div>
<div class="line"><span class="lineno">  316</span>            <span class="keywordflow">if</span> (i-&gt;ptr)</div>
<div class="line"><span class="lineno">  317</span>                <span class="keyword">delete</span> i-&gt;ptr;</div>
<div class="line"><span class="lineno">  318</span>        }</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>        <span class="keyword">delete</span> m_pList;</div>
<div class="line"><span class="lineno">  321</span>    }</div>
<div class="line"><span class="lineno">  322</span>}</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  339</span><span class="keywordtype">bool</span> CIccCreateXformHintManager::AddHint(IIccCreateXformHint* pHint)</div>
<div class="line"><span class="lineno">  340</span>{</div>
<div class="line"><span class="lineno">  341</span>    <span class="keywordflow">if</span> (!m_pList) {</div>
<div class="line"><span class="lineno">  342</span>        m_pList = <span class="keyword">new</span> IIccCreateXformHintList;</div>
<div class="line"><span class="lineno">  343</span>    }</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>    <span class="keywordflow">if</span> (pHint) {</div>
<div class="line"><span class="lineno">  346</span>        <span class="keywordflow">if</span> (GetHint(pHint-&gt;GetHintType())) {</div>
<div class="line"><span class="lineno">  347</span>            <span class="keyword">delete</span> pHint;</div>
<div class="line"><span class="lineno">  348</span>            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  349</span>        }</div>
<div class="line"><span class="lineno">  350</span>        IIccCreateXformHintPtr Hint;</div>
<div class="line"><span class="lineno">  351</span>        Hint.ptr = pHint;</div>
<div class="line"><span class="lineno">  352</span>        m_pList-&gt;push_back(Hint);</div>
<div class="line"><span class="lineno">  353</span>        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  354</span>    }</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  357</span>}</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  375</span><span class="keywordtype">bool</span> CIccCreateXformHintManager::DeleteHint(IIccCreateXformHint* pHint)</div>
<div class="line"><span class="lineno">  376</span>{</div>
<div class="line"><span class="lineno">  377</span>    <span class="keywordflow">if</span> (m_pList &amp;&amp; pHint) {</div>
<div class="line"><span class="lineno">  378</span>        IIccCreateXformHintList::iterator i;</div>
<div class="line"><span class="lineno">  379</span>        <span class="keywordflow">for</span> (i=m_pList-&gt;begin(); i!=m_pList-&gt;end(); i++) {</div>
<div class="line"><span class="lineno">  380</span>            <span class="keywordflow">if</span> (i-&gt;ptr) {</div>
<div class="line"><span class="lineno">  381</span>                <span class="keywordflow">if</span> (i-&gt;ptr == pHint) {</div>
<div class="line"><span class="lineno">  382</span>                    <span class="keyword">delete</span> pHint;</div>
<div class="line"><span class="lineno">  383</span>                    pHint = NULL;</div>
<div class="line"><span class="lineno">  384</span>                    m_pList-&gt;erase(i);</div>
<div class="line"><span class="lineno">  385</span>                    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  386</span>                }</div>
<div class="line"><span class="lineno">  387</span>            }</div>
<div class="line"><span class="lineno">  388</span>        }</div>
<div class="line"><span class="lineno">  389</span>    }</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  392</span>}</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  408</span>IIccCreateXformHint* CIccCreateXformHintManager::GetHint(<span class="keyword">const</span> <span class="keywordtype">char</span>* hintName)</div>
<div class="line"><span class="lineno">  409</span>{</div>
<div class="line"><span class="lineno">  410</span>    IIccCreateXformHint* pHint=NULL;</div>
<div class="line"><span class="lineno">  411</span>    </div>
<div class="line"><span class="lineno">  412</span>    <span class="keywordflow">if</span> (m_pList) {</div>
<div class="line"><span class="lineno">  413</span>        IIccCreateXformHintList::iterator i;</div>
<div class="line"><span class="lineno">  414</span>        <span class="keywordflow">for</span> (i=m_pList-&gt;begin(); i!=m_pList-&gt;end(); i++) {</div>
<div class="line"><span class="lineno">  415</span>            <span class="keywordflow">if</span> (i-&gt;ptr) {</div>
<div class="line"><span class="lineno">  416</span>                <span class="keywordflow">if</span> (!strcmp(i-&gt;ptr-&gt;GetHintType(), hintName)) {</div>
<div class="line"><span class="lineno">  417</span>                    pHint = i-&gt;ptr;</div>
<div class="line"><span class="lineno">  418</span>                    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  419</span>                }</div>
<div class="line"><span class="lineno">  420</span>            }</div>
<div class="line"><span class="lineno">  421</span>        }</div>
<div class="line"><span class="lineno">  422</span>    }</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>    <span class="keywordflow">return</span> pHint;</div>
<div class="line"><span class="lineno">  425</span>}</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  435</span>CIccXform::CIccXform() </div>
<div class="line"><span class="lineno">  436</span>{</div>
<div class="line"><span class="lineno">  437</span>  m_pProfile = NULL;</div>
<div class="line"><span class="lineno">  438</span>  m_bOwnsProfile = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  439</span>  m_bInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  440</span>  m_nIntent = <a class="code hl_define" href="../../d7/d46/a00002.html#a0fbdbf76357f4ad739b1df71bd87ef8a">icUnknownIntent</a>;</div>
<div class="line"><span class="lineno">  441</span>  m_pAdjustPCS = NULL;</div>
<div class="line"><span class="lineno">  442</span>  m_bAdjustPCS = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  443</span>  m_bAbsToRel = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  444</span>  m_nMCS = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393a7777670882f9cded205c604bbdde8b0d">icNoMCS</a>;</div>
<div class="line"><span class="lineno">  445</span>  m_bUseSpectralPCS = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  446</span>  m_bSrcPcsConversion = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  447</span>  m_bDstPcsConversion = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  448</span>  m_pConnectionConditions = NULL;</div>
<div class="line"><span class="lineno">  449</span>  m_bDeleteEnvLooup = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  450</span>  m_pCmmEnvVarLookup = NULL;</div>
<div class="line"><span class="lineno">  451</span>  m_nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a>;</div>
<div class="line"><span class="lineno">  452</span>  m_MediaXYZ = {};</div>
<div class="line"><span class="lineno">  453</span>  m_nInterp = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913af6e0f18af557a029c4dda563c3a003fb">icInterpLinear</a>;</div>
<div class="line"><span class="lineno">  454</span>  m_bUseD2BTags = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  455</span>  m_bLuminanceMatching = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  456</span>  m_PCSOffset[0] = m_PCSOffset[1] = m_PCSOffset[2] = 0;</div>
<div class="line"><span class="lineno">  457</span>}</div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  468</span>CIccXform::~CIccXform()</div>
<div class="line"><span class="lineno">  469</span>{</div>
<div class="line"><span class="lineno">  470</span>  <span class="keywordflow">if</span> (m_pProfile &amp;&amp; m_bOwnsProfile)</div>
<div class="line"><span class="lineno">  471</span>    <span class="keyword">delete</span> m_pProfile;</div>
<div class="line"><span class="lineno">  472</span> </div>
<div class="line"><span class="lineno">  473</span>    <span class="keywordflow">if</span> (m_pAdjustPCS) {</div>
<div class="line"><span class="lineno">  474</span>        <span class="keyword">delete</span> m_pAdjustPCS;</div>
<div class="line"><span class="lineno">  475</span>    }</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>  <span class="keywordflow">if</span> (m_pCmmEnvVarLookup &amp;&amp; m_bDeleteEnvLooup) {</div>
<div class="line"><span class="lineno">  478</span>    <span class="keyword">delete</span> m_pCmmEnvVarLookup;</div>
<div class="line"><span class="lineno">  479</span>  }</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>}</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span><span class="keywordtype">void</span> CIccXform::DetachAll()</div>
<div class="line"><span class="lineno">  485</span>{</div>
<div class="line"><span class="lineno">  486</span>  m_pProfile = NULL;</div>
<div class="line"><span class="lineno">  487</span>  m_bOwnsProfile = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  488</span>  m_pConnectionConditions = NULL;</div>
<div class="line"><span class="lineno">  489</span>}</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  514</span>CIccXform *CIccXform::Create(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile,</div>
<div class="line"><span class="lineno">  515</span>                             <span class="keywordtype">bool</span> bInput<span class="comment">/* =true */</span>,</div>
<div class="line"><span class="lineno">  516</span>                             <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nIntent<span class="comment">/* =icUnknownIntent */</span>, </div>
<div class="line"><span class="lineno">  517</span>                                                         <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913">icXformInterp</a> nInterp<span class="comment">/* =icInterpLinear */</span>, </div>
<div class="line"><span class="lineno">  518</span>                             <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc<span class="comment">/*=NULL*/</span>,</div>
<div class="line"><span class="lineno">  519</span>                             <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7b">icXformLutType</a> nLutType<span class="comment">/* =icXformLutColor */</span>, </div>
<div class="line"><span class="lineno">  520</span>                                                         <span class="keywordtype">bool</span> bUseD2BTags<span class="comment">/* =true */</span>, CIccCreateXformHintManager *pHintManager<span class="comment">/* =NULL */</span>)</div>
<div class="line"><span class="lineno">  521</span>{</div>
<div class="line"><span class="lineno">  522</span>  CIccXform *rv = NULL;</div>
<div class="line"><span class="lineno">  523</span>  <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nTagIntent = nIntent;</div>
<div class="line"><span class="lineno">  524</span>  <span class="keywordtype">bool</span> bUseSpectralPCS = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  525</span>  <span class="keywordtype">bool</span> bAbsToRel = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  526</span>  <span class="keywordtype">bool</span> bRelToAbs = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  527</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393">icMCSConnectionType</a> nMCS = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393a7777670882f9cded205c604bbdde8b0d">icNoMCS</a>;</div>
<div class="line"><span class="lineno">  528</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7b">icXformLutType</a> nUseLutType = nLutType;</div>
<div class="line"><span class="lineno">  529</span>  <span class="keywordtype">bool</span> bUseColorimeticTags = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>  <span class="keywordflow">if</span> (nLutType == <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262">icXformLutSpectral</a>) {</div>
<div class="line"><span class="lineno">  532</span>    nUseLutType = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614">icXformLutColor</a>;</div>
<div class="line"><span class="lineno">  533</span>    bUseD2BTags = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  534</span>    bUseColorimeticTags = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  535</span>  }</div>
<div class="line"><span class="lineno">  536</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nLutType == <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013">icXformLutColorimetric</a>) {</div>
<div class="line"><span class="lineno">  537</span>    nUseLutType = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614">icXformLutColor</a>;</div>
<div class="line"><span class="lineno">  538</span>  }</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>  <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a24cf99d0920e4e0b4549d67311e99928">icSigColorEncodingClass</a>) {</div>
<div class="line"><span class="lineno">  541</span>    <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pEncProfile;</div>
<div class="line"><span class="lineno">  542</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/dd5/a00215.html#aa1b934352875d96de59a8b3332dc8e1d">icConvertEncodingProfile</a>(pEncProfile, pProfile)!=<a class="code hl_enumvalue" href="../../d3/dd5/a00215.html#af0a7084e49f2f756cb1ff0cc500a9a41a3fed7724f564a3c845311a6694bc0b06">icEncConvertOk</a>)</div>
<div class="line"><span class="lineno">  543</span>      <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  544</span>    <span class="keyword">delete</span> pProfile;</div>
<div class="line"><span class="lineno">  545</span>    pProfile = pEncProfile;</div>
<div class="line"><span class="lineno">  546</span>  }</div>
<div class="line"><span class="lineno">  547</span>  <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0af50c13fdfab9fcc0a7b831ac86d1fe3b">icSigLinkClass</a><span class="comment">/* &amp;&amp; nIntent==icAbsoluteColorimetric*/</span>) {</div>
<div class="line"><span class="lineno">  548</span>    nIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a>;</div>
<div class="line"><span class="lineno">  549</span>  }</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>  <span class="keywordflow">if</span> (nTagIntent == <a class="code hl_define" href="../../d7/d46/a00002.html#a0fbdbf76357f4ad739b1df71bd87ef8a">icUnknownIntent</a>)</div>
<div class="line"><span class="lineno">  552</span>    nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a>;</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>  <span class="keywordflow">switch</span> (nUseLutType) {</div>
<div class="line"><span class="lineno">  555</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614">icXformLutColor</a>:</div>
<div class="line"><span class="lineno">  556</span>      <span class="keywordflow">if</span> (bInput) {</div>
<div class="line"><span class="lineno">  557</span>        <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = NULL;</div>
<div class="line"><span class="lineno">  558</span>        <span class="keywordflow">if</span> (bUseD2BTags) {</div>
<div class="line"><span class="lineno">  559</span>          <span class="keywordflow">if</span> (pProfile-&gt;m_Header.spectralPCS &amp;&amp; nLutType!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013">icXformLutColorimetric</a>) {</div>
<div class="line"><span class="lineno">  560</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a703f1866ed4cc98f623090b38917bc8e">icSigDToB0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>            <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno">  563</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ae185d0e91c27dc49b2a4a328de2fbb92">icSigDToB1Tag</a>);</div>
<div class="line"><span class="lineno">  564</span>              <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno">  565</span>                nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno">  566</span>            }</div>
<div class="line"><span class="lineno">  567</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>) {</div>
<div class="line"><span class="lineno">  568</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a585329dfc33381a67de302149941bd38">icSigDToB3Tag</a>);</div>
<div class="line"><span class="lineno">  569</span>              <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno">  570</span>                nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno">  571</span>                bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  572</span>              }</div>
<div class="line"><span class="lineno">  573</span>            }</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span>            <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno">  576</span>              bUseSpectralPCS = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>            <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  579</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a703f1866ed4cc98f623090b38917bc8e">icSigDToB0Tag</a>);</div>
<div class="line"><span class="lineno">  580</span>            }</div>
<div class="line"><span class="lineno">  581</span>            <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  582</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ae185d0e91c27dc49b2a4a328de2fbb92">icSigDToB1Tag</a>);</div>
<div class="line"><span class="lineno">  583</span>            }</div>
<div class="line"><span class="lineno">  584</span>            <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  585</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a585329dfc33381a67de302149941bd38">icSigDToB3Tag</a>);</div>
<div class="line"><span class="lineno">  586</span>              <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno">  587</span>                nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno">  588</span>                bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  589</span>              }</div>
<div class="line"><span class="lineno">  590</span>            }</div>
<div class="line"><span class="lineno">  591</span>          }</div>
<div class="line"><span class="lineno">  592</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pProfile-&gt;m_Header.version &lt; <a class="code hl_define" href="../../d7/d46/a00002.html#a802c8f93248af9679280a8c10705807c">icVersionNumberV5</a>) {</div>
<div class="line"><span class="lineno">  593</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a703f1866ed4cc98f623090b38917bc8e">icSigDToB0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>            <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent ==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno">  596</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ae185d0e91c27dc49b2a4a328de2fbb92">icSigDToB1Tag</a>);</div>
<div class="line"><span class="lineno">  597</span>              <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno">  598</span>                nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno">  599</span>            }</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>            <span class="comment">//Apparently Using DtoB0 is not prescribed here by the v4 ICC Specification</span></div>
<div class="line"><span class="lineno">  602</span>            <span class="keywordflow">if</span> (!pTag &amp;&amp; pProfile-&gt;m_Header.version &gt;= <a class="code hl_define" href="../../d7/d46/a00002.html#a802c8f93248af9679280a8c10705807c">icVersionNumberV5</a>) {</div>
<div class="line"><span class="lineno">  603</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a703f1866ed4cc98f623090b38917bc8e">icSigDToB0Tag</a>);</div>
<div class="line"><span class="lineno">  604</span>            }</div>
<div class="line"><span class="lineno">  605</span>          }</div>
<div class="line"><span class="lineno">  606</span>        }</div>
<div class="line"><span class="lineno">  607</span> </div>
<div class="line"><span class="lineno">  608</span>        <span class="keywordflow">if</span> (bUseColorimeticTags) {</div>
<div class="line"><span class="lineno">  609</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  610</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a48a680ba3049e0c37a44da9f08e411c7">icSigAToB0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno">  611</span>          }</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>          <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno">  614</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ab04125e571eb02f134e54fb3b0bcdb45">icSigAToB1Tag</a>);</div>
<div class="line"><span class="lineno">  615</span>            <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno">  616</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno">  617</span>          }</div>
<div class="line"><span class="lineno">  618</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>) {</div>
<div class="line"><span class="lineno">  619</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a19b39e0d70b49c0c8864ec3b5ee2f1ba">icSigAToB3Tag</a>);</div>
<div class="line"><span class="lineno">  620</span>            <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno">  621</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno">  622</span>              bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  623</span>            }</div>
<div class="line"><span class="lineno">  624</span>          }</div>
<div class="line"><span class="lineno">  625</span> </div>
<div class="line"><span class="lineno">  626</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  627</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a48a680ba3049e0c37a44da9f08e411c7">icSigAToB0Tag</a>);</div>
<div class="line"><span class="lineno">  628</span>          }</div>
<div class="line"><span class="lineno">  629</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  630</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ab04125e571eb02f134e54fb3b0bcdb45">icSigAToB1Tag</a>);</div>
<div class="line"><span class="lineno">  631</span>          }</div>
<div class="line"><span class="lineno">  632</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  633</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a19b39e0d70b49c0c8864ec3b5ee2f1ba">icSigAToB3Tag</a>);</div>
<div class="line"><span class="lineno">  634</span>            <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno">  635</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno">  636</span>              bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  637</span>            }</div>
<div class="line"><span class="lineno">  638</span>          }</div>
<div class="line"><span class="lineno">  639</span>        }</div>
<div class="line"><span class="lineno">  640</span> </div>
<div class="line"><span class="lineno">  641</span>        <span class="comment">//Unsupported elements cause fall back behavior</span></div>
<div class="line"><span class="lineno">  642</span>        <span class="keywordflow">if</span> (pTag &amp;&amp; !pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a3415307280dc7b871cc1797704008991">IsSupported</a>())</div>
<div class="line"><span class="lineno">  643</span>          pTag = NULL;</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>        <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  646</span>          <span class="keywordflow">if</span> (pProfile-&gt;m_Header.version &lt; <a class="code hl_define" href="../../d7/d46/a00002.html#a802c8f93248af9679280a8c10705807c">icVersionNumberV5</a>) {</div>
<div class="line"><span class="lineno">  647</span>            <span class="comment">//Matrix/TRC profiles are deprecated in v5 profiles</span></div>
<div class="line"><span class="lineno">  648</span>            <span class="keywordflow">if</span> (pProfile-&gt;m_Header.colorSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30">icSigRgbData</a>) {</div>
<div class="line"><span class="lineno">  649</span>              rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa06be3d5a167735863cb627f627c27988">icXformTypeMatrixTRC</a>, NULL, pHintManager);</div>
<div class="line"><span class="lineno">  650</span>            }</div>
<div class="line"><span class="lineno">  651</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pProfile-&gt;m_Header.colorSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917af4c6afaa42216765b0431ec6ae0ba27c">icSigGrayData</a>) {</div>
<div class="line"><span class="lineno">  652</span>              rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa4ce2fe52f1dcd97ba1d6b9ad0628e6df">icXformTypeMonochrome</a>, NULL, pHintManager);</div>
<div class="line"><span class="lineno">  653</span>            }</div>
<div class="line"><span class="lineno">  654</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  655</span>              <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  656</span>          }</div>
<div class="line"><span class="lineno">  657</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  658</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  659</span>        }</div>
<div class="line"><span class="lineno">  660</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">GetType</a>()==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481">icSigMultiProcessElementType</a>) {</div>
<div class="line"><span class="lineno">  661</span>          rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d">icXformTypeMpe</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno">  662</span>        }</div>
<div class="line"><span class="lineno">  663</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  664</span>          <span class="keywordflow">switch</span>(pProfile-&gt;m_Header.colorSpace) {</div>
<div class="line"><span class="lineno">  665</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>:</div>
<div class="line"><span class="lineno">  666</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>:</div>
<div class="line"><span class="lineno">  667</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0ab090e1f79d31e78c006c6ab25933dd">icSigLuvData</a>:</div>
<div class="line"><span class="lineno">  668</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ae02a4b86c48a9b85be92fdfc2114e496">icSigYCbCrData</a>:</div>
<div class="line"><span class="lineno">  669</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917afc7f319f261280fc48d7510c3a8bc330">icSigYxyData</a>:</div>
<div class="line"><span class="lineno">  670</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30">icSigRgbData</a>:</div>
<div class="line"><span class="lineno">  671</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917afc7cddf72b4d83ee5cb3568143580828">icSigHsvData</a>:</div>
<div class="line"><span class="lineno">  672</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad4a717752d16d5fcf92e1fdd892b8bd8">icSigHlsData</a>:</div>
<div class="line"><span class="lineno">  673</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917af20259a5702129c41fd08e21c7e94a74">icSigCmyData</a>:</div>
<div class="line"><span class="lineno">  674</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917afa0686ad8f20f604e7e52807087f04da">icSig3colorData</a>:</div>
<div class="line"><span class="lineno">  675</span>              rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa8f98fe94a91c4c002341c77b47ffed35">icXformType3DLut</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno">  676</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661">icSigCmykData</a>:</div>
<div class="line"><span class="lineno">  679</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917addb4c9db388eda46c3ec7fdaa8824cf5">icSig4colorData</a>:</div>
<div class="line"><span class="lineno">  680</span>              rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa9ad326943cff407bb96bdc9a53920996">icXformType4DLut</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno">  681</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  684</span>              rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa2e963058ad1caacf212b0527242ec9e1">icXformTypeNDLut</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno">  685</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  686</span>          }</div>
<div class="line"><span class="lineno">  687</span>        }</div>
<div class="line"><span class="lineno">  688</span>      }</div>
<div class="line"><span class="lineno">  689</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  690</span>        <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = NULL;</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>        <span class="keywordflow">if</span> (nLutType == <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013">icXformLutColorimetric</a> &amp;&amp; pProfile-&gt;m_Header.version &gt;= <a class="code hl_define" href="../../d7/d46/a00002.html#a802c8f93248af9679280a8c10705807c">icVersionNumberV5</a>) {</div>
<div class="line"><span class="lineno">  693</span>          bUseD2BTags = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  694</span>        }</div>
<div class="line"><span class="lineno">  695</span>        </div>
<div class="line"><span class="lineno">  696</span>        <span class="keywordflow">if</span> (bUseD2BTags) {</div>
<div class="line"><span class="lineno">  697</span>          pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a0247611a0b2a3faa49a0df2dfc8420cc">icSigBToD0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>          <span class="comment">//Additional precedence not prescribed by the v4 ICC Specification</span></div>
<div class="line"><span class="lineno">  700</span>          <span class="keywordflow">if</span> (!pTag &amp;&amp; pProfile-&gt;m_Header.version &gt;= <a class="code hl_define" href="../../d7/d46/a00002.html#a802c8f93248af9679280a8c10705807c">icVersionNumberV5</a>) {</div>
<div class="line"><span class="lineno">  701</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a0247611a0b2a3faa49a0df2dfc8420cc">icSigBToD0Tag</a>);</div>
<div class="line"><span class="lineno">  702</span> </div>
<div class="line"><span class="lineno">  703</span>            <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  704</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a8a66e2d1402c9f9796a902cd2f0ac0eb">icSigBToD1Tag</a>);</div>
<div class="line"><span class="lineno">  705</span>              <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno">  706</span>                nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno">  707</span>                <span class="keywordflow">if</span> (nTagIntent==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>)</div>
<div class="line"><span class="lineno">  708</span>                  bRelToAbs = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  709</span>              }</div>
<div class="line"><span class="lineno">  710</span>            }</div>
<div class="line"><span class="lineno">  711</span> </div>
<div class="line"><span class="lineno">  712</span>            <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  713</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a740cafe42e07749bbe3b36d881325801">icSigBToD3Tag</a>);</div>
<div class="line"><span class="lineno">  714</span>              <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno">  715</span>                nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno">  716</span>                bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  717</span>              }</div>
<div class="line"><span class="lineno">  718</span>            }</div>
<div class="line"><span class="lineno">  719</span>          }</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span>          <span class="comment">//Unsupported elements cause fall back behavior</span></div>
<div class="line"><span class="lineno">  722</span>          <span class="keywordflow">if</span> (pTag &amp;&amp; !pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a3415307280dc7b871cc1797704008991">IsSupported</a>())</div>
<div class="line"><span class="lineno">  723</span>            pTag = NULL;</div>
<div class="line"><span class="lineno">  724</span> </div>
<div class="line"><span class="lineno">  725</span>          <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno">  726</span>            bUseSpectralPCS = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  727</span> </div>
<div class="line"><span class="lineno">  728</span>          <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a> &amp;&amp; pProfile-&gt;m_Header.version &lt; <a class="code hl_define" href="../../d7/d46/a00002.html#a802c8f93248af9679280a8c10705807c">icVersionNumberV5</a>) {</div>
<div class="line"><span class="lineno">  729</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a8a66e2d1402c9f9796a902cd2f0ac0eb">icSigBToD1Tag</a>);</div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span>            <span class="comment">//Unsupported elements cause fall back behavior</span></div>
<div class="line"><span class="lineno">  732</span>            <span class="keywordflow">if</span> (pTag &amp;&amp; !pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a3415307280dc7b871cc1797704008991">IsSupported</a>())</div>
<div class="line"><span class="lineno">  733</span>              pTag = NULL;</div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span>            <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno">  736</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno">  737</span>          }</div>
<div class="line"><span class="lineno">  738</span>        }</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>        <span class="keywordflow">if</span> (bUseColorimeticTags) {</div>
<div class="line"><span class="lineno">  741</span> </div>
<div class="line"><span class="lineno">  742</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  743</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a78413df8b7d634ae4e0ec02f006e5bd0">icSigBToA0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno">  744</span>          }</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>          <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno">  747</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a53147bf01d2c36339096d2f22b9c2869">icSigBToA1Tag</a>);</div>
<div class="line"><span class="lineno">  748</span>            <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno">  749</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno">  750</span>          }</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  753</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a78413df8b7d634ae4e0ec02f006e5bd0">icSigBToA0Tag</a>);</div>
<div class="line"><span class="lineno">  754</span>          }</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>          <span class="comment">//Additional precedence not prescribed by the v4 ICC Specification</span></div>
<div class="line"><span class="lineno">  757</span>          <span class="keywordflow">if</span> (!pTag &amp;&amp; pProfile-&gt;m_Header.version &gt;= <a class="code hl_define" href="../../d7/d46/a00002.html#a802c8f93248af9679280a8c10705807c">icVersionNumberV5</a>) {</div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a53147bf01d2c36339096d2f22b9c2869">icSigBToA1Tag</a>);</div>
<div class="line"><span class="lineno">  760</span>            <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno">  761</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno">  762</span>              <span class="keywordflow">if</span> (nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>)</div>
<div class="line"><span class="lineno">  763</span>                bRelToAbs = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  764</span>            }</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>            <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  767</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ab6a3ba830b4ac279851cb5674c83ce06">icSigBToA3Tag</a>);</div>
<div class="line"><span class="lineno">  768</span>              <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno">  769</span>                nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno">  770</span>                bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  771</span>              }</div>
<div class="line"><span class="lineno">  772</span>            }</div>
<div class="line"><span class="lineno">  773</span>          }</div>
<div class="line"><span class="lineno">  774</span>        }</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>        <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  777</span>          <span class="keywordflow">if</span> (pProfile-&gt;m_Header.version &lt; <a class="code hl_define" href="../../d7/d46/a00002.html#a802c8f93248af9679280a8c10705807c">icVersionNumberV5</a>) {</div>
<div class="line"><span class="lineno">  778</span>            <span class="keywordflow">if</span> (pProfile-&gt;m_Header.colorSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30">icSigRgbData</a>) {</div>
<div class="line"><span class="lineno">  779</span>              rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa06be3d5a167735863cb627f627c27988">icXformTypeMatrixTRC</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno">  780</span>            }</div>
<div class="line"><span class="lineno">  781</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pProfile-&gt;m_Header.colorSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917af4c6afaa42216765b0431ec6ae0ba27c">icSigGrayData</a>) {</div>
<div class="line"><span class="lineno">  782</span>              rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa4ce2fe52f1dcd97ba1d6b9ad0628e6df">icXformTypeMonochrome</a>, NULL, pHintManager);</div>
<div class="line"><span class="lineno">  783</span>            }</div>
<div class="line"><span class="lineno">  784</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  785</span>              <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  786</span>          }</div>
<div class="line"><span class="lineno">  787</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  788</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  789</span>        }</div>
<div class="line"><span class="lineno">  790</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">GetType</a>()==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481">icSigMultiProcessElementType</a>) {</div>
<div class="line"><span class="lineno">  791</span>          rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d">icXformTypeMpe</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno">  792</span>        }</div>
<div class="line"><span class="lineno">  793</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  794</span>          <span class="keywordflow">switch</span>(pProfile-&gt;m_Header.pcs) {</div>
<div class="line"><span class="lineno">  795</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>:</div>
<div class="line"><span class="lineno">  796</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>:</div>
<div class="line"><span class="lineno">  797</span>              rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa8f98fe94a91c4c002341c77b47ffed35">icXformType3DLut</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno">  798</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>          <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  801</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  802</span>          }</div>
<div class="line"><span class="lineno">  803</span>        }</div>
<div class="line"><span class="lineno">  804</span>      }</div>
<div class="line"><span class="lineno">  805</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  806</span> </div>
<div class="line"><span class="lineno">  807</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba0b1f2aadd55b74ea25adc32e3cadf4c0">icXformLutNamedColor</a>:</div>
<div class="line"><span class="lineno">  808</span>      {</div>
<div class="line"><span class="lineno">  809</span>        <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ac9a9457a436bbfaa9212552f337d2beb">icSigNamedColor2Tag</a>);</div>
<div class="line"><span class="lineno">  810</span>        <span class="keywordflow">if</span> (!pTag)</div>
<div class="line"><span class="lineno">  811</span>          <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  812</span> </div>
<div class="line"><span class="lineno">  813</span>        CIccCreateNamedColorXformHint* pNamedColorHint = <span class="keyword">new</span> CIccCreateNamedColorXformHint();</div>
<div class="line"><span class="lineno">  814</span>        pNamedColorHint-&gt;csPcs = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno">  815</span>        pNamedColorHint-&gt;csDevice = pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno">  816</span>        pNamedColorHint-&gt;csSpectralPcs = pProfile-&gt;m_Header.spectralPCS;</div>
<div class="line"><span class="lineno">  817</span>        pNamedColorHint-&gt;spectralRange = pProfile-&gt;m_Header.spectralRange;</div>
<div class="line"><span class="lineno">  818</span>        pNamedColorHint-&gt;biSpectralRange = pProfile-&gt;m_Header.biSpectralRange;</div>
<div class="line"><span class="lineno">  819</span>                <span class="keywordflow">if</span> (pHintManager) {</div>
<div class="line"><span class="lineno">  820</span>                    pHintManager-&gt;AddHint(pNamedColorHint);</div>
<div class="line"><span class="lineno">  821</span>                    rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno">  822</span>                    pHintManager-&gt;DeleteHint(pNamedColorHint);</div>
<div class="line"><span class="lineno">  823</span>                }</div>
<div class="line"><span class="lineno">  824</span>                <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  825</span>                    CIccCreateXformHintManager HintManager;</div>
<div class="line"><span class="lineno">  826</span>                    HintManager.AddHint(pNamedColorHint);</div>
<div class="line"><span class="lineno">  827</span>                    rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>, pTag, &amp;HintManager);</div>
<div class="line"><span class="lineno">  828</span>                }</div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span>        <span class="keywordflow">if</span> (pProfile-&gt;m_Header.spectralPCS)</div>
<div class="line"><span class="lineno">  831</span>          bUseSpectralPCS = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  832</span>      }</div>
<div class="line"><span class="lineno">  833</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7baeb0501fdc1dcc7f1388f0fdca9b17356">icXformLutPreview</a>:</div>
<div class="line"><span class="lineno">  836</span>      {</div>
<div class="line"><span class="lineno">  837</span>        bInput = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  838</span>        <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ac5ae9a8a0d00acc2b7ec4f2da4ccc3f8">icSigPreview0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno">  839</span>        <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  840</span>          pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ac5ae9a8a0d00acc2b7ec4f2da4ccc3f8">icSigPreview0Tag</a>);</div>
<div class="line"><span class="lineno">  841</span>        }</div>
<div class="line"><span class="lineno">  842</span>        <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  843</span>          <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  844</span>        }</div>
<div class="line"><span class="lineno">  845</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  846</span>          <span class="keywordflow">switch</span>(pProfile-&gt;m_Header.pcs) {</div>
<div class="line"><span class="lineno">  847</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>:</div>
<div class="line"><span class="lineno">  848</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>:</div>
<div class="line"><span class="lineno">  849</span>              rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa8f98fe94a91c4c002341c77b47ffed35">icXformType3DLut</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  852</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  853</span>          }</div>
<div class="line"><span class="lineno">  854</span>        }</div>
<div class="line"><span class="lineno">  855</span>      }</div>
<div class="line"><span class="lineno">  856</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  857</span> </div>
<div class="line"><span class="lineno">  858</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba6df311bd7dc6c9c9284ad186b15f53de">icXformLutGamut</a>:</div>
<div class="line"><span class="lineno">  859</span>      {</div>
<div class="line"><span class="lineno">  860</span>        bInput = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  861</span>        <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ad57d49a829f89f04159908e21ffe9d01">icSigGamutTag</a>);</div>
<div class="line"><span class="lineno">  862</span>        <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  863</span>          <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">  864</span>        }</div>
<div class="line"><span class="lineno">  865</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  866</span>          <span class="keywordflow">switch</span>(pProfile-&gt;m_Header.pcs) {</div>
<div class="line"><span class="lineno">  867</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>:</div>
<div class="line"><span class="lineno">  868</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>:</div>
<div class="line"><span class="lineno">  869</span>              rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa8f98fe94a91c4c002341c77b47ffed35">icXformType3DLut</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  872</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  873</span>          }</div>
<div class="line"><span class="lineno">  874</span>        }</div>
<div class="line"><span class="lineno">  875</span>      }</div>
<div class="line"><span class="lineno">  876</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7baf26b30e0e73bf289c23075e2f6106e6d">icXformLutBRDFParam</a>:</div>
<div class="line"><span class="lineno">  879</span>    {</div>
<div class="line"><span class="lineno">  880</span>      <span class="comment">// get the correct tag first</span></div>
<div class="line"><span class="lineno">  881</span> </div>
<div class="line"><span class="lineno">  882</span>      <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = NULL;</div>
<div class="line"><span class="lineno">  883</span>      <span class="keywordflow">if</span> (bUseD2BTags) {</div>
<div class="line"><span class="lineno">  884</span>        <span class="keywordflow">if</span> (pProfile-&gt;m_Header.spectralPCS) {</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span>          pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a341a5307f022df0104358887c08c4115">icSigBrdfSpectralParameter0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno">  887</span> </div>
<div class="line"><span class="lineno">  888</span>          <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno">  889</span>            bUseSpectralPCS = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  890</span>        }</div>
<div class="line"><span class="lineno">  891</span>      }</div>
<div class="line"><span class="lineno">  892</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  893</span>      {</div>
<div class="line"><span class="lineno">  894</span>        pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ae6f4fd41479c1274ea14e0bb432f0253">icSigBrdfColorimetricParameter0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno">  895</span> </div>
<div class="line"><span class="lineno">  896</span>        <span class="comment">//Unsupported elements cause fall back behavior</span></div>
<div class="line"><span class="lineno">  897</span>        <span class="keywordflow">if</span> (pTag &amp;&amp; !pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a3415307280dc7b871cc1797704008991">IsSupported</a>())</div>
<div class="line"><span class="lineno">  898</span>          pTag = NULL;</div>
<div class="line"><span class="lineno">  899</span>      }</div>
<div class="line"><span class="lineno">  900</span> </div>
<div class="line"><span class="lineno">  901</span>      <span class="comment">// now extract the correct part from the structure</span></div>
<div class="line"><span class="lineno">  902</span>      <a class="code hl_class" href="../../d7/d00/a00401.html">CIccStructBRDF</a>* pStructTag = <span class="keyword">dynamic_cast&lt;</span><a class="code hl_class" href="../../d7/d00/a00401.html">CIccStructBRDF</a>*<span class="keyword">&gt;</span>(pTag);</div>
<div class="line"><span class="lineno">  903</span> </div>
<div class="line"><span class="lineno">  904</span>      <span class="keywordflow">if</span> (pStructTag != NULL)</div>
<div class="line"><span class="lineno">  905</span>      {</div>
<div class="line"><span class="lineno">  906</span>        <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag2 = NULL;</div>
<div class="line"><span class="lineno">  907</span> </div>
<div class="line"><span class="lineno">  908</span>          <span class="keywordflow">switch</span> (nLutType) {</div>
<div class="line"><span class="lineno">  909</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7baf26b30e0e73bf289c23075e2f6106e6d">icXformLutBRDFParam</a>:</div>
<div class="line"><span class="lineno">  910</span>              pTag2 = pStructTag-&gt;<a class="code hl_function" href="../../da/dbf/a00393.html#ae59376fd46156a41bb687406b3d881d7">GetElem</a>(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#af46212fb10475a9822be7160951f142cadd1015e094e8b2a1f9dff66dc0271754">icSigBrdfTransformMbr</a>);</div>
<div class="line"><span class="lineno">  911</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  912</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  913</span>              <span class="comment">// can&#39;t get here, get rid of warning</span></div>
<div class="line"><span class="lineno">  914</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  915</span>          }</div>
<div class="line"><span class="lineno">  916</span>          <span class="keywordflow">if</span> (pTag2)</div>
<div class="line"><span class="lineno">  917</span>            rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d">icXformTypeMpe</a>, pTag2, pHintManager);</div>
<div class="line"><span class="lineno">  918</span>      }</div>
<div class="line"><span class="lineno">  919</span>    }</div>
<div class="line"><span class="lineno">  920</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba1109d56a39fd11938962b487d6f965b8">icXformLutBRDFDirect</a>:</div>
<div class="line"><span class="lineno">  923</span>    {</div>
<div class="line"><span class="lineno">  924</span>      <span class="comment">// get the correct tag first</span></div>
<div class="line"><span class="lineno">  925</span> </div>
<div class="line"><span class="lineno">  926</span>      <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = NULL;</div>
<div class="line"><span class="lineno">  927</span>      <span class="keywordflow">if</span> (bUseD2BTags) {</div>
<div class="line"><span class="lineno">  928</span>        <span class="keywordflow">if</span> (pProfile-&gt;m_Header.spectralPCS) {</div>
<div class="line"><span class="lineno">  929</span> </div>
<div class="line"><span class="lineno">  930</span>          pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a182f63dba24e9033151133f9678f7b75">icSigBRDFDToB0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>          <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno">  933</span>            bUseSpectralPCS = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  934</span>        }</div>
<div class="line"><span class="lineno">  935</span>      }</div>
<div class="line"><span class="lineno">  936</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  937</span>      {</div>
<div class="line"><span class="lineno">  938</span>        pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a6a8323df91e18a157d90c1f0f27c6a22">icSigBRDFAToB0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno">  939</span> </div>
<div class="line"><span class="lineno">  940</span>        <span class="comment">//Unsupported elements cause fall back behavior</span></div>
<div class="line"><span class="lineno">  941</span>        <span class="keywordflow">if</span> (pTag &amp;&amp; !pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a3415307280dc7b871cc1797704008991">IsSupported</a>())</div>
<div class="line"><span class="lineno">  942</span>          pTag = NULL;</div>
<div class="line"><span class="lineno">  943</span>      }</div>
<div class="line"><span class="lineno">  944</span> </div>
<div class="line"><span class="lineno">  945</span>      <span class="keywordflow">if</span> (pTag != NULL)</div>
<div class="line"><span class="lineno">  946</span>      {</div>
<div class="line"><span class="lineno">  947</span>        rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d">icXformTypeMpe</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno">  948</span>      }</div>
<div class="line"><span class="lineno">  949</span>    }</div>
<div class="line"><span class="lineno">  950</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  951</span> </div>
<div class="line"><span class="lineno">  952</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba1765210771d77678d0600381557d8bba">icXformLutBRDFMcsParam</a>:</div>
<div class="line"><span class="lineno">  953</span>    {</div>
<div class="line"><span class="lineno">  954</span>      <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = NULL;</div>
<div class="line"><span class="lineno">  955</span>      <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f">icSigMaterialVisualizationClass</a>) {</div>
<div class="line"><span class="lineno">  956</span>        bInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  957</span>        nMCS = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393a9900382442b6928de2af4b116f08dd5e">icFromMCS</a>;</div>
<div class="line"><span class="lineno">  958</span> </div>
<div class="line"><span class="lineno">  959</span>        <span class="keywordflow">if</span> (pProfile-&gt;m_Header.spectralPCS) {</div>
<div class="line"><span class="lineno">  960</span>          pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5abf1026085f40d42c8202fd1b3a8ad9b4">icSigBRDFMToS0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno">  961</span> </div>
<div class="line"><span class="lineno">  962</span>          <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno">  963</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5abda57fa68ef3f179ca1728b2030da340">icSigBRDFMToS1Tag</a>);</div>
<div class="line"><span class="lineno">  964</span>            <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno">  965</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno">  966</span>          }</div>
<div class="line"><span class="lineno">  967</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno">  968</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5aa5b272ef03d506460dbb1c5c6a6cc599">icSigBRDFMToS3Tag</a>);</div>
<div class="line"><span class="lineno">  969</span>            <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno">  970</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno">  971</span>              bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  972</span>            }</div>
<div class="line"><span class="lineno">  973</span>          }</div>
<div class="line"><span class="lineno">  974</span> </div>
<div class="line"><span class="lineno">  975</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  976</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5abf1026085f40d42c8202fd1b3a8ad9b4">icSigBRDFMToS0Tag</a>);</div>
<div class="line"><span class="lineno">  977</span>          }</div>
<div class="line"><span class="lineno">  978</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  979</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5abda57fa68ef3f179ca1728b2030da340">icSigBRDFMToS1Tag</a>);</div>
<div class="line"><span class="lineno">  980</span>          }</div>
<div class="line"><span class="lineno">  981</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno">  982</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5aa5b272ef03d506460dbb1c5c6a6cc599">icSigBRDFMToS3Tag</a>);</div>
<div class="line"><span class="lineno">  983</span>            <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno">  984</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno">  985</span>              bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  986</span>            }</div>
<div class="line"><span class="lineno">  987</span>          }</div>
<div class="line"><span class="lineno">  988</span> </div>
<div class="line"><span class="lineno">  989</span>          <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno">  990</span>            bUseSpectralPCS = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  991</span>        }</div>
<div class="line"><span class="lineno">  992</span>        <span class="keywordflow">if</span> (!pTag &amp;&amp; pProfile-&gt;m_Header.pcs != 0) {</div>
<div class="line"><span class="lineno">  993</span>          pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5af8c5abf6686452d76ab9c0327ad5067c">icSigBRDFMToB0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno">  994</span> </div>
<div class="line"><span class="lineno">  995</span>          <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno">  996</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a078ce8e7fc1f2e78a5bcd4506216f2b7">icSigBRDFMToB1Tag</a>);</div>
<div class="line"><span class="lineno">  997</span>            <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno">  998</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno">  999</span>          }</div>
<div class="line"><span class="lineno"> 1000</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno"> 1001</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a07ee2aaf6842476471432af3cc786404">icSigBRDFMToB3Tag</a>);</div>
<div class="line"><span class="lineno"> 1002</span>            <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno"> 1003</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno"> 1004</span>              bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1005</span>            }</div>
<div class="line"><span class="lineno"> 1006</span>          }</div>
<div class="line"><span class="lineno"> 1007</span>         <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 1008</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5af8c5abf6686452d76ab9c0327ad5067c">icSigBRDFMToB0Tag</a>);</div>
<div class="line"><span class="lineno"> 1009</span>          }</div>
<div class="line"><span class="lineno"> 1010</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 1011</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a078ce8e7fc1f2e78a5bcd4506216f2b7">icSigBRDFMToB1Tag</a>);</div>
<div class="line"><span class="lineno"> 1012</span>          }</div>
<div class="line"><span class="lineno"> 1013</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 1014</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a07ee2aaf6842476471432af3cc786404">icSigBRDFMToB3Tag</a>);</div>
<div class="line"><span class="lineno"> 1015</span>            <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno"> 1016</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno"> 1017</span>              bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1018</span>            }</div>
<div class="line"><span class="lineno"> 1019</span>          }</div>
<div class="line"><span class="lineno"> 1020</span>        }</div>
<div class="line"><span class="lineno"> 1021</span> </div>
<div class="line"><span class="lineno"> 1022</span>        <span class="comment">//Unsupported elements cause fall back behavior</span></div>
<div class="line"><span class="lineno"> 1023</span>        <span class="keywordflow">if</span> (pTag &amp;&amp; !pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a3415307280dc7b871cc1797704008991">IsSupported</a>())</div>
<div class="line"><span class="lineno"> 1024</span>          pTag = NULL;</div>
<div class="line"><span class="lineno"> 1025</span>  </div>
<div class="line"><span class="lineno"> 1026</span>        <span class="comment">//Unsupported elements cause fall back behavior</span></div>
<div class="line"><span class="lineno"> 1027</span>        <span class="keywordflow">if</span> (pTag &amp;&amp; !pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a3415307280dc7b871cc1797704008991">IsSupported</a>())</div>
<div class="line"><span class="lineno"> 1028</span>          pTag = NULL;</div>
<div class="line"><span class="lineno"> 1029</span>      }</div>
<div class="line"><span class="lineno"> 1030</span>      <span class="keywordflow">if</span> (pTag &amp;&amp; pProfile-&gt;m_Header.mcs) {</div>
<div class="line"><span class="lineno"> 1031</span>        rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d">icXformTypeMpe</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno"> 1032</span>      }</div>
<div class="line"><span class="lineno"> 1033</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1034</span>        rv = NULL;</div>
<div class="line"><span class="lineno"> 1035</span>    }</div>
<div class="line"><span class="lineno"> 1036</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1037</span> </div>
<div class="line"><span class="lineno"> 1038</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153">icXformLutMCS</a>:</div>
<div class="line"><span class="lineno"> 1039</span>      {</div>
<div class="line"><span class="lineno"> 1040</span>        <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = NULL;</div>
<div class="line"><span class="lineno"> 1041</span>        <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0aeb74955777b1abe38df700474c7be5ce">icSigMaterialIdentificationClass</a> ||</div>
<div class="line"><span class="lineno"> 1042</span>            pProfile-&gt;m_Header.deviceClass==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a787f32c0c9368bc8c4e85a670ae91c8d">icSigInputClass</a>) {</div>
<div class="line"><span class="lineno"> 1043</span>          bInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1044</span>          nMCS = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393a792a9f663756385f0a63c62606fbd5b5">icToMCS</a>;</div>
<div class="line"><span class="lineno"> 1045</span>          pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a4101fbfb53a9e422f925a0eb9b9754dc">icSigAToM0Tag</a>);</div>
<div class="line"><span class="lineno"> 1046</span>        }</div>
<div class="line"><span class="lineno"> 1047</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f">icSigMaterialVisualizationClass</a>) {</div>
<div class="line"><span class="lineno"> 1048</span>          bInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1049</span>          nMCS = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393a9900382442b6928de2af4b116f08dd5e">icFromMCS</a>;</div>
<div class="line"><span class="lineno"> 1050</span> </div>
<div class="line"><span class="lineno"> 1051</span>          <span class="keywordflow">if</span> (pProfile-&gt;m_Header.spectralPCS) {</div>
<div class="line"><span class="lineno"> 1052</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a7a93318f3fc1c8582f6b11da800a899a">icSigMToS0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno"> 1053</span> </div>
<div class="line"><span class="lineno"> 1054</span>            <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno"> 1055</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5adb1d5ba824d4d843572fe8206edad0ca">icSigMToS1Tag</a>);</div>
<div class="line"><span class="lineno"> 1056</span>              <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno"> 1057</span>                nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno"> 1058</span>            }</div>
<div class="line"><span class="lineno"> 1059</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno"> 1060</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a33c2ed77d7d42de199cb874ec5ad4abf">icSigMToS3Tag</a>);</div>
<div class="line"><span class="lineno"> 1061</span>              <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno"> 1062</span>                nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno"> 1063</span>                bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1064</span>              }</div>
<div class="line"><span class="lineno"> 1065</span>            }</div>
<div class="line"><span class="lineno"> 1066</span> </div>
<div class="line"><span class="lineno"> 1067</span>            <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 1068</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a7a93318f3fc1c8582f6b11da800a899a">icSigMToS0Tag</a>);</div>
<div class="line"><span class="lineno"> 1069</span>            }</div>
<div class="line"><span class="lineno"> 1070</span>            <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 1071</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5adb1d5ba824d4d843572fe8206edad0ca">icSigMToS1Tag</a>);</div>
<div class="line"><span class="lineno"> 1072</span>            }</div>
<div class="line"><span class="lineno"> 1073</span>            <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 1074</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a33c2ed77d7d42de199cb874ec5ad4abf">icSigMToS3Tag</a>);</div>
<div class="line"><span class="lineno"> 1075</span>              <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno"> 1076</span>                nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno"> 1077</span>                bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1078</span>              }</div>
<div class="line"><span class="lineno"> 1079</span>            }</div>
<div class="line"><span class="lineno"> 1080</span> </div>
<div class="line"><span class="lineno"> 1081</span>            <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno"> 1082</span>              bUseSpectralPCS = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1083</span>          }</div>
<div class="line"><span class="lineno"> 1084</span>          <span class="keywordflow">if</span> (!pTag &amp;&amp; pProfile-&gt;m_Header.pcs!=0) {</div>
<div class="line"><span class="lineno"> 1085</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a486e40891ee768a1331bf94d608d8400">icSigMToB0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno"> 1086</span> </div>
<div class="line"><span class="lineno"> 1087</span>            <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno"> 1088</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a8ee39bf8d934b766ca5884899d3357a0">icSigMToB1Tag</a>);</div>
<div class="line"><span class="lineno"> 1089</span>              <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno"> 1090</span>                nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno"> 1091</span>            }</div>
<div class="line"><span class="lineno"> 1092</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno"> 1093</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a50703cf46b465a10ad158fbb65ac8f8e">icSigMToB3Tag</a>);</div>
<div class="line"><span class="lineno"> 1094</span>              <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno"> 1095</span>                nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno"> 1096</span>                bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1097</span>              }</div>
<div class="line"><span class="lineno"> 1098</span>            }</div>
<div class="line"><span class="lineno"> 1099</span> </div>
<div class="line"><span class="lineno"> 1100</span>            <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 1101</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a486e40891ee768a1331bf94d608d8400">icSigMToB0Tag</a>);</div>
<div class="line"><span class="lineno"> 1102</span>            }</div>
<div class="line"><span class="lineno"> 1103</span>            <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 1104</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a8ee39bf8d934b766ca5884899d3357a0">icSigMToB1Tag</a>);</div>
<div class="line"><span class="lineno"> 1105</span>            }</div>
<div class="line"><span class="lineno"> 1106</span>            <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 1107</span>              pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a50703cf46b465a10ad158fbb65ac8f8e">icSigMToB3Tag</a>);</div>
<div class="line"><span class="lineno"> 1108</span>              <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno"> 1109</span>                nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno"> 1110</span>                bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1111</span>              }</div>
<div class="line"><span class="lineno"> 1112</span>            }</div>
<div class="line"><span class="lineno"> 1113</span>          }</div>
<div class="line"><span class="lineno"> 1114</span> </div>
<div class="line"><span class="lineno"> 1115</span>          <span class="comment">//Unsupported elements cause fall back behavior</span></div>
<div class="line"><span class="lineno"> 1116</span>          <span class="keywordflow">if</span> (pTag &amp;&amp; !pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a3415307280dc7b871cc1797704008991">IsSupported</a>())</div>
<div class="line"><span class="lineno"> 1117</span>            pTag = NULL;</div>
<div class="line"><span class="lineno"> 1118</span>        }</div>
<div class="line"><span class="lineno"> 1119</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a8b2deae24b9246ac33314b42ad02ac48">icSigMaterialLinkClass</a>) {</div>
<div class="line"><span class="lineno"> 1120</span>          bInput = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1121</span>          nMCS = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393a9900382442b6928de2af4b116f08dd5e">icFromMCS</a>;</div>
<div class="line"><span class="lineno"> 1122</span>          pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ad5d6c8e49e16de86bede2c2e239b38d7">icSigMToA0Tag</a>);</div>
<div class="line"><span class="lineno"> 1123</span>        }</div>
<div class="line"><span class="lineno"> 1124</span>        <span class="keywordflow">if</span> (pTag &amp;&amp; pProfile-&gt;m_Header.mcs) {</div>
<div class="line"><span class="lineno"> 1125</span>          rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d">icXformTypeMpe</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno"> 1126</span>        }</div>
<div class="line"><span class="lineno"> 1127</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1128</span>          rv = NULL;</div>
<div class="line"><span class="lineno"> 1129</span>      }</div>
<div class="line"><span class="lineno"> 1130</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span>  }</div>
<div class="line"><span class="lineno"> 1133</span> </div>
<div class="line"><span class="lineno"> 1134</span>  <span class="keywordflow">if</span> (rv) {</div>
<div class="line"><span class="lineno"> 1135</span>    <span class="keywordflow">if</span> (pPcc)</div>
<div class="line"><span class="lineno"> 1136</span>      rv-&gt;m_pConnectionConditions = pPcc;</div>
<div class="line"><span class="lineno"> 1137</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1138</span>      rv-&gt;m_pConnectionConditions = pProfile;</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span>    rv-&gt;SetParams(pProfile, bInput, nIntent, nTagIntent, bUseSpectralPCS, nInterp, pHintManager, bAbsToRel, nMCS);</div>
<div class="line"><span class="lineno"> 1141</span>  }</div>
<div class="line"><span class="lineno"> 1142</span> </div>
<div class="line"><span class="lineno"> 1143</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 1144</span>}</div>
<div class="line"><span class="lineno"> 1145</span> </div>
<div class="line"><span class="lineno"> 1169</span>CIccXform *CIccXform::Create(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile,</div>
<div class="line"><span class="lineno"> 1170</span>                             <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag,</div>
<div class="line"><span class="lineno"> 1171</span>                             <span class="keywordtype">bool</span> bInput<span class="comment">/* =true */</span>,</div>
<div class="line"><span class="lineno"> 1172</span>                             <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nIntent<span class="comment">/* =icUnknownIntent */</span>,</div>
<div class="line"><span class="lineno"> 1173</span>                             <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913">icXformInterp</a> nInterp<span class="comment">/* =icInterpLinear */</span>,</div>
<div class="line"><span class="lineno"> 1174</span>                             <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc<span class="comment">/*=NULL*/</span>,</div>
<div class="line"><span class="lineno"> 1175</span>                             <span class="keywordtype">bool</span> bUseSpectralPCS<span class="comment">/* =false*/</span>,</div>
<div class="line"><span class="lineno"> 1176</span>                             CIccCreateXformHintManager *pHintManager<span class="comment">/* =NULL */</span>)</div>
<div class="line"><span class="lineno"> 1177</span>{</div>
<div class="line"><span class="lineno"> 1178</span>  CIccXform *rv = NULL;</div>
<div class="line"><span class="lineno"> 1179</span>  <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nTagIntent = nIntent;</div>
<div class="line"><span class="lineno"> 1180</span>  <span class="keywordtype">bool</span> bAbsToRel = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1181</span>  <span class="keywordtype">bool</span> bRelToAbs = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1182</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393">icMCSConnectionType</a> nMCS = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393a7777670882f9cded205c604bbdde8b0d">icNoMCS</a>;</div>
<div class="line"><span class="lineno"> 1183</span> </div>
<div class="line"><span class="lineno"> 1184</span>  <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a24cf99d0920e4e0b4549d67311e99928">icSigColorEncodingClass</a>) {</div>
<div class="line"><span class="lineno"> 1185</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1186</span>  }</div>
<div class="line"><span class="lineno"> 1187</span> </div>
<div class="line"><span class="lineno"> 1188</span>  <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0af50c13fdfab9fcc0a7b831ac86d1fe3b">icSigLinkClass</a><span class="comment">/* &amp;&amp; nIntent==icAbsoluteColorimetric*/</span>) {</div>
<div class="line"><span class="lineno"> 1189</span>    nIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a>;</div>
<div class="line"><span class="lineno"> 1190</span>  }</div>
<div class="line"><span class="lineno"> 1191</span> </div>
<div class="line"><span class="lineno"> 1192</span>  <span class="keywordflow">if</span> (nTagIntent == <a class="code hl_define" href="../../d7/d46/a00002.html#a0fbdbf76357f4ad739b1df71bd87ef8a">icUnknownIntent</a>)</div>
<div class="line"><span class="lineno"> 1193</span>    nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a>;</div>
<div class="line"><span class="lineno"> 1194</span> </div>
<div class="line"><span class="lineno"> 1195</span>  <span class="comment">//Unsupported elements cause fall back behavior</span></div>
<div class="line"><span class="lineno"> 1196</span>  <span class="keywordflow">if</span> (pTag == NULL)</div>
<div class="line"><span class="lineno"> 1197</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1198</span>  <span class="keywordflow">if</span> (pTag &amp;&amp; !pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a3415307280dc7b871cc1797704008991">IsSupported</a>())</div>
<div class="line"><span class="lineno"> 1199</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1200</span> </div>
<div class="line"><span class="lineno"> 1201</span>  <span class="keywordflow">if</span> (bInput) {</div>
<div class="line"><span class="lineno"> 1202</span>    <span class="keywordflow">if</span> (pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">GetType</a>() == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481">icSigMultiProcessElementType</a>) {</div>
<div class="line"><span class="lineno"> 1203</span>      rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d">icXformTypeMpe</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno"> 1204</span>    }</div>
<div class="line"><span class="lineno"> 1205</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1206</span>      <span class="keywordflow">switch</span> (pProfile-&gt;m_Header.colorSpace) {</div>
<div class="line"><span class="lineno"> 1207</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>:</div>
<div class="line"><span class="lineno"> 1208</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>:</div>
<div class="line"><span class="lineno"> 1209</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0ab090e1f79d31e78c006c6ab25933dd">icSigLuvData</a>:</div>
<div class="line"><span class="lineno"> 1210</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ae02a4b86c48a9b85be92fdfc2114e496">icSigYCbCrData</a>:</div>
<div class="line"><span class="lineno"> 1211</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917afc7f319f261280fc48d7510c3a8bc330">icSigYxyData</a>:</div>
<div class="line"><span class="lineno"> 1212</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30">icSigRgbData</a>:</div>
<div class="line"><span class="lineno"> 1213</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917afc7cddf72b4d83ee5cb3568143580828">icSigHsvData</a>:</div>
<div class="line"><span class="lineno"> 1214</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad4a717752d16d5fcf92e1fdd892b8bd8">icSigHlsData</a>:</div>
<div class="line"><span class="lineno"> 1215</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917af20259a5702129c41fd08e21c7e94a74">icSigCmyData</a>:</div>
<div class="line"><span class="lineno"> 1216</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917afa0686ad8f20f604e7e52807087f04da">icSig3colorData</a>:</div>
<div class="line"><span class="lineno"> 1217</span>        rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa8f98fe94a91c4c002341c77b47ffed35">icXformType3DLut</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno"> 1218</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1219</span> </div>
<div class="line"><span class="lineno"> 1220</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661">icSigCmykData</a>:</div>
<div class="line"><span class="lineno"> 1221</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917addb4c9db388eda46c3ec7fdaa8824cf5">icSig4colorData</a>:</div>
<div class="line"><span class="lineno"> 1222</span>        rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa9ad326943cff407bb96bdc9a53920996">icXformType4DLut</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno"> 1223</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1224</span> </div>
<div class="line"><span class="lineno"> 1225</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1226</span>        rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa2e963058ad1caacf212b0527242ec9e1">icXformTypeNDLut</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno"> 1227</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1228</span>      }</div>
<div class="line"><span class="lineno"> 1229</span>    }</div>
<div class="line"><span class="lineno"> 1230</span>  }</div>
<div class="line"><span class="lineno"> 1231</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1232</span>    <span class="keywordflow">if</span> (pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">GetType</a>() == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481">icSigMultiProcessElementType</a>) {</div>
<div class="line"><span class="lineno"> 1233</span>      rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d">icXformTypeMpe</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno"> 1234</span>    }</div>
<div class="line"><span class="lineno"> 1235</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1236</span>      <span class="keywordflow">switch</span> (pProfile-&gt;m_Header.pcs) {</div>
<div class="line"><span class="lineno"> 1237</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>:</div>
<div class="line"><span class="lineno"> 1238</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>:</div>
<div class="line"><span class="lineno"> 1239</span>        rv = <a class="code hl_function" href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a>(<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa8f98fe94a91c4c002341c77b47ffed35">icXformType3DLut</a>, pTag, pHintManager);</div>
<div class="line"><span class="lineno"> 1240</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1241</span> </div>
<div class="line"><span class="lineno"> 1242</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 1243</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1244</span>      }</div>
<div class="line"><span class="lineno"> 1245</span>    }</div>
<div class="line"><span class="lineno"> 1246</span>  }</div>
<div class="line"><span class="lineno"> 1247</span> </div>
<div class="line"><span class="lineno"> 1248</span>  <span class="keywordflow">if</span> (rv) {</div>
<div class="line"><span class="lineno"> 1249</span>    <span class="keywordflow">if</span> (pPcc)</div>
<div class="line"><span class="lineno"> 1250</span>      rv-&gt;m_pConnectionConditions = pPcc;</div>
<div class="line"><span class="lineno"> 1251</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1252</span>      rv-&gt;m_pConnectionConditions = pProfile;</div>
<div class="line"><span class="lineno"> 1253</span> </div>
<div class="line"><span class="lineno"> 1254</span>    rv-&gt;SetParams(pProfile, bInput, nIntent, nTagIntent, bUseSpectralPCS, nInterp, pHintManager, bAbsToRel, nMCS);</div>
<div class="line"><span class="lineno"> 1255</span>  }</div>
<div class="line"><span class="lineno"> 1256</span> </div>
<div class="line"><span class="lineno"> 1257</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 1258</span>}</div>
<div class="line"><span class="lineno"> 1259</span> </div>
<div class="line"><span class="lineno"> 1273</span><span class="keywordtype">void</span> CIccXform::SetParams(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile, <span class="keywordtype">bool</span> bInput, <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nIntent, <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nTagIntent,</div>
<div class="line"><span class="lineno"> 1274</span>                          <span class="keywordtype">bool</span> bUseSpectralPCS, <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913">icXformInterp</a> nInterp, CIccCreateXformHintManager *pHintManager<span class="comment">/* =NULL */</span>,</div>
<div class="line"><span class="lineno"> 1275</span>                          <span class="keywordtype">bool</span> bAbsToRel<span class="comment">/*=false*/</span>, <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393">icMCSConnectionType</a> nMCS<span class="comment">/*=icNoMCS*/</span>)</div>
<div class="line"><span class="lineno"> 1276</span>{</div>
<div class="line"><span class="lineno"> 1277</span>  m_pProfile = pProfile;</div>
<div class="line"><span class="lineno"> 1278</span>  m_bInput = bInput;</div>
<div class="line"><span class="lineno"> 1279</span>  m_nIntent = nIntent;</div>
<div class="line"><span class="lineno"> 1280</span>  m_nTagIntent = nTagIntent;</div>
<div class="line"><span class="lineno"> 1281</span>  m_nInterp = nInterp;</div>
<div class="line"><span class="lineno"> 1282</span>    m_pAdjustPCS = NULL;</div>
<div class="line"><span class="lineno"> 1283</span>  m_bUseSpectralPCS = bUseSpectralPCS;</div>
<div class="line"><span class="lineno"> 1284</span>  m_bAbsToRel = bAbsToRel;</div>
<div class="line"><span class="lineno"> 1285</span>  m_nMCS = nMCS;</div>
<div class="line"><span class="lineno"> 1286</span>  m_bLuminanceMatching = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1287</span> </div>
<div class="line"><span class="lineno"> 1288</span>  <span class="keywordflow">if</span> (pHintManager) {</div>
<div class="line"><span class="lineno"> 1289</span>    IIccCreateXformHint *pHint=NULL;</div>
<div class="line"><span class="lineno"> 1290</span> </div>
<div class="line"><span class="lineno"> 1291</span>    pHint = pHintManager-&gt;GetHint(<span class="stringliteral">&quot;CIccCreateAdjustPCSXformHint&quot;</span>);</div>
<div class="line"><span class="lineno"> 1292</span>    <span class="keywordflow">if</span> (pHint) {</div>
<div class="line"><span class="lineno"> 1293</span>          CIccCreateAdjustPCSXformHint *pAdjustPCSHint = (CIccCreateAdjustPCSXformHint*)pHint;</div>
<div class="line"><span class="lineno"> 1294</span>          m_pAdjustPCS = pAdjustPCSHint-&gt;GetNewAdjustPCSXform();</div>
<div class="line"><span class="lineno"> 1295</span>      }</div>
<div class="line"><span class="lineno"> 1296</span> </div>
<div class="line"><span class="lineno"> 1297</span>    pHint = pHintManager-&gt;GetHint(<span class="stringliteral">&quot;CIccCreateCmmEnvVarXformHint&quot;</span>);</div>
<div class="line"><span class="lineno"> 1298</span>    <span class="keywordflow">if</span> (pHint) {</div>
<div class="line"><span class="lineno"> 1299</span>      CIccCreateCmmEnvVarXformHint *pCmmEnvVarHint = (CIccCreateCmmEnvVarXformHint*)pHint;</div>
<div class="line"><span class="lineno"> 1300</span>      m_pCmmEnvVarLookup = pCmmEnvVarHint-&gt;GetNewCmmEnvVarLookup();</div>
<div class="line"><span class="lineno"> 1301</span>    }</div>
<div class="line"><span class="lineno"> 1302</span> </div>
<div class="line"><span class="lineno"> 1303</span>    pHint = pHintManager-&gt;GetHint(<span class="stringliteral">&quot;CIccLuminanceMatchingHint&quot;</span>);</div>
<div class="line"><span class="lineno"> 1304</span>    <span class="keywordflow">if</span> (pHint) {</div>
<div class="line"><span class="lineno"> 1305</span>      m_bLuminanceMatching = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1306</span>    }</div>
<div class="line"><span class="lineno"> 1307</span>  }</div>
<div class="line"><span class="lineno"> 1308</span>}</div>
<div class="line"><span class="lineno"> 1309</span> </div>
<div class="line"><span class="lineno"> 1333</span>CIccXform *CIccXform::Create(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> &amp;Profile,</div>
<div class="line"><span class="lineno"> 1334</span>                             <span class="keywordtype">bool</span> bInput<span class="comment">/* =true */</span>,</div>
<div class="line"><span class="lineno"> 1335</span>                             <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nIntent<span class="comment">/* =icUnknownIntent */</span>, </div>
<div class="line"><span class="lineno"> 1336</span>                                                         <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913">icXformInterp</a> nInterp<span class="comment">/* =icInterpLinear */</span>, </div>
<div class="line"><span class="lineno"> 1337</span>                             <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc<span class="comment">/*=NULL*/</span>,</div>
<div class="line"><span class="lineno"> 1338</span>                             <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7b">icXformLutType</a> nLutType<span class="comment">/* =icXformLutColor */</span>, </div>
<div class="line"><span class="lineno"> 1339</span>                                                         <span class="keywordtype">bool</span> bUseD2BxB2DxTags<span class="comment">/* =true */</span>,</div>
<div class="line"><span class="lineno"> 1340</span>                             CIccCreateXformHintManager *pHintManager<span class="comment">/* =NULL */</span>)</div>
<div class="line"><span class="lineno"> 1341</span>{</div>
<div class="line"><span class="lineno"> 1342</span>  <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile = <span class="keyword">new</span> <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a>(Profile);</div>
<div class="line"><span class="lineno"> 1343</span>  CIccXform *pXform = Create(pProfile, bInput, nIntent, nInterp, pPcc, nLutType, bUseD2BxB2DxTags, pHintManager);</div>
<div class="line"><span class="lineno"> 1344</span> </div>
<div class="line"><span class="lineno"> 1345</span>  <span class="keywordflow">if</span> (!pXform)</div>
<div class="line"><span class="lineno"> 1346</span>    <span class="keyword">delete</span> pProfile;</div>
<div class="line"><span class="lineno"> 1347</span> </div>
<div class="line"><span class="lineno"> 1348</span>  <span class="keywordflow">return</span> pXform;</div>
<div class="line"><span class="lineno"> 1349</span>}</div>
<div class="line"><span class="lineno"> 1350</span> </div>
<div class="line"><span class="lineno"> 1351</span> </div>
<div class="line"><span class="lineno"> 1363</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccXform::Begin()</div>
<div class="line"><span class="lineno"> 1364</span>{</div>
<div class="line"><span class="lineno"> 1365</span>  <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pCond = GetConnectionConditions();</div>
<div class="line"><span class="lineno"> 1366</span> </div>
<div class="line"><span class="lineno"> 1367</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> mediaXYZ[3];</div>
<div class="line"><span class="lineno"> 1368</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> illumXYZ[3];</div>
<div class="line"><span class="lineno"> 1369</span> </div>
<div class="line"><span class="lineno"> 1370</span>  <span class="keywordflow">if</span> (m_nIntent==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno"> 1371</span>    <span class="keywordflow">if</span> (pCond) {</div>
<div class="line"><span class="lineno"> 1372</span>      pCond-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a7268d05a042b582c68477e4aa956041a">getMediaWhiteXYZ</a>(mediaXYZ);</div>
<div class="line"><span class="lineno"> 1373</span> </div>
<div class="line"><span class="lineno"> 1374</span>      m_MediaXYZ.X = <a class="code hl_function" href="../../d7/dce/a00143.html#a7f49bd1c3d34a4dd4199f6bb0a674f96">icFtoF16</a>(mediaXYZ[0]);</div>
<div class="line"><span class="lineno"> 1375</span>      m_MediaXYZ.Y = <a class="code hl_function" href="../../d7/dce/a00143.html#a7f49bd1c3d34a4dd4199f6bb0a674f96">icFtoF16</a>(mediaXYZ[1]);</div>
<div class="line"><span class="lineno"> 1376</span>      m_MediaXYZ.Z = <a class="code hl_function" href="../../d7/dce/a00143.html#a7f49bd1c3d34a4dd4199f6bb0a674f96">icFtoF16</a>(mediaXYZ[2]);</div>
<div class="line"><span class="lineno"> 1377</span>    }</div>
<div class="line"><span class="lineno"> 1378</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1379</span>      <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = m_pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5aa000d29d0c1e0b2ed0fa49651a5efd26">icSigMediaWhitePointTag</a>);</div>
<div class="line"><span class="lineno"> 1380</span> </div>
<div class="line"><span class="lineno"> 1381</span>      <span class="keywordflow">if</span> (!pTag || pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">GetType</a>()!=<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea6226593792ef658c78bcab04a6fd4850">icSigXYZType</a>)</div>
<div class="line"><span class="lineno"> 1382</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860">icCmmStatInvalidProfile</a>;</div>
<div class="line"><span class="lineno"> 1383</span> </div>
<div class="line"><span class="lineno"> 1384</span>      <a class="code hl_class" href="../../d3/ded/a01017.html">CIccTagXYZ</a> *pXyzTag = (<a class="code hl_class" href="../../d3/ded/a01017.html">CIccTagXYZ</a>*)pTag;</div>
<div class="line"><span class="lineno"> 1385</span> </div>
<div class="line"><span class="lineno"> 1386</span>      m_MediaXYZ = (*pXyzTag)[0];</div>
<div class="line"><span class="lineno"> 1387</span>      mediaXYZ[0] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>(m_MediaXYZ.X);</div>
<div class="line"><span class="lineno"> 1388</span>      mediaXYZ[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>(m_MediaXYZ.Y);</div>
<div class="line"><span class="lineno"> 1389</span>      mediaXYZ[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>(m_MediaXYZ.Z);</div>
<div class="line"><span class="lineno"> 1390</span>    }</div>
<div class="line"><span class="lineno"> 1391</span>  }</div>
<div class="line"><span class="lineno"> 1392</span> </div>
<div class="line"><span class="lineno"> 1393</span>  <a class="code hl_struct" href="../../d7/d46/a00002.html#d8/dc7/a00517">icXYZNumber</a> illXYZ;</div>
<div class="line"><span class="lineno"> 1394</span>  <span class="keywordflow">if</span> (pCond) {</div>
<div class="line"><span class="lineno"> 1395</span>    pCond-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a9c5c38685ec6a82b97608f5571e303f2">getNormIlluminantXYZ</a>(illumXYZ);</div>
<div class="line"><span class="lineno"> 1396</span>    illXYZ.<a class="code hl_variable" href="../../d7/d46/a00002.html#a8a82647ad953c198665aee9e3b659ea7">X</a> = <a class="code hl_function" href="../../d7/dce/a00143.html#a4a143eb09493d53cb1f7252819615498">icDtoF</a>(illumXYZ[0]);</div>
<div class="line"><span class="lineno"> 1397</span>    illXYZ.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3e75b8d208a5e4c55eac077643bc7689">Y</a> = <a class="code hl_function" href="../../d7/dce/a00143.html#a4a143eb09493d53cb1f7252819615498">icDtoF</a>(illumXYZ[1]);</div>
<div class="line"><span class="lineno"> 1398</span>    illXYZ.<a class="code hl_variable" href="../../d7/d46/a00002.html#a8753b09e8d550ace7d30a0af5d0e7ab3">Z</a> = <a class="code hl_function" href="../../d7/dce/a00143.html#a4a143eb09493d53cb1f7252819615498">icDtoF</a>(illumXYZ[2]);</div>
<div class="line"><span class="lineno"> 1399</span>  }</div>
<div class="line"><span class="lineno"> 1400</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1401</span>    illXYZ = m_pProfile-&gt;m_Header.illuminant;</div>
<div class="line"><span class="lineno"> 1402</span>    illumXYZ[0] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>(illXYZ.<a class="code hl_variable" href="../../d7/d46/a00002.html#a8a82647ad953c198665aee9e3b659ea7">X</a>);</div>
<div class="line"><span class="lineno"> 1403</span>    illumXYZ[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>(illXYZ.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3e75b8d208a5e4c55eac077643bc7689">Y</a>);</div>
<div class="line"><span class="lineno"> 1404</span>    illumXYZ[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>(illXYZ.<a class="code hl_variable" href="../../d7/d46/a00002.html#a8753b09e8d550ace7d30a0af5d0e7ab3">Z</a>);</div>
<div class="line"><span class="lineno"> 1405</span>  }</div>
<div class="line"><span class="lineno"> 1406</span> </div>
<div class="line"><span class="lineno"> 1407</span>    <span class="comment">// set up for any needed PCS adjustment</span></div>
<div class="line"><span class="lineno"> 1408</span>    <span class="keywordflow">if</span> (m_nIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a> &amp;&amp; </div>
<div class="line"><span class="lineno"> 1409</span>          (m_MediaXYZ.X != illXYZ.<a class="code hl_variable" href="../../d7/d46/a00002.html#a8a82647ad953c198665aee9e3b659ea7">X</a> ||</div>
<div class="line"><span class="lineno"> 1410</span>           m_MediaXYZ.Y != illXYZ.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3e75b8d208a5e4c55eac077643bc7689">Y</a> ||</div>
<div class="line"><span class="lineno"> 1411</span>           m_MediaXYZ.Z != illXYZ.<a class="code hl_variable" href="../../d7/d46/a00002.html#a8753b09e8d550ace7d30a0af5d0e7ab3">Z</a>)) {</div>
<div class="line"><span class="lineno"> 1412</span> </div>
<div class="line"><span class="lineno"> 1413</span>            <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> Space = m_pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 1414</span> </div>
<div class="line"><span class="lineno"> 1415</span>            <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d3/df8/a00155.html#af2bf8c7d947cb795089de5f391f91d4d">IsSpacePCS</a>(Space)) {</div>
<div class="line"><span class="lineno"> 1416</span>                m_bAdjustPCS = <span class="keyword">true</span>;                <span class="comment">// turn ON PCS adjustment</span></div>
<div class="line"><span class="lineno"> 1417</span> </div>
<div class="line"><span class="lineno"> 1418</span>                <span class="comment">// scale factors depend upon media white point</span></div>
<div class="line"><span class="lineno"> 1419</span>                <span class="comment">// set up for input transform</span></div>
<div class="line"><span class="lineno"> 1420</span>        <span class="keywordflow">if</span> (!m_bInput) {</div>
<div class="line"><span class="lineno"> 1421</span>          m_PCSScale[0] = illumXYZ[0] / mediaXYZ[0];    </div>
<div class="line"><span class="lineno"> 1422</span>          m_PCSScale[1] = illumXYZ[1] / mediaXYZ[1];</div>
<div class="line"><span class="lineno"> 1423</span>          m_PCSScale[2] = illumXYZ[2] / mediaXYZ[2];</div>
<div class="line"><span class="lineno"> 1424</span>        }</div>
<div class="line"><span class="lineno"> 1425</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1426</span>          m_PCSScale[0] = mediaXYZ[0] / illumXYZ[0];    </div>
<div class="line"><span class="lineno"> 1427</span>          m_PCSScale[1] = mediaXYZ[1] / illumXYZ[1];</div>
<div class="line"><span class="lineno"> 1428</span>          m_PCSScale[2] = mediaXYZ[2] / illumXYZ[2];</div>
<div class="line"><span class="lineno"> 1429</span> </div>
<div class="line"><span class="lineno"> 1430</span>        }</div>
<div class="line"><span class="lineno"> 1431</span> </div>
<div class="line"><span class="lineno"> 1432</span>                m_PCSOffset[0] = 0.0;</div>
<div class="line"><span class="lineno"> 1433</span>                m_PCSOffset[1] = 0.0;</div>
<div class="line"><span class="lineno"> 1434</span>                m_PCSOffset[2] = 0.0;</div>
<div class="line"><span class="lineno"> 1435</span>            }</div>
<div class="line"><span class="lineno"> 1436</span>    }</div>
<div class="line"><span class="lineno"> 1437</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_nIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a> &amp;&amp; (IsVersion2() || !HasPerceptualHandling())) {</div>
<div class="line"><span class="lineno"> 1438</span>        <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> Space = m_pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 1439</span> </div>
<div class="line"><span class="lineno"> 1440</span>        <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d3/df8/a00155.html#af2bf8c7d947cb795089de5f391f91d4d">IsSpacePCS</a>(Space) &amp;&amp; m_pProfile-&gt;m_Header.deviceClass!=<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a200e4fc8dcec29c6d411cae0c9a0483c">icSigAbstractClass</a>) {</div>
<div class="line"><span class="lineno"> 1441</span>            m_bAdjustPCS = <span class="keyword">true</span>;                <span class="comment">// turn ON PCS adjustment</span></div>
<div class="line"><span class="lineno"> 1442</span> </div>
<div class="line"><span class="lineno"> 1443</span>            <span class="comment">// set up for input transform, which needs version 2 black point to version 4</span></div>
<div class="line"><span class="lineno"> 1444</span>            m_PCSScale[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>) (1.0 - <a class="code hl_define" href="../../d6/d5b/a00026.html#af707981d921fc26ac8eb85f4ff285e41">icPerceptualRefBlackX</a> / <a class="code hl_define" href="../../d6/d5b/a00026.html#a2099748836172e9623ed265cf9a416fe">icPerceptualRefWhiteX</a>);  <span class="comment">// scale factors</span></div>
<div class="line"><span class="lineno"> 1445</span>            m_PCSScale[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>) (1.0 - <a class="code hl_define" href="../../d6/d5b/a00026.html#a91d9d2e6ccc7b48d1c505eac7d472e11">icPerceptualRefBlackY</a> / <a class="code hl_define" href="../../d6/d5b/a00026.html#ac9449e1acbe4f8a51e242f04afd25361">icPerceptualRefWhiteY</a>);</div>
<div class="line"><span class="lineno"> 1446</span>            m_PCSScale[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>) (1.0 - <a class="code hl_define" href="../../d6/d5b/a00026.html#a519837a14867b2fc70159d63527bfb48">icPerceptualRefBlackZ</a> / <a class="code hl_define" href="../../d6/d5b/a00026.html#a970c241f6169898a9ae88b10fe06f91b">icPerceptualRefWhiteZ</a>);</div>
<div class="line"><span class="lineno"> 1447</span> </div>
<div class="line"><span class="lineno"> 1448</span>            m_PCSOffset[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>) (<a class="code hl_define" href="../../d6/d5b/a00026.html#af707981d921fc26ac8eb85f4ff285e41">icPerceptualRefBlackX</a> * 32768.0 / 65535.0);   <span class="comment">// offset factors</span></div>
<div class="line"><span class="lineno"> 1449</span>            m_PCSOffset[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>) (<a class="code hl_define" href="../../d6/d5b/a00026.html#a91d9d2e6ccc7b48d1c505eac7d472e11">icPerceptualRefBlackY</a> * 32768.0 / 65535.0);</div>
<div class="line"><span class="lineno"> 1450</span>            m_PCSOffset[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>) (<a class="code hl_define" href="../../d6/d5b/a00026.html#a519837a14867b2fc70159d63527bfb48">icPerceptualRefBlackZ</a> * 32768.0 / 65535.0);</div>
<div class="line"><span class="lineno"> 1451</span> </div>
<div class="line"><span class="lineno"> 1452</span>            <span class="keywordflow">if</span> (!m_bInput) {                <span class="comment">// output transform must convert version 4 black point to version 2</span></div>
<div class="line"><span class="lineno"> 1453</span>                m_PCSScale[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>) 1.0 / m_PCSScale[0];    <span class="comment">// invert scale factors</span></div>
<div class="line"><span class="lineno"> 1454</span>                m_PCSScale[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>) 1.0 / m_PCSScale[1];</div>
<div class="line"><span class="lineno"> 1455</span>                m_PCSScale[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>) 1.0 / m_PCSScale[2];</div>
<div class="line"><span class="lineno"> 1456</span> </div>
<div class="line"><span class="lineno"> 1457</span>                m_PCSOffset[0] = - m_PCSOffset[0] * m_PCSScale[0];  <span class="comment">// negate offset factors</span></div>
<div class="line"><span class="lineno"> 1458</span>                m_PCSOffset[1] = - m_PCSOffset[1] * m_PCSScale[1];</div>
<div class="line"><span class="lineno"> 1459</span>                m_PCSOffset[2] = - m_PCSOffset[2] * m_PCSScale[2];</div>
<div class="line"><span class="lineno"> 1460</span>            }</div>
<div class="line"><span class="lineno"> 1461</span>        }</div>
<div class="line"><span class="lineno"> 1462</span>    }</div>
<div class="line"><span class="lineno"> 1463</span> </div>
<div class="line"><span class="lineno"> 1464</span> </div>
<div class="line"><span class="lineno"> 1465</span>    <span class="keywordflow">if</span> (m_pAdjustPCS) {</div>
<div class="line"><span class="lineno"> 1466</span>        <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> ProfileCopy(*m_pProfile);</div>
<div class="line"><span class="lineno"> 1467</span> </div>
<div class="line"><span class="lineno"> 1468</span>        <span class="comment">// need to read in all the tags, so that a copy of the profile can be made</span></div>
<div class="line"><span class="lineno"> 1469</span>        <span class="keywordflow">if</span> (!ProfileCopy.ReadTags(m_pProfile)) {</div>
<div class="line"><span class="lineno"> 1470</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860">icCmmStatInvalidProfile</a>;</div>
<div class="line"><span class="lineno"> 1471</span>        }</div>
<div class="line"><span class="lineno"> 1472</span>        </div>
<div class="line"><span class="lineno"> 1473</span>        <span class="keywordflow">if</span> (!m_pAdjustPCS-&gt;CalcFactors(&amp;ProfileCopy, <span class="keyword">this</span>, m_PCSScale, m_PCSOffset)) {</div>
<div class="line"><span class="lineno"> 1474</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno"> 1475</span>  }</div>
<div class="line"><span class="lineno"> 1476</span> </div>
<div class="line"><span class="lineno"> 1477</span>        m_bAdjustPCS = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1478</span>        <span class="keyword">delete</span> m_pAdjustPCS;</div>
<div class="line"><span class="lineno"> 1479</span>        m_pAdjustPCS = NULL;</div>
<div class="line"><span class="lineno"> 1480</span>    }</div>
<div class="line"><span class="lineno"> 1481</span> </div>
<div class="line"><span class="lineno"> 1482</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 1483</span>}</div>
<div class="line"><span class="lineno"> 1484</span> </div>
<div class="line"><span class="lineno"> 1494</span>CIccApplyXform *CIccXform::GetNewApply(<a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> &amp;status)</div>
<div class="line"><span class="lineno"> 1495</span>{</div>
<div class="line"><span class="lineno"> 1496</span>  CIccApplyXform *rv = <span class="keyword">new</span> CIccApplyXform(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 1497</span>  </div>
<div class="line"><span class="lineno"> 1498</span>  <span class="keywordflow">if</span> (!rv) {</div>
<div class="line"><span class="lineno"> 1499</span>    status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 1500</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 1501</span>  }</div>
<div class="line"><span class="lineno"> 1502</span> </div>
<div class="line"><span class="lineno"> 1503</span>  status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 1504</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 1505</span>}</div>
<div class="line"><span class="lineno"> 1506</span> </div>
<div class="line"><span class="lineno"> 1521</span><span class="keywordtype">void</span> CIccXform::AdjustPCS(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 1522</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 1523</span>  <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> Space = m_pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 1524</span> </div>
<div class="line"><span class="lineno"> 1525</span>  <span class="keywordflow">if</span> (Space==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>) {</div>
<div class="line"><span class="lineno"> 1526</span>    <span class="keywordflow">if</span> (UseLegacyPCS()) {</div>
<div class="line"><span class="lineno"> 1527</span>        CIccPCSUtil::Lab2ToXyz(DstPixel, SrcPixel, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1528</span>    }</div>
<div class="line"><span class="lineno"> 1529</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1530</span>      CIccPCSUtil::LabToXyz(DstPixel, SrcPixel, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1531</span>    }</div>
<div class="line"><span class="lineno"> 1532</span>  }</div>
<div class="line"><span class="lineno"> 1533</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1534</span>    DstPixel[0] = SrcPixel[0];</div>
<div class="line"><span class="lineno"> 1535</span>    DstPixel[1] = SrcPixel[1];</div>
<div class="line"><span class="lineno"> 1536</span>    DstPixel[2] = SrcPixel[2];</div>
<div class="line"><span class="lineno"> 1537</span>  }</div>
<div class="line"><span class="lineno"> 1538</span> </div>
<div class="line"><span class="lineno"> 1539</span>  DstPixel[0] = DstPixel[0] * m_PCSScale[0] + m_PCSOffset[0];</div>
<div class="line"><span class="lineno"> 1540</span>  DstPixel[1] = DstPixel[1] * m_PCSScale[1] + m_PCSOffset[1];</div>
<div class="line"><span class="lineno"> 1541</span>  DstPixel[2] = DstPixel[2] * m_PCSScale[2] + m_PCSOffset[2];</div>
<div class="line"><span class="lineno"> 1542</span> </div>
<div class="line"><span class="lineno"> 1543</span>  <span class="keywordflow">if</span> (Space==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>) {</div>
<div class="line"><span class="lineno"> 1544</span>    <span class="keywordflow">if</span> (UseLegacyPCS()) {</div>
<div class="line"><span class="lineno"> 1545</span> </div>
<div class="line"><span class="lineno"> 1546</span>        CIccPCSUtil::XyzToLab2(DstPixel, DstPixel, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1547</span>    }</div>
<div class="line"><span class="lineno"> 1548</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1549</span>      CIccPCSUtil::XyzToLab(DstPixel, DstPixel, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1550</span>    }</div>
<div class="line"><span class="lineno"> 1551</span>  }</div>
<div class="line"><span class="lineno"> 1552</span><span class="preprocessor">#ifndef SAMPLEICC_NOCLIPLABTOXYZ</span></div>
<div class="line"><span class="lineno"> 1553</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1554</span>    DstPixel[0] = CIccPCSUtil::NegClip(DstPixel[0]);</div>
<div class="line"><span class="lineno"> 1555</span>    DstPixel[1] = CIccPCSUtil::NegClip(DstPixel[1]);</div>
<div class="line"><span class="lineno"> 1556</span>    DstPixel[2] = CIccPCSUtil::NegClip(DstPixel[2]);</div>
<div class="line"><span class="lineno"> 1557</span>  }</div>
<div class="line"><span class="lineno"> 1558</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1559</span>}</div>
<div class="line"><span class="lineno"> 1560</span> </div>
<div class="line"><span class="lineno"> 1577</span><span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *CIccXform::CheckSrcAbs(CIccApplyXform *pApply, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Pixel)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 1578</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 1579</span>    <span class="keywordflow">if</span> (m_bAdjustPCS &amp;&amp; !m_bInput) {</div>
<div class="line"><span class="lineno"> 1580</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pAbsLab = pApply-&gt;m_AbsLab;</div>
<div class="line"><span class="lineno"> 1581</span>        AdjustPCS(pAbsLab, Pixel);</div>
<div class="line"><span class="lineno"> 1582</span>    <span class="keywordflow">return</span> pAbsLab;</div>
<div class="line"><span class="lineno"> 1583</span>  }</div>
<div class="line"><span class="lineno"> 1584</span> </div>
<div class="line"><span class="lineno"> 1585</span>  <span class="keywordflow">return</span> Pixel;</div>
<div class="line"><span class="lineno"> 1586</span>}</div>
<div class="line"><span class="lineno"> 1587</span> </div>
<div class="line"><span class="lineno"> 1602</span><span class="keywordtype">void</span> CIccXform::CheckDstAbs(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Pixel)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 1603</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 1604</span>    <span class="keywordflow">if</span> (m_bAdjustPCS &amp;&amp; m_bInput) {</div>
<div class="line"><span class="lineno"> 1605</span>        AdjustPCS(Pixel, Pixel);</div>
<div class="line"><span class="lineno"> 1606</span>  }</div>
<div class="line"><span class="lineno"> 1607</span>}</div>
<div class="line"><span class="lineno"> 1608</span>        </div>
<div class="line"><span class="lineno"> 1620</span><a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> CIccXform::GetSrcSpace()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 1621</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 1622</span>  <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> rv;</div>
<div class="line"><span class="lineno"> 1623</span>  <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0">icProfileClassSignature</a> deviceClass = m_pProfile-&gt;m_Header.deviceClass;</div>
<div class="line"><span class="lineno"> 1624</span> </div>
<div class="line"><span class="lineno"> 1625</span>  <span class="keywordflow">if</span> (m_bInput) {</div>
<div class="line"><span class="lineno"> 1626</span>    <span class="keywordflow">if</span> (m_bPcsAdjustXform)</div>
<div class="line"><span class="lineno"> 1627</span>      rv = m_pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 1628</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1629</span>      rv = m_pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno"> 1630</span> </div>
<div class="line"><span class="lineno"> 1631</span>      <span class="keywordflow">if</span> (deviceClass != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a200e4fc8dcec29c6d411cae0c9a0483c">icSigAbstractClass</a>) {</div>
<div class="line"><span class="lineno"> 1632</span>        <span class="comment">//convert signature to device colorspace signature (avoid confusion about encoding).</span></div>
<div class="line"><span class="lineno"> 1633</span>        <span class="keywordflow">if</span> (rv == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>) {</div>
<div class="line"><span class="lineno"> 1634</span>          rv = <a class="code hl_define" href="../../d4/d81/a00110.html#a550e980dd884839e33548afbd55b4277">icSigDevXYZData</a>;</div>
<div class="line"><span class="lineno"> 1635</span>        }</div>
<div class="line"><span class="lineno"> 1636</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rv == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>) {</div>
<div class="line"><span class="lineno"> 1637</span>          rv = <a class="code hl_define" href="../../d4/d81/a00110.html#a92d563abc2c24efa8ccad672a9dfd14f">icSigDevLabData</a>;</div>
<div class="line"><span class="lineno"> 1638</span>        }</div>
<div class="line"><span class="lineno"> 1639</span>      }</div>
<div class="line"><span class="lineno"> 1640</span>    }</div>
<div class="line"><span class="lineno"> 1641</span>  }</div>
<div class="line"><span class="lineno"> 1642</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!m_bUseSpectralPCS || !m_pProfile-&gt;m_Header.spectralPCS) {</div>
<div class="line"><span class="lineno"> 1643</span>    rv = m_pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 1644</span>  }</div>
<div class="line"><span class="lineno"> 1645</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1646</span>    rv = <a class="code hl_define" href="../../d7/d46/a00002.html#a47e4f847bd0bc609907b5fea4daf3e75">icGetColorSpaceType</a>(m_pProfile-&gt;m_Header.spectralPCS);</div>
<div class="line"><span class="lineno"> 1647</span>  }</div>
<div class="line"><span class="lineno"> 1648</span> </div>
<div class="line"><span class="lineno"> 1649</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 1650</span>}</div>
<div class="line"><span class="lineno"> 1651</span> </div>
<div class="line"><span class="lineno"> 1663</span><a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> CIccXform::GetNumSrcSamples()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 1664</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 1665</span>  <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> rv;</div>
<div class="line"><span class="lineno"> 1666</span> </div>
<div class="line"><span class="lineno"> 1667</span>  <span class="keywordflow">if</span> (m_nMCS==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393a9900382442b6928de2af4b116f08dd5e">icFromMCS</a>) {</div>
<div class="line"><span class="lineno"> 1668</span>    rv = (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)<a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>((<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)m_pProfile-&gt;m_Header.mcs);</div>
<div class="line"><span class="lineno"> 1669</span>  }</div>
<div class="line"><span class="lineno"> 1670</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_bInput) {</div>
<div class="line"><span class="lineno"> 1671</span>    rv = (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)<a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(m_pProfile-&gt;m_Header.colorSpace);</div>
<div class="line"><span class="lineno"> 1672</span>  }</div>
<div class="line"><span class="lineno"> 1673</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!m_bUseSpectralPCS || !m_pProfile-&gt;m_Header.spectralPCS) {</div>
<div class="line"><span class="lineno"> 1674</span>    rv = (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)<a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(m_pProfile-&gt;m_Header.pcs);</div>
<div class="line"><span class="lineno"> 1675</span>  }</div>
<div class="line"><span class="lineno"> 1676</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1677</span>    rv = (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)<a class="code hl_function" href="../../d7/dce/a00143.html#a0ae39400770bbc7c8be88c485167ad26">icGetSpectralSpaceSamples</a>(&amp;m_pProfile-&gt;m_Header);</div>
<div class="line"><span class="lineno"> 1678</span>  }</div>
<div class="line"><span class="lineno"> 1679</span> </div>
<div class="line"><span class="lineno"> 1680</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 1681</span>}</div>
<div class="line"><span class="lineno"> 1682</span> </div>
<div class="line"><span class="lineno"> 1694</span><a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> CIccXform::GetDstSpace()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 1695</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 1696</span>  <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> rv;</div>
<div class="line"><span class="lineno"> 1697</span>  <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0">icProfileClassSignature</a> deviceClass = m_pProfile-&gt;m_Header.deviceClass;</div>
<div class="line"><span class="lineno"> 1698</span> </div>
<div class="line"><span class="lineno"> 1699</span>  <span class="keywordflow">if</span> (m_nMCS==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393a792a9f663756385f0a63c62606fbd5b5">icToMCS</a>) {</div>
<div class="line"><span class="lineno"> 1700</span>    rv = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)m_pProfile-&gt;m_Header.mcs;</div>
<div class="line"><span class="lineno"> 1701</span>  }</div>
<div class="line"><span class="lineno"> 1702</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_bInput) {</div>
<div class="line"><span class="lineno"> 1703</span>    <span class="keywordflow">if</span> (m_bUseSpectralPCS &amp;&amp; m_pProfile-&gt;m_Header.spectralPCS)</div>
<div class="line"><span class="lineno"> 1704</span>      rv = <a class="code hl_define" href="../../d7/d46/a00002.html#a47e4f847bd0bc609907b5fea4daf3e75">icGetColorSpaceType</a>(m_pProfile-&gt;m_Header.spectralPCS);</div>
<div class="line"><span class="lineno"> 1705</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1706</span>      rv = m_pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 1707</span>  }</div>
<div class="line"><span class="lineno"> 1708</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1709</span>    rv = m_pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno"> 1710</span> </div>
<div class="line"><span class="lineno"> 1711</span>    <span class="comment">//convert signature to device colorspace signature (avoid confusion about encoding).</span></div>
<div class="line"><span class="lineno"> 1712</span>    <span class="keywordflow">if</span> (deviceClass != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a200e4fc8dcec29c6d411cae0c9a0483c">icSigAbstractClass</a>) {</div>
<div class="line"><span class="lineno"> 1713</span>      <span class="keywordflow">if</span> (rv==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>) {</div>
<div class="line"><span class="lineno"> 1714</span>        rv = <a class="code hl_define" href="../../d4/d81/a00110.html#a550e980dd884839e33548afbd55b4277">icSigDevXYZData</a>;</div>
<div class="line"><span class="lineno"> 1715</span>      }</div>
<div class="line"><span class="lineno"> 1716</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (rv==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>) {</div>
<div class="line"><span class="lineno"> 1717</span>        rv = <a class="code hl_define" href="../../d4/d81/a00110.html#a92d563abc2c24efa8ccad672a9dfd14f">icSigDevLabData</a>;</div>
<div class="line"><span class="lineno"> 1718</span>      }</div>
<div class="line"><span class="lineno"> 1719</span>    }</div>
<div class="line"><span class="lineno"> 1720</span>  }</div>
<div class="line"><span class="lineno"> 1721</span> </div>
<div class="line"><span class="lineno"> 1722</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 1723</span>}</div>
<div class="line"><span class="lineno"> 1724</span> </div>
<div class="line"><span class="lineno"> 1736</span><a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> CIccXform::GetNumDstSamples()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 1737</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 1738</span>  <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> rv;</div>
<div class="line"><span class="lineno"> 1739</span> </div>
<div class="line"><span class="lineno"> 1740</span>  <span class="keywordflow">if</span> (m_nMCS==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393a792a9f663756385f0a63c62606fbd5b5">icToMCS</a>) {</div>
<div class="line"><span class="lineno"> 1741</span>    rv = (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)<a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>((<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)m_pProfile-&gt;m_Header.mcs);</div>
<div class="line"><span class="lineno"> 1742</span>  }</div>
<div class="line"><span class="lineno"> 1743</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!m_bInput) {</div>
<div class="line"><span class="lineno"> 1744</span>    rv = (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)<a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(m_pProfile-&gt;m_Header.colorSpace);</div>
<div class="line"><span class="lineno"> 1745</span>  }</div>
<div class="line"><span class="lineno"> 1746</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!m_bUseSpectralPCS || !m_pProfile-&gt;m_Header.spectralPCS) {</div>
<div class="line"><span class="lineno"> 1747</span>    rv = (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)<a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(m_pProfile-&gt;m_Header.pcs);</div>
<div class="line"><span class="lineno"> 1748</span>  }</div>
<div class="line"><span class="lineno"> 1749</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1750</span>    rv = (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)<a class="code hl_function" href="../../d7/dce/a00143.html#a0ae39400770bbc7c8be88c485167ad26">icGetSpectralSpaceSamples</a>(&amp;m_pProfile-&gt;m_Header);</div>
<div class="line"><span class="lineno"> 1751</span>  }</div>
<div class="line"><span class="lineno"> 1752</span> </div>
<div class="line"><span class="lineno"> 1753</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 1754</span>}</div>
<div class="line"><span class="lineno"> 1755</span> </div>
<div class="line"><span class="lineno"> 1756</span> </div>
<div class="line"><span class="lineno"> 1765</span>CIccApplyXform::CIccApplyXform(CIccXform *pXform) : m_AbsLab{}</div>
<div class="line"><span class="lineno"> 1766</span>{</div>
<div class="line"><span class="lineno"> 1767</span>  m_pXform = pXform;</div>
<div class="line"><span class="lineno"> 1768</span>}</div>
<div class="line"><span class="lineno"> 1769</span> </div>
<div class="line"><span class="lineno"> 1778</span>CIccApplyXform::~CIccApplyXform()</div>
<div class="line"><span class="lineno"> 1779</span>{</div>
<div class="line"><span class="lineno"> 1780</span>}</div>
<div class="line"><span class="lineno"> 1781</span> </div>
<div class="line"><span class="lineno"> 1782</span> </div>
<div class="line"><span class="lineno"> 1791</span>CIccApplyNDLutXform::CIccApplyNDLutXform(CIccXformNDLut* pXform, <a class="code hl_class" href="../../d9/d65/a01145.html">CIccApplyCLUT</a> *pApply) : CIccApplyXform(pXform)</div>
<div class="line"><span class="lineno"> 1792</span>{</div>
<div class="line"><span class="lineno"> 1793</span>  m_pApply = pApply;</div>
<div class="line"><span class="lineno"> 1794</span>}</div>
<div class="line"><span class="lineno"> 1795</span> </div>
<div class="line"><span class="lineno"> 1796</span> </div>
<div class="line"><span class="lineno"> 1805</span>CIccApplyNDLutXform::~CIccApplyNDLutXform()</div>
<div class="line"><span class="lineno"> 1806</span>{</div>
<div class="line"><span class="lineno"> 1807</span>  <span class="keywordflow">if</span> (m_pApply)</div>
<div class="line"><span class="lineno"> 1808</span>    <span class="keyword">delete</span> m_pApply;</div>
<div class="line"><span class="lineno"> 1809</span>}</div>
<div class="line"><span class="lineno"> 1810</span> </div>
<div class="line"><span class="lineno"> 1811</span> </div>
<div class="line"><span class="lineno"> 1820</span>CIccApplyPcsXform::CIccApplyPcsXform(CIccXform *pXform) : CIccApplyXform(pXform)</div>
<div class="line"><span class="lineno"> 1821</span>{</div>
<div class="line"><span class="lineno"> 1822</span>  m_list = <span class="keyword">new</span> CIccApplyPcsStepList();</div>
<div class="line"><span class="lineno"> 1823</span>  m_temp1 = NULL;</div>
<div class="line"><span class="lineno"> 1824</span>  m_temp2 = NULL;</div>
<div class="line"><span class="lineno"> 1825</span>}</div>
<div class="line"><span class="lineno"> 1826</span> </div>
<div class="line"><span class="lineno"> 1835</span>CIccApplyPcsXform::~CIccApplyPcsXform()</div>
<div class="line"><span class="lineno"> 1836</span>{</div>
<div class="line"><span class="lineno"> 1837</span> </div>
<div class="line"><span class="lineno"> 1838</span>  <span class="keywordflow">if</span> (m_list) {</div>
<div class="line"><span class="lineno"> 1839</span>    CIccApplyPcsStepList::iterator i;</div>
<div class="line"><span class="lineno"> 1840</span>    <span class="keywordflow">for</span> (i=m_list-&gt;begin(); i!=m_list-&gt;end(); i++) {</div>
<div class="line"><span class="lineno"> 1841</span>      <span class="keywordflow">if</span> (i-&gt;ptr)</div>
<div class="line"><span class="lineno"> 1842</span>        <span class="keyword">delete</span> i-&gt;ptr;</div>
<div class="line"><span class="lineno"> 1843</span>    }</div>
<div class="line"><span class="lineno"> 1844</span> </div>
<div class="line"><span class="lineno"> 1845</span>    <span class="keyword">delete</span> m_list;</div>
<div class="line"><span class="lineno"> 1846</span>  }</div>
<div class="line"><span class="lineno"> 1847</span> </div>
<div class="line"><span class="lineno"> 1848</span>  <span class="keywordflow">if</span> (m_temp1)</div>
<div class="line"><span class="lineno"> 1849</span>    <span class="keyword">delete</span> [] m_temp1;</div>
<div class="line"><span class="lineno"> 1850</span>  <span class="keywordflow">if</span> (m_temp2)</div>
<div class="line"><span class="lineno"> 1851</span>    <span class="keyword">delete</span> [] m_temp2;</div>
<div class="line"><span class="lineno"> 1852</span>}</div>
<div class="line"><span class="lineno"> 1853</span> </div>
<div class="line"><span class="lineno"> 1862</span><span class="keywordtype">bool</span> CIccApplyPcsXform::Init()</div>
<div class="line"><span class="lineno"> 1863</span>{</div>
<div class="line"><span class="lineno"> 1864</span>  CIccPcsXform *pXform = (CIccPcsXform*)m_pXform;</div>
<div class="line"><span class="lineno"> 1865</span>  <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nChan = pXform-&gt;MaxChannels();</div>
<div class="line"><span class="lineno"> 1866</span> </div>
<div class="line"><span class="lineno"> 1867</span>  <span class="keywordflow">if</span> (nChan) {</div>
<div class="line"><span class="lineno"> 1868</span>    m_temp1 = <span class="keyword">new</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>[nChan];</div>
<div class="line"><span class="lineno"> 1869</span>    m_temp2 = <span class="keyword">new</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>[nChan];</div>
<div class="line"><span class="lineno"> 1870</span>  }</div>
<div class="line"><span class="lineno"> 1871</span> </div>
<div class="line"><span class="lineno"> 1872</span>  <span class="keywordflow">return</span> m_temp1!=NULL &amp;&amp; m_temp2!=NULL;</div>
<div class="line"><span class="lineno"> 1873</span>}</div>
<div class="line"><span class="lineno"> 1874</span> </div>
<div class="line"><span class="lineno"> 1875</span> </div>
<div class="line"><span class="lineno"> 1876</span><span class="keywordtype">void</span> CIccApplyPcsXform::AppendApplyStep(CIccApplyPcsStep *pStep)</div>
<div class="line"><span class="lineno"> 1877</span>{</div>
<div class="line"><span class="lineno"> 1878</span>  CIccApplyPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 1879</span> </div>
<div class="line"><span class="lineno"> 1880</span>  <span class="keywordflow">if</span> (pStep &amp;&amp; m_list) {</div>
<div class="line"><span class="lineno"> 1881</span>    ptr.ptr = pStep;</div>
<div class="line"><span class="lineno"> 1882</span>    m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 1883</span>  }</div>
<div class="line"><span class="lineno"> 1884</span>}</div>
<div class="line"><span class="lineno"> 1885</span> </div>
<div class="line"><span class="lineno"> 1886</span> </div>
<div class="line"><span class="lineno"> 1895</span>CIccPcsXform::CIccPcsXform()</div>
<div class="line"><span class="lineno"> 1896</span>{</div>
<div class="line"><span class="lineno"> 1897</span>  m_list = <span class="keyword">new</span> CIccPcsStepList();</div>
<div class="line"><span class="lineno"> 1898</span> </div>
<div class="line"><span class="lineno"> 1899</span>  m_srcSpace = <a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a>;</div>
<div class="line"><span class="lineno"> 1900</span>  m_nSrcSamples = 0;</div>
<div class="line"><span class="lineno"> 1901</span> </div>
<div class="line"><span class="lineno"> 1902</span>  m_dstSpace = <a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a>;</div>
<div class="line"><span class="lineno"> 1903</span>  m_nDstSamples = 0;</div>
<div class="line"><span class="lineno"> 1904</span>}</div>
<div class="line"><span class="lineno"> 1905</span> </div>
<div class="line"><span class="lineno"> 1914</span>CIccPcsXform::~CIccPcsXform()</div>
<div class="line"><span class="lineno"> 1915</span>{</div>
<div class="line"><span class="lineno"> 1916</span>  <span class="keywordflow">if</span> (m_list) {</div>
<div class="line"><span class="lineno"> 1917</span>    CIccPcsStepList::iterator step;</div>
<div class="line"><span class="lineno"> 1918</span>    <span class="keywordflow">for</span> (step=m_list-&gt;begin(); step!=m_list-&gt;end(); step++) {</div>
<div class="line"><span class="lineno"> 1919</span>      <span class="keywordflow">if</span> (step-&gt;ptr) {</div>
<div class="line"><span class="lineno"> 1920</span>        <span class="keyword">delete</span> step-&gt;ptr;</div>
<div class="line"><span class="lineno"> 1921</span>        step-&gt;ptr = NULL;</div>
<div class="line"><span class="lineno"> 1922</span>      }</div>
<div class="line"><span class="lineno"> 1923</span>    }</div>
<div class="line"><span class="lineno"> 1924</span>    <span class="keyword">delete</span> m_list;</div>
<div class="line"><span class="lineno"> 1925</span>  }</div>
<div class="line"><span class="lineno"> 1926</span>}</div>
<div class="line"><span class="lineno"> 1927</span> </div>
<div class="line"><span class="lineno"> 1937</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccPcsXform::Connect(CIccXform *pFromXform, CIccXform *pToXform)</div>
<div class="line"><span class="lineno"> 1938</span>{</div>
<div class="line"><span class="lineno"> 1939</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> stat;</div>
<div class="line"><span class="lineno"> 1940</span> </div>
<div class="line"><span class="lineno"> 1941</span>  <span class="keywordflow">if</span> (!pFromXform || !pToXform)</div>
<div class="line"><span class="lineno"> 1942</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno"> 1943</span> </div>
<div class="line"><span class="lineno"> 1944</span>  <span class="keywordflow">if</span> (pFromXform-&gt;IsMCS() &amp;&amp; pToXform-&gt;IsMCS()) {</div>
<div class="line"><span class="lineno"> 1945</span>    <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pFromProfile = pFromXform-&gt;GetProfilePtr();</div>
<div class="line"><span class="lineno"> 1946</span>    <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pToProfile = pToXform-&gt;GetProfilePtr();</div>
<div class="line"><span class="lineno"> 1947</span> </div>
<div class="line"><span class="lineno"> 1948</span>    <span class="keywordflow">if</span> (!pFromProfile || !pToProfile) {</div>
<div class="line"><span class="lineno"> 1949</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 1950</span>    }</div>
<div class="line"><span class="lineno"> 1951</span>    <a class="code hl_class" href="../../db/de0/a00465.html">CIccTagArray</a> *pFromChannels = (<a class="code hl_class" href="../../db/de0/a00465.html">CIccTagArray</a>*)(pFromProfile-&gt;FindTagOfType(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ae92349e1ad0bb9aab7d390df0a8c82cc">icSigMaterialTypeArrayTag</a>, <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea2a4636dabf07722022104d8d112e2417">icSigTagArrayType</a>));</div>
<div class="line"><span class="lineno"> 1952</span>    <a class="code hl_class" href="../../db/de0/a00465.html">CIccTagArray</a> *pToChannels = (<a class="code hl_class" href="../../db/de0/a00465.html">CIccTagArray</a>*)(pToProfile-&gt;FindTagOfType(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ae92349e1ad0bb9aab7d390df0a8c82cc">icSigMaterialTypeArrayTag</a>, <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea2a4636dabf07722022104d8d112e2417">icSigTagArrayType</a>));</div>
<div class="line"><span class="lineno"> 1953</span> </div>
<div class="line"><span class="lineno"> 1954</span>    <span class="keywordflow">if</span> (!pFromChannels || !pToChannels) {</div>
<div class="line"><span class="lineno"> 1955</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 1956</span>    }</div>
<div class="line"><span class="lineno"> 1957</span>    <span class="keywordflow">if</span> (pFromChannels-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#ae4d0c4f6859dc47d44b5b0c9c6ab4e44">GetTagArrayType</a>()!=<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a97bb6c6d4e1859ba7290162215ac8beba89d9aedd1fa4b16ba01ee9ea41dec24f">icSigUtf8TextTypeArray</a> ||</div>
<div class="line"><span class="lineno"> 1958</span>        pToChannels-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#ae4d0c4f6859dc47d44b5b0c9c6ab4e44">GetTagArrayType</a>()!=<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a97bb6c6d4e1859ba7290162215ac8beba89d9aedd1fa4b16ba01ee9ea41dec24f">icSigUtf8TextTypeArray</a> ||</div>
<div class="line"><span class="lineno"> 1959</span>        !pFromChannels-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#a0eec94cc1fea6ce5febd2d2a2c33921f">AreAllOfType</a>(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea21dfb852fbf1b3dfa35ca6804d3d0499">icSigUtf8TextType</a>) ||</div>
<div class="line"><span class="lineno"> 1960</span>        !pToChannels-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#a0eec94cc1fea6ce5febd2d2a2c33921f">AreAllOfType</a>(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea21dfb852fbf1b3dfa35ca6804d3d0499">icSigUtf8TextType</a>)) {</div>
<div class="line"><span class="lineno"> 1961</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 1962</span>    }</div>
<div class="line"><span class="lineno"> 1963</span> </div>
<div class="line"><span class="lineno"> 1964</span>    m_nSrcSamples = pFromXform-&gt;GetNumDstSamples();</div>
<div class="line"><span class="lineno"> 1965</span>    m_nDstSamples = pToXform-&gt;GetNumSrcSamples();</div>
<div class="line"><span class="lineno"> 1966</span> </div>
<div class="line"><span class="lineno"> 1967</span>    <span class="keywordflow">if</span> (pFromChannels-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#ad89262b326c7dde5b444599ed6d862e7">GetSize</a>() != m_nSrcSamples || pToChannels-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#ad89262b326c7dde5b444599ed6d862e7">GetSize</a>() != m_nDstSamples) {</div>
<div class="line"><span class="lineno"> 1968</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 1969</span>    }</div>
<div class="line"><span class="lineno"> 1970</span>    <span class="keywordtype">int</span> i, j;</div>
<div class="line"><span class="lineno"> 1971</span> </div>
<div class="line"><span class="lineno"> 1972</span>    <span class="keywordflow">if</span> (pFromProfile-&gt;m_Header.flags&amp;<a class="code hl_define" href="../../d7/d46/a00002.html#ada4a40a4c4b6cd075f42e5364e90dcf7">icMCSNeedsSubsetTrue</a>) {</div>
<div class="line"><span class="lineno"> 1973</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_nSrcSamples; i++) {</div>
<div class="line"><span class="lineno"> 1974</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a11ef650eb30d34d4f469f2c5db79aa50">icUChar</a> *szSrcChan = ((<a class="code hl_class" href="../../dd/d24/a00981.html">CIccTagUtf8Text</a>*)pFromChannels-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#ac30ff943da70f26a654f2e9d39c0e568">GetIndex</a>(i))-&gt;GetText();</div>
<div class="line"><span class="lineno"> 1975</span>        <span class="keywordflow">for</span> (j=0; j&lt;m_nDstSamples; j++) {</div>
<div class="line"><span class="lineno"> 1976</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a11ef650eb30d34d4f469f2c5db79aa50">icUChar</a> *szDstChan = ((<a class="code hl_class" href="../../dd/d24/a00981.html">CIccTagUtf8Text</a>*)pToChannels-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#ac30ff943da70f26a654f2e9d39c0e568">GetIndex</a>(i))-&gt;GetText();</div>
<div class="line"><span class="lineno"> 1977</span>          <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d7/dce/a00143.html#ae716aa59d818f8dda39c5a4245061336">icUtf8StrCmp</a>(szSrcChan, szDstChan))</div>
<div class="line"><span class="lineno"> 1978</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1979</span>        }</div>
<div class="line"><span class="lineno"> 1980</span>        <span class="keywordflow">if</span> (j==m_nDstSamples)</div>
<div class="line"><span class="lineno"> 1981</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a6bd126a39f8787a82bf08db1af1fcb9b">icCmmStatBadMCSLink</a>;</div>
<div class="line"><span class="lineno"> 1982</span>      }</div>
<div class="line"><span class="lineno"> 1983</span>    }</div>
<div class="line"><span class="lineno"> 1984</span> </div>
<div class="line"><span class="lineno"> 1985</span>    <span class="keywordflow">if</span> (pToProfile-&gt;m_Header.flags&amp;<a class="code hl_define" href="../../d7/d46/a00002.html#ada4a40a4c4b6cd075f42e5364e90dcf7">icMCSNeedsSubsetTrue</a>) {</div>
<div class="line"><span class="lineno"> 1986</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_nDstSamples; i++) {</div>
<div class="line"><span class="lineno"> 1987</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a11ef650eb30d34d4f469f2c5db79aa50">icUChar</a> *szDstChan = ((<a class="code hl_class" href="../../dd/d24/a00981.html">CIccTagUtf8Text</a>*)pToChannels-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#ac30ff943da70f26a654f2e9d39c0e568">GetIndex</a>(i))-&gt;GetText();</div>
<div class="line"><span class="lineno"> 1988</span>        <span class="keywordflow">for</span> (j=0; j&lt;m_nSrcSamples; j++) {</div>
<div class="line"><span class="lineno"> 1989</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a11ef650eb30d34d4f469f2c5db79aa50">icUChar</a> *szSrcChan = ((<a class="code hl_class" href="../../dd/d24/a00981.html">CIccTagUtf8Text</a>*)pFromChannels-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#ac30ff943da70f26a654f2e9d39c0e568">GetIndex</a>(i))-&gt;GetText();</div>
<div class="line"><span class="lineno"> 1990</span>          <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d7/dce/a00143.html#ae716aa59d818f8dda39c5a4245061336">icUtf8StrCmp</a>(szSrcChan, szDstChan))</div>
<div class="line"><span class="lineno"> 1991</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1992</span>        }</div>
<div class="line"><span class="lineno"> 1993</span>        <span class="keywordflow">if</span> (j==m_nSrcSamples)</div>
<div class="line"><span class="lineno"> 1994</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a6bd126a39f8787a82bf08db1af1fcb9b">icCmmStatBadMCSLink</a>;</div>
<div class="line"><span class="lineno"> 1995</span>      }</div>
<div class="line"><span class="lineno"> 1996</span>    }</div>
<div class="line"><span class="lineno"> 1997</span>    <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = pToProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a32d9a526626e93fa27620c528e48daf4">icSigMaterialDefaultValuesTag</a>);</div>
<div class="line"><span class="lineno"> 1998</span>    <a class="code hl_class" href="../../d0/daa/a01029.html">CIccTagNumArray</a> *pDefaults = NULL;</div>
<div class="line"><span class="lineno"> 1999</span>    <span class="keywordflow">if</span> (pTag &amp;&amp; pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#aa2a3dd91bfad9cf1297300d70936121a">IsNumArrayType</a>()) {</div>
<div class="line"><span class="lineno"> 2000</span>      pDefaults = (<a class="code hl_class" href="../../d0/daa/a01029.html">CIccTagNumArray</a> *)pTag;</div>
<div class="line"><span class="lineno"> 2001</span>    }</div>
<div class="line"><span class="lineno"> 2002</span> </div>
<div class="line"><span class="lineno"> 2003</span>    pushRouteMcs(pFromChannels, pToChannels, pDefaults);</div>
<div class="line"><span class="lineno"> 2004</span>  }</div>
<div class="line"><span class="lineno"> 2005</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2006</span>    <span class="keywordflow">if</span> (!pFromXform-&gt;IsInput() || (pToXform-&gt;IsInput() &amp;&amp; !pToXform-&gt;IsAbstract())) {</div>
<div class="line"><span class="lineno"> 2007</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 2008</span>    }</div>
<div class="line"><span class="lineno"> 2009</span> </div>
<div class="line"><span class="lineno"> 2010</span>    m_srcSpace = pFromXform-&gt;GetDstSpace();</div>
<div class="line"><span class="lineno"> 2011</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/df8/a00155.html#a05df9b9a2f56c907e676a0efc3e9219d">IsSpaceSpectralPCS</a>(m_srcSpace))</div>
<div class="line"><span class="lineno"> 2012</span>      m_srcSpace = <a class="code hl_define" href="../../d7/d46/a00002.html#a47e4f847bd0bc609907b5fea4daf3e75">icGetColorSpaceType</a>(m_srcSpace);</div>
<div class="line"><span class="lineno"> 2013</span> </div>
<div class="line"><span class="lineno"> 2014</span>    m_nSrcSamples = pFromXform-&gt;GetNumDstSamples();</div>
<div class="line"><span class="lineno"> 2015</span> </div>
<div class="line"><span class="lineno"> 2016</span>    m_dstSpace = pToXform-&gt;GetSrcSpace();</div>
<div class="line"><span class="lineno"> 2017</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/df8/a00155.html#a05df9b9a2f56c907e676a0efc3e9219d">IsSpaceSpectralPCS</a>(m_dstSpace))</div>
<div class="line"><span class="lineno"> 2018</span>      m_dstSpace = <a class="code hl_define" href="../../d7/d46/a00002.html#a47e4f847bd0bc609907b5fea4daf3e75">icGetColorSpaceType</a>(m_dstSpace);</div>
<div class="line"><span class="lineno"> 2019</span> </div>
<div class="line"><span class="lineno"> 2020</span>    m_nDstSamples = pToXform-&gt;GetNumSrcSamples();</div>
<div class="line"><span class="lineno"> 2021</span> </div>
<div class="line"><span class="lineno"> 2022</span>    <span class="keywordflow">switch</span> (m_srcSpace) {</div>
<div class="line"><span class="lineno"> 2023</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a043048bd0c63d3bd54d35e8b5743d226">icSigLabPcsData</a>:</div>
<div class="line"><span class="lineno"> 2024</span>        <span class="keywordflow">switch</span> (m_dstSpace) {</div>
<div class="line"><span class="lineno"> 2025</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a043048bd0c63d3bd54d35e8b5743d226">icSigLabPcsData</a>:</div>
<div class="line"><span class="lineno"> 2026</span>            <span class="keywordflow">if</span> (pFromXform-&gt;UseLegacyPCS())</div>
<div class="line"><span class="lineno"> 2027</span>              pushLab2ToXyz(pFromXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2028</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2029</span>              pushLabToXyz(pFromXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2030</span>            <span class="keywordflow">if</span> (pFromXform-&gt;NeedAdjustDstPCS()) {</div>
<div class="line"><span class="lineno"> 2031</span>              pushScale3(pFromXform-&gt;m_PCSScale[0], pFromXform-&gt;m_PCSScale[1], pFromXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2032</span>              pushOffset3(pFromXform-&gt;m_PCSOffset[0], pFromXform-&gt;m_PCSOffset[1], pFromXform-&gt;m_PCSOffset[2]);</div>
<div class="line"><span class="lineno"> 2033</span>            }</div>
<div class="line"><span class="lineno"> 2034</span>            <span class="keywordflow">if</span> ((stat=pushXYZConvert(pFromXform, pToXform))!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 2035</span>              <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 2036</span>            }</div>
<div class="line"><span class="lineno"> 2037</span>            <span class="keywordflow">if</span> (pToXform-&gt;NeedAdjustSrcPCS()) {</div>
<div class="line"><span class="lineno"> 2038</span>              pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</div>
<div class="line"><span class="lineno"> 2039</span>                            pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</div>
<div class="line"><span class="lineno"> 2040</span>                            pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2041</span>              pushScale3(pToXform-&gt;m_PCSScale[0], pToXform-&gt;m_PCSScale[1], pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2042</span>            }</div>
<div class="line"><span class="lineno"> 2043</span>            <span class="keywordflow">if</span> (pToXform-&gt;UseLegacyPCS())</div>
<div class="line"><span class="lineno"> 2044</span>              pushXyzToLab2(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2045</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2046</span>              pushXyzToLab(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2047</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2048</span> </div>
<div class="line"><span class="lineno"> 2049</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a3cc88012894a42474b7609adbe314918">icSigXYZPcsData</a>:</div>
<div class="line"><span class="lineno"> 2050</span>            <span class="keywordflow">if</span> (pFromXform-&gt;UseLegacyPCS())</div>
<div class="line"><span class="lineno"> 2051</span>              pushLab2ToXyz(pFromXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2052</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2053</span>              pushLabToXyz(pFromXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2054</span>            <span class="keywordflow">if</span> (pFromXform-&gt;NeedAdjustDstPCS()) {</div>
<div class="line"><span class="lineno"> 2055</span>              pushScale3(pFromXform-&gt;m_PCSScale[0], pFromXform-&gt;m_PCSScale[1], pFromXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2056</span>              pushOffset3(pFromXform-&gt;m_PCSOffset[0], pFromXform-&gt;m_PCSOffset[1], pFromXform-&gt;m_PCSOffset[2]);</div>
<div class="line"><span class="lineno"> 2057</span>            }</div>
<div class="line"><span class="lineno"> 2058</span>            <span class="keywordflow">if</span> ((stat=pushXYZConvert(pFromXform, pToXform))!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 2059</span>              <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 2060</span>            }</div>
<div class="line"><span class="lineno"> 2061</span>            <span class="keywordflow">if</span> (pToXform-&gt;NeedAdjustSrcPCS()) {</div>
<div class="line"><span class="lineno"> 2062</span>              pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</div>
<div class="line"><span class="lineno"> 2063</span>                          pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</div>
<div class="line"><span class="lineno"> 2064</span>                          pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2065</span>              pushScale3(pToXform-&gt;m_PCSScale[0], pToXform-&gt;m_PCSScale[1], pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2066</span>            }</div>
<div class="line"><span class="lineno"> 2067</span>            pushXyzToXyzIn();</div>
<div class="line"><span class="lineno"> 2068</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2069</span> </div>
<div class="line"><span class="lineno"> 2070</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#aa9cd4477816537fbf648a155f6b78eda">icSigReflectanceSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2071</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#af5df74ebff3f8247e1c7c88844c1f140">icSigTransmissionSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2072</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a163dee4d9a8a1568dded8480a166e852">icSigRadiantSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2073</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#ae84d222edd132ad7741c628c1d4729d9">icSigBiDirReflectanceSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2074</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a1b59192d9fcc1aee71b8cc523b4978ca">icSigSparseMatrixSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2075</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281">icCmmStatUnsupportedPcsLink</a>;</div>
<div class="line"><span class="lineno"> 2076</span>        }</div>
<div class="line"><span class="lineno"> 2077</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2078</span> </div>
<div class="line"><span class="lineno"> 2079</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a3cc88012894a42474b7609adbe314918">icSigXYZPcsData</a>:</div>
<div class="line"><span class="lineno"> 2080</span>        <span class="keywordflow">switch</span> (m_dstSpace) {</div>
<div class="line"><span class="lineno"> 2081</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a043048bd0c63d3bd54d35e8b5743d226">icSigLabPcsData</a>:</div>
<div class="line"><span class="lineno"> 2082</span>            pushXyzInToXyz();</div>
<div class="line"><span class="lineno"> 2083</span>            <span class="keywordflow">if</span> (pFromXform-&gt;NeedAdjustDstPCS()) {</div>
<div class="line"><span class="lineno"> 2084</span>              pushScale3(pFromXform-&gt;m_PCSScale[0], pFromXform-&gt;m_PCSScale[1], pFromXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2085</span>              pushOffset3(pFromXform-&gt;m_PCSOffset[0], pFromXform-&gt;m_PCSOffset[1], pFromXform-&gt;m_PCSOffset[2]);</div>
<div class="line"><span class="lineno"> 2086</span>            }</div>
<div class="line"><span class="lineno"> 2087</span>            <span class="keywordflow">if</span> ((stat=pushXYZConvert(pFromXform, pToXform))!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 2088</span>              <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 2089</span>            }</div>
<div class="line"><span class="lineno"> 2090</span>            <span class="keywordflow">if</span> (pToXform-&gt;NeedAdjustSrcPCS()) {</div>
<div class="line"><span class="lineno"> 2091</span>              pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</div>
<div class="line"><span class="lineno"> 2092</span>                            pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</div>
<div class="line"><span class="lineno"> 2093</span>                            pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2094</span>              pushScale3(pToXform-&gt;m_PCSScale[0], pToXform-&gt;m_PCSScale[1], pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2095</span>            }</div>
<div class="line"><span class="lineno"> 2096</span>            <span class="keywordflow">if</span> (pToXform-&gt;UseLegacyPCS())</div>
<div class="line"><span class="lineno"> 2097</span>              pushXyzToLab2(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2098</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2099</span>              pushXyzToLab(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2100</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2101</span> </div>
<div class="line"><span class="lineno"> 2102</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a3cc88012894a42474b7609adbe314918">icSigXYZPcsData</a>:</div>
<div class="line"><span class="lineno"> 2103</span>            pushXyzInToXyz();</div>
<div class="line"><span class="lineno"> 2104</span>            <span class="keywordflow">if</span> (pFromXform-&gt;NeedAdjustDstPCS()) {</div>
<div class="line"><span class="lineno"> 2105</span>              pushScale3(pFromXform-&gt;m_PCSScale[0], pFromXform-&gt;m_PCSScale[1], pFromXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2106</span>              pushOffset3(pFromXform-&gt;m_PCSOffset[0], pFromXform-&gt;m_PCSOffset[1], pFromXform-&gt;m_PCSOffset[2]);</div>
<div class="line"><span class="lineno"> 2107</span>            }</div>
<div class="line"><span class="lineno"> 2108</span>            <span class="keywordflow">if</span> ((stat=pushXYZConvert(pFromXform, pToXform))!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 2109</span>              <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 2110</span>            }</div>
<div class="line"><span class="lineno"> 2111</span>            <span class="keywordflow">if</span> (pToXform-&gt;NeedAdjustSrcPCS()) {</div>
<div class="line"><span class="lineno"> 2112</span>              pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</div>
<div class="line"><span class="lineno"> 2113</span>                            pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</div>
<div class="line"><span class="lineno"> 2114</span>                            pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2115</span>              pushScale3(pToXform-&gt;m_PCSScale[0], pToXform-&gt;m_PCSScale[1], pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2116</span>            }</div>
<div class="line"><span class="lineno"> 2117</span>            pushXyzToXyzIn();</div>
<div class="line"><span class="lineno"> 2118</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2119</span> </div>
<div class="line"><span class="lineno"> 2120</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#aa9cd4477816537fbf648a155f6b78eda">icSigReflectanceSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2121</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#af5df74ebff3f8247e1c7c88844c1f140">icSigTransmissionSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2122</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a163dee4d9a8a1568dded8480a166e852">icSigRadiantSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2123</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#ae84d222edd132ad7741c628c1d4729d9">icSigBiDirReflectanceSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2124</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a1b59192d9fcc1aee71b8cc523b4978ca">icSigSparseMatrixSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2125</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281">icCmmStatUnsupportedPcsLink</a>;</div>
<div class="line"><span class="lineno"> 2126</span>        }</div>
<div class="line"><span class="lineno"> 2127</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2128</span> </div>
<div class="line"><span class="lineno"> 2129</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#aa9cd4477816537fbf648a155f6b78eda">icSigReflectanceSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2130</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#af5df74ebff3f8247e1c7c88844c1f140">icSigTransmissionSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2131</span>        <span class="keywordflow">switch</span> (m_dstSpace) {</div>
<div class="line"><span class="lineno"> 2132</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a043048bd0c63d3bd54d35e8b5743d226">icSigLabPcsData</a>:</div>
<div class="line"><span class="lineno"> 2133</span>            pushRef2Xyz(pFromXform-&gt;m_pProfile, pFromXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2134</span>            <span class="keywordflow">if</span> ((stat=pushXYZConvert(pFromXform, pToXform))!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 2135</span>              <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 2136</span>            }</div>
<div class="line"><span class="lineno"> 2137</span>            <span class="keywordflow">if</span> (pToXform-&gt;NeedAdjustSrcPCS()) {</div>
<div class="line"><span class="lineno"> 2138</span>              pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</div>
<div class="line"><span class="lineno"> 2139</span>                                  pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</div>
<div class="line"><span class="lineno"> 2140</span>                                  pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2141</span>              pushScale3(pToXform-&gt;m_PCSScale[0], pToXform-&gt;m_PCSScale[1], pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2142</span>            }</div>
<div class="line"><span class="lineno"> 2143</span>            <span class="keywordflow">if</span> (pToXform-&gt;UseLegacyPCS())</div>
<div class="line"><span class="lineno"> 2144</span>              pushXyzToLab2(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2145</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2146</span>              pushXyzToLab(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2147</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2148</span> </div>
<div class="line"><span class="lineno"> 2149</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a3cc88012894a42474b7609adbe314918">icSigXYZPcsData</a>:</div>
<div class="line"><span class="lineno"> 2150</span>            pushRef2Xyz(pFromXform-&gt;m_pProfile, pFromXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2151</span>            <span class="keywordflow">if</span> ((stat=pushXYZConvert(pFromXform, pToXform))!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 2152</span>              <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 2153</span>            }</div>
<div class="line"><span class="lineno"> 2154</span>            <span class="keywordflow">if</span> (pToXform-&gt;NeedAdjustSrcPCS()) {</div>
<div class="line"><span class="lineno"> 2155</span>              pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</div>
<div class="line"><span class="lineno"> 2156</span>                            pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</div>
<div class="line"><span class="lineno"> 2157</span>                            pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2158</span>              pushScale3(pToXform-&gt;m_PCSScale[0], pToXform-&gt;m_PCSScale[1], pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2159</span>            }</div>
<div class="line"><span class="lineno"> 2160</span>            pushXyzToXyzIn();</div>
<div class="line"><span class="lineno"> 2161</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2162</span> </div>
<div class="line"><span class="lineno"> 2163</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#aa9cd4477816537fbf648a155f6b78eda">icSigReflectanceSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2164</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#af5df74ebff3f8247e1c7c88844c1f140">icSigTransmissionSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2165</span>              pushSpecToRange(pFromXform-&gt;m_pProfile-&gt;m_Header.spectralRange, </div>
<div class="line"><span class="lineno"> 2166</span>                              pToXform-&gt;m_pProfile-&gt;m_Header.spectralRange);</div>
<div class="line"><span class="lineno"> 2167</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2168</span> </div>
<div class="line"><span class="lineno"> 2169</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a163dee4d9a8a1568dded8480a166e852">icSigRadiantSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2170</span>            pushApplyIllum(pFromXform-&gt;m_pProfile, pFromXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2171</span>            pushSpecToRange(pFromXform-&gt;m_pProfile-&gt;m_Header.spectralRange, </div>
<div class="line"><span class="lineno"> 2172</span>                            pToXform-&gt;m_pProfile-&gt;m_Header.spectralRange);</div>
<div class="line"><span class="lineno"> 2173</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2174</span> </div>
<div class="line"><span class="lineno"> 2175</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#ae84d222edd132ad7741c628c1d4729d9">icSigBiDirReflectanceSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2176</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a1b59192d9fcc1aee71b8cc523b4978ca">icSigSparseMatrixSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2177</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281">icCmmStatUnsupportedPcsLink</a>;</div>
<div class="line"><span class="lineno"> 2178</span>        }</div>
<div class="line"><span class="lineno"> 2179</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2180</span> </div>
<div class="line"><span class="lineno"> 2181</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a163dee4d9a8a1568dded8480a166e852">icSigRadiantSpectralPcsData</a>: {</div>
<div class="line"><span class="lineno"> 2182</span>        <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pFromProfile = pFromXform-&gt;GetProfilePtr();</div>
<div class="line"><span class="lineno"> 2183</span>        <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pToProfile = pToXform-&gt;GetProfilePtr();</div>
<div class="line"><span class="lineno"> 2184</span> </div>
<div class="line"><span class="lineno"> 2185</span>        <span class="keywordflow">switch</span> (m_dstSpace) {</div>
<div class="line"><span class="lineno"> 2186</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a043048bd0c63d3bd54d35e8b5743d226">icSigLabPcsData</a>:</div>
<div class="line"><span class="lineno"> 2187</span>            pushRad2Xyz(pFromProfile, pFromXform-&gt;m_pConnectionConditions, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2188</span>            <span class="keywordflow">if</span> ((stat=pushXYZConvert(pFromXform, pToXform))!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 2189</span>              <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 2190</span>            }</div>
<div class="line"><span class="lineno"> 2191</span>            <span class="keywordflow">if</span> (pToXform-&gt;NeedAdjustSrcPCS()) {</div>
<div class="line"><span class="lineno"> 2192</span>              pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</div>
<div class="line"><span class="lineno"> 2193</span>                            pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</div>
<div class="line"><span class="lineno"> 2194</span>                            pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2195</span>              pushScale3(pToXform-&gt;m_PCSScale[0], pToXform-&gt;m_PCSScale[1], pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2196</span>            }</div>
<div class="line"><span class="lineno"> 2197</span>            <span class="keywordflow">if</span> (pToXform-&gt;UseLegacyPCS())</div>
<div class="line"><span class="lineno"> 2198</span>              pushXyzToLab2(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2199</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2200</span>              pushXyzToLab(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2201</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2202</span> </div>
<div class="line"><span class="lineno"> 2203</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a3cc88012894a42474b7609adbe314918">icSigXYZPcsData</a>:</div>
<div class="line"><span class="lineno"> 2204</span>            pushRad2Xyz(pFromProfile, pFromXform-&gt;m_pConnectionConditions, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2205</span>            <span class="keywordflow">if</span> ((stat=pushXYZConvert(pFromXform, pToXform))!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 2206</span>              <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 2207</span>            }</div>
<div class="line"><span class="lineno"> 2208</span>            <span class="keywordflow">if</span> (pToXform-&gt;NeedAdjustSrcPCS()) {</div>
<div class="line"><span class="lineno"> 2209</span>              pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</div>
<div class="line"><span class="lineno"> 2210</span>                            pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</div>
<div class="line"><span class="lineno"> 2211</span>                            pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2212</span>              pushScale3(pToXform-&gt;m_PCSScale[0], pToXform-&gt;m_PCSScale[1], pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2213</span>            }</div>
<div class="line"><span class="lineno"> 2214</span>            pushXyzToXyzIn();</div>
<div class="line"><span class="lineno"> 2215</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2216</span> </div>
<div class="line"><span class="lineno"> 2217</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#aa9cd4477816537fbf648a155f6b78eda">icSigReflectanceSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2218</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#af5df74ebff3f8247e1c7c88844c1f140">icSigTransmissionSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2219</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281">icCmmStatUnsupportedPcsLink</a>;</div>
<div class="line"><span class="lineno"> 2220</span> </div>
<div class="line"><span class="lineno"> 2221</span> </div>
<div class="line"><span class="lineno"> 2222</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a163dee4d9a8a1568dded8480a166e852">icSigRadiantSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2223</span>                pushSpecToRange(pFromXform-&gt;m_pProfile-&gt;m_Header.spectralRange, </div>
<div class="line"><span class="lineno"> 2224</span>                                   pToXform-&gt;m_pProfile-&gt;m_Header.spectralRange);</div>
<div class="line"><span class="lineno"> 2225</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2226</span> </div>
<div class="line"><span class="lineno"> 2227</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#ae84d222edd132ad7741c628c1d4729d9">icSigBiDirReflectanceSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2228</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a1b59192d9fcc1aee71b8cc523b4978ca">icSigSparseMatrixSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2229</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281">icCmmStatUnsupportedPcsLink</a>;</div>
<div class="line"><span class="lineno"> 2230</span>        }</div>
<div class="line"><span class="lineno"> 2231</span>      }</div>
<div class="line"><span class="lineno"> 2232</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2233</span> </div>
<div class="line"><span class="lineno"> 2234</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#ae84d222edd132ad7741c628c1d4729d9">icSigBiDirReflectanceSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2235</span>      <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a1b59192d9fcc1aee71b8cc523b4978ca">icSigSparseMatrixSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2236</span>        <span class="keywordflow">switch</span> (m_dstSpace) {</div>
<div class="line"><span class="lineno"> 2237</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a043048bd0c63d3bd54d35e8b5743d226">icSigLabPcsData</a>:</div>
<div class="line"><span class="lineno"> 2238</span>            pushBiRef2Xyz(pFromXform-&gt;m_pProfile, pFromXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2239</span>            <span class="keywordflow">if</span> ((stat=pushXYZConvert(pFromXform, pToXform))!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 2240</span>              <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 2241</span>            }</div>
<div class="line"><span class="lineno"> 2242</span>            <span class="keywordflow">if</span> (pToXform-&gt;NeedAdjustSrcPCS()) {</div>
<div class="line"><span class="lineno"> 2243</span>              pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</div>
<div class="line"><span class="lineno"> 2244</span>                            pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</div>
<div class="line"><span class="lineno"> 2245</span>                            pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2246</span>              pushScale3(pToXform-&gt;m_PCSScale[0], pToXform-&gt;m_PCSScale[1], pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2247</span>            }</div>
<div class="line"><span class="lineno"> 2248</span>            <span class="keywordflow">if</span> (pToXform-&gt;UseLegacyPCS())</div>
<div class="line"><span class="lineno"> 2249</span>              pushXyzToLab2(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2250</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2251</span>              pushXyzToLab(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2252</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2253</span> </div>
<div class="line"><span class="lineno"> 2254</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a3cc88012894a42474b7609adbe314918">icSigXYZPcsData</a>:</div>
<div class="line"><span class="lineno"> 2255</span>            <span class="keywordflow">if</span> ((stat=pushBiRef2Xyz(pFromXform-&gt;m_pProfile, pFromXform-&gt;m_pConnectionConditions))!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 2256</span>              <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 2257</span>            }</div>
<div class="line"><span class="lineno"> 2258</span>            <span class="keywordflow">if</span> ((stat=pushXYZConvert(pFromXform, pToXform))!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 2259</span>              <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 2260</span>            }</div>
<div class="line"><span class="lineno"> 2261</span>            <span class="keywordflow">if</span> (pToXform-&gt;NeedAdjustSrcPCS()) {</div>
<div class="line"><span class="lineno"> 2262</span>              pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</div>
<div class="line"><span class="lineno"> 2263</span>                            pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</div>
<div class="line"><span class="lineno"> 2264</span>                            pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2265</span>              pushScale3(pToXform-&gt;m_PCSScale[0], pToXform-&gt;m_PCSScale[1], pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2266</span>            }</div>
<div class="line"><span class="lineno"> 2267</span>            pushXyzToXyzIn();</div>
<div class="line"><span class="lineno"> 2268</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2269</span> </div>
<div class="line"><span class="lineno"> 2270</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#aa9cd4477816537fbf648a155f6b78eda">icSigReflectanceSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2271</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#af5df74ebff3f8247e1c7c88844c1f140">icSigTransmissionSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2272</span>            <span class="keywordflow">if</span> ((stat=pushBiRef2Ref(pFromXform-&gt;m_pProfile, pFromXform-&gt;m_pConnectionConditions))!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 2273</span>              <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 2274</span>            }</div>
<div class="line"><span class="lineno"> 2275</span>            pushSpecToRange(pFromXform-&gt;m_pProfile-&gt;m_Header.spectralRange, </div>
<div class="line"><span class="lineno"> 2276</span>                            pToXform-&gt;m_pProfile-&gt;m_Header.spectralRange);</div>
<div class="line"><span class="lineno"> 2277</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2278</span> </div>
<div class="line"><span class="lineno"> 2279</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a163dee4d9a8a1568dded8480a166e852">icSigRadiantSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2280</span>            <span class="keywordflow">if</span> ((stat=pushBiRef2Rad(pFromXform-&gt;m_pProfile, pFromXform-&gt;m_pConnectionConditions))!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 2281</span>              <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 2282</span>            }</div>
<div class="line"><span class="lineno"> 2283</span>            pushSpecToRange(pFromXform-&gt;m_pProfile-&gt;m_Header.spectralRange, </div>
<div class="line"><span class="lineno"> 2284</span>                            pToXform-&gt;m_pProfile-&gt;m_Header.spectralRange);</div>
<div class="line"><span class="lineno"> 2285</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2286</span> </div>
<div class="line"><span class="lineno"> 2287</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#ae84d222edd132ad7741c628c1d4729d9">icSigBiDirReflectanceSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2288</span>            <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d7/dce/a00143.html#aaa32c9864a601c0a28143886cadb344d">icSameSpectralRange</a>(pFromXform-&gt;m_pProfile-&gt;m_Header.spectralRange, pToXform-&gt;m_pProfile-&gt;m_Header.spectralRange) &amp;&amp;</div>
<div class="line"><span class="lineno"> 2289</span>                <a class="code hl_function" href="../../d7/dce/a00143.html#aaa32c9864a601c0a28143886cadb344d">icSameSpectralRange</a>(pFromXform-&gt;m_pProfile-&gt;m_Header.biSpectralRange, pToXform-&gt;m_pProfile-&gt;m_Header.biSpectralRange))</div>
<div class="line"><span class="lineno"> 2290</span>                <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2291</span>            <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2292</span>              <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281">icCmmStatUnsupportedPcsLink</a>;</div>
<div class="line"><span class="lineno"> 2293</span>          </div>
<div class="line"><span class="lineno"> 2294</span>          <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a1b59192d9fcc1aee71b8cc523b4978ca">icSigSparseMatrixSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 2295</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281">icCmmStatUnsupportedPcsLink</a>;</div>
<div class="line"><span class="lineno"> 2296</span>        }</div>
<div class="line"><span class="lineno"> 2297</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2298</span>    }</div>
<div class="line"><span class="lineno"> 2299</span>  }</div>
<div class="line"><span class="lineno"> 2300</span> </div>
<div class="line"><span class="lineno"> 2301</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv = Optimize();</div>
<div class="line"><span class="lineno"> 2302</span>  <span class="keywordflow">if</span> (rv!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno"> 2303</span>    <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 2304</span> </div>
<div class="line"><span class="lineno"> 2305</span>  <span class="keywordflow">if</span> (m_list-&gt;begin()==m_list-&gt;end())</div>
<div class="line"><span class="lineno"> 2306</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10">icCmmStatIdentityXform</a>;</div>
<div class="line"><span class="lineno"> 2307</span> </div>
<div class="line"><span class="lineno"> 2308</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 2309</span>}</div>
<div class="line"><span class="lineno"> 2310</span> </div>
<div class="line"><span class="lineno"> 2311</span> </div>
<div class="line"><span class="lineno"> 2321</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccPcsXform::ConnectFirst(CIccXform* pToXform, <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> srcSpace)</div>
<div class="line"><span class="lineno"> 2322</span>{</div>
<div class="line"><span class="lineno"> 2323</span>  <span class="keywordflow">if</span> (!pToXform)</div>
<div class="line"><span class="lineno"> 2324</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno"> 2325</span> </div>
<div class="line"><span class="lineno"> 2326</span> </div>
<div class="line"><span class="lineno"> 2327</span>  <span class="keywordflow">if</span> (srcSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>) {</div>
<div class="line"><span class="lineno"> 2328</span>    pushXyzInToXyz();</div>
<div class="line"><span class="lineno"> 2329</span>    <span class="keywordflow">if</span> (pToXform-&gt;NeedAdjustSrcPCS()) {</div>
<div class="line"><span class="lineno"> 2330</span>      pushScale3(pToXform-&gt;m_PCSScale[0], pToXform-&gt;m_PCSScale[1], pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2331</span>      pushOffset3(pToXform-&gt;m_PCSOffset[0], pToXform-&gt;m_PCSOffset[1], pToXform-&gt;m_PCSOffset[2]);</div>
<div class="line"><span class="lineno"> 2332</span>    }</div>
<div class="line"><span class="lineno"> 2333</span> </div>
<div class="line"><span class="lineno"> 2334</span>    <span class="keywordflow">if</span> (pToXform-&gt;GetSrcSpace() == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>) {</div>
<div class="line"><span class="lineno"> 2335</span>      <span class="keywordflow">if</span> (pToXform-&gt;UseLegacyPCS())</div>
<div class="line"><span class="lineno"> 2336</span>        pushXyzToLab2(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2337</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2338</span>        pushXyzToLab(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2339</span>    }</div>
<div class="line"><span class="lineno"> 2340</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2341</span>      pushXyzToXyzIn();</div>
<div class="line"><span class="lineno"> 2342</span>    }</div>
<div class="line"><span class="lineno"> 2343</span>  }</div>
<div class="line"><span class="lineno"> 2344</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (srcSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>) {</div>
<div class="line"><span class="lineno"> 2345</span> </div>
<div class="line"><span class="lineno"> 2346</span>    <span class="keywordflow">if</span> (pToXform-&gt;GetSrcSpace() == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>) {</div>
<div class="line"><span class="lineno"> 2347</span>      pushLabToXyz(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2348</span>      <span class="keywordflow">if</span> (pToXform-&gt;NeedAdjustSrcPCS()) {</div>
<div class="line"><span class="lineno"> 2349</span>        pushScale3(pToXform-&gt;m_PCSScale[0], pToXform-&gt;m_PCSScale[1], pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2350</span>        pushOffset3(pToXform-&gt;m_PCSOffset[0], pToXform-&gt;m_PCSOffset[1], pToXform-&gt;m_PCSOffset[2]);</div>
<div class="line"><span class="lineno"> 2351</span>      }</div>
<div class="line"><span class="lineno"> 2352</span>    }</div>
<div class="line"><span class="lineno"> 2353</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pToXform-&gt;NeedAdjustSrcPCS()) {</div>
<div class="line"><span class="lineno"> 2354</span>      pushLabToXyz(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2355</span>      pushScale3(pToXform-&gt;m_PCSScale[0], pToXform-&gt;m_PCSScale[1], pToXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2356</span>      pushOffset3(pToXform-&gt;m_PCSOffset[0], pToXform-&gt;m_PCSOffset[1], pToXform-&gt;m_PCSOffset[2]);</div>
<div class="line"><span class="lineno"> 2357</span>      <span class="keywordflow">if</span> (pToXform-&gt;UseLegacyPCS())</div>
<div class="line"><span class="lineno"> 2358</span>        pushXyzToLab2(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2359</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2360</span>        pushXyzToLab(pToXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2361</span>    }</div>
<div class="line"><span class="lineno"> 2362</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pToXform-&gt;UseLegacyPCS() &amp;&amp; !pToXform-&gt;IsInput()) {</div>
<div class="line"><span class="lineno"> 2363</span>      pushLabToLab2();</div>
<div class="line"><span class="lineno"> 2364</span>    }</div>
<div class="line"><span class="lineno"> 2365</span> </div>
<div class="line"><span class="lineno"> 2366</span>  }</div>
<div class="line"><span class="lineno"> 2367</span> </div>
<div class="line"><span class="lineno"> 2368</span> </div>
<div class="line"><span class="lineno"> 2369</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv = Optimize();</div>
<div class="line"><span class="lineno"> 2370</span>  <span class="keywordflow">if</span> (rv != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno"> 2371</span>    <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 2372</span> </div>
<div class="line"><span class="lineno"> 2373</span>  <span class="keywordflow">if</span> (m_list-&gt;begin() == m_list-&gt;end())</div>
<div class="line"><span class="lineno"> 2374</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10">icCmmStatIdentityXform</a>;</div>
<div class="line"><span class="lineno"> 2375</span> </div>
<div class="line"><span class="lineno"> 2376</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 2377</span>}</div>
<div class="line"><span class="lineno"> 2378</span> </div>
<div class="line"><span class="lineno"> 2379</span> </div>
<div class="line"><span class="lineno"> 2389</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccPcsXform::ConnectLast(CIccXform* pFromXform, <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> dstSpace)</div>
<div class="line"><span class="lineno"> 2390</span>{</div>
<div class="line"><span class="lineno"> 2391</span>  <span class="keywordflow">if</span> (!pFromXform)</div>
<div class="line"><span class="lineno"> 2392</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno"> 2393</span>  <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> srcSpace = pFromXform-&gt;GetDstSpace();</div>
<div class="line"><span class="lineno"> 2394</span> </div>
<div class="line"><span class="lineno"> 2395</span>  <span class="keywordflow">if</span> (pFromXform-&gt;NeedAdjustDstPCS() &amp;&amp; <a class="code hl_define" href="../../d3/df8/a00155.html#aaacd6d45813e2697ad238b12befa5719">IsSpaceColorimetricPCS</a>(dstSpace)) {</div>
<div class="line"><span class="lineno"> 2396</span>    <span class="keywordflow">if</span> (srcSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>) {</div>
<div class="line"><span class="lineno"> 2397</span>      <span class="keywordflow">if</span> (pFromXform-&gt;UseLegacyPCS())</div>
<div class="line"><span class="lineno"> 2398</span>        pushLab2ToXyz(pFromXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2399</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2400</span>        pushLabToXyz(pFromXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2401</span>    }</div>
<div class="line"><span class="lineno"> 2402</span> </div>
<div class="line"><span class="lineno"> 2403</span>    pushScale3(pFromXform-&gt;m_PCSScale[0], pFromXform-&gt;m_PCSScale[1], pFromXform-&gt;m_PCSScale[2]);</div>
<div class="line"><span class="lineno"> 2404</span>    pushOffset3(pFromXform-&gt;m_PCSOffset[0], pFromXform-&gt;m_PCSOffset[1], pFromXform-&gt;m_PCSOffset[2]);</div>
<div class="line"><span class="lineno"> 2405</span> </div>
<div class="line"><span class="lineno"> 2406</span>    pushXyzToXyzIn();</div>
<div class="line"><span class="lineno"> 2407</span> </div>
<div class="line"><span class="lineno"> 2408</span>    srcSpace = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>;</div>
<div class="line"><span class="lineno"> 2409</span>  }</div>
<div class="line"><span class="lineno"> 2410</span> </div>
<div class="line"><span class="lineno"> 2411</span>  <span class="keywordflow">if</span> (srcSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a> &amp;&amp; dstSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>) {</div>
<div class="line"><span class="lineno"> 2412</span>    pushXyzInToXyz();</div>
<div class="line"><span class="lineno"> 2413</span>    pushXyzToLab(pFromXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2414</span>  }</div>
<div class="line"><span class="lineno"> 2415</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (srcSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a> &amp;&amp; dstSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>) {</div>
<div class="line"><span class="lineno"> 2416</span>    <span class="keywordflow">if</span> (pFromXform-&gt;UseLegacyPCS())</div>
<div class="line"><span class="lineno"> 2417</span>      pushLab2ToXyz(pFromXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2418</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2419</span>      pushLabToXyz(pFromXform-&gt;m_pConnectionConditions);</div>
<div class="line"><span class="lineno"> 2420</span>    <span class="keywordflow">if</span> (pFromXform-&gt;IsInput())</div>
<div class="line"><span class="lineno"> 2421</span>      pushXyzToXyzIn();</div>
<div class="line"><span class="lineno"> 2422</span>  }</div>
<div class="line"><span class="lineno"> 2423</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pFromXform-&gt;UseLegacyPCS() &amp;&amp; pFromXform-&gt;IsInput() &amp;&amp; srcSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a> &amp;&amp; dstSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>) {</div>
<div class="line"><span class="lineno"> 2424</span>    pushLab2ToLab();</div>
<div class="line"><span class="lineno"> 2425</span>  }</div>
<div class="line"><span class="lineno"> 2426</span> </div>
<div class="line"><span class="lineno"> 2427</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv = Optimize();</div>
<div class="line"><span class="lineno"> 2428</span>  <span class="keywordflow">if</span> (rv != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno"> 2429</span>    <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 2430</span> </div>
<div class="line"><span class="lineno"> 2431</span>  <span class="keywordflow">if</span> (m_list-&gt;begin() == m_list-&gt;end())</div>
<div class="line"><span class="lineno"> 2432</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10">icCmmStatIdentityXform</a>;</div>
<div class="line"><span class="lineno"> 2433</span> </div>
<div class="line"><span class="lineno"> 2434</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 2435</span>}</div>
<div class="line"><span class="lineno"> 2436</span> </div>
<div class="line"><span class="lineno"> 2437</span> </div>
<div class="line"><span class="lineno"> 2446</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccPcsXform::Optimize()</div>
<div class="line"><span class="lineno"> 2447</span>{</div>
<div class="line"><span class="lineno"> 2448</span>  <span class="keywordflow">if</span> (!m_list)</div>
<div class="line"><span class="lineno"> 2449</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno"> 2450</span> </div>
<div class="line"><span class="lineno"> 2451</span>  CIccPcsStepList steps = *m_list;</div>
<div class="line"><span class="lineno"> 2452</span>  CIccPcsStepList::iterator next, last;</div>
<div class="line"><span class="lineno"> 2453</span>  <span class="keywordtype">bool</span> done=<span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2454</span> </div>
<div class="line"><span class="lineno"> 2455</span><span class="preprocessor">#if 0</span></div>
<div class="line"><span class="lineno"> 2456</span>  std::string str;</div>
<div class="line"><span class="lineno"> 2457</span>  <span class="keywordflow">for</span> (next = steps.begin(); next != steps.end(); next++) {</div>
<div class="line"><span class="lineno"> 2458</span>    next-&gt;ptr-&gt;dump(str);</div>
<div class="line"><span class="lineno"> 2459</span>  }</div>
<div class="line"><span class="lineno"> 2460</span>  printf(<span class="stringliteral">&quot;PCS_Steps:\n%s&quot;</span>, str.c_str());</div>
<div class="line"><span class="lineno"> 2461</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2462</span> </div>
<div class="line"><span class="lineno"> 2463</span>  <span class="keywordflow">while</span> (!done) {</div>
<div class="line"><span class="lineno"> 2464</span>    CIccPcsStepList newSteps;</div>
<div class="line"><span class="lineno"> 2465</span>    CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 2466</span> </div>
<div class="line"><span class="lineno"> 2467</span>    done = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2468</span> </div>
<div class="line"><span class="lineno"> 2469</span>    next = steps.begin();</div>
<div class="line"><span class="lineno"> 2470</span>    <span class="keywordflow">if</span> (next==steps.end()) {</div>
<div class="line"><span class="lineno"> 2471</span>      *m_list = steps;</div>
<div class="line"><span class="lineno"> 2472</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10">icCmmStatIdentityXform</a>;</div>
<div class="line"><span class="lineno"> 2473</span>    }</div>
<div class="line"><span class="lineno"> 2474</span>    last = next;</div>
<div class="line"><span class="lineno"> 2475</span>    next++;</div>
<div class="line"><span class="lineno"> 2476</span> </div>
<div class="line"><span class="lineno"> 2477</span>    ptr.ptr = last-&gt;ptr;</div>
<div class="line"><span class="lineno"> 2478</span> </div>
<div class="line"><span class="lineno"> 2479</span>    <span class="keywordflow">for</span> (;next!=steps.end(); next++) {</div>
<div class="line"><span class="lineno"> 2480</span>      CIccPcsStep *pStep = ptr.ptr-&gt;concat(next-&gt;ptr);</div>
<div class="line"><span class="lineno"> 2481</span> </div>
<div class="line"><span class="lineno"> 2482</span>      <span class="keywordflow">if</span> (pStep) {</div>
<div class="line"><span class="lineno"> 2483</span>        done = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2484</span> </div>
<div class="line"><span class="lineno"> 2485</span>        <span class="keyword">delete</span> ptr.ptr;</div>
<div class="line"><span class="lineno"> 2486</span>        <span class="keyword">delete</span> next-&gt;ptr;</div>
<div class="line"><span class="lineno"> 2487</span>        ptr.ptr = pStep;</div>
<div class="line"><span class="lineno"> 2488</span>      }</div>
<div class="line"><span class="lineno"> 2489</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2490</span>        <span class="keywordflow">if</span> (!ptr.ptr-&gt;isIdentity()) {</div>
<div class="line"><span class="lineno"> 2491</span>          newSteps.push_back(ptr);</div>
<div class="line"><span class="lineno"> 2492</span>        }</div>
<div class="line"><span class="lineno"> 2493</span>        ptr.ptr = next-&gt;ptr;</div>
<div class="line"><span class="lineno"> 2494</span>      }</div>
<div class="line"><span class="lineno"> 2495</span>    }</div>
<div class="line"><span class="lineno"> 2496</span>    <span class="keywordflow">if</span> (!ptr.ptr-&gt;isIdentity()) {</div>
<div class="line"><span class="lineno"> 2497</span>      newSteps.push_back(ptr);</div>
<div class="line"><span class="lineno"> 2498</span>    }</div>
<div class="line"><span class="lineno"> 2499</span> </div>
<div class="line"><span class="lineno"> 2500</span>    steps = newSteps;</div>
<div class="line"><span class="lineno"> 2501</span> </div>
<div class="line"><span class="lineno"> 2502</span><span class="comment">//     for (next=steps.begin(); next!=steps.end(); next++) {</span></div>
<div class="line"><span class="lineno"> 2503</span><span class="comment">//       ptr.ptr = next-&gt;ptr;</span></div>
<div class="line"><span class="lineno"> 2504</span><span class="comment">//       done = true;</span></div>
<div class="line"><span class="lineno"> 2505</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno"> 2506</span> </div>
<div class="line"><span class="lineno"> 2507</span>  }</div>
<div class="line"><span class="lineno"> 2508</span> </div>
<div class="line"><span class="lineno"> 2509</span>  <span class="keywordflow">if</span> (!steps.empty()) {</div>
<div class="line"><span class="lineno"> 2510</span>    CIccPcsStepList newSteps;</div>
<div class="line"><span class="lineno"> 2511</span>    CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 2512</span> </div>
<div class="line"><span class="lineno"> 2513</span>    <span class="keywordflow">for</span> (next=steps.begin(); next != steps.end(); next++) {</div>
<div class="line"><span class="lineno"> 2514</span>      ptr.ptr = next-&gt;ptr-&gt;reduce();</div>
<div class="line"><span class="lineno"> 2515</span>      <span class="keywordflow">if</span> (ptr.ptr != next-&gt;ptr)</div>
<div class="line"><span class="lineno"> 2516</span>        <span class="keyword">delete</span> next-&gt;ptr;</div>
<div class="line"><span class="lineno"> 2517</span>      newSteps.push_back(ptr);</div>
<div class="line"><span class="lineno"> 2518</span>    }</div>
<div class="line"><span class="lineno"> 2519</span>    steps = newSteps;</div>
<div class="line"><span class="lineno"> 2520</span>  }</div>
<div class="line"><span class="lineno"> 2521</span> </div>
<div class="line"><span class="lineno"> 2522</span>  *m_list = steps;</div>
<div class="line"><span class="lineno"> 2523</span> </div>
<div class="line"><span class="lineno"> 2524</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 2525</span>}</div>
<div class="line"><span class="lineno"> 2526</span> </div>
<div class="line"><span class="lineno"> 2527</span> </div>
<div class="line"><span class="lineno"> 2537</span>CIccApplyXform *CIccPcsXform::GetNewApply(<a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> &amp;status)</div>
<div class="line"><span class="lineno"> 2538</span>{</div>
<div class="line"><span class="lineno"> 2539</span>  CIccApplyPcsXform *pNew = <span class="keyword">new</span> CIccApplyPcsXform(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 2540</span> </div>
<div class="line"><span class="lineno"> 2541</span>  <span class="keywordflow">if</span> (pNew) {</div>
<div class="line"><span class="lineno"> 2542</span>    <span class="keywordflow">if</span> (!pNew-&gt;Init()) {</div>
<div class="line"><span class="lineno"> 2543</span>      <span class="keyword">delete</span> pNew;</div>
<div class="line"><span class="lineno"> 2544</span>      status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 2545</span>      <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 2546</span>    }</div>
<div class="line"><span class="lineno"> 2547</span>  }</div>
<div class="line"><span class="lineno"> 2548</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2549</span>    status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 2550</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 2551</span>  }</div>
<div class="line"><span class="lineno"> 2552</span> </div>
<div class="line"><span class="lineno"> 2553</span>  CIccPcsStepList::iterator i;</div>
<div class="line"><span class="lineno"> 2554</span>  CIccApplyPcsStep *pStep;</div>
<div class="line"><span class="lineno"> 2555</span> </div>
<div class="line"><span class="lineno"> 2556</span>  <span class="keywordflow">for</span> (i=m_list-&gt;begin(); i!=m_list-&gt;end(); i++) {</div>
<div class="line"><span class="lineno"> 2557</span>    pStep = i-&gt;ptr-&gt;GetNewApply();</div>
<div class="line"><span class="lineno"> 2558</span>    <span class="keywordflow">if</span> (!pStep || status != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 2559</span>      <span class="keyword">delete</span> pNew;</div>
<div class="line"><span class="lineno"> 2560</span>      <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 2561</span>    }</div>
<div class="line"><span class="lineno"> 2562</span>    pNew-&gt;AppendApplyStep(pStep);</div>
<div class="line"><span class="lineno"> 2563</span>  }</div>
<div class="line"><span class="lineno"> 2564</span> </div>
<div class="line"><span class="lineno"> 2565</span>  <span class="keywordflow">return</span> pNew;</div>
<div class="line"><span class="lineno"> 2566</span>}</div>
<div class="line"><span class="lineno"> 2567</span> </div>
<div class="line"><span class="lineno"> 2568</span> </div>
<div class="line"><span class="lineno"> 2577</span><a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> CIccPcsXform::MaxChannels()</div>
<div class="line"><span class="lineno"> 2578</span>{</div>
<div class="line"><span class="lineno"> 2579</span>  <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nMax = 0;</div>
<div class="line"><span class="lineno"> 2580</span>  CIccPcsStepList::const_iterator s = m_list-&gt;begin();</div>
<div class="line"><span class="lineno"> 2581</span>  <span class="keywordflow">if</span> (s==m_list-&gt;end())</div>
<div class="line"><span class="lineno"> 2582</span>    <span class="keywordflow">return</span> nMax;</div>
<div class="line"><span class="lineno"> 2583</span>  nMax = s-&gt;ptr-&gt;GetDstChannels();</div>
<div class="line"><span class="lineno"> 2584</span>  s++;</div>
<div class="line"><span class="lineno"> 2585</span>  <span class="keywordflow">for</span> (; s!= m_list-&gt;end(); s++) {</div>
<div class="line"><span class="lineno"> 2586</span>    <span class="keywordflow">if</span> (s-&gt;ptr-&gt;GetSrcChannels()&gt;nMax)</div>
<div class="line"><span class="lineno"> 2587</span>      nMax = s-&gt;ptr-&gt;GetSrcChannels();</div>
<div class="line"><span class="lineno"> 2588</span>  }</div>
<div class="line"><span class="lineno"> 2589</span>  <span class="keywordflow">return</span> nMax;</div>
<div class="line"><span class="lineno"> 2590</span>}</div>
<div class="line"><span class="lineno"> 2591</span> </div>
<div class="line"><span class="lineno"> 2600</span><span class="keywordtype">void</span> CIccPcsXform::pushRouteMcs(<a class="code hl_class" href="../../db/de0/a00465.html">CIccTagArray</a> *pSrcChannels, <a class="code hl_class" href="../../db/de0/a00465.html">CIccTagArray</a> *pDstChannels, <a class="code hl_class" href="../../d0/daa/a01029.html">CIccTagNumArray</a> *pDefaults)</div>
<div class="line"><span class="lineno"> 2601</span>{</div>
<div class="line"><span class="lineno"> 2602</span>  CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 2603</span> </div>
<div class="line"><span class="lineno"> 2604</span>  ptr.ptr = <span class="keyword">new</span> CIccPcsStepRouteMcs(pSrcChannels, pDstChannels, pDefaults);</div>
<div class="line"><span class="lineno"> 2605</span>  m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 2606</span>}</div>
<div class="line"><span class="lineno"> 2607</span> </div>
<div class="line"><span class="lineno"> 2608</span> </div>
<div class="line"><span class="lineno"> 2617</span><span class="keywordtype">void</span> CIccPcsXform::pushLab2ToLab()</div>
<div class="line"><span class="lineno"> 2618</span>{</div>
<div class="line"><span class="lineno"> 2619</span>  CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 2620</span> </div>
<div class="line"><span class="lineno"> 2621</span>  ptr.ptr = <span class="keyword">new</span> CIccPcsStepLab2ToLab();</div>
<div class="line"><span class="lineno"> 2622</span>  m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 2623</span>}</div>
<div class="line"><span class="lineno"> 2624</span> </div>
<div class="line"><span class="lineno"> 2625</span> </div>
<div class="line"><span class="lineno"> 2634</span><span class="keywordtype">void</span> CIccPcsXform::pushLabToLab2()</div>
<div class="line"><span class="lineno"> 2635</span>{</div>
<div class="line"><span class="lineno"> 2636</span>  CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 2637</span> </div>
<div class="line"><span class="lineno"> 2638</span>  ptr.ptr = <span class="keyword">new</span> CIccPcsStepLabToLab2();</div>
<div class="line"><span class="lineno"> 2639</span>  m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 2640</span>}</div>
<div class="line"><span class="lineno"> 2641</span> </div>
<div class="line"><span class="lineno"> 2642</span> </div>
<div class="line"><span class="lineno"> 2651</span><span class="keywordtype">void</span> CIccPcsXform::pushLab2ToXyz( <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPCC)</div>
<div class="line"><span class="lineno"> 2652</span>{</div>
<div class="line"><span class="lineno"> 2653</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> xyzWhite[3];</div>
<div class="line"><span class="lineno"> 2654</span>  pPCC-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a9c5c38685ec6a82b97608f5571e303f2">getNormIlluminantXYZ</a>(xyzWhite);</div>
<div class="line"><span class="lineno"> 2655</span> </div>
<div class="line"><span class="lineno"> 2656</span>  CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 2657</span> </div>
<div class="line"><span class="lineno"> 2658</span>  ptr.ptr = <span class="keyword">new</span> CIccPcsStepLab2ToXYZ(xyzWhite);</div>
<div class="line"><span class="lineno"> 2659</span>  m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 2660</span>}</div>
<div class="line"><span class="lineno"> 2661</span> </div>
<div class="line"><span class="lineno"> 2662</span> </div>
<div class="line"><span class="lineno"> 2671</span><span class="keywordtype">void</span> CIccPcsXform::pushXyzToLab2(<a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPCC)</div>
<div class="line"><span class="lineno"> 2672</span>{</div>
<div class="line"><span class="lineno"> 2673</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> xyzWhite[3];</div>
<div class="line"><span class="lineno"> 2674</span>  pPCC-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a9c5c38685ec6a82b97608f5571e303f2">getNormIlluminantXYZ</a>(xyzWhite);</div>
<div class="line"><span class="lineno"> 2675</span> </div>
<div class="line"><span class="lineno"> 2676</span>  CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 2677</span> </div>
<div class="line"><span class="lineno"> 2678</span>  ptr.ptr = <span class="keyword">new</span> CIccPcsStepXYZToLab2(xyzWhite);</div>
<div class="line"><span class="lineno"> 2679</span>  m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 2680</span>}</div>
<div class="line"><span class="lineno"> 2681</span> </div>
<div class="line"><span class="lineno"> 2682</span> </div>
<div class="line"><span class="lineno"> 2691</span><span class="keywordtype">void</span> CIccPcsXform::pushLabToXyz(<a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPCC)</div>
<div class="line"><span class="lineno"> 2692</span>{</div>
<div class="line"><span class="lineno"> 2693</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> xyzWhite[3];</div>
<div class="line"><span class="lineno"> 2694</span>  pPCC-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a9c5c38685ec6a82b97608f5571e303f2">getNormIlluminantXYZ</a>(xyzWhite);</div>
<div class="line"><span class="lineno"> 2695</span> </div>
<div class="line"><span class="lineno"> 2696</span>  CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 2697</span> </div>
<div class="line"><span class="lineno"> 2698</span>  ptr.ptr = <span class="keyword">new</span> CIccPcsStepLabToXYZ(xyzWhite);</div>
<div class="line"><span class="lineno"> 2699</span>  m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 2700</span>}</div>
<div class="line"><span class="lineno"> 2701</span> </div>
<div class="line"><span class="lineno"> 2702</span> </div>
<div class="line"><span class="lineno"> 2711</span><span class="keywordtype">void</span> CIccPcsXform::pushXyzToLab( <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPCC)</div>
<div class="line"><span class="lineno"> 2712</span>{</div>
<div class="line"><span class="lineno"> 2713</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> xyzWhite[3];</div>
<div class="line"><span class="lineno"> 2714</span>  pPCC-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a9c5c38685ec6a82b97608f5571e303f2">getNormIlluminantXYZ</a>(xyzWhite);</div>
<div class="line"><span class="lineno"> 2715</span> </div>
<div class="line"><span class="lineno"> 2716</span>  CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 2717</span> </div>
<div class="line"><span class="lineno"> 2718</span>  ptr.ptr = <span class="keyword">new</span> CIccPcsStepXYZToLab(xyzWhite);</div>
<div class="line"><span class="lineno"> 2719</span>  m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 2720</span>}</div>
<div class="line"><span class="lineno"> 2721</span> </div>
<div class="line"><span class="lineno"> 2731</span><span class="keywordtype">void</span> CIccPcsXform::pushScale3(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> v1, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> v2, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> v3)</div>
<div class="line"><span class="lineno"> 2732</span>{</div>
<div class="line"><span class="lineno"> 2733</span>  CIccPcsStepScale *scale;</div>
<div class="line"><span class="lineno"> 2734</span>  CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 2735</span> </div>
<div class="line"><span class="lineno"> 2736</span>  scale = <span class="keyword">new</span> CIccPcsStepScale(3);</div>
<div class="line"><span class="lineno"> 2737</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *data = scale-&gt;data();</div>
<div class="line"><span class="lineno"> 2738</span>  data[0] = v1;</div>
<div class="line"><span class="lineno"> 2739</span>  data[1] = v2;</div>
<div class="line"><span class="lineno"> 2740</span>  data[2] = v3;</div>
<div class="line"><span class="lineno"> 2741</span> </div>
<div class="line"><span class="lineno"> 2742</span>  ptr.ptr = scale;</div>
<div class="line"><span class="lineno"> 2743</span>  m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 2744</span>}</div>
<div class="line"><span class="lineno"> 2745</span> </div>
<div class="line"><span class="lineno"> 2754</span><span class="keywordtype">void</span> CIccPcsXform::pushXyzToXyzIn()</div>
<div class="line"><span class="lineno"> 2755</span>{</div>
<div class="line"><span class="lineno"> 2756</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> scale = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>) (32768.0 / 65535.0);</div>
<div class="line"><span class="lineno"> 2757</span>  pushScale3(scale, scale, scale);</div>
<div class="line"><span class="lineno"> 2758</span>}</div>
<div class="line"><span class="lineno"> 2759</span> </div>
<div class="line"><span class="lineno"> 2760</span> </div>
<div class="line"><span class="lineno"> 2769</span><span class="keywordtype">void</span> CIccPcsXform::pushXyzInToXyz()</div>
<div class="line"><span class="lineno"> 2770</span>{</div>
<div class="line"><span class="lineno"> 2771</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> scale = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>) (65535.0 / 32768.0);</div>
<div class="line"><span class="lineno"> 2772</span>  <span class="keywordflow">return</span> pushScale3(scale, scale, scale);</div>
<div class="line"><span class="lineno"> 2773</span>}</div>
<div class="line"><span class="lineno"> 2774</span> </div>
<div class="line"><span class="lineno"> 2775</span> </div>
<div class="line"><span class="lineno"> 2784</span><span class="keywordtype">void</span> CIccPcsXform::pushXyzToXyzLum(<a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPCC)</div>
<div class="line"><span class="lineno"> 2785</span>{</div>
<div class="line"><span class="lineno"> 2786</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> XYZLum[3];</div>
<div class="line"><span class="lineno"> 2787</span>  pPCC-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a6b7d53898284b4c85611c2443e14d70c">getLumIlluminantXYZ</a>(&amp;XYZLum[0]);</div>
<div class="line"><span class="lineno"> 2788</span> </div>
<div class="line"><span class="lineno"> 2789</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> scale = XYZLum[1];</div>
<div class="line"><span class="lineno"> 2790</span> </div>
<div class="line"><span class="lineno"> 2791</span>  <span class="keywordflow">return</span> pushScale3(scale, scale, scale);</div>
<div class="line"><span class="lineno"> 2792</span>}</div>
<div class="line"><span class="lineno"> 2793</span> </div>
<div class="line"><span class="lineno"> 2794</span> </div>
<div class="line"><span class="lineno"> 2803</span><span class="keywordtype">void</span> CIccPcsXform::pushXyzLumToXyz(<a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPCC)</div>
<div class="line"><span class="lineno"> 2804</span>{</div>
<div class="line"><span class="lineno"> 2805</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> XYZLum[3];</div>
<div class="line"><span class="lineno"> 2806</span>  pPCC-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a6b7d53898284b4c85611c2443e14d70c">getLumIlluminantXYZ</a>(&amp;XYZLum[0]);</div>
<div class="line"><span class="lineno"> 2807</span> </div>
<div class="line"><span class="lineno"> 2808</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> scale = 1.0f / XYZLum[1];</div>
<div class="line"><span class="lineno"> 2809</span> </div>
<div class="line"><span class="lineno"> 2810</span>  <span class="keywordflow">return</span> pushScale3(scale, scale, scale);</div>
<div class="line"><span class="lineno"> 2811</span>}</div>
<div class="line"><span class="lineno"> 2812</span> </div>
<div class="line"><span class="lineno"> 2813</span> </div>
<div class="line"><span class="lineno"> 2824</span><span class="keywordtype">void</span> CIccPcsXform::pushOffset3(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> v1, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> v2, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> v3, <span class="keywordtype">bool</span> bConvertIntXyzOffset<span class="comment">/*=true*/</span>)</div>
<div class="line"><span class="lineno"> 2825</span>{</div>
<div class="line"><span class="lineno"> 2826</span>  CIccPcsStepOffset *offset;</div>
<div class="line"><span class="lineno"> 2827</span>  CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 2828</span> </div>
<div class="line"><span class="lineno"> 2829</span>  offset = <span class="keyword">new</span> CIccPcsStepOffset(3);</div>
<div class="line"><span class="lineno"> 2830</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *data = offset-&gt;data();</div>
<div class="line"><span class="lineno"> 2831</span>  <span class="keywordflow">if</span> (bConvertIntXyzOffset) {</div>
<div class="line"><span class="lineno"> 2832</span>    data[0] = v1*65535.0f/32768.0f;</div>
<div class="line"><span class="lineno"> 2833</span>    data[1] = v2*65535.0f/32768.0f;</div>
<div class="line"><span class="lineno"> 2834</span>    data[2] = v3*65535.0f/32768.0f;</div>
<div class="line"><span class="lineno"> 2835</span>  }</div>
<div class="line"><span class="lineno"> 2836</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2837</span>    data[0] = v1;</div>
<div class="line"><span class="lineno"> 2838</span>    data[1] = v2;</div>
<div class="line"><span class="lineno"> 2839</span>    data[2] = v3;</div>
<div class="line"><span class="lineno"> 2840</span>  }</div>
<div class="line"><span class="lineno"> 2841</span> </div>
<div class="line"><span class="lineno"> 2842</span>  ptr.ptr = offset;</div>
<div class="line"><span class="lineno"> 2843</span>  m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 2844</span>}</div>
<div class="line"><span class="lineno"> 2845</span> </div>
<div class="line"><span class="lineno"> 2846</span> </div>
<div class="line"><span class="lineno"> 2856</span><span class="keywordtype">void</span> CIccPcsXform::pushScale(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> n, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *vals)</div>
<div class="line"><span class="lineno"> 2857</span>{</div>
<div class="line"><span class="lineno"> 2858</span>  CIccPcsStepScale *scale = <span class="keyword">new</span> CIccPcsStepScale(n);</div>
<div class="line"><span class="lineno"> 2859</span>  memcpy(scale-&gt;data(), vals, n*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 2860</span>  </div>
<div class="line"><span class="lineno"> 2861</span>  CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 2862</span>  ptr.ptr = scale;</div>
<div class="line"><span class="lineno"> 2863</span>  m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 2864</span>}</div>
<div class="line"><span class="lineno"> 2865</span> </div>
<div class="line"><span class="lineno"> 2866</span> </div>
<div class="line"><span class="lineno"> 2875</span><span class="keywordtype">void</span> CIccPcsXform::pushMatrix(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nRows, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nCols, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *vals)</div>
<div class="line"><span class="lineno"> 2876</span>{</div>
<div class="line"><span class="lineno"> 2877</span>  CIccPcsStepMatrix *mtx = <span class="keyword">new</span> CIccPcsStepMatrix(nRows, nCols);</div>
<div class="line"><span class="lineno"> 2878</span>  memcpy(mtx-&gt;entry(0), vals, nRows*nCols*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 2879</span> </div>
<div class="line"><span class="lineno"> 2880</span>  CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 2881</span>  ptr.ptr = mtx;</div>
<div class="line"><span class="lineno"> 2882</span>  m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 2883</span>}</div>
<div class="line"><span class="lineno"> 2884</span> </div>
<div class="line"><span class="lineno"> 2885</span> </div>
<div class="line"><span class="lineno"> 2896</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccPcsXform::pushXYZConvert(CIccXform *pFromXform, CIccXform *pToXform)</div>
<div class="line"><span class="lineno"> 2897</span>{</div>
<div class="line"><span class="lineno"> 2898</span>  <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pSrcPcc = pFromXform-&gt;GetConnectionConditions();</div>
<div class="line"><span class="lineno"> 2899</span>  <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pDstPcc = pToXform-&gt;GetConnectionConditions();</div>
<div class="line"><span class="lineno"> 2900</span> </div>
<div class="line"><span class="lineno"> 2901</span>  <span class="keywordflow">if</span> (!pSrcPcc || !pDstPcc)</div>
<div class="line"><span class="lineno"> 2902</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9d8efd1c91aa512d46f51cd30a7927f5">icCmmStatBadConnection</a>;</div>
<div class="line"><span class="lineno"> 2903</span> </div>
<div class="line"><span class="lineno"> 2904</span>  <span class="comment">//If source and dest observer and illuminant are same then no transform is needed</span></div>
<div class="line"><span class="lineno"> 2905</span>  <span class="keywordflow">if</span> (pSrcPcc-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a9ca9746d8f42338293e7570275af03d7">isEquivalentPcc</a>(*pDstPcc)) {</div>
<div class="line"><span class="lineno"> 2906</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 2907</span>  }</div>
<div class="line"><span class="lineno"> 2908</span> </div>
<div class="line"><span class="lineno"> 2909</span>  CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 2910</span> </div>
<div class="line"><span class="lineno"> 2911</span>  <span class="keywordflow">if</span> (!pSrcPcc-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a91dc6e895f5fcc5cd924bcdedd5ea0b5">isStandardPcc</a>()) {</div>
<div class="line"><span class="lineno"> 2912</span> </div>
<div class="line"><span class="lineno"> 2913</span>    <a class="code hl_class" href="../../d5/d54/a01213.html">CIccTagMultiProcessElement</a> *pMpe = pSrcPcc-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a6a535454f7d93b11bc5f6a83e9142331">getCustomToStandardPcc</a>();</div>
<div class="line"><span class="lineno"> 2914</span> </div>
<div class="line"><span class="lineno"> 2915</span>    <span class="keywordflow">if</span> (!pMpe || pMpe-&gt;<a class="code hl_function" href="../../d5/d54/a01213.html#a1492a516235fdb066359bb5362efc89a">NumInputChannels</a>()!=3 || pMpe-&gt;<a class="code hl_function" href="../../d5/d54/a01213.html#a425dfa52f0af074b588df02d283d63f9">NumOutputChannels</a>()!=3)</div>
<div class="line"><span class="lineno"> 2916</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 2917</span> </div>
<div class="line"><span class="lineno"> 2918</span>    ptr.ptr = NULL;</div>
<div class="line"><span class="lineno"> 2919</span> </div>
<div class="line"><span class="lineno"> 2920</span>    <span class="comment">//push single matrix element as a CIccPcsStepMatrix so it can be optimized</span></div>
<div class="line"><span class="lineno"> 2921</span>    <span class="keywordflow">if</span> (pMpe-&gt;<a class="code hl_function" href="../../d5/d54/a01213.html#a9074a090efc10dd2470ff45594e10a11">NumElements</a>()==1) {</div>
<div class="line"><span class="lineno"> 2922</span>      <a class="code hl_class" href="../../dd/d43/a01193.html">CIccMultiProcessElement</a> *pElem = pMpe-&gt;<a class="code hl_function" href="../../d5/d54/a01213.html#ad49db93f89c409fc5aa3bd646a00beac">GetElement</a>(0);</div>
<div class="line"><span class="lineno"> 2923</span>      <span class="keywordflow">if</span> (pElem) {</div>
<div class="line"><span class="lineno"> 2924</span>        <span class="keywordflow">if</span> (pElem-&gt;<a class="code hl_function" href="../../dd/d43/a01193.html#abc48ee629f3d2102bfdd5c03891b37e1">GetType</a>()==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a5dbecf663e56b6445a7f199306ee1b4da9f1d5e498c47af2a0e0be3fa029970fe">icSigMatrixElemType</a>) {</div>
<div class="line"><span class="lineno"> 2925</span>          <a class="code hl_class" href="../../d0/d82/a00857.html">CIccMpeMatrix</a> *pMatElem = (<a class="code hl_class" href="../../d0/d82/a00857.html">CIccMpeMatrix</a>*)pElem;</div>
<div class="line"><span class="lineno"> 2926</span> </div>
<div class="line"><span class="lineno"> 2927</span>          <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pMat = pMatElem-&gt;<a class="code hl_function" href="../../d0/d82/a00857.html#a8caea712089acbdd830b1fa29d10aa8c">GetMatrix</a>();</div>
<div class="line"><span class="lineno"> 2928</span>          <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pOffset = pMatElem-&gt;<a class="code hl_function" href="../../d0/d82/a00857.html#a02f8ec1722ad1f16f5ea3efa7b241f91">GetConstants</a>();</div>
<div class="line"><span class="lineno"> 2929</span> </div>
<div class="line"><span class="lineno"> 2930</span>          <span class="keywordflow">if</span> (pMat &amp;&amp; (!pOffset || (pOffset[0]==0.0 &amp;&amp; pOffset[1]==0.0 &amp;&amp; pOffset[2]==0.0))) {</div>
<div class="line"><span class="lineno"> 2931</span>            CIccPcsStepMatrix *pStepMtx = <span class="keyword">new</span> CIccPcsStepMatrix(3, 3);</div>
<div class="line"><span class="lineno"> 2932</span> </div>
<div class="line"><span class="lineno"> 2933</span>            <span class="keywordflow">if</span> (pStepMtx ) {</div>
<div class="line"><span class="lineno"> 2934</span>              memcpy(pStepMtx-&gt;entry(0,0), pMat, 9*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 2935</span>            }</div>
<div class="line"><span class="lineno"> 2936</span>            ptr.ptr = pStepMtx;</div>
<div class="line"><span class="lineno"> 2937</span>          }</div>
<div class="line"><span class="lineno"> 2938</span>        }</div>
<div class="line"><span class="lineno"> 2939</span>      }</div>
<div class="line"><span class="lineno"> 2940</span>    }</div>
<div class="line"><span class="lineno"> 2941</span> </div>
<div class="line"><span class="lineno"> 2942</span>    <span class="keywordflow">if</span> (!ptr.ptr) {</div>
<div class="line"><span class="lineno"> 2943</span>      CIccPcsStepMpe *pStepMpe = <span class="keyword">new</span> CIccPcsStepMpe((<a class="code hl_class" href="../../d5/d54/a01213.html">CIccTagMultiProcessElement</a>*)pMpe-&gt;<a class="code hl_function" href="../../d5/d54/a01213.html#a87956fe8fd516379d8a450d057f258fb">NewCopy</a>());</div>
<div class="line"><span class="lineno"> 2944</span> </div>
<div class="line"><span class="lineno"> 2945</span>      <span class="keywordflow">if</span> (!pStepMpe)</div>
<div class="line"><span class="lineno"> 2946</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 2947</span> </div>
<div class="line"><span class="lineno"> 2948</span>      <span class="keywordflow">if</span> (!pStepMpe-&gt;Begin()) {</div>
<div class="line"><span class="lineno"> 2949</span>        <span class="keyword">delete</span> pStepMpe;</div>
<div class="line"><span class="lineno"> 2950</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9d8efd1c91aa512d46f51cd30a7927f5">icCmmStatBadConnection</a>;</div>
<div class="line"><span class="lineno"> 2951</span>      }</div>
<div class="line"><span class="lineno"> 2952</span> </div>
<div class="line"><span class="lineno"> 2953</span>      ptr.ptr = pStepMpe;</div>
<div class="line"><span class="lineno"> 2954</span>    }</div>
<div class="line"><span class="lineno"> 2955</span> </div>
<div class="line"><span class="lineno"> 2956</span>    m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 2957</span>  }</div>
<div class="line"><span class="lineno"> 2958</span> </div>
<div class="line"><span class="lineno"> 2959</span>  <span class="keywordflow">if</span> (!pDstPcc-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a91dc6e895f5fcc5cd924bcdedd5ea0b5">isStandardPcc</a>()) {</div>
<div class="line"><span class="lineno"> 2960</span> </div>
<div class="line"><span class="lineno"> 2961</span>    <a class="code hl_class" href="../../d5/d54/a01213.html">CIccTagMultiProcessElement</a> *pMpe = pDstPcc-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a16094632a566d2945892046797fac4d9">getStandardToCustomPcc</a>();</div>
<div class="line"><span class="lineno"> 2962</span> </div>
<div class="line"><span class="lineno"> 2963</span>    <span class="keywordflow">if</span> (!pMpe || pMpe-&gt;<a class="code hl_function" href="../../d5/d54/a01213.html#a1492a516235fdb066359bb5362efc89a">NumInputChannels</a>()!=3 || pMpe-&gt;<a class="code hl_function" href="../../d5/d54/a01213.html#a425dfa52f0af074b588df02d283d63f9">NumOutputChannels</a>()!=3)</div>
<div class="line"><span class="lineno"> 2964</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 2965</span> </div>
<div class="line"><span class="lineno"> 2966</span>    ptr.ptr = NULL;</div>
<div class="line"><span class="lineno"> 2967</span> </div>
<div class="line"><span class="lineno"> 2968</span>    <span class="comment">//push single matrix element as a CIccPcsStepMatrix so it can be optimized</span></div>
<div class="line"><span class="lineno"> 2969</span>    <span class="keywordflow">if</span> (pMpe-&gt;<a class="code hl_function" href="../../d5/d54/a01213.html#a9074a090efc10dd2470ff45594e10a11">NumElements</a>()==1) {</div>
<div class="line"><span class="lineno"> 2970</span>      <a class="code hl_class" href="../../dd/d43/a01193.html">CIccMultiProcessElement</a> *pElem = pMpe-&gt;<a class="code hl_function" href="../../d5/d54/a01213.html#ad49db93f89c409fc5aa3bd646a00beac">GetElement</a>(0);</div>
<div class="line"><span class="lineno"> 2971</span>      <span class="keywordflow">if</span> (pElem) {</div>
<div class="line"><span class="lineno"> 2972</span>        <span class="keywordflow">if</span> (pElem-&gt;<a class="code hl_function" href="../../dd/d43/a01193.html#abc48ee629f3d2102bfdd5c03891b37e1">GetType</a>()==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a5dbecf663e56b6445a7f199306ee1b4da9f1d5e498c47af2a0e0be3fa029970fe">icSigMatrixElemType</a>) {</div>
<div class="line"><span class="lineno"> 2973</span>          <a class="code hl_class" href="../../d0/d82/a00857.html">CIccMpeMatrix</a> *pMatElem = (<a class="code hl_class" href="../../d0/d82/a00857.html">CIccMpeMatrix</a>*)pElem;</div>
<div class="line"><span class="lineno"> 2974</span> </div>
<div class="line"><span class="lineno"> 2975</span>          <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pMat = pMatElem-&gt;<a class="code hl_function" href="../../d0/d82/a00857.html#a8caea712089acbdd830b1fa29d10aa8c">GetMatrix</a>();</div>
<div class="line"><span class="lineno"> 2976</span>          <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pOffset = pMatElem-&gt;<a class="code hl_function" href="../../d0/d82/a00857.html#a02f8ec1722ad1f16f5ea3efa7b241f91">GetConstants</a>();</div>
<div class="line"><span class="lineno"> 2977</span> </div>
<div class="line"><span class="lineno"> 2978</span>          <span class="keywordflow">if</span> (pMat &amp;&amp; (!pOffset || (pOffset[0]==0.0 &amp;&amp; pOffset[1]==0.0 &amp;&amp; pOffset[2]==0.0))) {</div>
<div class="line"><span class="lineno"> 2979</span>            CIccPcsStepMatrix *pStepMtx = <span class="keyword">new</span> CIccPcsStepMatrix(3, 3);</div>
<div class="line"><span class="lineno"> 2980</span> </div>
<div class="line"><span class="lineno"> 2981</span>            <span class="keywordflow">if</span> (pStepMtx ) {</div>
<div class="line"><span class="lineno"> 2982</span>              memcpy(pStepMtx-&gt;entry(0,0), pMat, 9*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 2983</span>            }</div>
<div class="line"><span class="lineno"> 2984</span>            ptr.ptr = pStepMtx;</div>
<div class="line"><span class="lineno"> 2985</span>          }</div>
<div class="line"><span class="lineno"> 2986</span>        }</div>
<div class="line"><span class="lineno"> 2987</span>      }</div>
<div class="line"><span class="lineno"> 2988</span>    }</div>
<div class="line"><span class="lineno"> 2989</span> </div>
<div class="line"><span class="lineno"> 2990</span>    <span class="keywordflow">if</span> (!ptr.ptr) {</div>
<div class="line"><span class="lineno"> 2991</span>      CIccPcsStepMpe *pStepMpe = <span class="keyword">new</span> CIccPcsStepMpe((<a class="code hl_class" href="../../d5/d54/a01213.html">CIccTagMultiProcessElement</a>*)pMpe-&gt;<a class="code hl_function" href="../../d5/d54/a01213.html#a87956fe8fd516379d8a450d057f258fb">NewCopy</a>());</div>
<div class="line"><span class="lineno"> 2992</span> </div>
<div class="line"><span class="lineno"> 2993</span>      <span class="keywordflow">if</span> (!pStepMpe)</div>
<div class="line"><span class="lineno"> 2994</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 2995</span> </div>
<div class="line"><span class="lineno"> 2996</span>      <span class="keywordflow">if</span> (!pStepMpe-&gt;Begin()) {</div>
<div class="line"><span class="lineno"> 2997</span>        <span class="keyword">delete</span> pStepMpe;</div>
<div class="line"><span class="lineno"> 2998</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9d8efd1c91aa512d46f51cd30a7927f5">icCmmStatBadConnection</a>;</div>
<div class="line"><span class="lineno"> 2999</span>      }</div>
<div class="line"><span class="lineno"> 3000</span> </div>
<div class="line"><span class="lineno"> 3001</span>      ptr.ptr = pStepMpe;</div>
<div class="line"><span class="lineno"> 3002</span>    }</div>
<div class="line"><span class="lineno"> 3003</span> </div>
<div class="line"><span class="lineno"> 3004</span>    m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 3005</span>  }</div>
<div class="line"><span class="lineno"> 3006</span> </div>
<div class="line"><span class="lineno"> 3007</span>  <span class="keywordflow">if</span> (pFromXform-&gt;LuminanceMatching()) {</div>
<div class="line"><span class="lineno"> 3008</span>    pushXyzToXyzLum(pSrcPcc);</div>
<div class="line"><span class="lineno"> 3009</span>  }</div>
<div class="line"><span class="lineno"> 3010</span>  <span class="keywordflow">if</span> (pToXform-&gt;LuminanceMatching()) {</div>
<div class="line"><span class="lineno"> 3011</span>    pushXyzLumToXyz(pDstPcc);</div>
<div class="line"><span class="lineno"> 3012</span>  }</div>
<div class="line"><span class="lineno"> 3013</span>  </div>
<div class="line"><span class="lineno"> 3014</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 3015</span>}</div>
<div class="line"><span class="lineno"> 3016</span> </div>
<div class="line"><span class="lineno"> 3017</span><span class="keywordtype">void</span> CIccPcsXform::pushXYZNormalize(<a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc, <span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> &amp;srcRange, <span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> &amp;dstRange)</div>
<div class="line"><span class="lineno"> 3018</span>{</div>
<div class="line"><span class="lineno"> 3019</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d8/dbf/a01109.html">CIccTagSpectralViewingConditions</a> *pView = pPcc-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a41d44184a1e66e1f7bd46e60fc69fda6">getPccViewingConditions</a>();</div>
<div class="line"><span class="lineno"> 3020</span>  CIccPcsXform tmp;</div>
<div class="line"><span class="lineno"> 3021</span> </div>
<div class="line"><span class="lineno"> 3022</span>  <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> illuminantRange;</div>
<div class="line"><span class="lineno"> 3023</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *illuminant = pView-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#aa4fe6556022cceea44adf34848528245">getIlluminant</a>(illuminantRange);</div>
<div class="line"><span class="lineno"> 3024</span> </div>
<div class="line"><span class="lineno"> 3025</span>  <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> observerRange;</div>
<div class="line"><span class="lineno"> 3026</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *observer = pView-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#a2319ced95e40cb2493820227f54a302d">getObserver</a>(observerRange);</div>
<div class="line"><span class="lineno"> 3027</span> </div>
<div class="line"><span class="lineno"> 3028</span>  <span class="comment">//make sure illuminant goes through identical conversion steps</span></div>
<div class="line"><span class="lineno"> 3029</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d7/dce/a00143.html#aaa32c9864a601c0a28143886cadb344d">icSameSpectralRange</a>(srcRange, illuminantRange) || !<a class="code hl_function" href="../../d7/dce/a00143.html#aaa32c9864a601c0a28143886cadb344d">icSameSpectralRange</a>(dstRange, illuminantRange)) {</div>
<div class="line"><span class="lineno"> 3030</span>    tmp.pushSpecToRange(illuminantRange, srcRange);</div>
<div class="line"><span class="lineno"> 3031</span>    tmp.pushSpecToRange(srcRange, dstRange);</div>
<div class="line"><span class="lineno"> 3032</span>    tmp.pushSpecToRange(dstRange, observerRange);</div>
<div class="line"><span class="lineno"> 3033</span>  }</div>
<div class="line"><span class="lineno"> 3034</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3035</span>    tmp.pushSpecToRange(illuminantRange, observerRange);</div>
<div class="line"><span class="lineno"> 3036</span>  }</div>
<div class="line"><span class="lineno"> 3037</span>  tmp.pushMatrix(3, observerRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">steps</a>, observer);</div>
<div class="line"><span class="lineno"> 3038</span> </div>
<div class="line"><span class="lineno"> 3039</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> stat=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 3040</span>  CIccApplyXform *pApply = tmp.GetNewApply(stat);</div>
<div class="line"><span class="lineno"> 3041</span>  <span class="keywordflow">if</span> (pApply) {</div>
<div class="line"><span class="lineno"> 3042</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> xyz[3], normxyz[3], pccxyz[3];</div>
<div class="line"><span class="lineno"> 3043</span> </div>
<div class="line"><span class="lineno"> 3044</span>    <span class="comment">//Get absolute xyz for illuminant and observer</span></div>
<div class="line"><span class="lineno"> 3045</span>    tmp.Apply(pApply, xyz, illuminant);</div>
<div class="line"><span class="lineno"> 3046</span> </div>
<div class="line"><span class="lineno"> 3047</span>    <span class="comment">//calculate normalized XYZ</span></div>
<div class="line"><span class="lineno"> 3048</span>    normxyz[0] = xyz[0] / xyz[1];</div>
<div class="line"><span class="lineno"> 3049</span>    normxyz[1] = xyz[1] / xyz[1];</div>
<div class="line"><span class="lineno"> 3050</span>    normxyz[2] = xyz[2] / xyz[1];</div>
<div class="line"><span class="lineno"> 3051</span> </div>
<div class="line"><span class="lineno"> 3052</span>    <span class="comment">//get desired XYZ from pcc (might be slightly different from calculated normxyz)</span></div>
<div class="line"><span class="lineno"> 3053</span>    pPcc-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a9c5c38685ec6a82b97608f5571e303f2">getNormIlluminantXYZ</a>(pccxyz);</div>
<div class="line"><span class="lineno"> 3054</span> </div>
<div class="line"><span class="lineno"> 3055</span><span class="preprocessor">#if 1</span></div>
<div class="line"><span class="lineno"> 3056</span>    <span class="comment">//push scale factor to normalize XYZ values and correct for difference between calculated and desired XYZ</span></div>
<div class="line"><span class="lineno"> 3057</span>    pushScale3(pccxyz[0] / (normxyz[0] * xyz[1]), </div>
<div class="line"><span class="lineno"> 3058</span>               pccxyz[1] / (normxyz[1] * xyz[1]),</div>
<div class="line"><span class="lineno"> 3059</span>               pccxyz[2] / (normxyz[2] * xyz[1]));</div>
<div class="line"><span class="lineno"> 3060</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 3061</span>    pushScale3(1.0f/xyz[1], 1.0f/xyz[1], 1.0f/xyz[1]);</div>
<div class="line"><span class="lineno"> 3062</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3063</span> </div>
<div class="line"><span class="lineno"> 3064</span>    <span class="keyword">delete</span> pApply;</div>
<div class="line"><span class="lineno"> 3065</span>  }</div>
<div class="line"><span class="lineno"> 3066</span>}</div>
<div class="line"><span class="lineno"> 3067</span> </div>
<div class="line"><span class="lineno"> 3078</span><span class="keywordtype">void</span> CIccPcsXform::pushRef2Xyz(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile, <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc)</div>
<div class="line"><span class="lineno"> 3079</span>{</div>
<div class="line"><span class="lineno"> 3080</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d8/dbf/a01109.html">CIccTagSpectralViewingConditions</a> *pView = pPcc-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a41d44184a1e66e1f7bd46e60fc69fda6">getPccViewingConditions</a>();</div>
<div class="line"><span class="lineno"> 3081</span> </div>
<div class="line"><span class="lineno"> 3082</span>  <span class="keywordflow">if</span> (pView) {</div>
<div class="line"><span class="lineno"> 3083</span>    <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> illuminantRange;</div>
<div class="line"><span class="lineno"> 3084</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *illuminant = pView-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#aa4fe6556022cceea44adf34848528245">getIlluminant</a>(illuminantRange);</div>
<div class="line"><span class="lineno"> 3085</span> </div>
<div class="line"><span class="lineno"> 3086</span>    <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> observerRange;</div>
<div class="line"><span class="lineno"> 3087</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *observer = pView-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#a2319ced95e40cb2493820227f54a302d">getObserver</a>(observerRange);</div>
<div class="line"><span class="lineno"> 3088</span> </div>
<div class="line"><span class="lineno"> 3089</span>    pushSpecToRange(pProfile-&gt;m_Header.spectralRange, illuminantRange);</div>
<div class="line"><span class="lineno"> 3090</span>    pushScale(illuminantRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">steps</a>, illuminant);</div>
<div class="line"><span class="lineno"> 3091</span>    pushSpecToRange(illuminantRange, observerRange);</div>
<div class="line"><span class="lineno"> 3092</span>    pushMatrix(3, observerRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">steps</a>, observer);</div>
<div class="line"><span class="lineno"> 3093</span> </div>
<div class="line"><span class="lineno"> 3094</span>    pushXYZNormalize(pPcc, illuminantRange, illuminantRange);</div>
<div class="line"><span class="lineno"> 3095</span>  }</div>
<div class="line"><span class="lineno"> 3096</span>}</div>
<div class="line"><span class="lineno"> 3097</span> </div>
<div class="line"><span class="lineno"> 3098</span> </div>
<div class="line"><span class="lineno"> 3108</span>CIccPcsStepMatrix *CIccPcsXform::rangeMap(<span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> &amp;srcRange, <span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> &amp;dstRange)</div>
<div class="line"><span class="lineno"> 3109</span>{</div>
<div class="line"><span class="lineno"> 3110</span>  <span class="keywordflow">if</span> (srcRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">steps</a> != dstRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">steps</a> ||</div>
<div class="line"><span class="lineno"> 3111</span>      srcRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a65d0544793f49b86857f2d54f9897446">start</a> != dstRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a65d0544793f49b86857f2d54f9897446">start</a> ||</div>
<div class="line"><span class="lineno"> 3112</span>      srcRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a81f6d2d938687df976c13f1f3c8d4b09">end</a> != dstRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a81f6d2d938687df976c13f1f3c8d4b09">end</a>) {</div>
<div class="line"><span class="lineno"> 3113</span>    CIccPcsStepMatrix *mtx = <span class="keyword">new</span> CIccPcsStepMatrix(dstRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">steps</a>, srcRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">steps</a>);</div>
<div class="line"><span class="lineno"> 3114</span>    <span class="keywordflow">if</span> (!mtx-&gt;SetRange(srcRange, dstRange))</div>
<div class="line"><span class="lineno"> 3115</span>    {</div>
<div class="line"><span class="lineno"> 3116</span>      <span class="keyword">delete</span> mtx;</div>
<div class="line"><span class="lineno"> 3117</span>      <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 3118</span>    }</div>
<div class="line"><span class="lineno"> 3119</span>    <span class="keywordflow">return</span> mtx;</div>
<div class="line"><span class="lineno"> 3120</span>  }</div>
<div class="line"><span class="lineno"> 3121</span> </div>
<div class="line"><span class="lineno"> 3122</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 3123</span>}</div>
<div class="line"><span class="lineno"> 3124</span> </div>
<div class="line"><span class="lineno"> 3125</span> </div>
<div class="line"><span class="lineno"> 3135</span><span class="keywordtype">void</span> CIccPcsXform::pushSpecToRange(<span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> &amp;srcRange, <span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> &amp;dstRange)</div>
<div class="line"><span class="lineno"> 3136</span>{</div>
<div class="line"><span class="lineno"> 3137</span>  <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d7/dce/a00143.html#aaa32c9864a601c0a28143886cadb344d">icSameSpectralRange</a>(srcRange, dstRange)) {</div>
<div class="line"><span class="lineno"> 3138</span>    CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 3139</span>    ptr.ptr = rangeMap(srcRange, dstRange);</div>
<div class="line"><span class="lineno"> 3140</span> </div>
<div class="line"><span class="lineno"> 3141</span>    <span class="keywordflow">if</span> (ptr.ptr)</div>
<div class="line"><span class="lineno"> 3142</span>      m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 3143</span>  }</div>
<div class="line"><span class="lineno"> 3144</span>}</div>
<div class="line"><span class="lineno"> 3145</span> </div>
<div class="line"><span class="lineno"> 3146</span> </div>
<div class="line"><span class="lineno"> 3158</span><span class="keywordtype">void</span> CIccPcsXform::pushApplyIllum(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile, <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc)</div>
<div class="line"><span class="lineno"> 3159</span>{</div>
<div class="line"><span class="lineno"> 3160</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d8/dbf/a01109.html">CIccTagSpectralViewingConditions</a> *pView = pPcc-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a41d44184a1e66e1f7bd46e60fc69fda6">getPccViewingConditions</a>();</div>
<div class="line"><span class="lineno"> 3161</span> </div>
<div class="line"><span class="lineno"> 3162</span>  <span class="keywordflow">if</span> (pView) {</div>
<div class="line"><span class="lineno"> 3163</span>    CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 3164</span> </div>
<div class="line"><span class="lineno"> 3165</span>    <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> illuminantRange;</div>
<div class="line"><span class="lineno"> 3166</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *illuminant = pView-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#aa4fe6556022cceea44adf34848528245">getIlluminant</a>(illuminantRange);</div>
<div class="line"><span class="lineno"> 3167</span> </div>
<div class="line"><span class="lineno"> 3168</span>    CIccPcsStepScale *pScale = <span class="keyword">new</span> CIccPcsStepScale(illuminantRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">steps</a>);</div>
<div class="line"><span class="lineno"> 3169</span>    memcpy(pScale-&gt;data(), illuminant, illuminantRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">steps</a>*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 3170</span> </div>
<div class="line"><span class="lineno"> 3171</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d7/dce/a00143.html#aaa32c9864a601c0a28143886cadb344d">icSameSpectralRange</a>(pProfile-&gt;m_Header.spectralRange, illuminantRange)) {</div>
<div class="line"><span class="lineno"> 3172</span>      ptr.ptr = pScale;</div>
<div class="line"><span class="lineno"> 3173</span>      m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 3174</span>    }</div>
<div class="line"><span class="lineno"> 3175</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3176</span>      ptr.ptr  = rangeMap(pProfile-&gt;m_Header.spectralRange, illuminantRange);</div>
<div class="line"><span class="lineno"> 3177</span>      <span class="keywordflow">if</span> (ptr.ptr) {</div>
<div class="line"><span class="lineno"> 3178</span>        m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 3179</span>      }</div>
<div class="line"><span class="lineno"> 3180</span> </div>
<div class="line"><span class="lineno"> 3181</span>      ptr.ptr = pScale;</div>
<div class="line"><span class="lineno"> 3182</span>      m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 3183</span> </div>
<div class="line"><span class="lineno"> 3184</span>      ptr.ptr = rangeMap(illuminantRange, pProfile-&gt;m_Header.spectralRange);</div>
<div class="line"><span class="lineno"> 3185</span>      <span class="keywordflow">if</span> (ptr.ptr)</div>
<div class="line"><span class="lineno"> 3186</span>        m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 3187</span>    }</div>
<div class="line"><span class="lineno"> 3188</span>  }</div>
<div class="line"><span class="lineno"> 3189</span>}</div>
<div class="line"><span class="lineno"> 3190</span> </div>
<div class="line"><span class="lineno"> 3191</span> </div>
<div class="line"><span class="lineno"> 3202</span><span class="keywordtype">void</span> CIccPcsXform::pushRad2Xyz(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a>* pProfile, <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc, <span class="keywordtype">bool</span> bAbsoluteCIEColorimetry)</div>
<div class="line"><span class="lineno"> 3203</span>{</div>
<div class="line"><span class="lineno"> 3204</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d8/dbf/a01109.html">CIccTagSpectralViewingConditions</a> *pProfView = pProfile ? pProfile-&gt;getPccViewingConditions() : NULL;</div>
<div class="line"><span class="lineno"> 3205</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d8/dbf/a01109.html">CIccTagSpectralViewingConditions</a> *pView = pPcc-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a41d44184a1e66e1f7bd46e60fc69fda6">getPccViewingConditions</a>();</div>
<div class="line"><span class="lineno"> 3206</span>  <span class="keywordflow">if</span> (pProfView &amp;&amp; pView) {</div>
<div class="line"><span class="lineno"> 3207</span>    <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> illuminantRange;</div>
<div class="line"><span class="lineno"> 3208</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *illuminant = pView-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#aa4fe6556022cceea44adf34848528245">getIlluminant</a>(illuminantRange);</div>
<div class="line"><span class="lineno"> 3209</span> </div>
<div class="line"><span class="lineno"> 3210</span>    <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> observerRange;</div>
<div class="line"><span class="lineno"> 3211</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *observer = pView-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#a2319ced95e40cb2493820227f54a302d">getObserver</a>(observerRange);</div>
<div class="line"><span class="lineno"> 3212</span> </div>
<div class="line"><span class="lineno"> 3213</span>    <span class="comment">//Preserve smallest step size</span></div>
<div class="line"><span class="lineno"> 3214</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> dPCSStepSize = (<a class="code hl_function" href="../../d7/dce/a00143.html#af29908d138da11b5eb2b6174fb9020e2">icF16toF</a>(pProfile-&gt;m_Header.spectralRange.end) - <a class="code hl_function" href="../../d7/dce/a00143.html#af29908d138da11b5eb2b6174fb9020e2">icF16toF</a>(pProfile-&gt;m_Header.spectralRange.start))/(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pProfile-&gt;m_Header.spectralRange.steps;</div>
<div class="line"><span class="lineno"> 3215</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> dObsStepSize = (<a class="code hl_function" href="../../d7/dce/a00143.html#af29908d138da11b5eb2b6174fb9020e2">icF16toF</a>(observerRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a81f6d2d938687df976c13f1f3c8d4b09">end</a>) - <a class="code hl_function" href="../../d7/dce/a00143.html#af29908d138da11b5eb2b6174fb9020e2">icF16toF</a>(observerRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a65d0544793f49b86857f2d54f9897446">start</a>)) / (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>) observerRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">steps</a>;</div>
<div class="line"><span class="lineno"> 3216</span> </div>
<div class="line"><span class="lineno"> 3217</span>    <span class="keywordflow">if</span> (dPCSStepSize&lt;dObsStepSize) {</div>
<div class="line"><span class="lineno"> 3218</span>      <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *obs = pView-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#ab70e50510cb2440171a3ba005587adff">applyRangeToObserver</a>(pProfile-&gt;m_Header.spectralRange);</div>
<div class="line"><span class="lineno"> 3219</span> </div>
<div class="line"><span class="lineno"> 3220</span>      pushMatrix(3, pProfile-&gt;m_Header.spectralRange.steps, obs);</div>
<div class="line"><span class="lineno"> 3221</span>      free(obs);</div>
<div class="line"><span class="lineno"> 3222</span>    }</div>
<div class="line"><span class="lineno"> 3223</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3224</span>      pushSpecToRange(pProfile-&gt;m_Header.spectralRange, observerRange);</div>
<div class="line"><span class="lineno"> 3225</span>      pushMatrix(3, observerRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">steps</a>, observer);</div>
<div class="line"><span class="lineno"> 3226</span> </div>
<div class="line"><span class="lineno"> 3227</span>    }</div>
<div class="line"><span class="lineno"> 3228</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> k;</div>
<div class="line"><span class="lineno"> 3229</span>    <span class="keywordflow">if</span> (bAbsoluteCIEColorimetry) {</div>
<div class="line"><span class="lineno"> 3230</span>      k = 683;</div>
<div class="line"><span class="lineno"> 3231</span>    }</div>
<div class="line"><span class="lineno"> 3232</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3233</span>      k = 1.0f / pPcc-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a81fb6e4ffae390d84145d802702b6d6c">getObserverWhiteScaleFactor</a>(illuminant, illuminantRange);</div>
<div class="line"><span class="lineno"> 3234</span>    }</div>
<div class="line"><span class="lineno"> 3235</span>    pushScale3(k, k, k);</div>
<div class="line"><span class="lineno"> 3236</span>  }</div>
<div class="line"><span class="lineno"> 3237</span>}</div>
<div class="line"><span class="lineno"> 3238</span> </div>
<div class="line"><span class="lineno"> 3239</span> </div>
<div class="line"><span class="lineno"> 3249</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccPcsXform::pushBiRef2Rad(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile, <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc)</div>
<div class="line"><span class="lineno"> 3250</span>{</div>
<div class="line"><span class="lineno"> 3251</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d8/dbf/a01109.html">CIccTagSpectralViewingConditions</a> *pView = pPcc-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a41d44184a1e66e1f7bd46e60fc69fda6">getPccViewingConditions</a>();</div>
<div class="line"><span class="lineno"> 3252</span> </div>
<div class="line"><span class="lineno"> 3253</span>  <span class="keywordflow">if</span> (pView) {</div>
<div class="line"><span class="lineno"> 3254</span>    <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> illuminantRange;</div>
<div class="line"><span class="lineno"> 3255</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *illuminant = pView-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#aa4fe6556022cceea44adf34848528245">getIlluminant</a>(illuminantRange);</div>
<div class="line"><span class="lineno"> 3256</span> </div>
<div class="line"><span class="lineno"> 3257</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d7/d46/a00002.html#a47e4f847bd0bc609907b5fea4daf3e75">icGetColorSpaceType</a>(pProfile-&gt;m_Header.spectralPCS)==<a class="code hl_define" href="../../d7/d46/a00002.html#a1b59192d9fcc1aee71b8cc523b4978ca">icSigSparseMatrixSpectralPcsData</a>) {</div>
<div class="line"><span class="lineno"> 3258</span>      CIccPcsStepSrcSparseMatrix *pMtx = <span class="keyword">new</span> CIccPcsStepSrcSparseMatrix(pProfile-&gt;m_Header.spectralRange.steps, </div>
<div class="line"><span class="lineno"> 3259</span>                                                                        pProfile-&gt;m_Header.biSpectralRange.steps,</div>
<div class="line"><span class="lineno"> 3260</span>                                                                        (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)<a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>((<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.spectralPCS));</div>
<div class="line"><span class="lineno"> 3261</span>      <span class="keywordflow">if</span> (!pMtx)</div>
<div class="line"><span class="lineno"> 3262</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 3263</span> </div>
<div class="line"><span class="lineno"> 3264</span>      CIccPcsStepMatrix *illumMtx = rangeMap(illuminantRange, pProfile-&gt;m_Header.biSpectralRange);</div>
<div class="line"><span class="lineno"> 3265</span>      <span class="keywordflow">if</span> (illumMtx) {</div>
<div class="line"><span class="lineno"> 3266</span>        illumMtx-&gt;Apply(NULL, pMtx-&gt;data(), illuminant);</div>
<div class="line"><span class="lineno"> 3267</span>        <span class="keyword">delete</span> illumMtx; </div>
<div class="line"><span class="lineno"> 3268</span>      }</div>
<div class="line"><span class="lineno"> 3269</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3270</span>        memcpy(pMtx-&gt;data(), illuminant, illuminantRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">steps</a>*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 3271</span>      }</div>
<div class="line"><span class="lineno"> 3272</span> </div>
<div class="line"><span class="lineno"> 3273</span>      CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 3274</span>      ptr.ptr = pMtx;</div>
<div class="line"><span class="lineno"> 3275</span>      m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 3276</span> </div>
<div class="line"><span class="lineno"> 3277</span>    }</div>
<div class="line"><span class="lineno"> 3278</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3279</span>      CIccPcsStepSrcMatrix *pMtx = <span class="keyword">new</span> CIccPcsStepSrcMatrix(pProfile-&gt;m_Header.spectralRange.steps, pProfile-&gt;m_Header.biSpectralRange.steps);</div>
<div class="line"><span class="lineno"> 3280</span>      <span class="keywordflow">if</span> (!pMtx)</div>
<div class="line"><span class="lineno"> 3281</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 3282</span> </div>
<div class="line"><span class="lineno"> 3283</span>      CIccPcsStepMatrix *illumMtx = rangeMap(illuminantRange, pProfile-&gt;m_Header.biSpectralRange);</div>
<div class="line"><span class="lineno"> 3284</span>      <span class="keywordflow">if</span> (illumMtx) {</div>
<div class="line"><span class="lineno"> 3285</span>        illumMtx-&gt;Apply(NULL, pMtx-&gt;data(), illuminant);</div>
<div class="line"><span class="lineno"> 3286</span>        <span class="keyword">delete</span> illumMtx; </div>
<div class="line"><span class="lineno"> 3287</span>      }</div>
<div class="line"><span class="lineno"> 3288</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3289</span>        memcpy(pMtx-&gt;data(), illuminant, illuminantRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">steps</a>*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 3290</span>      }</div>
<div class="line"><span class="lineno"> 3291</span> </div>
<div class="line"><span class="lineno"> 3292</span>      CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 3293</span>      ptr.ptr = pMtx;</div>
<div class="line"><span class="lineno"> 3294</span>      m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 3295</span> </div>
<div class="line"><span class="lineno"> 3296</span>    }</div>
<div class="line"><span class="lineno"> 3297</span>  }</div>
<div class="line"><span class="lineno"> 3298</span> </div>
<div class="line"><span class="lineno"> 3299</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 3300</span>}</div>
<div class="line"><span class="lineno"> 3301</span> </div>
<div class="line"><span class="lineno"> 3302</span> </div>
<div class="line"><span class="lineno"> 3314</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccPcsXform::pushBiRef2Xyz(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile, <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc)</div>
<div class="line"><span class="lineno"> 3315</span>{</div>
<div class="line"><span class="lineno"> 3316</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> stat = pushBiRef2Rad(pProfile, pPcc);</div>
<div class="line"><span class="lineno"> 3317</span>  <span class="keywordflow">if</span> (stat!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno"> 3318</span>    <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 3319</span> </div>
<div class="line"><span class="lineno"> 3320</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d8/dbf/a01109.html">CIccTagSpectralViewingConditions</a> *pView = pPcc-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a41d44184a1e66e1f7bd46e60fc69fda6">getPccViewingConditions</a>();</div>
<div class="line"><span class="lineno"> 3321</span> </div>
<div class="line"><span class="lineno"> 3322</span>  <span class="keywordflow">if</span> (pView) {</div>
<div class="line"><span class="lineno"> 3323</span>    <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> observerRange;</div>
<div class="line"><span class="lineno"> 3324</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *observer = pView-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#a2319ced95e40cb2493820227f54a302d">getObserver</a>(observerRange);</div>
<div class="line"><span class="lineno"> 3325</span> </div>
<div class="line"><span class="lineno"> 3326</span>    pushSpecToRange(pProfile-&gt;m_Header.spectralRange, observerRange);</div>
<div class="line"><span class="lineno"> 3327</span>    pushMatrix(3, observerRange.<a class="code hl_variable" href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">steps</a>, observer);</div>
<div class="line"><span class="lineno"> 3328</span>    pushXYZNormalize(pPcc, pProfile-&gt;m_Header.biSpectralRange, pProfile-&gt;m_Header.spectralRange);</div>
<div class="line"><span class="lineno"> 3329</span>  }</div>
<div class="line"><span class="lineno"> 3330</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3331</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9d8efd1c91aa512d46f51cd30a7927f5">icCmmStatBadConnection</a>;</div>
<div class="line"><span class="lineno"> 3332</span>  }</div>
<div class="line"><span class="lineno"> 3333</span> </div>
<div class="line"><span class="lineno"> 3334</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 3335</span>}</div>
<div class="line"><span class="lineno"> 3336</span> </div>
<div class="line"><span class="lineno"> 3337</span> </div>
<div class="line"><span class="lineno"> 3348</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccPcsXform::pushBiRef2Ref(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile, <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc)</div>
<div class="line"><span class="lineno"> 3349</span>{</div>
<div class="line"><span class="lineno"> 3350</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> stat = pushBiRef2Rad(pProfile, pPcc);</div>
<div class="line"><span class="lineno"> 3351</span>  <span class="keywordflow">if</span> (stat!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno"> 3352</span>    <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 3353</span> </div>
<div class="line"><span class="lineno"> 3354</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d8/dbf/a01109.html">CIccTagSpectralViewingConditions</a> *pView = pPcc-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a41d44184a1e66e1f7bd46e60fc69fda6">getPccViewingConditions</a>();</div>
<div class="line"><span class="lineno"> 3355</span> </div>
<div class="line"><span class="lineno"> 3356</span>  <span class="keywordflow">if</span> (pView) {</div>
<div class="line"><span class="lineno"> 3357</span>    <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> illuminantRange;</div>
<div class="line"><span class="lineno"> 3358</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *illuminant = pView-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#aa4fe6556022cceea44adf34848528245">getIlluminant</a>(illuminantRange);</div>
<div class="line"><span class="lineno"> 3359</span> </div>
<div class="line"><span class="lineno"> 3360</span>    CIccPcsStepScale *pScale = <span class="keyword">new</span> CIccPcsStepScale(pProfile-&gt;m_Header.spectralRange.steps);</div>
<div class="line"><span class="lineno"> 3361</span> </div>
<div class="line"><span class="lineno"> 3362</span>    <span class="keywordflow">if</span> (pScale) {</div>
<div class="line"><span class="lineno"> 3363</span>      <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pData = pScale-&gt;data();</div>
<div class="line"><span class="lineno"> 3364</span>      CIccPcsStepMatrix *illumMtx = rangeMap(illuminantRange, pProfile-&gt;m_Header.spectralRange);</div>
<div class="line"><span class="lineno"> 3365</span>      <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 3366</span> </div>
<div class="line"><span class="lineno"> 3367</span>      <span class="keywordflow">if</span> (illumMtx) {</div>
<div class="line"><span class="lineno"> 3368</span>        illumMtx-&gt;Apply(NULL, pData, illuminant);</div>
<div class="line"><span class="lineno"> 3369</span>        <span class="keywordflow">for</span> (i=0; i&lt;pProfile-&gt;m_Header.spectralRange.steps; i++)</div>
<div class="line"><span class="lineno"> 3370</span>          pData[i] = 1.0f / pData[i];</div>
<div class="line"><span class="lineno"> 3371</span> </div>
<div class="line"><span class="lineno"> 3372</span>        <span class="keyword">delete</span> illumMtx;</div>
<div class="line"><span class="lineno"> 3373</span> </div>
<div class="line"><span class="lineno"> 3374</span>      }</div>
<div class="line"><span class="lineno"> 3375</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3376</span>        <span class="keywordflow">for</span> (i=0; i&lt;pProfile-&gt;m_Header.spectralRange.steps; i++) {</div>
<div class="line"><span class="lineno"> 3377</span>          pData[i] = 1.0f / illuminant[i];</div>
<div class="line"><span class="lineno"> 3378</span>        }</div>
<div class="line"><span class="lineno"> 3379</span>      }</div>
<div class="line"><span class="lineno"> 3380</span> </div>
<div class="line"><span class="lineno"> 3381</span>      CIccPcsStepPtr ptr;</div>
<div class="line"><span class="lineno"> 3382</span>      ptr.ptr = pScale;</div>
<div class="line"><span class="lineno"> 3383</span>      m_list-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 3384</span>    }</div>
<div class="line"><span class="lineno"> 3385</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3386</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 3387</span>  }</div>
<div class="line"><span class="lineno"> 3388</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3389</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9d8efd1c91aa512d46f51cd30a7927f5">icCmmStatBadConnection</a>;</div>
<div class="line"><span class="lineno"> 3390</span> </div>
<div class="line"><span class="lineno"> 3391</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 3392</span>}</div>
<div class="line"><span class="lineno"> 3393</span> </div>
<div class="line"><span class="lineno"> 3394</span> </div>
<div class="line"><span class="lineno"> 3395</span><span class="preprocessor">#ifdef _DEBUG</span></div>
<div class="line"><span class="lineno"> 3396</span><span class="comment">//#define DUMPCSSTEPRESULTS</span></div>
<div class="line"><span class="lineno"> 3397</span><span class="preprocessor">#ifdef DUMPCSSTEPRESULTS</span></div>
<div class="line"><span class="lineno"> 3398</span><span class="preprocessor">  #define ICCDUMPPIXEL(n, pix) \</span></div>
<div class="line"><span class="lineno"> 3399</span><span class="preprocessor">  if ((n)&lt;96) { \</span></div>
<div class="line"><span class="lineno"> 3400</span><span class="preprocessor">    printf(&quot;[&quot;); \</span></div>
<div class="line"><span class="lineno"> 3401</span><span class="preprocessor">    int i; \</span></div>
<div class="line"><span class="lineno"> 3402</span><span class="preprocessor">    for (i=0; i&lt;(n); i++) { \</span></div>
<div class="line"><span class="lineno"> 3403</span><span class="preprocessor">      if (i &amp;&amp; !(i%12)) \</span></div>
<div class="line"><span class="lineno"> 3404</span><span class="preprocessor">        printf(&quot;...\n&quot;); \</span></div>
<div class="line"><span class="lineno"> 3405</span><span class="preprocessor">      printf(&quot; %.5f&quot;, pix[i]); \</span></div>
<div class="line"><span class="lineno"> 3406</span><span class="preprocessor">    } \</span></div>
<div class="line"><span class="lineno"> 3407</span><span class="preprocessor">    printf(&quot;]\n&quot;); \</span></div>
<div class="line"><span class="lineno"> 3408</span><span class="preprocessor">  } \</span></div>
<div class="line"><span class="lineno"> 3409</span><span class="preprocessor">  else { \</span></div>
<div class="line"><span class="lineno"> 3410</span><span class="preprocessor">    printf(&quot;[ BigAray with %d elements]\n&quot;, (n)); \</span></div>
<div class="line"><span class="lineno"> 3411</span><span class="preprocessor">  }</span></div>
<div class="line"><span class="lineno"> 3412</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 3413</span><span class="preprocessor">  #define ICCDUMPPIXEL(n, pix)</span></div>
<div class="line"><span class="lineno"> 3414</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3415</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 3416</span><span class="preprocessor">  #define ICCDUMPPIXEL(n, pix)</span></div>
<div class="line"><span class="lineno"> 3417</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 3418</span> </div>
<div class="line"><span class="lineno"> 3419</span> </div>
<div class="line"><span class="lineno"> 3428</span><span class="keywordtype">void</span> CIccPcsXform::Apply(CIccApplyXform *pXform, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3429</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3430</span>  CIccApplyPcsXform *pApplyXform = (CIccApplyPcsXform*)pXform;</div>
<div class="line"><span class="lineno"> 3431</span>  CIccApplyPcsStepList *pList = pApplyXform-&gt;m_list;</div>
<div class="line"><span class="lineno"> 3432</span> </div>
<div class="line"><span class="lineno"> 3433</span>  <a class="code hl_define" href="../../d3/df8/a00155.html#abb796a32bb9b930ceb2efcbb87f4a909">ICCDUMPPIXEL</a>(GetNumSrcSamples(), SrcPixel);</div>
<div class="line"><span class="lineno"> 3434</span> </div>
<div class="line"><span class="lineno"> 3435</span>  <span class="keywordflow">if</span> (!pList) {</div>
<div class="line"><span class="lineno"> 3436</span>    memcpy(DstPixel, SrcPixel, GetNumSrcSamples()*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 3437</span>    <a class="code hl_define" href="../../d3/df8/a00155.html#abb796a32bb9b930ceb2efcbb87f4a909">ICCDUMPPIXEL</a>(GetNumSrcSamples(), DstPixel);</div>
<div class="line"><span class="lineno"> 3438</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3439</span>  }</div>
<div class="line"><span class="lineno"> 3440</span>  </div>
<div class="line"><span class="lineno"> 3441</span>  CIccApplyPcsStepList::iterator s, n;</div>
<div class="line"><span class="lineno"> 3442</span>  s = n =pList-&gt;begin();</div>
<div class="line"><span class="lineno"> 3443</span> </div>
<div class="line"><span class="lineno"> 3444</span>  <span class="keywordflow">if</span> (s==pList-&gt;end()) {</div>
<div class="line"><span class="lineno"> 3445</span>    memcpy(DstPixel, SrcPixel, GetNumSrcSamples()*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 3446</span>    <a class="code hl_define" href="../../d3/df8/a00155.html#abb796a32bb9b930ceb2efcbb87f4a909">ICCDUMPPIXEL</a>(GetNumSrcSamples(), DstPixel);</div>
<div class="line"><span class="lineno"> 3447</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 3448</span>  }</div>
<div class="line"><span class="lineno"> 3449</span> </div>
<div class="line"><span class="lineno"> 3450</span>  n++;</div>
<div class="line"><span class="lineno"> 3451</span> </div>
<div class="line"><span class="lineno"> 3452</span>  <span class="keywordflow">if</span> (n==pList-&gt;end()) {</div>
<div class="line"><span class="lineno"> 3453</span>    s-&gt;ptr-&gt;Apply(DstPixel, SrcPixel);</div>
<div class="line"><span class="lineno"> 3454</span>    <a class="code hl_define" href="../../d3/df8/a00155.html#abb796a32bb9b930ceb2efcbb87f4a909">ICCDUMPPIXEL</a>(s-&gt;ptr-&gt;GetStep()-&gt;GetDstChannels(), DstPixel);</div>
<div class="line"><span class="lineno"> 3455</span>  }</div>
<div class="line"><span class="lineno"> 3456</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3457</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *src = SrcPixel;</div>
<div class="line"><span class="lineno"> 3458</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *p1 = pApplyXform-&gt;m_temp1;</div>
<div class="line"><span class="lineno"> 3459</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *p2 = pApplyXform-&gt;m_temp2;</div>
<div class="line"><span class="lineno"> 3460</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *t;</div>
<div class="line"><span class="lineno"> 3461</span> </div>
<div class="line"><span class="lineno"> 3462</span>    <span class="keywordflow">for</span> (;n!=pList-&gt;end(); s=n, n++) {</div>
<div class="line"><span class="lineno"> 3463</span>      s-&gt;ptr-&gt;Apply(p1, src);</div>
<div class="line"><span class="lineno"> 3464</span>      <a class="code hl_define" href="../../d3/df8/a00155.html#abb796a32bb9b930ceb2efcbb87f4a909">ICCDUMPPIXEL</a>(s-&gt;ptr-&gt;GetStep()-&gt;GetDstChannels(), p1);</div>
<div class="line"><span class="lineno"> 3465</span>      src=p1;</div>
<div class="line"><span class="lineno"> 3466</span>      t=p1; p1=p2; p2=t;</div>
<div class="line"><span class="lineno"> 3467</span>    }</div>
<div class="line"><span class="lineno"> 3468</span>    s-&gt;ptr-&gt;Apply(DstPixel, src);</div>
<div class="line"><span class="lineno"> 3469</span>    <a class="code hl_define" href="../../d3/df8/a00155.html#abb796a32bb9b930ceb2efcbb87f4a909">ICCDUMPPIXEL</a>(s-&gt;ptr-&gt;GetStep()-&gt;GetDstChannels(), DstPixel);</div>
<div class="line"><span class="lineno"> 3470</span>  }</div>
<div class="line"><span class="lineno"> 3471</span>}</div>
<div class="line"><span class="lineno"> 3472</span> </div>
<div class="line"><span class="lineno"> 3481</span>CIccApplyPcsStep* CIccPcsStep::GetNewApply()</div>
<div class="line"><span class="lineno"> 3482</span>{</div>
<div class="line"><span class="lineno"> 3483</span>  <span class="keywordflow">return</span> <span class="keyword">new</span> CIccApplyPcsStep(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 3484</span>}</div>
<div class="line"><span class="lineno"> 3485</span> </div>
<div class="line"><span class="lineno"> 3486</span> </div>
<div class="line"><span class="lineno"> 3495</span><span class="keywordtype">void</span> CIccPcsStepIdentity::Apply(CIccApplyPcsStep *pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3496</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3497</span>  <span class="keywordflow">if</span> (pDst != pSrc)</div>
<div class="line"><span class="lineno"> 3498</span>    memcpy(pDst, pSrc, m_nChannels*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 3499</span>}</div>
<div class="line"><span class="lineno"> 3500</span> </div>
<div class="line"><span class="lineno"> 3501</span> </div>
<div class="line"><span class="lineno"> 3510</span><span class="keywordtype">void</span> CIccPcsStepIdentity::dump(std::string &amp;str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3511</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3512</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepIdentity\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 3513</span>}</div>
<div class="line"><span class="lineno"> 3514</span> </div>
<div class="line"><span class="lineno"> 3515</span> </div>
<div class="line"><span class="lineno"> 3524</span>CIccPcsStepRouteMcs::CIccPcsStepRouteMcs(<a class="code hl_class" href="../../db/de0/a00465.html">CIccTagArray</a> *pSrcChannels, <a class="code hl_class" href="../../db/de0/a00465.html">CIccTagArray</a> *pDstChannels, <a class="code hl_class" href="../../d0/daa/a01029.html">CIccTagNumArray</a> *pDefaults)</div>
<div class="line"><span class="lineno"> 3525</span>{</div>
<div class="line"><span class="lineno"> 3526</span>  m_nSrcChannels = (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)pSrcChannels-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#ad89262b326c7dde5b444599ed6d862e7">GetSize</a>();</div>
<div class="line"><span class="lineno"> 3527</span>  m_nDstChannels = (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)pDstChannels-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#ad89262b326c7dde5b444599ed6d862e7">GetSize</a>();</div>
<div class="line"><span class="lineno"> 3528</span>  m_Index = <span class="keyword">new</span> <span class="keywordtype">int</span>[m_nDstChannels];</div>
<div class="line"><span class="lineno"> 3529</span>  m_Defaults = <span class="keyword">new</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>[m_nDstChannels];</div>
<div class="line"><span class="lineno"> 3530</span> </div>
<div class="line"><span class="lineno"> 3531</span>  memset(m_Defaults, 0, m_nDstChannels*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 3532</span> </div>
<div class="line"><span class="lineno"> 3533</span>  <span class="keywordflow">if</span> (pDefaults) {</div>
<div class="line"><span class="lineno"> 3534</span>    pDefaults-&gt;<a class="code hl_function" href="../../d0/daa/a01029.html#a2c8e9e09f0916181fc93e0d5ce1817d8">GetValues</a>(m_Defaults, 0, m_nDstChannels);</div>
<div class="line"><span class="lineno"> 3535</span>  }</div>
<div class="line"><span class="lineno"> 3536</span> </div>
<div class="line"><span class="lineno"> 3537</span>  <span class="keywordtype">int</span> i, j;</div>
<div class="line"><span class="lineno"> 3538</span>  <span class="keywordtype">char</span> *szSrc;</div>
<div class="line"><span class="lineno"> 3539</span> </div>
<div class="line"><span class="lineno"> 3540</span>  <span class="keywordflow">for</span> (i=0; i&lt;m_nDstChannels; i++) {</div>
<div class="line"><span class="lineno"> 3541</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a11ef650eb30d34d4f469f2c5db79aa50">icUChar</a> *szDstChan = ((<a class="code hl_class" href="../../dd/d24/a00981.html">CIccTagUtf8Text</a>*)(pDstChannels-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#ac30ff943da70f26a654f2e9d39c0e568">GetIndex</a>(i)))-&gt;GetText();</div>
<div class="line"><span class="lineno"> 3542</span>    <span class="keywordflow">for</span> (j=0; j&lt;m_nSrcChannels; j++) {</div>
<div class="line"><span class="lineno"> 3543</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a11ef650eb30d34d4f469f2c5db79aa50">icUChar</a> *szSrcChan = ((<a class="code hl_class" href="../../dd/d24/a00981.html">CIccTagUtf8Text</a>*)(pSrcChannels-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#ac30ff943da70f26a654f2e9d39c0e568">GetIndex</a>(j)))-&gt;GetText();</div>
<div class="line"><span class="lineno"> 3544</span>      szSrc = (<span class="keywordtype">char</span>*)szSrcChan;</div>
<div class="line"><span class="lineno"> 3545</span>      <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d7/dce/a00143.html#ae716aa59d818f8dda39c5a4245061336">icUtf8StrCmp</a>(szDstChan, szSrcChan))</div>
<div class="line"><span class="lineno"> 3546</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3547</span>    }</div>
<div class="line"><span class="lineno"> 3548</span>    <span class="keywordflow">if</span> (j==m_nSrcChannels) {</div>
<div class="line"><span class="lineno"> 3549</span>      m_Index[i] = -1;</div>
<div class="line"><span class="lineno"> 3550</span>    }</div>
<div class="line"><span class="lineno"> 3551</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3552</span>      m_Index[i] = j;</div>
<div class="line"><span class="lineno"> 3553</span>    }</div>
<div class="line"><span class="lineno"> 3554</span>    <span class="comment">//printf(&quot;%d - %d %s\n&quot;, m_Index[i], i, szDstChan);</span></div>
<div class="line"><span class="lineno"> 3555</span>  }</div>
<div class="line"><span class="lineno"> 3556</span>}</div>
<div class="line"><span class="lineno"> 3557</span> </div>
<div class="line"><span class="lineno"> 3558</span> </div>
<div class="line"><span class="lineno"> 3567</span>CIccPcsStepRouteMcs::~CIccPcsStepRouteMcs()</div>
<div class="line"><span class="lineno"> 3568</span>{</div>
<div class="line"><span class="lineno"> 3569</span>  <span class="keywordflow">if</span> (m_Index)</div>
<div class="line"><span class="lineno"> 3570</span>    <span class="keyword">delete</span> [] m_Index;</div>
<div class="line"><span class="lineno"> 3571</span>  <span class="keywordflow">if</span> (m_Defaults)</div>
<div class="line"><span class="lineno"> 3572</span>    <span class="keyword">delete</span> [] m_Defaults;</div>
<div class="line"><span class="lineno"> 3573</span>}</div>
<div class="line"><span class="lineno"> 3574</span> </div>
<div class="line"><span class="lineno"> 3575</span> </div>
<div class="line"><span class="lineno"> 3584</span><span class="keywordtype">bool</span> CIccPcsStepRouteMcs::isIdentity()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3585</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3586</span>  <span class="keywordflow">if</span> (m_nSrcChannels!=m_nDstChannels)</div>
<div class="line"><span class="lineno"> 3587</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3588</span> </div>
<div class="line"><span class="lineno"> 3589</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 3590</span>  <span class="keywordflow">for</span> (i=0; i&lt;m_nDstChannels; i++) {</div>
<div class="line"><span class="lineno"> 3591</span>    <span class="keywordflow">if</span> (m_Index[i]!=i)</div>
<div class="line"><span class="lineno"> 3592</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 3593</span>  }</div>
<div class="line"><span class="lineno"> 3594</span> </div>
<div class="line"><span class="lineno"> 3595</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 3596</span>}</div>
<div class="line"><span class="lineno"> 3597</span> </div>
<div class="line"><span class="lineno"> 3598</span> </div>
<div class="line"><span class="lineno"> 3599</span> </div>
<div class="line"><span class="lineno"> 3608</span><span class="keywordtype">void</span> CIccPcsStepRouteMcs::Apply(CIccApplyPcsStep *pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3609</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3610</span>  <span class="keywordflow">if</span> (pDst != pSrc) {</div>
<div class="line"><span class="lineno"> 3611</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 3612</span>    <span class="keywordflow">for</span> (i=0; i&lt;m_nDstChannels; i++) {</div>
<div class="line"><span class="lineno"> 3613</span>      <span class="keywordflow">if</span> (m_Index[i]&gt;=0)</div>
<div class="line"><span class="lineno"> 3614</span>        pDst[i] = pSrc[m_Index[i]];</div>
<div class="line"><span class="lineno"> 3615</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3616</span>        pDst[i] = m_Defaults[i];</div>
<div class="line"><span class="lineno"> 3617</span>    }</div>
<div class="line"><span class="lineno"> 3618</span>  }</div>
<div class="line"><span class="lineno"> 3619</span>}</div>
<div class="line"><span class="lineno"> 3620</span> </div>
<div class="line"><span class="lineno"> 3621</span> </div>
<div class="line"><span class="lineno"> 3630</span><span class="keywordtype">void</span> CIccPcsStepRouteMcs::dump(std::string &amp;str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3631</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3632</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepRouteMcs\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 3633</span>}</div>
<div class="line"><span class="lineno"> 3634</span> </div>
<div class="line"><span class="lineno"> 3635</span><span class="keyword">extern</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> <a class="code hl_variable" href="../../d3/df8/a00155.html#a961f0b709819f36204e7da4148c1505e">icD50XYZ</a>[3];</div>
<div class="line"><span class="lineno"> 3636</span> </div>
<div class="line"><span class="lineno"> 3645</span><span class="keywordtype">bool</span> CIccPcsLabStep::isSameWhite(<span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *xyzWhite)</div>
<div class="line"><span class="lineno"> 3646</span>{</div>
<div class="line"><span class="lineno"> 3647</span>  <span class="keywordflow">return</span> (m_xyzWhite[0]==xyzWhite[0] &amp;&amp;</div>
<div class="line"><span class="lineno"> 3648</span>          m_xyzWhite[1]==xyzWhite[1] &amp;&amp;</div>
<div class="line"><span class="lineno"> 3649</span>          m_xyzWhite[2]==xyzWhite[2]);</div>
<div class="line"><span class="lineno"> 3650</span>}</div>
<div class="line"><span class="lineno"> 3651</span> </div>
<div class="line"><span class="lineno"> 3652</span> </div>
<div class="line"><span class="lineno"> 3653</span> </div>
<div class="line"><span class="lineno"> 3662</span>CIccPcsStepLabToXYZ::CIccPcsStepLabToXYZ(<span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *xyzWhite<span class="comment">/*=NULL*/</span>)</div>
<div class="line"><span class="lineno"> 3663</span>{</div>
<div class="line"><span class="lineno"> 3664</span>  <span class="keywordflow">if</span> (xyzWhite) {</div>
<div class="line"><span class="lineno"> 3665</span>    memcpy(m_xyzWhite, xyzWhite, <span class="keyword">sizeof</span>(m_xyzWhite));</div>
<div class="line"><span class="lineno"> 3666</span>  }</div>
<div class="line"><span class="lineno"> 3667</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3668</span>    memcpy(m_xyzWhite, <a class="code hl_variable" href="../../d3/df8/a00155.html#a961f0b709819f36204e7da4148c1505e">icD50XYZ</a>, <span class="keyword">sizeof</span>(m_xyzWhite));</div>
<div class="line"><span class="lineno"> 3669</span>  }</div>
<div class="line"><span class="lineno"> 3670</span>}</div>
<div class="line"><span class="lineno"> 3671</span> </div>
<div class="line"><span class="lineno"> 3672</span> </div>
<div class="line"><span class="lineno"> 3681</span><span class="keywordtype">void</span> CIccPcsStepLabToXYZ::Apply(CIccApplyPcsStep *pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3682</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3683</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> Lab[3];</div>
<div class="line"><span class="lineno"> 3684</span> </div>
<div class="line"><span class="lineno"> 3685</span>  <span class="comment">//lab4 to XYZ</span></div>
<div class="line"><span class="lineno"> 3686</span>  Lab[0] = pSrc[0] * 100.0f;</div>
<div class="line"><span class="lineno"> 3687</span>  Lab[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pSrc[1]*255.0f - 128.0f);</div>
<div class="line"><span class="lineno"> 3688</span>  Lab[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pSrc[2]*255.0f - 128.0f);</div>
<div class="line"><span class="lineno"> 3689</span> </div>
<div class="line"><span class="lineno"> 3690</span>  <a class="code hl_function" href="../../d7/dce/a00143.html#aaf617b49cf0d56a218cd52c840228705">icLabtoXYZ</a>(pDst, Lab, m_xyzWhite);</div>
<div class="line"><span class="lineno"> 3691</span>}</div>
<div class="line"><span class="lineno"> 3692</span> </div>
<div class="line"><span class="lineno"> 3693</span> </div>
<div class="line"><span class="lineno"> 3702</span><span class="keywordtype">void</span> CIccPcsStepLabToXYZ::dump(std::string &amp;str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3703</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3704</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepLabToXYZ\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 3705</span>}</div>
<div class="line"><span class="lineno"> 3706</span> </div>
<div class="line"><span class="lineno"> 3707</span> </div>
<div class="line"><span class="lineno"> 3718</span>CIccPcsStep *CIccPcsStepLabToXYZ::concat(CIccPcsStep *pNext)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3719</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3720</span>  <span class="keywordflow">if</span> (pNext) {</div>
<div class="line"><span class="lineno"> 3721</span>    <span class="keywordflow">if</span> (pNext-&gt;GetType() == icPcsStepXYZToLab) {</div>
<div class="line"><span class="lineno"> 3722</span>      CIccPcsLabStep* pStep = (CIccPcsLabStep*)pNext;</div>
<div class="line"><span class="lineno"> 3723</span>      <span class="keywordflow">if</span> (pStep-&gt;isSameWhite(m_xyzWhite))</div>
<div class="line"><span class="lineno"> 3724</span>        <span class="keywordflow">return</span> <span class="keyword">new</span> CIccPcsStepIdentity(3);</div>
<div class="line"><span class="lineno"> 3725</span>    }</div>
<div class="line"><span class="lineno"> 3726</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pNext-&gt;GetType() == icPcsStepXYZToLab2) {</div>
<div class="line"><span class="lineno"> 3727</span>      CIccPcsLabStep* pStep = (CIccPcsLabStep*)pNext;</div>
<div class="line"><span class="lineno"> 3728</span>      <span class="keywordflow">if</span> (pStep-&gt;isSameWhite(m_xyzWhite))</div>
<div class="line"><span class="lineno"> 3729</span>        <span class="keywordflow">return</span> <span class="keyword">new</span> CIccPcsStepLabToLab2();</div>
<div class="line"><span class="lineno"> 3730</span>    }</div>
<div class="line"><span class="lineno"> 3731</span>  }</div>
<div class="line"><span class="lineno"> 3732</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 3733</span>}</div>
<div class="line"><span class="lineno"> 3734</span> </div>
<div class="line"><span class="lineno"> 3735</span> </div>
<div class="line"><span class="lineno"> 3744</span>CIccPcsStepXYZToLab::CIccPcsStepXYZToLab(<span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *xyzWhite<span class="comment">/*=NULL*/</span>)</div>
<div class="line"><span class="lineno"> 3745</span>{</div>
<div class="line"><span class="lineno"> 3746</span>  <span class="keywordflow">if</span> (xyzWhite) {</div>
<div class="line"><span class="lineno"> 3747</span>    memcpy(m_xyzWhite, xyzWhite, <span class="keyword">sizeof</span>(m_xyzWhite));</div>
<div class="line"><span class="lineno"> 3748</span>  }</div>
<div class="line"><span class="lineno"> 3749</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3750</span>    memcpy(m_xyzWhite, <a class="code hl_variable" href="../../d3/df8/a00155.html#a961f0b709819f36204e7da4148c1505e">icD50XYZ</a>, <span class="keyword">sizeof</span>(m_xyzWhite));</div>
<div class="line"><span class="lineno"> 3751</span>  }</div>
<div class="line"><span class="lineno"> 3752</span>}</div>
<div class="line"><span class="lineno"> 3753</span> </div>
<div class="line"><span class="lineno"> 3754</span> </div>
<div class="line"><span class="lineno"> 3763</span><span class="keywordtype">void</span> CIccPcsStepXYZToLab::Apply(CIccApplyPcsStep *pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3764</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3765</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> Lab[3];</div>
<div class="line"><span class="lineno"> 3766</span>  <a class="code hl_function" href="../../d7/dce/a00143.html#a4ff45349385af6c19d5b3f68150a27b5">icXYZtoLab</a>(Lab, (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>*)pSrc, m_xyzWhite);</div>
<div class="line"><span class="lineno"> 3767</span>  <span class="comment">//lab4 from XYZ</span></div>
<div class="line"><span class="lineno"> 3768</span>  pDst[0] = Lab[0] / 100.0f;</div>
<div class="line"><span class="lineno"> 3769</span>  pDst[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((Lab[1] + 128.0f) / 255.0f);</div>
<div class="line"><span class="lineno"> 3770</span>  pDst[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((Lab[2] + 128.0f) / 255.0f);</div>
<div class="line"><span class="lineno"> 3771</span>}</div>
<div class="line"><span class="lineno"> 3772</span> </div>
<div class="line"><span class="lineno"> 3773</span> </div>
<div class="line"><span class="lineno"> 3782</span><span class="keywordtype">void</span> CIccPcsStepXYZToLab::dump(std::string &amp;str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3783</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3784</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepXYZToLab\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 3785</span>}</div>
<div class="line"><span class="lineno"> 3786</span> </div>
<div class="line"><span class="lineno"> 3787</span> </div>
<div class="line"><span class="lineno"> 3798</span>CIccPcsStep *CIccPcsStepXYZToLab::concat(CIccPcsStep *pNext)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3799</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3800</span>  <span class="keywordflow">if</span> (pNext &amp;&amp; pNext-&gt;GetType()==icPcsStepLabToXYZ) {</div>
<div class="line"><span class="lineno"> 3801</span>    CIccPcsLabStep *pStep = (CIccPcsLabStep *)pNext;</div>
<div class="line"><span class="lineno"> 3802</span>    <span class="keywordflow">if</span> (pStep-&gt;isSameWhite(m_xyzWhite))</div>
<div class="line"><span class="lineno"> 3803</span>      <span class="keywordflow">return</span> <span class="keyword">new</span> CIccPcsStepIdentity(3);</div>
<div class="line"><span class="lineno"> 3804</span>  }</div>
<div class="line"><span class="lineno"> 3805</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 3806</span>}</div>
<div class="line"><span class="lineno"> 3807</span> </div>
<div class="line"><span class="lineno"> 3808</span> </div>
<div class="line"><span class="lineno"> 3817</span>CIccPcsStepLab2ToXYZ::CIccPcsStepLab2ToXYZ(<span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *xyzWhite<span class="comment">/*=NULL*/</span>)</div>
<div class="line"><span class="lineno"> 3818</span>{</div>
<div class="line"><span class="lineno"> 3819</span>  <span class="keywordflow">if</span> (xyzWhite) {</div>
<div class="line"><span class="lineno"> 3820</span>    memcpy(m_xyzWhite, xyzWhite, <span class="keyword">sizeof</span>(m_xyzWhite));</div>
<div class="line"><span class="lineno"> 3821</span>  }</div>
<div class="line"><span class="lineno"> 3822</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3823</span>    memcpy(m_xyzWhite, <a class="code hl_variable" href="../../d3/df8/a00155.html#a961f0b709819f36204e7da4148c1505e">icD50XYZ</a>, <span class="keyword">sizeof</span>(m_xyzWhite));</div>
<div class="line"><span class="lineno"> 3824</span>  }</div>
<div class="line"><span class="lineno"> 3825</span>}</div>
<div class="line"><span class="lineno"> 3826</span> </div>
<div class="line"><span class="lineno"> 3835</span><span class="keywordtype">void</span> CIccPcsStepLab2ToXYZ::Apply(CIccApplyPcsStep *pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3836</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3837</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> Lab[3];</div>
<div class="line"><span class="lineno"> 3838</span> </div>
<div class="line"><span class="lineno"> 3839</span>  <span class="comment">//lab2 to XYZ</span></div>
<div class="line"><span class="lineno"> 3840</span>  Lab[0] = pSrc[0] * (65535.0f / 65280.0f) * 100.0f;</div>
<div class="line"><span class="lineno"> 3841</span>  Lab[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pSrc[1] * 65535.0f / 65280.0f * 255.0f - 128.0f);</div>
<div class="line"><span class="lineno"> 3842</span>  Lab[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pSrc[2] * 65535.0f / 65280.0f * 255.0f - 128.0f);</div>
<div class="line"><span class="lineno"> 3843</span> </div>
<div class="line"><span class="lineno"> 3844</span>  <a class="code hl_function" href="../../d7/dce/a00143.html#aaf617b49cf0d56a218cd52c840228705">icLabtoXYZ</a>(pDst, Lab, m_xyzWhite);</div>
<div class="line"><span class="lineno"> 3845</span>}</div>
<div class="line"><span class="lineno"> 3846</span> </div>
<div class="line"><span class="lineno"> 3847</span> </div>
<div class="line"><span class="lineno"> 3856</span><span class="keywordtype">void</span> CIccPcsStepLab2ToXYZ::dump(std::string &amp;str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3857</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3858</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepLab2ToXYZ\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 3859</span>}</div>
<div class="line"><span class="lineno"> 3860</span> </div>
<div class="line"><span class="lineno"> 3861</span> </div>
<div class="line"><span class="lineno"> 3872</span>CIccPcsStep *CIccPcsStepLab2ToXYZ::concat(CIccPcsStep *pNext)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3873</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3874</span>  <span class="keywordflow">if</span> (pNext) {</div>
<div class="line"><span class="lineno"> 3875</span>    <span class="keywordflow">if</span> (pNext-&gt;GetType() == icPcsStepXYZToLab2) {</div>
<div class="line"><span class="lineno"> 3876</span>      CIccPcsLabStep* pStep = (CIccPcsLabStep*)pNext;</div>
<div class="line"><span class="lineno"> 3877</span>      <span class="keywordflow">if</span> (pStep-&gt;isSameWhite(m_xyzWhite))</div>
<div class="line"><span class="lineno"> 3878</span>        <span class="keywordflow">return</span> <span class="keyword">new</span> CIccPcsStepIdentity(3);</div>
<div class="line"><span class="lineno"> 3879</span>    }</div>
<div class="line"><span class="lineno"> 3880</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pNext-&gt;GetType() == icPcsStepXYZToLab) {</div>
<div class="line"><span class="lineno"> 3881</span>      CIccPcsLabStep* pStep = (CIccPcsLabStep*)pNext;</div>
<div class="line"><span class="lineno"> 3882</span>      <span class="keywordflow">if</span> (pStep-&gt;isSameWhite(m_xyzWhite))</div>
<div class="line"><span class="lineno"> 3883</span>        <span class="keywordflow">return</span> <span class="keyword">new</span> CIccPcsStepLab2ToLab();</div>
<div class="line"><span class="lineno"> 3884</span>    }</div>
<div class="line"><span class="lineno"> 3885</span>  }</div>
<div class="line"><span class="lineno"> 3886</span> </div>
<div class="line"><span class="lineno"> 3887</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 3888</span>}</div>
<div class="line"><span class="lineno"> 3889</span> </div>
<div class="line"><span class="lineno"> 3890</span> </div>
<div class="line"><span class="lineno"> 3899</span>CIccPcsStepXYZToLab2::CIccPcsStepXYZToLab2(<span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *xyzWhite<span class="comment">/*=NULL*/</span>)</div>
<div class="line"><span class="lineno"> 3900</span>{</div>
<div class="line"><span class="lineno"> 3901</span>  <span class="keywordflow">if</span> (xyzWhite) {</div>
<div class="line"><span class="lineno"> 3902</span>    memcpy(m_xyzWhite, xyzWhite, <span class="keyword">sizeof</span>(m_xyzWhite));</div>
<div class="line"><span class="lineno"> 3903</span>  }</div>
<div class="line"><span class="lineno"> 3904</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 3905</span>    memcpy(m_xyzWhite, <a class="code hl_variable" href="../../d3/df8/a00155.html#a961f0b709819f36204e7da4148c1505e">icD50XYZ</a>, <span class="keyword">sizeof</span>(m_xyzWhite));</div>
<div class="line"><span class="lineno"> 3906</span>  }</div>
<div class="line"><span class="lineno"> 3907</span>}</div>
<div class="line"><span class="lineno"> 3908</span> </div>
<div class="line"><span class="lineno"> 3909</span> </div>
<div class="line"><span class="lineno"> 3918</span><span class="keywordtype">void</span> CIccPcsStepXYZToLab2::Apply(CIccApplyPcsStep *pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3919</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3920</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> Lab[3];</div>
<div class="line"><span class="lineno"> 3921</span>  <a class="code hl_function" href="../../d7/dce/a00143.html#a4ff45349385af6c19d5b3f68150a27b5">icXYZtoLab</a>(Lab, (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>*)pSrc, m_xyzWhite);</div>
<div class="line"><span class="lineno"> 3922</span>  <span class="comment">//lab2 from XYZ</span></div>
<div class="line"><span class="lineno"> 3923</span>  pDst[0] = (Lab[0] / 100.0f) * (65280.0f / 65535.0f);</div>
<div class="line"><span class="lineno"> 3924</span>  pDst[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((Lab[1] + 128.0f) / 255.0f) * (65280.0f / 65535.0f);</div>
<div class="line"><span class="lineno"> 3925</span>  pDst[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((Lab[2] + 128.0f) / 255.0f) * (65280.0f / 65535.0f);</div>
<div class="line"><span class="lineno"> 3926</span>}</div>
<div class="line"><span class="lineno"> 3927</span> </div>
<div class="line"><span class="lineno"> 3928</span> </div>
<div class="line"><span class="lineno"> 3937</span><span class="keywordtype">void</span> CIccPcsStepXYZToLab2::dump(std::string &amp;str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3938</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3939</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepXYZToLab2\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 3940</span>}</div>
<div class="line"><span class="lineno"> 3941</span> </div>
<div class="line"><span class="lineno"> 3942</span> </div>
<div class="line"><span class="lineno"> 3953</span>CIccPcsStep *CIccPcsStepXYZToLab2::concat(CIccPcsStep *pNext)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3954</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3955</span>  <span class="keywordflow">if</span> (pNext &amp;&amp; pNext-&gt;GetType()==icPcsStepLab2ToXYZ) {</div>
<div class="line"><span class="lineno"> 3956</span>    CIccPcsLabStep *pStep = (CIccPcsLabStep *)pNext;</div>
<div class="line"><span class="lineno"> 3957</span>    <span class="keywordflow">if</span> (pStep-&gt;isSameWhite(m_xyzWhite))</div>
<div class="line"><span class="lineno"> 3958</span>      <span class="keywordflow">return</span> <span class="keyword">new</span> CIccPcsStepIdentity(3);</div>
<div class="line"><span class="lineno"> 3959</span>  }</div>
<div class="line"><span class="lineno"> 3960</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 3961</span>}</div>
<div class="line"><span class="lineno"> 3962</span> </div>
<div class="line"><span class="lineno"> 3963</span> </div>
<div class="line"><span class="lineno"> 3972</span><span class="keywordtype">void</span> CIccPcsStepLabToLab2::Apply(CIccApplyPcsStep* pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>* pDst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>* pSrc)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3973</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3974</span>  pDst[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pSrc[0] * 65280.0f / 65535.0f);</div>
<div class="line"><span class="lineno"> 3975</span>  pDst[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pSrc[1] * 65280.0f / 65535.0f);</div>
<div class="line"><span class="lineno"> 3976</span>  pDst[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pSrc[2] * 65280.0f / 65535.0f);</div>
<div class="line"><span class="lineno"> 3977</span>}</div>
<div class="line"><span class="lineno"> 3978</span> </div>
<div class="line"><span class="lineno"> 3979</span> </div>
<div class="line"><span class="lineno"> 3988</span><span class="keywordtype">void</span> CIccPcsStepLabToLab2::dump(std::string&amp; str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 3989</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 3990</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepLabToLab2\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 3991</span>}</div>
<div class="line"><span class="lineno"> 3992</span> </div>
<div class="line"><span class="lineno"> 4003</span>CIccPcsStep* CIccPcsStepLabToLab2::concat(CIccPcsStep* pNext)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4004</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4005</span>  <span class="keywordflow">if</span> (pNext &amp;&amp; pNext-&gt;GetType() == icPcsStepLab2ToLab) {</div>
<div class="line"><span class="lineno"> 4006</span>    <span class="keywordflow">return</span> <span class="keyword">new</span> CIccPcsStepIdentity(3);</div>
<div class="line"><span class="lineno"> 4007</span>  }</div>
<div class="line"><span class="lineno"> 4008</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 4009</span>}</div>
<div class="line"><span class="lineno"> 4010</span> </div>
<div class="line"><span class="lineno"> 4011</span> </div>
<div class="line"><span class="lineno"> 4020</span><span class="keywordtype">void</span> CIccPcsStepLab2ToLab::Apply(CIccApplyPcsStep* pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>* pDst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>* pSrc)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4021</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4022</span>  pDst[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pSrc[0] * 65535.0f / 65280.0f);</div>
<div class="line"><span class="lineno"> 4023</span>  pDst[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pSrc[1] * 65535.0f / 65280.0f);</div>
<div class="line"><span class="lineno"> 4024</span>  pDst[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pSrc[2] * 65535.0f / 65280.0f);</div>
<div class="line"><span class="lineno"> 4025</span>}</div>
<div class="line"><span class="lineno"> 4026</span> </div>
<div class="line"><span class="lineno"> 4027</span> </div>
<div class="line"><span class="lineno"> 4036</span><span class="keywordtype">void</span> CIccPcsStepLab2ToLab::dump(std::string&amp; str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4037</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4038</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepLab2ToLab\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 4039</span>}</div>
<div class="line"><span class="lineno"> 4040</span> </div>
<div class="line"><span class="lineno"> 4041</span> </div>
<div class="line"><span class="lineno"> 4052</span>CIccPcsStep* CIccPcsStepLab2ToLab::concat(CIccPcsStep* pNext)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4053</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4054</span>  <span class="keywordflow">if</span> (pNext &amp;&amp; pNext-&gt;GetType() == icPcsStepLabToLab2) {</div>
<div class="line"><span class="lineno"> 4055</span>    <span class="keywordflow">return</span> <span class="keyword">new</span> CIccPcsStepIdentity(3);</div>
<div class="line"><span class="lineno"> 4056</span>  }</div>
<div class="line"><span class="lineno"> 4057</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 4058</span>}</div>
<div class="line"><span class="lineno"> 4059</span> </div>
<div class="line"><span class="lineno"> 4060</span> </div>
<div class="line"><span class="lineno"> 4069</span>CIccPcsStepOffset::CIccPcsStepOffset(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nChannels)</div>
<div class="line"><span class="lineno"> 4070</span>{</div>
<div class="line"><span class="lineno"> 4071</span>  m_nChannels = nChannels;</div>
<div class="line"><span class="lineno"> 4072</span>  m_vals = <span class="keyword">new</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>[nChannels];</div>
<div class="line"><span class="lineno"> 4073</span>}</div>
<div class="line"><span class="lineno"> 4074</span> </div>
<div class="line"><span class="lineno"> 4075</span> </div>
<div class="line"><span class="lineno"> 4084</span>CIccPcsStepOffset::~CIccPcsStepOffset()</div>
<div class="line"><span class="lineno"> 4085</span>{</div>
<div class="line"><span class="lineno"> 4086</span>  <span class="keywordflow">if</span> (m_vals)</div>
<div class="line"><span class="lineno"> 4087</span>    <span class="keyword">delete</span> [] m_vals;</div>
<div class="line"><span class="lineno"> 4088</span>}</div>
<div class="line"><span class="lineno"> 4089</span> </div>
<div class="line"><span class="lineno"> 4090</span> </div>
<div class="line"><span class="lineno"> 4099</span><span class="keywordtype">void</span> CIccPcsStepOffset::Apply(CIccApplyPcsStep *pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4100</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4101</span>  <span class="keywordflow">if</span> (m_nChannels==3) {</div>
<div class="line"><span class="lineno"> 4102</span>    pDst[0] = m_vals[0] + pSrc[0];</div>
<div class="line"><span class="lineno"> 4103</span>    pDst[1] = m_vals[1] + pSrc[1];</div>
<div class="line"><span class="lineno"> 4104</span>    pDst[2] = m_vals[2] + pSrc[2];</div>
<div class="line"><span class="lineno"> 4105</span>  }</div>
<div class="line"><span class="lineno"> 4106</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4107</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 4108</span>    <span class="keywordflow">for</span> (i=0; i&lt;m_nChannels; i++) {</div>
<div class="line"><span class="lineno"> 4109</span>      pDst[i] = m_vals[i] + pSrc[i];</div>
<div class="line"><span class="lineno"> 4110</span>    }</div>
<div class="line"><span class="lineno"> 4111</span>  }</div>
<div class="line"><span class="lineno"> 4112</span>}</div>
<div class="line"><span class="lineno"> 4113</span> </div>
<div class="line"><span class="lineno"> 4114</span> </div>
<div class="line"><span class="lineno"> 4123</span><span class="keywordtype">void</span> CIccPcsStepOffset::dump(std::string &amp;str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4124</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4125</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepOffset\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 4126</span>  <span class="keywordtype">char</span> buf[80];</div>
<div class="line"><span class="lineno"> 4127</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;m_nChannels; i++) {</div>
<div class="line"><span class="lineno"> 4128</span>    sprintf(buf, <a class="code hl_define" href="../../d3/df8/a00155.html#a09ef76f73cd16ef7b7c77358b527e816">ICCPCSSTEPDUMPFMT</a>, m_vals[i]);</div>
<div class="line"><span class="lineno"> 4129</span>    str += buf;</div>
<div class="line"><span class="lineno"> 4130</span>  }</div>
<div class="line"><span class="lineno"> 4131</span>  str +=<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 4132</span>}</div>
<div class="line"><span class="lineno"> 4133</span> </div>
<div class="line"><span class="lineno"> 4134</span> </div>
<div class="line"><span class="lineno"> 4144</span>CIccPcsStepOffset *CIccPcsStepOffset::Add(<span class="keyword">const</span> CIccPcsStepOffset *offset)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4145</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4146</span>  <span class="keywordflow">if</span> (offset-&gt;m_nChannels != m_nChannels)</div>
<div class="line"><span class="lineno"> 4147</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 4148</span> </div>
<div class="line"><span class="lineno"> 4149</span>  CIccPcsStepOffset *pNew = <span class="keyword">new</span> CIccPcsStepOffset(m_nChannels);</div>
<div class="line"><span class="lineno"> 4150</span> </div>
<div class="line"><span class="lineno"> 4151</span>  <span class="keywordflow">if</span> (pNew) {</div>
<div class="line"><span class="lineno"> 4152</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 4153</span>    <span class="keywordflow">for</span> (i=0; i&lt;m_nChannels; i++) {</div>
<div class="line"><span class="lineno"> 4154</span>      pNew-&gt;m_vals[i] = m_vals[i] + offset-&gt;m_vals[i]; </div>
<div class="line"><span class="lineno"> 4155</span>    }</div>
<div class="line"><span class="lineno"> 4156</span>  }</div>
<div class="line"><span class="lineno"> 4157</span> </div>
<div class="line"><span class="lineno"> 4158</span>  <span class="keywordflow">return</span> pNew;</div>
<div class="line"><span class="lineno"> 4159</span>}</div>
<div class="line"><span class="lineno"> 4160</span> </div>
<div class="line"><span class="lineno"> 4171</span>CIccPcsStep *CIccPcsStepOffset::concat(CIccPcsStep *pNext)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4172</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4173</span>  <span class="keywordflow">if</span> (pNext &amp;&amp; pNext-&gt;GetType()==icPcsStepOffset &amp;&amp; m_nChannels==pNext-&gt;GetSrcChannels())</div>
<div class="line"><span class="lineno"> 4174</span>    <span class="keywordflow">return</span> Add((<span class="keyword">const</span> CIccPcsStepOffset*)pNext);</div>
<div class="line"><span class="lineno"> 4175</span> </div>
<div class="line"><span class="lineno"> 4176</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 4177</span>}</div>
<div class="line"><span class="lineno"> 4178</span> </div>
<div class="line"><span class="lineno"> 4179</span> </div>
<div class="line"><span class="lineno"> 4188</span><span class="keywordtype">bool</span> CIccPcsStepOffset::isIdentity()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4189</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4190</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 4191</span>  <span class="keywordflow">for</span> (i=0; i&lt;m_nChannels; i++) {</div>
<div class="line"><span class="lineno"> 4192</span>    <span class="keywordflow">if</span> (m_vals[i]&lt;-<a class="code hl_define" href="../../dc/dfe/a00125.html#aa35e9dfb9d4807cbd014d00681934905">icNearRange</a> || m_vals[i]&gt;<a class="code hl_define" href="../../dc/dfe/a00125.html#aa35e9dfb9d4807cbd014d00681934905">icNearRange</a>)</div>
<div class="line"><span class="lineno"> 4193</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4194</span>  }</div>
<div class="line"><span class="lineno"> 4195</span> </div>
<div class="line"><span class="lineno"> 4196</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4197</span>}</div>
<div class="line"><span class="lineno"> 4198</span> </div>
<div class="line"><span class="lineno"> 4199</span> </div>
<div class="line"><span class="lineno"> 4208</span>CIccPcsStepScale::CIccPcsStepScale(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nChannels)</div>
<div class="line"><span class="lineno"> 4209</span>{</div>
<div class="line"><span class="lineno"> 4210</span>  m_nChannels = nChannels;</div>
<div class="line"><span class="lineno"> 4211</span>  m_vals = <span class="keyword">new</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>[nChannels];</div>
<div class="line"><span class="lineno"> 4212</span>}</div>
<div class="line"><span class="lineno"> 4213</span> </div>
<div class="line"><span class="lineno"> 4214</span> </div>
<div class="line"><span class="lineno"> 4223</span>CIccPcsStepScale::~CIccPcsStepScale()</div>
<div class="line"><span class="lineno"> 4224</span>{</div>
<div class="line"><span class="lineno"> 4225</span>  <span class="keywordflow">if</span> (m_vals)</div>
<div class="line"><span class="lineno"> 4226</span>    <span class="keyword">delete</span> [] m_vals;</div>
<div class="line"><span class="lineno"> 4227</span>}</div>
<div class="line"><span class="lineno"> 4228</span> </div>
<div class="line"><span class="lineno"> 4237</span><span class="keywordtype">void</span> CIccPcsStepScale::Apply(CIccApplyPcsStep *pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4238</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4239</span>  <span class="keywordflow">if</span> (m_nChannels==3) {</div>
<div class="line"><span class="lineno"> 4240</span>    pDst[0] = m_vals[0] * pSrc[0];</div>
<div class="line"><span class="lineno"> 4241</span>    pDst[1] = m_vals[1] * pSrc[1];</div>
<div class="line"><span class="lineno"> 4242</span>    pDst[2] = m_vals[2] * pSrc[2];</div>
<div class="line"><span class="lineno"> 4243</span>  }</div>
<div class="line"><span class="lineno"> 4244</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4245</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 4246</span>    <span class="keywordflow">for</span> (i=0; i&lt;m_nChannels; i++) {</div>
<div class="line"><span class="lineno"> 4247</span>      pDst[i] = m_vals[i] * pSrc[i];</div>
<div class="line"><span class="lineno"> 4248</span>    }</div>
<div class="line"><span class="lineno"> 4249</span>  }</div>
<div class="line"><span class="lineno"> 4250</span>}</div>
<div class="line"><span class="lineno"> 4251</span> </div>
<div class="line"><span class="lineno"> 4252</span> </div>
<div class="line"><span class="lineno"> 4261</span><span class="keywordtype">void</span> CIccPcsStepScale::dump(std::string &amp;str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4262</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4263</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepScale\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 4264</span>  <span class="keywordtype">char</span> buf[80];</div>
<div class="line"><span class="lineno"> 4265</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;m_nChannels; i++) {</div>
<div class="line"><span class="lineno"> 4266</span>    sprintf(buf, <a class="code hl_define" href="../../d3/df8/a00155.html#a09ef76f73cd16ef7b7c77358b527e816">ICCPCSSTEPDUMPFMT</a>, m_vals[i]);</div>
<div class="line"><span class="lineno"> 4267</span>    str += buf;</div>
<div class="line"><span class="lineno"> 4268</span>  }</div>
<div class="line"><span class="lineno"> 4269</span>  str +=<span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 4270</span>}</div>
<div class="line"><span class="lineno"> 4271</span> </div>
<div class="line"><span class="lineno"> 4272</span> </div>
<div class="line"><span class="lineno"> 4282</span>CIccPcsStepScale *CIccPcsStepScale::Mult(<span class="keyword">const</span> CIccPcsStepScale *scale)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4283</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4284</span>  <span class="keywordflow">if</span> (scale-&gt;m_nChannels != m_nChannels)</div>
<div class="line"><span class="lineno"> 4285</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 4286</span> </div>
<div class="line"><span class="lineno"> 4287</span>  CIccPcsStepScale *pNew = <span class="keyword">new</span> CIccPcsStepScale(m_nChannels);</div>
<div class="line"><span class="lineno"> 4288</span> </div>
<div class="line"><span class="lineno"> 4289</span>  <span class="keywordflow">if</span> (pNew) {</div>
<div class="line"><span class="lineno"> 4290</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 4291</span>    <span class="keywordflow">for</span> (i=0; i&lt;m_nChannels; i++) {</div>
<div class="line"><span class="lineno"> 4292</span>      pNew-&gt;m_vals[i] = m_vals[i] * scale-&gt;m_vals[i]; </div>
<div class="line"><span class="lineno"> 4293</span>    }</div>
<div class="line"><span class="lineno"> 4294</span>  }</div>
<div class="line"><span class="lineno"> 4295</span>  <span class="keywordflow">return</span> pNew;</div>
<div class="line"><span class="lineno"> 4296</span>}</div>
<div class="line"><span class="lineno"> 4297</span> </div>
<div class="line"><span class="lineno"> 4307</span>CIccPcsStepMatrix *CIccPcsStepScale::Mult(<span class="keyword">const</span> CIccPcsStepMatrix *matrix)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4308</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4309</span>  <span class="keywordflow">if</span> (matrix-&gt;GetSrcChannels() != m_nChannels)</div>
<div class="line"><span class="lineno"> 4310</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 4311</span> </div>
<div class="line"><span class="lineno"> 4312</span>  CIccPcsStepMatrix *pNew = <span class="keyword">new</span> CIccPcsStepMatrix(matrix-&gt;GetDstChannels(), matrix-&gt;GetSrcChannels());</div>
<div class="line"><span class="lineno"> 4313</span> </div>
<div class="line"><span class="lineno"> 4314</span>  <span class="keywordflow">if</span> (pNew) {</div>
<div class="line"><span class="lineno"> 4315</span>    <span class="keywordtype">int</span> i, j;</div>
<div class="line"><span class="lineno"> 4316</span>    <span class="keywordflow">for</span> (j=0; j&lt;matrix-&gt;GetDstChannels(); j++) {</div>
<div class="line"><span class="lineno"> 4317</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *row = matrix-&gt;entry(j);</div>
<div class="line"><span class="lineno"> 4318</span>      <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *to=pNew-&gt;entry(j);</div>
<div class="line"><span class="lineno"> 4319</span> </div>
<div class="line"><span class="lineno"> 4320</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_nChannels; i++) {</div>
<div class="line"><span class="lineno"> 4321</span>        to[i] = m_vals[i] * row[i]; </div>
<div class="line"><span class="lineno"> 4322</span>      }</div>
<div class="line"><span class="lineno"> 4323</span>    }</div>
<div class="line"><span class="lineno"> 4324</span>  }</div>
<div class="line"><span class="lineno"> 4325</span> </div>
<div class="line"><span class="lineno"> 4326</span>  <span class="keywordflow">return</span> pNew;</div>
<div class="line"><span class="lineno"> 4327</span>}</div>
<div class="line"><span class="lineno"> 4328</span> </div>
<div class="line"><span class="lineno"> 4338</span>CIccPcsStepMatrix *CIccPcsStepScale::Mult(<span class="keyword">const</span> <a class="code hl_class" href="../../d0/d82/a00857.html">CIccMpeMatrix</a> *matrix)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4339</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4340</span>  <span class="keywordflow">if</span> (matrix-&gt;<a class="code hl_function" href="../../dd/d43/a01193.html#a0e7393d937cb768d52265a7ebed2b3a9">NumInputChannels</a>() != m_nChannels)</div>
<div class="line"><span class="lineno"> 4341</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 4342</span> </div>
<div class="line"><span class="lineno"> 4343</span>  CIccPcsStepMatrix *pNew = <span class="keyword">new</span> CIccPcsStepMatrix(matrix-&gt;<a class="code hl_function" href="../../dd/d43/a01193.html#a431d2d96c834f4f9b0674dafe8609ae1">NumOutputChannels</a>(), matrix-&gt;<a class="code hl_function" href="../../dd/d43/a01193.html#a0e7393d937cb768d52265a7ebed2b3a9">NumInputChannels</a>());</div>
<div class="line"><span class="lineno"> 4344</span> </div>
<div class="line"><span class="lineno"> 4345</span>  <span class="keywordflow">if</span> (pNew) {</div>
<div class="line"><span class="lineno"> 4346</span>    <span class="keywordtype">int</span> i, j;</div>
<div class="line"><span class="lineno"> 4347</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *mtx = matrix-&gt;<a class="code hl_function" href="../../d0/d82/a00857.html#a8caea712089acbdd830b1fa29d10aa8c">GetMatrix</a>();</div>
<div class="line"><span class="lineno"> 4348</span>    <span class="keywordflow">for</span> (j = 0; j &lt; matrix-&gt;<a class="code hl_function" href="../../dd/d43/a01193.html#a431d2d96c834f4f9b0674dafe8609ae1">NumOutputChannels</a>(); j++) {</div>
<div class="line"><span class="lineno"> 4349</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *row = &amp;mtx[j*matrix-&gt;<a class="code hl_function" href="../../dd/d43/a01193.html#a0e7393d937cb768d52265a7ebed2b3a9">NumInputChannels</a>()];</div>
<div class="line"><span class="lineno"> 4350</span>      <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *to = pNew-&gt;entry(j);</div>
<div class="line"><span class="lineno"> 4351</span> </div>
<div class="line"><span class="lineno"> 4352</span>      <span class="keywordflow">for</span> (i = 0; i &lt; m_nChannels; i++) {</div>
<div class="line"><span class="lineno"> 4353</span>        to[i] = m_vals[i] * row[i];</div>
<div class="line"><span class="lineno"> 4354</span>      }</div>
<div class="line"><span class="lineno"> 4355</span>    }</div>
<div class="line"><span class="lineno"> 4356</span>  }</div>
<div class="line"><span class="lineno"> 4357</span> </div>
<div class="line"><span class="lineno"> 4358</span>  <span class="keywordflow">return</span> pNew;</div>
<div class="line"><span class="lineno"> 4359</span>}</div>
<div class="line"><span class="lineno"> 4360</span> </div>
<div class="line"><span class="lineno"> 4361</span> </div>
<div class="line"><span class="lineno"> 4372</span>CIccPcsStep *CIccPcsStepScale::concat(CIccPcsStep *pNext)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4373</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4374</span>  <span class="keywordflow">if</span> (pNext) {</div>
<div class="line"><span class="lineno"> 4375</span>    <span class="keywordflow">if</span> (pNext-&gt;GetType()==icPcsStepScale &amp;&amp; m_nChannels==pNext-&gt;GetSrcChannels())</div>
<div class="line"><span class="lineno"> 4376</span>      <span class="keywordflow">return</span> Mult((<span class="keyword">const</span> CIccPcsStepScale*)pNext);</div>
<div class="line"><span class="lineno"> 4377</span>    <span class="keywordflow">if</span> (pNext-&gt;GetType()==icPcsStepMatrix &amp;&amp; m_nChannels==pNext-&gt;GetSrcChannels())</div>
<div class="line"><span class="lineno"> 4378</span>      <span class="keywordflow">return</span> Mult((<span class="keyword">const</span> CIccPcsStepMatrix*)pNext);</div>
<div class="line"><span class="lineno"> 4379</span>    <span class="keywordflow">if</span> (pNext-&gt;GetType() == icPcsStepMpe &amp;&amp; m_nChannels == pNext-&gt;GetSrcChannels()) {</div>
<div class="line"><span class="lineno"> 4380</span>      CIccPcsStepMpe *pMpe = (CIccPcsStepMpe*)pNext;</div>
<div class="line"><span class="lineno"> 4381</span>      <a class="code hl_class" href="../../d0/d82/a00857.html">CIccMpeMatrix</a> *pMatrix = pMpe-&gt;<a class="code hl_function" href="../../d0/d82/a00857.html#a8caea712089acbdd830b1fa29d10aa8c">GetMatrix</a>();</div>
<div class="line"><span class="lineno"> 4382</span>      <span class="keywordflow">if</span> (pMatrix)</div>
<div class="line"><span class="lineno"> 4383</span>        <span class="keywordflow">return</span> Mult(pMatrix);</div>
<div class="line"><span class="lineno"> 4384</span>    }</div>
<div class="line"><span class="lineno"> 4385</span>  }</div>
<div class="line"><span class="lineno"> 4386</span> </div>
<div class="line"><span class="lineno"> 4387</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 4388</span>}</div>
<div class="line"><span class="lineno"> 4389</span> </div>
<div class="line"><span class="lineno"> 4390</span> </div>
<div class="line"><span class="lineno"> 4399</span><span class="keywordtype">bool</span> CIccPcsStepScale::isIdentity()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4400</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4401</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 4402</span>  <span class="keywordflow">for</span> (i=0; i&lt;m_nChannels; i++) {</div>
<div class="line"><span class="lineno"> 4403</span>    <span class="keywordflow">if</span> (m_vals[i]&lt;1.0f-<a class="code hl_define" href="../../dc/dfe/a00125.html#aa35e9dfb9d4807cbd014d00681934905">icNearRange</a> || m_vals[i]&gt;1.0f+<a class="code hl_define" href="../../dc/dfe/a00125.html#aa35e9dfb9d4807cbd014d00681934905">icNearRange</a>)</div>
<div class="line"><span class="lineno"> 4404</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4405</span>  }</div>
<div class="line"><span class="lineno"> 4406</span> </div>
<div class="line"><span class="lineno"> 4407</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4408</span>}</div>
<div class="line"><span class="lineno"> 4409</span> </div>
<div class="line"><span class="lineno"> 4410</span> </div>
<div class="line"><span class="lineno"> 4411</span> </div>
<div class="line"><span class="lineno"> 4420</span><span class="keywordtype">void</span> CIccPcsStepMatrix::dump(std::string &amp;str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4421</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4422</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepMatrix\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 4423</span>  dumpMtx(str);</div>
<div class="line"><span class="lineno"> 4424</span>}</div>
<div class="line"><span class="lineno"> 4425</span> </div>
<div class="line"><span class="lineno"> 4426</span> </div>
<div class="line"><span class="lineno"> 4436</span>CIccPcsStepMatrix *CIccPcsStepMatrix::Mult(<span class="keyword">const</span> CIccPcsStepScale *scale)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4437</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4438</span>  <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> mCols = scale-&gt;GetSrcChannels();</div>
<div class="line"><span class="lineno"> 4439</span>  <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> mRows = mCols;</div>
<div class="line"><span class="lineno"> 4440</span> </div>
<div class="line"><span class="lineno"> 4441</span>  <span class="keywordflow">if</span> (m_nRows != mCols)</div>
<div class="line"><span class="lineno"> 4442</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 4443</span> </div>
<div class="line"><span class="lineno"> 4444</span>  CIccPcsStepMatrix *pNew = <span class="keyword">new</span> CIccPcsStepMatrix(m_nRows, m_nCols);</div>
<div class="line"><span class="lineno"> 4445</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *data = scale-&gt;data();</div>
<div class="line"><span class="lineno"> 4446</span> </div>
<div class="line"><span class="lineno"> 4447</span>  <span class="keywordtype">int</span> i, j;</div>
<div class="line"><span class="lineno"> 4448</span>  <span class="keywordflow">for</span> (j=0; j&lt;m_nRows; j++) {</div>
<div class="line"><span class="lineno"> 4449</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *row = entry(j);</div>
<div class="line"><span class="lineno"> 4450</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *to = pNew-&gt;entry(j);</div>
<div class="line"><span class="lineno"> 4451</span>    <span class="keywordflow">for</span> (i=0; i&lt;m_nCols; i++) {</div>
<div class="line"><span class="lineno"> 4452</span>      to[i] = data[j] * row[i];</div>
<div class="line"><span class="lineno"> 4453</span>    }</div>
<div class="line"><span class="lineno"> 4454</span>  }</div>
<div class="line"><span class="lineno"> 4455</span> </div>
<div class="line"><span class="lineno"> 4456</span>  <span class="keywordflow">return</span> pNew;</div>
<div class="line"><span class="lineno"> 4457</span>}</div>
<div class="line"><span class="lineno"> 4458</span> </div>
<div class="line"><span class="lineno"> 4468</span>CIccPcsStepMatrix *CIccPcsStepMatrix::Mult(<span class="keyword">const</span> CIccPcsStepMatrix *matrix)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4469</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4470</span>  <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> mCols = matrix-&gt;m_nCols;</div>
<div class="line"><span class="lineno"> 4471</span>  <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> mRows = matrix-&gt;m_nRows;</div>
<div class="line"><span class="lineno"> 4472</span> </div>
<div class="line"><span class="lineno"> 4473</span>  <span class="keywordflow">if</span> (m_nRows != mCols)</div>
<div class="line"><span class="lineno"> 4474</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 4475</span> </div>
<div class="line"><span class="lineno"> 4476</span>  CIccPcsStepMatrix *pNew = <span class="keyword">new</span> CIccPcsStepMatrix(mRows, m_nCols);</div>
<div class="line"><span class="lineno"> 4477</span> </div>
<div class="line"><span class="lineno"> 4478</span>  <span class="keywordtype">int</span> i, j, k;</div>
<div class="line"><span class="lineno"> 4479</span>  <span class="keywordflow">for</span> (j=0; j&lt;mRows; j++) {</div>
<div class="line"><span class="lineno"> 4480</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *row = matrix-&gt;entry(j);</div>
<div class="line"><span class="lineno"> 4481</span>    <span class="keywordflow">for</span> (i=0; i&lt;m_nCols; i++) {</div>
<div class="line"><span class="lineno"> 4482</span>      <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *to = pNew-&gt;entry(j, i);</div>
<div class="line"><span class="lineno"> 4483</span>      <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *from = entry(0, i);</div>
<div class="line"><span class="lineno"> 4484</span> </div>
<div class="line"><span class="lineno"> 4485</span>      *to = 0.0f;</div>
<div class="line"><span class="lineno"> 4486</span>      <span class="keywordflow">for</span> (k=0; k&lt;m_nRows; k++) {</div>
<div class="line"><span class="lineno"> 4487</span>        *to += row[k] * (*from);</div>
<div class="line"><span class="lineno"> 4488</span>        from += m_nCols;</div>
<div class="line"><span class="lineno"> 4489</span>      }</div>
<div class="line"><span class="lineno"> 4490</span>    }</div>
<div class="line"><span class="lineno"> 4491</span>  }</div>
<div class="line"><span class="lineno"> 4492</span> </div>
<div class="line"><span class="lineno"> 4493</span>  <span class="keywordflow">return</span> pNew;</div>
<div class="line"><span class="lineno"> 4494</span>}</div>
<div class="line"><span class="lineno"> 4495</span> </div>
<div class="line"><span class="lineno"> 4496</span> </div>
<div class="line"><span class="lineno"> 4507</span>CIccPcsStep *CIccPcsStepMatrix::concat(CIccPcsStep *pNext)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4508</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4509</span>  <span class="keywordflow">if</span> (pNext) {</div>
<div class="line"><span class="lineno"> 4510</span>    <span class="keywordflow">if</span> (pNext-&gt;GetType()==icPcsStepScale &amp;&amp; GetDstChannels()==pNext-&gt;GetSrcChannels())</div>
<div class="line"><span class="lineno"> 4511</span>      <span class="keywordflow">return</span> Mult((<span class="keyword">const</span> CIccPcsStepScale*)pNext);</div>
<div class="line"><span class="lineno"> 4512</span>    <span class="keywordflow">if</span> (pNext-&gt;GetType()==icPcsStepMatrix &amp;&amp; GetDstChannels()==pNext-&gt;GetSrcChannels())</div>
<div class="line"><span class="lineno"> 4513</span>      <span class="keywordflow">return</span> Mult((<span class="keyword">const</span> CIccPcsStepMatrix*)pNext);</div>
<div class="line"><span class="lineno"> 4514</span>  }</div>
<div class="line"><span class="lineno"> 4515</span> </div>
<div class="line"><span class="lineno"> 4516</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 4517</span>}</div>
<div class="line"><span class="lineno"> 4518</span> </div>
<div class="line"><span class="lineno"> 4529</span>CIccPcsStep *CIccPcsStepMatrix::reduce()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4530</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4531</span>  <span class="keywordtype">int</span> nVals = m_nRows*m_nCols;</div>
<div class="line"><span class="lineno"> 4532</span>  <span class="keywordtype">int</span> nNonZeros = 0;</div>
<div class="line"><span class="lineno"> 4533</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 4534</span> </div>
<div class="line"><span class="lineno"> 4535</span>  <span class="keywordflow">for</span> (i=0; i&lt;nVals; i++) {</div>
<div class="line"><span class="lineno"> 4536</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> v = m_vals[i];</div>
<div class="line"><span class="lineno"> 4537</span>    <span class="keywordflow">if</span> (<a class="code hl_define" href="../../d7/dce/a00143.html#af798ee3250b2d1add99b57064aaf1961">icNotZero</a>(v))</div>
<div class="line"><span class="lineno"> 4538</span>      nNonZeros++;</div>
<div class="line"><span class="lineno"> 4539</span>  }</div>
<div class="line"><span class="lineno"> 4540</span>  <span class="keywordflow">if</span> (nNonZeros&lt;nVals*3/4) {</div>
<div class="line"><span class="lineno"> 4541</span>    <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> nMatrixBytes = <a class="code hl_function" href="../../d6/dad/a00941.html#a966b1ee488c4648da2c84b4484e7ff4a">CIccSparseMatrix::MemSize</a>(nNonZeros, m_nRows, <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>))+4*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>);</div>
<div class="line"><span class="lineno"> 4542</span>    CIccPcsStepSparseMatrix *pMtx = <span class="keyword">new</span> CIccPcsStepSparseMatrix(m_nRows, m_nCols, nMatrixBytes);</div>
<div class="line"><span class="lineno"> 4543</span>    <a class="code hl_class" href="../../d6/dad/a00941.html">CIccSparseMatrix</a> mtx(pMtx-&gt;data(), nMatrixBytes);</div>
<div class="line"><span class="lineno"> 4544</span>    mtx.Init(m_nRows, m_nCols, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 4545</span>    mtx.FillFromFullMatrix(m_vals);</div>
<div class="line"><span class="lineno"> 4546</span>    <span class="keywordflow">return</span> pMtx;</div>
<div class="line"><span class="lineno"> 4547</span>  }</div>
<div class="line"><span class="lineno"> 4548</span> </div>
<div class="line"><span class="lineno"> 4549</span>  <span class="keywordflow">return</span> (CIccPcsStep*)<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno"> 4550</span>}</div>
<div class="line"><span class="lineno"> 4551</span> </div>
<div class="line"><span class="lineno"> 4552</span> </div>
<div class="line"><span class="lineno"> 4553</span> </div>
<div class="line"><span class="lineno"> 4562</span>CIccPcsStepMpe::CIccPcsStepMpe(<a class="code hl_class" href="../../d5/d54/a01213.html">CIccTagMultiProcessElement</a> *pMpe)</div>
<div class="line"><span class="lineno"> 4563</span>{</div>
<div class="line"><span class="lineno"> 4564</span>  m_pMpe = pMpe;</div>
<div class="line"><span class="lineno"> 4565</span>}</div>
<div class="line"><span class="lineno"> 4566</span> </div>
<div class="line"><span class="lineno"> 4567</span> </div>
<div class="line"><span class="lineno"> 4576</span>CIccPcsStepMpe::~CIccPcsStepMpe()</div>
<div class="line"><span class="lineno"> 4577</span>{</div>
<div class="line"><span class="lineno"> 4578</span>  <span class="keywordflow">if</span> (m_pMpe)</div>
<div class="line"><span class="lineno"> 4579</span>    <span class="keyword">delete</span> m_pMpe;</div>
<div class="line"><span class="lineno"> 4580</span>}</div>
<div class="line"><span class="lineno"> 4581</span> </div>
<div class="line"><span class="lineno"> 4582</span> </div>
<div class="line"><span class="lineno"> 4591</span>CIccApplyPcsStep* CIccPcsStepMpe::GetNewApply()</div>
<div class="line"><span class="lineno"> 4592</span>{</div>
<div class="line"><span class="lineno"> 4593</span>  CIccApplyPcsStepMpe *rv = <span class="keyword">new</span> CIccApplyPcsStepMpe(<span class="keyword">this</span>, m_pMpe-&gt;GetNewApply());</div>
<div class="line"><span class="lineno"> 4594</span> </div>
<div class="line"><span class="lineno"> 4595</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 4596</span>}</div>
<div class="line"><span class="lineno"> 4597</span> </div>
<div class="line"><span class="lineno"> 4598</span> </div>
<div class="line"><span class="lineno"> 4607</span><span class="keywordtype">void</span> CIccPcsStepMpe::Apply(CIccApplyPcsStep *pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4608</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4609</span>  CIccApplyPcsStepMpe *pMpeApply = (CIccApplyPcsStepMpe*)pApply;</div>
<div class="line"><span class="lineno"> 4610</span> </div>
<div class="line"><span class="lineno"> 4611</span>  m_pMpe-&gt;Apply(pMpeApply-&gt;m_pApply, pDst, pSrc);</div>
<div class="line"><span class="lineno"> 4612</span>}</div>
<div class="line"><span class="lineno"> 4613</span> </div>
<div class="line"><span class="lineno"> 4614</span> </div>
<div class="line"><span class="lineno"> 4623</span><span class="keywordtype">void</span> CIccPcsStepMpe::dump(std::string &amp;str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4624</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4625</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepMpe\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 4626</span>  m_pMpe-&gt;Describe(str, 100); <span class="comment">// TODO propogate nVerboseness </span></div>
<div class="line"><span class="lineno"> 4627</span>}</div>
<div class="line"><span class="lineno"> 4628</span> </div>
<div class="line"><span class="lineno"> 4629</span> </div>
<div class="line"><span class="lineno"> 4638</span><span class="keywordtype">bool</span> CIccPcsStepMpe::isIdentity()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4639</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4640</span>  <span class="keywordflow">if</span> (!m_pMpe || !m_pMpe-&gt;NumElements())</div>
<div class="line"><span class="lineno"> 4641</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4642</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4643</span>}</div>
<div class="line"><span class="lineno"> 4644</span> </div>
<div class="line"><span class="lineno"> 4654</span><a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> CIccPcsStepMpe::GetSrcChannels()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4655</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4656</span>  <span class="keywordflow">return</span> m_pMpe-&gt;NumInputChannels();</div>
<div class="line"><span class="lineno"> 4657</span>}</div>
<div class="line"><span class="lineno"> 4658</span> </div>
<div class="line"><span class="lineno"> 4659</span> </div>
<div class="line"><span class="lineno"> 4669</span><a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> CIccPcsStepMpe::GetDstChannels()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4670</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4671</span>  <span class="keywordflow">return</span> m_pMpe-&gt;NumOutputChannels();</div>
<div class="line"><span class="lineno"> 4672</span>}</div>
<div class="line"><span class="lineno"> 4673</span> </div>
<div class="line"><span class="lineno"> 4674</span> </div>
<div class="line"><span class="lineno"> 4684</span><a class="code hl_class" href="../../d0/d82/a00857.html">CIccMpeMatrix</a> *CIccPcsStepMpe::GetMatrix()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4685</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4686</span>  <span class="comment">//Must be single element</span></div>
<div class="line"><span class="lineno"> 4687</span>  <span class="keywordflow">if</span> (m_pMpe-&gt;NumElements() == 1) {</div>
<div class="line"><span class="lineno"> 4688</span>    <a class="code hl_class" href="../../dd/d43/a01193.html">CIccMultiProcessElement</a> *pElem = m_pMpe-&gt;GetElement(0);</div>
<div class="line"><span class="lineno"> 4689</span>    <span class="comment">//Must be a matrix</span></div>
<div class="line"><span class="lineno"> 4690</span>    <span class="keywordflow">if</span> (pElem &amp;&amp; pElem-&gt;<a class="code hl_function" href="../../dd/d43/a01193.html#abc48ee629f3d2102bfdd5c03891b37e1">GetType</a>() == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a5dbecf663e56b6445a7f199306ee1b4da9f1d5e498c47af2a0e0be3fa029970fe">icSigMatrixElemType</a>) {</div>
<div class="line"><span class="lineno"> 4691</span>      <a class="code hl_class" href="../../d0/d82/a00857.html">CIccMpeMatrix</a> *pMtx = (<a class="code hl_class" href="../../d0/d82/a00857.html">CIccMpeMatrix</a>*)pElem;</div>
<div class="line"><span class="lineno"> 4692</span> </div>
<div class="line"><span class="lineno"> 4693</span>      <span class="comment">//Should not apply any constants</span></div>
<div class="line"><span class="lineno"> 4694</span>      <span class="keywordflow">if</span> (!pMtx-&gt;<a class="code hl_function" href="../../d0/d82/a00857.html#a02f8ec1722ad1f16f5ea3efa7b241f91">GetConstants</a>() || !pMtx-&gt;<a class="code hl_function" href="../../d0/d82/a00857.html#adbf9791bb07086c6e6770d1914817663">GetApplyConstants</a>())</div>
<div class="line"><span class="lineno"> 4695</span>        <span class="keywordflow">return</span> pMtx;</div>
<div class="line"><span class="lineno"> 4696</span>    }</div>
<div class="line"><span class="lineno"> 4697</span>  }</div>
<div class="line"><span class="lineno"> 4698</span> </div>
<div class="line"><span class="lineno"> 4699</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 4700</span>}</div>
<div class="line"><span class="lineno"> 4701</span> </div>
<div class="line"><span class="lineno"> 4702</span> </div>
<div class="line"><span class="lineno"> 4703</span> </div>
<div class="line"><span class="lineno"> 4704</span> </div>
<div class="line"><span class="lineno"> 4714</span><span class="keywordtype">bool</span> CIccPcsStepMpe::Begin()</div>
<div class="line"><span class="lineno"> 4715</span>{</div>
<div class="line"><span class="lineno"> 4716</span>  <span class="keywordflow">return</span> m_pMpe-&gt;<a class="code hl_function" href="../../d0/d82/a00857.html#a6e45463a693a93771269d03b6c5ccd53">Begin</a>();</div>
<div class="line"><span class="lineno"> 4717</span>}</div>
<div class="line"><span class="lineno"> 4718</span> </div>
<div class="line"><span class="lineno"> 4719</span> </div>
<div class="line"><span class="lineno"> 4728</span>CIccPcsStepSrcMatrix::CIccPcsStepSrcMatrix(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nRows, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nCols)</div>
<div class="line"><span class="lineno"> 4729</span>{</div>
<div class="line"><span class="lineno"> 4730</span>  m_nRows = nRows;</div>
<div class="line"><span class="lineno"> 4731</span>  m_nCols = nCols;</div>
<div class="line"><span class="lineno"> 4732</span>  m_vals = <span class="keyword">new</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>[nCols];</div>
<div class="line"><span class="lineno"> 4733</span>}</div>
<div class="line"><span class="lineno"> 4734</span> </div>
<div class="line"><span class="lineno"> 4735</span> </div>
<div class="line"><span class="lineno"> 4744</span>CIccPcsStepSrcMatrix::~CIccPcsStepSrcMatrix()</div>
<div class="line"><span class="lineno"> 4745</span>{</div>
<div class="line"><span class="lineno"> 4746</span>  <span class="keywordflow">if</span> (m_vals)</div>
<div class="line"><span class="lineno"> 4747</span>    <span class="keyword">delete</span> m_vals;</div>
<div class="line"><span class="lineno"> 4748</span>}</div>
<div class="line"><span class="lineno"> 4749</span> </div>
<div class="line"><span class="lineno"> 4750</span> </div>
<div class="line"><span class="lineno"> 4760</span><span class="keywordtype">void</span> CIccPcsStepSrcMatrix::Apply(CIccApplyPcsStep *pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4761</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4762</span>  <span class="keywordtype">int</span> i, j;</div>
<div class="line"><span class="lineno"> 4763</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *row = pSrc;</div>
<div class="line"><span class="lineno"> 4764</span>  <span class="keywordflow">for</span> (j=0; j&lt;m_nRows; j++) {</div>
<div class="line"><span class="lineno"> 4765</span>    pDst[j] = 0.0f;</div>
<div class="line"><span class="lineno"> 4766</span>    <span class="keywordflow">for</span> (i=0; i&lt;m_nCols; i++) {</div>
<div class="line"><span class="lineno"> 4767</span>      pDst[j] += row[i] * m_vals[i];</div>
<div class="line"><span class="lineno"> 4768</span>    }</div>
<div class="line"><span class="lineno"> 4769</span>    row += m_nCols;</div>
<div class="line"><span class="lineno"> 4770</span>  }</div>
<div class="line"><span class="lineno"> 4771</span>}</div>
<div class="line"><span class="lineno"> 4772</span> </div>
<div class="line"><span class="lineno"> 4773</span> </div>
<div class="line"><span class="lineno"> 4782</span><span class="keywordtype">void</span> CIccPcsStepSrcMatrix::dump(std::string &amp;str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4783</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4784</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepSrcMatrix\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 4785</span>  <span class="keywordtype">char</span> buf[80];</div>
<div class="line"><span class="lineno"> 4786</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;m_nCols; i++) {</div>
<div class="line"><span class="lineno"> 4787</span>    sprintf(buf, <a class="code hl_define" href="../../d3/df8/a00155.html#a09ef76f73cd16ef7b7c77358b527e816">ICCPCSSTEPDUMPFMT</a>, m_vals[i]);</div>
<div class="line"><span class="lineno"> 4788</span>    str += buf;</div>
<div class="line"><span class="lineno"> 4789</span>  }</div>
<div class="line"><span class="lineno"> 4790</span>  str += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 4791</span>}</div>
<div class="line"><span class="lineno"> 4792</span> </div>
<div class="line"><span class="lineno"> 4793</span> </div>
<div class="line"><span class="lineno"> 4802</span>CIccPcsStepSparseMatrix::CIccPcsStepSparseMatrix(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nRows, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nCols, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> nBytesPerMatrix)</div>
<div class="line"><span class="lineno"> 4803</span>{</div>
<div class="line"><span class="lineno"> 4804</span>  m_nRows = nRows;</div>
<div class="line"><span class="lineno"> 4805</span>  m_nCols = nCols;</div>
<div class="line"><span class="lineno"> 4806</span>  m_nBytesPerMatrix = nBytesPerMatrix;</div>
<div class="line"><span class="lineno"> 4807</span>  m_nChannels = 0;</div>
<div class="line"><span class="lineno"> 4808</span>  m_vals = <span class="keyword">new</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>[m_nBytesPerMatrix/<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)];</div>
<div class="line"><span class="lineno"> 4809</span>}</div>
<div class="line"><span class="lineno"> 4810</span> </div>
<div class="line"><span class="lineno"> 4811</span> </div>
<div class="line"><span class="lineno"> 4820</span>CIccPcsStepSparseMatrix::~CIccPcsStepSparseMatrix()</div>
<div class="line"><span class="lineno"> 4821</span>{</div>
<div class="line"><span class="lineno"> 4822</span>  <span class="keywordflow">if</span> (m_vals)</div>
<div class="line"><span class="lineno"> 4823</span>    <span class="keyword">delete</span> [] m_vals;</div>
<div class="line"><span class="lineno"> 4824</span>}</div>
<div class="line"><span class="lineno"> 4825</span> </div>
<div class="line"><span class="lineno"> 4826</span> </div>
<div class="line"><span class="lineno"> 4836</span><span class="keywordtype">void</span> CIccPcsStepSparseMatrix::Apply(CIccApplyPcsStep *pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4837</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4838</span>  <a class="code hl_class" href="../../d6/dad/a00941.html">CIccSparseMatrix</a> mtx((<a class="code hl_typedef" href="../../d7/d46/a00002.html#a0462ca2992be7c80b056e640a192b325">icUInt8Number</a>*)m_vals, m_nBytesPerMatrix, <a class="code hl_define" href="../../d7/d46/a00002.html#a5bc58d64df71e86546c9f40fe5fefa06">icSparseMatrixFloatNum</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 4839</span> </div>
<div class="line"><span class="lineno"> 4840</span>  mtx.MultiplyVector(pDst, pSrc);</div>
<div class="line"><span class="lineno"> 4841</span>}</div>
<div class="line"><span class="lineno"> 4842</span> </div>
<div class="line"><span class="lineno"> 4843</span> </div>
<div class="line"><span class="lineno"> 4852</span><span class="keywordtype">void</span> CIccPcsStepSparseMatrix::dump(std::string &amp;str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4853</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4854</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepSparseMatrix\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 4855</span><span class="comment">//   char buf[80];</span></div>
<div class="line"><span class="lineno"> 4856</span><span class="comment">//   for (int i=0; i&lt;m_nCols; i++) {</span></div>
<div class="line"><span class="lineno"> 4857</span><span class="comment">//     sprintf(buf, ICCPCSSTEPDUMPFMT, m_vals[i]);</span></div>
<div class="line"><span class="lineno"> 4858</span><span class="comment">//     str += buf;</span></div>
<div class="line"><span class="lineno"> 4859</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno"> 4860</span><span class="comment">//   str += &quot;\n&quot;;</span></div>
<div class="line"><span class="lineno"> 4861</span>}</div>
<div class="line"><span class="lineno"> 4862</span> </div>
<div class="line"><span class="lineno"> 4863</span> </div>
<div class="line"><span class="lineno"> 4872</span>CIccPcsStepSrcSparseMatrix::CIccPcsStepSrcSparseMatrix(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nRows, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nCols, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nChannels)</div>
<div class="line"><span class="lineno"> 4873</span>{</div>
<div class="line"><span class="lineno"> 4874</span>  m_nRows = nRows;</div>
<div class="line"><span class="lineno"> 4875</span>  m_nCols = nCols;</div>
<div class="line"><span class="lineno"> 4876</span>  m_nChannels = nChannels;</div>
<div class="line"><span class="lineno"> 4877</span>  m_nBytesPerMatrix = nChannels * <span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>);</div>
<div class="line"><span class="lineno"> 4878</span> </div>
<div class="line"><span class="lineno"> 4879</span>  m_vals = <span class="keyword">new</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>[nCols];</div>
<div class="line"><span class="lineno"> 4880</span>}</div>
<div class="line"><span class="lineno"> 4881</span> </div>
<div class="line"><span class="lineno"> 4882</span> </div>
<div class="line"><span class="lineno"> 4891</span>CIccPcsStepSrcSparseMatrix::~CIccPcsStepSrcSparseMatrix()</div>
<div class="line"><span class="lineno"> 4892</span>{</div>
<div class="line"><span class="lineno"> 4893</span>  <span class="keywordflow">if</span> (m_vals)</div>
<div class="line"><span class="lineno"> 4894</span>    <span class="keyword">delete</span> [] m_vals;</div>
<div class="line"><span class="lineno"> 4895</span>}</div>
<div class="line"><span class="lineno"> 4896</span> </div>
<div class="line"><span class="lineno"> 4897</span> </div>
<div class="line"><span class="lineno"> 4907</span><span class="keywordtype">void</span> CIccPcsStepSrcSparseMatrix::Apply(CIccApplyPcsStep *pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4908</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4909</span>  <a class="code hl_class" href="../../d6/dad/a00941.html">CIccSparseMatrix</a> mtx((<a class="code hl_typedef" href="../../d7/d46/a00002.html#a0462ca2992be7c80b056e640a192b325">icUInt8Number</a>*)pSrc, m_nBytesPerMatrix, <a class="code hl_define" href="../../d7/d46/a00002.html#a5bc58d64df71e86546c9f40fe5fefa06">icSparseMatrixFloatNum</a>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 4910</span> </div>
<div class="line"><span class="lineno"> 4911</span>  mtx.MultiplyVector(pDst, m_vals);</div>
<div class="line"><span class="lineno"> 4912</span>}</div>
<div class="line"><span class="lineno"> 4913</span> </div>
<div class="line"><span class="lineno"> 4914</span> </div>
<div class="line"><span class="lineno"> 4923</span><span class="keywordtype">void</span> CIccPcsStepSrcSparseMatrix::dump(std::string &amp;str)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 4924</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 4925</span>  str += <span class="stringliteral">&quot;\nCIccPcsStepSrcSparseMatrix\n\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 4926</span>  <span class="keywordtype">char</span> buf[80];</div>
<div class="line"><span class="lineno"> 4927</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;m_nCols; i++) {</div>
<div class="line"><span class="lineno"> 4928</span>    sprintf(buf, <a class="code hl_define" href="../../d3/df8/a00155.html#a09ef76f73cd16ef7b7c77358b527e816">ICCPCSSTEPDUMPFMT</a>, m_vals[i]);</div>
<div class="line"><span class="lineno"> 4929</span>    str += buf;</div>
<div class="line"><span class="lineno"> 4930</span>  }</div>
<div class="line"><span class="lineno"> 4931</span>  str += <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><span class="lineno"> 4932</span>}</div>
<div class="line"><span class="lineno"> 4933</span> </div>
<div class="line"><span class="lineno"> 4934</span> </div>
<div class="line"><span class="lineno"> 4943</span>CIccXformMonochrome::CIccXformMonochrome()</div>
<div class="line"><span class="lineno"> 4944</span>{</div>
<div class="line"><span class="lineno"> 4945</span>    m_Curve = NULL;</div>
<div class="line"><span class="lineno"> 4946</span>    m_ApplyCurvePtr = NULL;</div>
<div class="line"><span class="lineno"> 4947</span>    m_bFreeCurve = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 4948</span>}</div>
<div class="line"><span class="lineno"> 4949</span> </div>
<div class="line"><span class="lineno"> 4958</span>CIccXformMonochrome::~CIccXformMonochrome()</div>
<div class="line"><span class="lineno"> 4959</span>{</div>
<div class="line"><span class="lineno"> 4960</span>    <span class="keywordflow">if</span> (m_bFreeCurve &amp;&amp; m_Curve) {</div>
<div class="line"><span class="lineno"> 4961</span>        <span class="keyword">delete</span> m_Curve;</div>
<div class="line"><span class="lineno"> 4962</span>    }</div>
<div class="line"><span class="lineno"> 4963</span>}</div>
<div class="line"><span class="lineno"> 4964</span> </div>
<div class="line"><span class="lineno"> 4975</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccXformMonochrome::Begin()</div>
<div class="line"><span class="lineno"> 4976</span>{</div>
<div class="line"><span class="lineno"> 4977</span>    <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> status;</div>
<div class="line"><span class="lineno"> 4978</span> </div>
<div class="line"><span class="lineno"> 4979</span>    status = CIccXform::Begin();</div>
<div class="line"><span class="lineno"> 4980</span>    <span class="keywordflow">if</span> (status != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno"> 4981</span>        <span class="keywordflow">return</span> status;</div>
<div class="line"><span class="lineno"> 4982</span> </div>
<div class="line"><span class="lineno"> 4983</span>    m_ApplyCurvePtr = NULL;</div>
<div class="line"><span class="lineno"> 4984</span> </div>
<div class="line"><span class="lineno"> 4985</span>    <span class="keywordflow">if</span> (m_bInput) {</div>
<div class="line"><span class="lineno"> 4986</span>        m_Curve = GetCurve(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a046bf81412ed16e2ce5f0735bb7e7315">icSigGrayTRCTag</a>);</div>
<div class="line"><span class="lineno"> 4987</span> </div>
<div class="line"><span class="lineno"> 4988</span>        <span class="keywordflow">if</span> (!m_Curve) {</div>
<div class="line"><span class="lineno"> 4989</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a">icCmmStatProfileMissingTag</a>;</div>
<div class="line"><span class="lineno"> 4990</span>        }</div>
<div class="line"><span class="lineno"> 4991</span>    }</div>
<div class="line"><span class="lineno"> 4992</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 4993</span>        m_Curve = GetInvCurve(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a046bf81412ed16e2ce5f0735bb7e7315">icSigGrayTRCTag</a>);</div>
<div class="line"><span class="lineno"> 4994</span>        m_bFreeCurve = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 4995</span> </div>
<div class="line"><span class="lineno"> 4996</span>        <span class="keywordflow">if</span> (!m_Curve) {</div>
<div class="line"><span class="lineno"> 4997</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a">icCmmStatProfileMissingTag</a>;</div>
<div class="line"><span class="lineno"> 4998</span>        }</div>
<div class="line"><span class="lineno"> 4999</span>    }</div>
<div class="line"><span class="lineno"> 5000</span> </div>
<div class="line"><span class="lineno"> 5001</span>    m_Curve-&gt;Begin();</div>
<div class="line"><span class="lineno"> 5002</span>    <span class="keywordflow">if</span> (!m_Curve-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 5003</span>        m_ApplyCurvePtr = m_Curve;</div>
<div class="line"><span class="lineno"> 5004</span>    }</div>
<div class="line"><span class="lineno"> 5005</span> </div>
<div class="line"><span class="lineno"> 5006</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 5007</span>}</div>
<div class="line"><span class="lineno"> 5008</span> </div>
<div class="line"><span class="lineno"> 5022</span><span class="keywordtype">void</span> CIccXformMonochrome::Apply(CIccApplyXform* pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 5023</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 5024</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> Pixel[3];</div>
<div class="line"><span class="lineno"> 5025</span>  </div>
<div class="line"><span class="lineno"> 5026</span>  <span class="keywordflow">if</span> (m_bSrcPcsConversion)</div>
<div class="line"><span class="lineno"> 5027</span>      SrcPixel = CheckSrcAbs(pApply, SrcPixel);</div>
<div class="line"><span class="lineno"> 5028</span> </div>
<div class="line"><span class="lineno"> 5029</span>    <span class="keywordflow">if</span> (m_bInput) {</div>
<div class="line"><span class="lineno"> 5030</span>        Pixel[0] = SrcPixel[0];</div>
<div class="line"><span class="lineno"> 5031</span> </div>
<div class="line"><span class="lineno"> 5032</span>        <span class="keywordflow">if</span> (m_ApplyCurvePtr) {</div>
<div class="line"><span class="lineno"> 5033</span>            Pixel[0] = m_ApplyCurvePtr-&gt;Apply(Pixel[0]);</div>
<div class="line"><span class="lineno"> 5034</span>        }</div>
<div class="line"><span class="lineno"> 5035</span> </div>
<div class="line"><span class="lineno"> 5036</span>        DstPixel[0] = <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>(<a class="code hl_define" href="../../d6/d5b/a00026.html#a2099748836172e9623ed265cf9a416fe">icPerceptualRefWhiteX</a>); </div>
<div class="line"><span class="lineno"> 5037</span>        DstPixel[1] = <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>(<a class="code hl_define" href="../../d6/d5b/a00026.html#ac9449e1acbe4f8a51e242f04afd25361">icPerceptualRefWhiteY</a>);</div>
<div class="line"><span class="lineno"> 5038</span>        DstPixel[2] = <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>(<a class="code hl_define" href="../../d6/d5b/a00026.html#a970c241f6169898a9ae88b10fe06f91b">icPerceptualRefWhiteZ</a>);</div>
<div class="line"><span class="lineno"> 5039</span> </div>
<div class="line"><span class="lineno"> 5040</span>        <a class="code hl_function" href="../../d7/dce/a00143.html#a4b4cfb7788c3a780f19f2f104677a5b8">icXyzToPcs</a>(DstPixel);</div>
<div class="line"><span class="lineno"> 5041</span> </div>
<div class="line"><span class="lineno"> 5042</span>        <span class="keywordflow">if</span> (m_pProfile-&gt;m_Header.pcs==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>) {</div>
<div class="line"><span class="lineno"> 5043</span>            <span class="keywordflow">if</span> (UseLegacyPCS()) {</div>
<div class="line"><span class="lineno"> 5044</span>                CIccPCSUtil::XyzToLab2(DstPixel, DstPixel, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5045</span>            }</div>
<div class="line"><span class="lineno"> 5046</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5047</span>                CIccPCSUtil::XyzToLab(DstPixel, DstPixel, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5048</span>            }</div>
<div class="line"><span class="lineno"> 5049</span>        }</div>
<div class="line"><span class="lineno"> 5050</span> </div>
<div class="line"><span class="lineno"> 5051</span>        DstPixel[0] *= Pixel[0];</div>
<div class="line"><span class="lineno"> 5052</span>        DstPixel[1] *= Pixel[0];</div>
<div class="line"><span class="lineno"> 5053</span>        DstPixel[2] *= Pixel[0];</div>
<div class="line"><span class="lineno"> 5054</span>    }</div>
<div class="line"><span class="lineno"> 5055</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5056</span>        Pixel[0] = <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>(<a class="code hl_define" href="../../d6/d5b/a00026.html#a2099748836172e9623ed265cf9a416fe">icPerceptualRefWhiteX</a>); </div>
<div class="line"><span class="lineno"> 5057</span>        Pixel[1] = <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>(<a class="code hl_define" href="../../d6/d5b/a00026.html#ac9449e1acbe4f8a51e242f04afd25361">icPerceptualRefWhiteY</a>);</div>
<div class="line"><span class="lineno"> 5058</span>        Pixel[2] = <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>(<a class="code hl_define" href="../../d6/d5b/a00026.html#a970c241f6169898a9ae88b10fe06f91b">icPerceptualRefWhiteZ</a>);</div>
<div class="line"><span class="lineno"> 5059</span> </div>
<div class="line"><span class="lineno"> 5060</span>        <a class="code hl_function" href="../../d7/dce/a00143.html#a4b4cfb7788c3a780f19f2f104677a5b8">icXyzToPcs</a>(Pixel);</div>
<div class="line"><span class="lineno"> 5061</span> </div>
<div class="line"><span class="lineno"> 5062</span>        <span class="keywordflow">if</span> (m_pProfile-&gt;m_Header.pcs==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>) {</div>
<div class="line"><span class="lineno"> 5063</span>            <span class="keywordflow">if</span> (UseLegacyPCS()) {</div>
<div class="line"><span class="lineno"> 5064</span>                CIccPCSUtil::XyzToLab2(Pixel, Pixel, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5065</span>            }</div>
<div class="line"><span class="lineno"> 5066</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5067</span>                CIccPCSUtil::XyzToLab(Pixel, Pixel, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 5068</span>            }</div>
<div class="line"><span class="lineno"> 5069</span>            DstPixel[0] = SrcPixel[0]/Pixel[0];</div>
<div class="line"><span class="lineno"> 5070</span>        }</div>
<div class="line"><span class="lineno"> 5071</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5072</span>            DstPixel[0] = SrcPixel[1]/Pixel[1];</div>
<div class="line"><span class="lineno"> 5073</span>        }</div>
<div class="line"><span class="lineno"> 5074</span> </div>
<div class="line"><span class="lineno"> 5075</span>        <span class="keywordflow">if</span> (m_ApplyCurvePtr) {</div>
<div class="line"><span class="lineno"> 5076</span>            DstPixel[0] = m_ApplyCurvePtr-&gt;Apply(DstPixel[0]);</div>
<div class="line"><span class="lineno"> 5077</span>        }</div>
<div class="line"><span class="lineno"> 5078</span>    }</div>
<div class="line"><span class="lineno"> 5079</span> </div>
<div class="line"><span class="lineno"> 5080</span>  <span class="keywordflow">if</span> (m_bDstPcsConversion)</div>
<div class="line"><span class="lineno"> 5081</span>      CheckDstAbs(DstPixel);</div>
<div class="line"><span class="lineno"> 5082</span>}</div>
<div class="line"><span class="lineno"> 5083</span> </div>
<div class="line"><span class="lineno"> 5098</span><a class="code hl_class" href="../../dd/de4/a01121.html">CIccCurve</a> *CIccXformMonochrome::GetCurve(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a67fa1b773fad35303680761ee5ef9313">icSignature</a> sig)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 5099</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 5100</span>    <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = m_pProfile-&gt;FindTag(sig);</div>
<div class="line"><span class="lineno"> 5101</span> </div>
<div class="line"><span class="lineno"> 5102</span>    <span class="keywordflow">if</span> (pTag &amp;&amp; (pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">GetType</a>()==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea96cf6489d8d5dc86691eee5d443cf337">icSigCurveType</a> || pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">GetType</a>()==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea5f55d7347cee83f4b7570f2c0092a3c4">icSigParametricCurveType</a>)) {</div>
<div class="line"><span class="lineno"> 5103</span>        <span class="keywordflow">return</span> (<a class="code hl_class" href="../../dd/de4/a01121.html">CIccCurve</a>*)pTag;</div>
<div class="line"><span class="lineno"> 5104</span>    }</div>
<div class="line"><span class="lineno"> 5105</span> </div>
<div class="line"><span class="lineno"> 5106</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 5107</span>}</div>
<div class="line"><span class="lineno"> 5108</span> </div>
<div class="line"><span class="lineno"> 5123</span><a class="code hl_class" href="../../dd/de4/a01121.html">CIccCurve</a> *CIccXformMonochrome::GetInvCurve(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a67fa1b773fad35303680761ee5ef9313">icSignature</a> sig)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 5124</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 5125</span>    <a class="code hl_class" href="../../dd/de4/a01121.html">CIccCurve</a> *pCurve;</div>
<div class="line"><span class="lineno"> 5126</span>    <a class="code hl_class" href="../../d6/dc4/a01125.html">CIccTagCurve</a> *pInvCurve;</div>
<div class="line"><span class="lineno"> 5127</span> </div>
<div class="line"><span class="lineno"> 5128</span>    <span class="keywordflow">if</span> (!(pCurve = GetCurve(sig)))</div>
<div class="line"><span class="lineno"> 5129</span>        <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 5130</span> </div>
<div class="line"><span class="lineno"> 5131</span>    pCurve-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5132</span> </div>
<div class="line"><span class="lineno"> 5133</span>    pInvCurve = <span class="keyword">new</span> <a class="code hl_class" href="../../d6/dc4/a01125.html">CIccTagCurve</a>(2048);</div>
<div class="line"><span class="lineno"> 5134</span> </div>
<div class="line"><span class="lineno"> 5135</span>    <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 5136</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> x;</div>
<div class="line"><span class="lineno"> 5137</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Lut = &amp;(*pInvCurve)[0];</div>
<div class="line"><span class="lineno"> 5138</span> </div>
<div class="line"><span class="lineno"> 5139</span>    <span class="keywordflow">for</span> (i=0; i&lt;2048; i++) {</div>
<div class="line"><span class="lineno"> 5140</span>        x=(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)i / 2047;</div>
<div class="line"><span class="lineno"> 5141</span> </div>
<div class="line"><span class="lineno"> 5142</span>        Lut[i] = pCurve-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#abf88e98ece3d98f0e8bc090fe7596e05">Find</a>(x);</div>
<div class="line"><span class="lineno"> 5143</span>    }</div>
<div class="line"><span class="lineno"> 5144</span> </div>
<div class="line"><span class="lineno"> 5145</span>    <span class="keywordflow">return</span> pInvCurve;</div>
<div class="line"><span class="lineno"> 5146</span>}</div>
<div class="line"><span class="lineno"> 5147</span> </div>
<div class="line"><span class="lineno"> 5162</span><a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* CIccXformMonochrome::ExtractInputCurves()</div>
<div class="line"><span class="lineno"> 5163</span>{</div>
<div class="line"><span class="lineno"> 5164</span>    <span class="keywordflow">if</span> (m_bInput) {</div>
<div class="line"><span class="lineno"> 5165</span>        <span class="keywordflow">if</span> (m_Curve) {</div>
<div class="line"><span class="lineno"> 5166</span>            <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[1];</div>
<div class="line"><span class="lineno"> 5167</span>            Curve[0] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_Curve-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5168</span>            m_ApplyCurvePtr = NULL;</div>
<div class="line"><span class="lineno"> 5169</span>            <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 5170</span>        }</div>
<div class="line"><span class="lineno"> 5171</span>    }</div>
<div class="line"><span class="lineno"> 5172</span> </div>
<div class="line"><span class="lineno"> 5173</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 5174</span>}</div>
<div class="line"><span class="lineno"> 5175</span> </div>
<div class="line"><span class="lineno"> 5190</span><a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* CIccXformMonochrome::ExtractOutputCurves()</div>
<div class="line"><span class="lineno"> 5191</span>{</div>
<div class="line"><span class="lineno"> 5192</span>    <span class="keywordflow">if</span> (!m_bInput) {</div>
<div class="line"><span class="lineno"> 5193</span>        <span class="keywordflow">if</span> (m_Curve) {</div>
<div class="line"><span class="lineno"> 5194</span>            <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[1];</div>
<div class="line"><span class="lineno"> 5195</span>            Curve[0] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_Curve-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5196</span>            m_ApplyCurvePtr = NULL;</div>
<div class="line"><span class="lineno"> 5197</span>            <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 5198</span>        }</div>
<div class="line"><span class="lineno"> 5199</span>    }</div>
<div class="line"><span class="lineno"> 5200</span> </div>
<div class="line"><span class="lineno"> 5201</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 5202</span>}</div>
<div class="line"><span class="lineno"> 5203</span> </div>
<div class="line"><span class="lineno"> 5212</span>CIccXformMatrixTRC::CIccXformMatrixTRC() : m_e{}</div>
<div class="line"><span class="lineno"> 5213</span>{</div>
<div class="line"><span class="lineno"> 5214</span>  m_Curve[0] = m_Curve[1] = m_Curve[2] = NULL;</div>
<div class="line"><span class="lineno"> 5215</span>  m_ApplyCurvePtr = NULL;</div>
<div class="line"><span class="lineno"> 5216</span>  m_bFreeCurve = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 5217</span>}</div>
<div class="line"><span class="lineno"> 5218</span> </div>
<div class="line"><span class="lineno"> 5227</span>CIccXformMatrixTRC::~CIccXformMatrixTRC()</div>
<div class="line"><span class="lineno"> 5228</span>{</div>
<div class="line"><span class="lineno"> 5229</span>  <span class="keywordflow">if</span> (m_bFreeCurve) {</div>
<div class="line"><span class="lineno"> 5230</span>    <span class="keywordflow">if</span> (m_Curve[0])</div>
<div class="line"><span class="lineno"> 5231</span>      <span class="keyword">delete</span> m_Curve[0];</div>
<div class="line"><span class="lineno"> 5232</span>    <span class="keywordflow">if</span> (m_Curve[1])</div>
<div class="line"><span class="lineno"> 5233</span>      <span class="keyword">delete</span> m_Curve[1];</div>
<div class="line"><span class="lineno"> 5234</span>    <span class="keywordflow">if</span> (m_Curve[2])</div>
<div class="line"><span class="lineno"> 5235</span>      <span class="keyword">delete</span> m_Curve[2];</div>
<div class="line"><span class="lineno"> 5236</span>  }</div>
<div class="line"><span class="lineno"> 5237</span>}</div>
<div class="line"><span class="lineno"> 5238</span> </div>
<div class="line"><span class="lineno"> 5249</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccXformMatrixTRC::Begin()</div>
<div class="line"><span class="lineno"> 5250</span>{</div>
<div class="line"><span class="lineno"> 5251</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> status;</div>
<div class="line"><span class="lineno"> 5252</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d3/ded/a01017.html">CIccTagXYZ</a> *pXYZ;</div>
<div class="line"><span class="lineno"> 5253</span> </div>
<div class="line"><span class="lineno"> 5254</span>  status = CIccXform::Begin();</div>
<div class="line"><span class="lineno"> 5255</span>  <span class="keywordflow">if</span> (status != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno"> 5256</span>    <span class="keywordflow">return</span> status;</div>
<div class="line"><span class="lineno"> 5257</span> </div>
<div class="line"><span class="lineno"> 5258</span>  pXYZ = GetColumn(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ad3037f416da1bdbcee55755bd896db3e">icSigRedMatrixColumnTag</a>);</div>
<div class="line"><span class="lineno"> 5259</span>  <span class="keywordflow">if</span> (!pXYZ) {</div>
<div class="line"><span class="lineno"> 5260</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a">icCmmStatProfileMissingTag</a>;</div>
<div class="line"><span class="lineno"> 5261</span>  }</div>
<div class="line"><span class="lineno"> 5262</span> </div>
<div class="line"><span class="lineno"> 5263</span>  m_e[0] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>((*pXYZ)[0].X);</div>
<div class="line"><span class="lineno"> 5264</span>  m_e[3] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>((*pXYZ)[0].Y);</div>
<div class="line"><span class="lineno"> 5265</span>  m_e[6] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>((*pXYZ)[0].Z);</div>
<div class="line"><span class="lineno"> 5266</span> </div>
<div class="line"><span class="lineno"> 5267</span>  pXYZ = GetColumn(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a946d32df00f8fdcd52d05afdfa1ae897">icSigGreenMatrixColumnTag</a>);</div>
<div class="line"><span class="lineno"> 5268</span>  <span class="keywordflow">if</span> (!pXYZ) {</div>
<div class="line"><span class="lineno"> 5269</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a">icCmmStatProfileMissingTag</a>;</div>
<div class="line"><span class="lineno"> 5270</span>  }</div>
<div class="line"><span class="lineno"> 5271</span> </div>
<div class="line"><span class="lineno"> 5272</span>  m_e[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>((*pXYZ)[0].X);</div>
<div class="line"><span class="lineno"> 5273</span>  m_e[4] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>((*pXYZ)[0].Y);</div>
<div class="line"><span class="lineno"> 5274</span>  m_e[7] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>((*pXYZ)[0].Z);</div>
<div class="line"><span class="lineno"> 5275</span> </div>
<div class="line"><span class="lineno"> 5276</span>  pXYZ = GetColumn(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a19e7177ed729ed7835222428eef4c2a3">icSigBlueMatrixColumnTag</a>);</div>
<div class="line"><span class="lineno"> 5277</span>  <span class="keywordflow">if</span> (!pXYZ) {</div>
<div class="line"><span class="lineno"> 5278</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a">icCmmStatProfileMissingTag</a>;</div>
<div class="line"><span class="lineno"> 5279</span>  }</div>
<div class="line"><span class="lineno"> 5280</span> </div>
<div class="line"><span class="lineno"> 5281</span>  m_e[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>((*pXYZ)[0].X);</div>
<div class="line"><span class="lineno"> 5282</span>  m_e[5] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>((*pXYZ)[0].Y);</div>
<div class="line"><span class="lineno"> 5283</span>  m_e[8] = <a class="code hl_function" href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a>((*pXYZ)[0].Z);</div>
<div class="line"><span class="lineno"> 5284</span> </div>
<div class="line"><span class="lineno"> 5285</span>  m_ApplyCurvePtr = NULL;</div>
<div class="line"><span class="lineno"> 5286</span> </div>
<div class="line"><span class="lineno"> 5287</span>  <span class="keywordflow">if</span> (m_bInput) {</div>
<div class="line"><span class="lineno"> 5288</span>    m_Curve[0] = GetCurve(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a7fea74def2b68bdcd33cec08da4fa667">icSigRedTRCTag</a>);</div>
<div class="line"><span class="lineno"> 5289</span>    m_Curve[1] = GetCurve(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a3525a308b3af69ebe5c8888dcb80ef12">icSigGreenTRCTag</a>);</div>
<div class="line"><span class="lineno"> 5290</span>    m_Curve[2] = GetCurve(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a8b6202952425dbdc400d2626e650c903">icSigBlueTRCTag</a>);</div>
<div class="line"><span class="lineno"> 5291</span> </div>
<div class="line"><span class="lineno"> 5292</span>    <span class="keywordflow">if</span> (!m_Curve[0] || !m_Curve[1] || !m_Curve[2]) {</div>
<div class="line"><span class="lineno"> 5293</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a">icCmmStatProfileMissingTag</a>;</div>
<div class="line"><span class="lineno"> 5294</span>    }</div>
<div class="line"><span class="lineno"> 5295</span> </div>
<div class="line"><span class="lineno"> 5296</span>  }</div>
<div class="line"><span class="lineno"> 5297</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5298</span>    <span class="keywordflow">if</span> (m_pProfile-&gt;m_Header.pcs!=<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>) {</div>
<div class="line"><span class="lineno"> 5299</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 5300</span>    }</div>
<div class="line"><span class="lineno"> 5301</span> </div>
<div class="line"><span class="lineno"> 5302</span>    m_Curve[0] = GetInvCurve(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a7fea74def2b68bdcd33cec08da4fa667">icSigRedTRCTag</a>);</div>
<div class="line"><span class="lineno"> 5303</span>    m_Curve[1] = GetInvCurve(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a3525a308b3af69ebe5c8888dcb80ef12">icSigGreenTRCTag</a>);</div>
<div class="line"><span class="lineno"> 5304</span>    m_Curve[2] = GetInvCurve(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a8b6202952425dbdc400d2626e650c903">icSigBlueTRCTag</a>);</div>
<div class="line"><span class="lineno"> 5305</span> </div>
<div class="line"><span class="lineno"> 5306</span>    m_bFreeCurve = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 5307</span> </div>
<div class="line"><span class="lineno"> 5308</span>    <span class="keywordflow">if</span> (!m_Curve[0] || !m_Curve[1] || !m_Curve[2]) {</div>
<div class="line"><span class="lineno"> 5309</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a">icCmmStatProfileMissingTag</a>;</div>
<div class="line"><span class="lineno"> 5310</span>    }</div>
<div class="line"><span class="lineno"> 5311</span> </div>
<div class="line"><span class="lineno"> 5312</span>    <span class="keywordflow">if</span> (!<a class="code hl_function" href="../../d7/dce/a00143.html#aa1bb8385706c3c656575f0d6a4ae4d76">icMatrixInvert3x3</a>(m_e)) {</div>
<div class="line"><span class="lineno"> 5313</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860">icCmmStatInvalidProfile</a>;</div>
<div class="line"><span class="lineno"> 5314</span>    }</div>
<div class="line"><span class="lineno"> 5315</span>  }</div>
<div class="line"><span class="lineno"> 5316</span> </div>
<div class="line"><span class="lineno"> 5317</span>  m_Curve[0]-&gt;Begin();</div>
<div class="line"><span class="lineno"> 5318</span>  m_Curve[1]-&gt;Begin();</div>
<div class="line"><span class="lineno"> 5319</span>  m_Curve[2]-&gt;Begin();</div>
<div class="line"><span class="lineno"> 5320</span> </div>
<div class="line"><span class="lineno"> 5321</span>  <span class="keywordflow">if</span> (!m_Curve[0]-&gt;IsIdentity() || !m_Curve[1]-&gt;IsIdentity() || !m_Curve[2]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 5322</span>    m_ApplyCurvePtr = m_Curve;</div>
<div class="line"><span class="lineno"> 5323</span>  }</div>
<div class="line"><span class="lineno"> 5324</span>  </div>
<div class="line"><span class="lineno"> 5325</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 5326</span>}</div>
<div class="line"><span class="lineno"> 5327</span> </div>
<div class="line"><span class="lineno"> 5328</span> </div>
<div class="line"><span class="lineno"> 5329</span><span class="keyword">static</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> <a class="code hl_function" href="../../d3/df8/a00155.html#aa7c8bbc66b122b6419782fbfb02d51ac">XYZScale</a>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> v)</div>
<div class="line"><span class="lineno"> 5330</span>{</div>
<div class="line"><span class="lineno"> 5331</span>  v = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(v * 32768.0 / 65535.0);</div>
<div class="line"><span class="lineno"> 5332</span>  <span class="keywordflow">return</span> v;</div>
<div class="line"><span class="lineno"> 5333</span>}</div>
<div class="line"><span class="lineno"> 5334</span> </div>
<div class="line"><span class="lineno"> 5335</span><span class="keyword">static</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> <a class="code hl_function" href="../../d3/df8/a00155.html#ae5a787099f4191e4c234ca3301c9cc0a">XYZDescale</a>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> v)</div>
<div class="line"><span class="lineno"> 5336</span>{</div>
<div class="line"><span class="lineno"> 5337</span>  <span class="keywordflow">return</span> (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(v * 65535.0 / 32768.0);</div>
<div class="line"><span class="lineno"> 5338</span>}</div>
<div class="line"><span class="lineno"> 5339</span> </div>
<div class="line"><span class="lineno"> 5340</span><span class="keyword">static</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> <a class="code hl_function" href="../../d3/df8/a00155.html#a36a692db621ce2ccea49767209ab8294">RGBClip</a>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> v, <a class="code hl_class" href="../../dd/de4/a01121.html">CIccCurve</a> *pCurve)</div>
<div class="line"><span class="lineno"> 5341</span>{</div>
<div class="line"><span class="lineno"> 5342</span>  <span class="keywordflow">if</span> (v&lt;=0)</div>
<div class="line"><span class="lineno"> 5343</span>    <span class="keywordflow">return</span>(pCurve-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a0c972a2a0eacd5245a0f52993c9f501f">Apply</a>(0));</div>
<div class="line"><span class="lineno"> 5344</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v&gt;=1.0)</div>
<div class="line"><span class="lineno"> 5345</span>    <span class="keywordflow">return</span> (pCurve-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a0c972a2a0eacd5245a0f52993c9f501f">Apply</a>(1.0));</div>
<div class="line"><span class="lineno"> 5346</span> </div>
<div class="line"><span class="lineno"> 5347</span>  <span class="keywordflow">return</span> pCurve-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a0c972a2a0eacd5245a0f52993c9f501f">Apply</a>(v);</div>
<div class="line"><span class="lineno"> 5348</span>}</div>
<div class="line"><span class="lineno"> 5349</span> </div>
<div class="line"><span class="lineno"> 5363</span><span class="keywordtype">void</span> CIccXformMatrixTRC::Apply(CIccApplyXform* pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 5364</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 5365</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> Pixel[3];</div>
<div class="line"><span class="lineno"> 5366</span> </div>
<div class="line"><span class="lineno"> 5367</span>  <span class="keywordflow">if</span> (m_bSrcPcsConversion)</div>
<div class="line"><span class="lineno"> 5368</span>    SrcPixel = CheckSrcAbs(pApply, SrcPixel);</div>
<div class="line"><span class="lineno"> 5369</span> </div>
<div class="line"><span class="lineno"> 5370</span>  Pixel[0] = SrcPixel[0];</div>
<div class="line"><span class="lineno"> 5371</span>  Pixel[1] = SrcPixel[1];</div>
<div class="line"><span class="lineno"> 5372</span>  Pixel[2] = SrcPixel[2];</div>
<div class="line"><span class="lineno"> 5373</span> </div>
<div class="line"><span class="lineno"> 5374</span>  <span class="keywordflow">if</span> (m_bInput) {</div>
<div class="line"><span class="lineno"> 5375</span> </div>
<div class="line"><span class="lineno"> 5376</span>    <span class="keywordtype">double</span> LinR, LinG, LinB;</div>
<div class="line"><span class="lineno"> 5377</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtr) {</div>
<div class="line"><span class="lineno"> 5378</span>      LinR = m_ApplyCurvePtr[0]-&gt;Apply(Pixel[0]);</div>
<div class="line"><span class="lineno"> 5379</span>      LinG = m_ApplyCurvePtr[1]-&gt;Apply(Pixel[1]);</div>
<div class="line"><span class="lineno"> 5380</span>      LinB = m_ApplyCurvePtr[2]-&gt;Apply(Pixel[2]);</div>
<div class="line"><span class="lineno"> 5381</span>    }</div>
<div class="line"><span class="lineno"> 5382</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5383</span>      LinR = Pixel[0];</div>
<div class="line"><span class="lineno"> 5384</span>      LinG = Pixel[1];</div>
<div class="line"><span class="lineno"> 5385</span>      LinB = Pixel[2];</div>
<div class="line"><span class="lineno"> 5386</span>    }</div>
<div class="line"><span class="lineno"> 5387</span> </div>
<div class="line"><span class="lineno"> 5388</span>    DstPixel[0] = <a class="code hl_function" href="../../d3/df8/a00155.html#aa7c8bbc66b122b6419782fbfb02d51ac">XYZScale</a>((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(m_e[0] * LinR + m_e[1] * LinG + m_e[2] * LinB));</div>
<div class="line"><span class="lineno"> 5389</span>    DstPixel[1] = <a class="code hl_function" href="../../d3/df8/a00155.html#aa7c8bbc66b122b6419782fbfb02d51ac">XYZScale</a>((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(m_e[3] * LinR + m_e[4] * LinG + m_e[5] * LinB));</div>
<div class="line"><span class="lineno"> 5390</span>    DstPixel[2] = <a class="code hl_function" href="../../d3/df8/a00155.html#aa7c8bbc66b122b6419782fbfb02d51ac">XYZScale</a>((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(m_e[6] * LinR + m_e[7] * LinG + m_e[8] * LinB));</div>
<div class="line"><span class="lineno"> 5391</span>  }</div>
<div class="line"><span class="lineno"> 5392</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5393</span>    <span class="keywordtype">double</span> X = <a class="code hl_function" href="../../d3/df8/a00155.html#ae5a787099f4191e4c234ca3301c9cc0a">XYZDescale</a>(Pixel[0]);</div>
<div class="line"><span class="lineno"> 5394</span>    <span class="keywordtype">double</span> Y = <a class="code hl_function" href="../../d3/df8/a00155.html#ae5a787099f4191e4c234ca3301c9cc0a">XYZDescale</a>(Pixel[1]);</div>
<div class="line"><span class="lineno"> 5395</span>    <span class="keywordtype">double</span> Z = <a class="code hl_function" href="../../d3/df8/a00155.html#ae5a787099f4191e4c234ca3301c9cc0a">XYZDescale</a>(Pixel[2]);</div>
<div class="line"><span class="lineno"> 5396</span> </div>
<div class="line"><span class="lineno"> 5397</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtr) {</div>
<div class="line"><span class="lineno"> 5398</span>      DstPixel[0] = <a class="code hl_function" href="../../d3/df8/a00155.html#a36a692db621ce2ccea49767209ab8294">RGBClip</a>((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(m_e[0] * X + m_e[1] * Y + m_e[2] * Z), m_ApplyCurvePtr[0]);</div>
<div class="line"><span class="lineno"> 5399</span>      DstPixel[1] = <a class="code hl_function" href="../../d3/df8/a00155.html#a36a692db621ce2ccea49767209ab8294">RGBClip</a>((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(m_e[3] * X + m_e[4] * Y + m_e[5] * Z), m_ApplyCurvePtr[1]);</div>
<div class="line"><span class="lineno"> 5400</span>      DstPixel[2] = <a class="code hl_function" href="../../d3/df8/a00155.html#a36a692db621ce2ccea49767209ab8294">RGBClip</a>((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(m_e[6] * X + m_e[7] * Y + m_e[8] * Z), m_ApplyCurvePtr[2]);</div>
<div class="line"><span class="lineno"> 5401</span>    }</div>
<div class="line"><span class="lineno"> 5402</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5403</span>      DstPixel[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(m_e[0] * X + m_e[1] * Y + m_e[2] * Z);</div>
<div class="line"><span class="lineno"> 5404</span>      DstPixel[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(m_e[3] * X + m_e[4] * Y + m_e[5] * Z);</div>
<div class="line"><span class="lineno"> 5405</span>      DstPixel[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(m_e[6] * X + m_e[7] * Y + m_e[8] * Z);</div>
<div class="line"><span class="lineno"> 5406</span>    }</div>
<div class="line"><span class="lineno"> 5407</span>  }</div>
<div class="line"><span class="lineno"> 5408</span> </div>
<div class="line"><span class="lineno"> 5409</span>  <span class="keywordflow">if</span> (m_bDstPcsConversion)</div>
<div class="line"><span class="lineno"> 5410</span>    CheckDstAbs(DstPixel);</div>
<div class="line"><span class="lineno"> 5411</span>}</div>
<div class="line"><span class="lineno"> 5412</span> </div>
<div class="line"><span class="lineno"> 5427</span><a class="code hl_class" href="../../dd/de4/a01121.html">CIccCurve</a> *CIccXformMatrixTRC::GetCurve(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a67fa1b773fad35303680761ee5ef9313">icSignature</a> sig)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 5428</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 5429</span>  <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = m_pProfile-&gt;FindTag(sig);</div>
<div class="line"><span class="lineno"> 5430</span> </div>
<div class="line"><span class="lineno"> 5431</span>  <span class="keywordflow">if</span> (pTag &amp;&amp; (pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">GetType</a>()==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea96cf6489d8d5dc86691eee5d443cf337">icSigCurveType</a> || pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">GetType</a>()==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea5f55d7347cee83f4b7570f2c0092a3c4">icSigParametricCurveType</a>)) {</div>
<div class="line"><span class="lineno"> 5432</span>    <span class="keywordflow">return</span> (<a class="code hl_class" href="../../dd/de4/a01121.html">CIccCurve</a>*)pTag;</div>
<div class="line"><span class="lineno"> 5433</span>  }</div>
<div class="line"><span class="lineno"> 5434</span> </div>
<div class="line"><span class="lineno"> 5435</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 5436</span>}</div>
<div class="line"><span class="lineno"> 5437</span> </div>
<div class="line"><span class="lineno"> 5452</span><a class="code hl_class" href="../../d3/ded/a01017.html">CIccTagXYZ</a> *CIccXformMatrixTRC::GetColumn(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a67fa1b773fad35303680761ee5ef9313">icSignature</a> sig)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 5453</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 5454</span>  <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = m_pProfile-&gt;FindTag(sig);</div>
<div class="line"><span class="lineno"> 5455</span> </div>
<div class="line"><span class="lineno"> 5456</span>  <span class="keywordflow">if</span> (!pTag || pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">GetType</a>()!=<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea6226593792ef658c78bcab04a6fd4850">icSigXYZType</a>) {</div>
<div class="line"><span class="lineno"> 5457</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 5458</span>  }</div>
<div class="line"><span class="lineno"> 5459</span> </div>
<div class="line"><span class="lineno"> 5460</span>  <span class="keywordflow">return</span> (<a class="code hl_class" href="../../d3/ded/a01017.html">CIccTagXYZ</a>*)pTag;</div>
<div class="line"><span class="lineno"> 5461</span>}</div>
<div class="line"><span class="lineno"> 5462</span> </div>
<div class="line"><span class="lineno"> 5477</span><a class="code hl_class" href="../../dd/de4/a01121.html">CIccCurve</a> *CIccXformMatrixTRC::GetInvCurve(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a67fa1b773fad35303680761ee5ef9313">icSignature</a> sig)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 5478</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 5479</span>  <a class="code hl_class" href="../../dd/de4/a01121.html">CIccCurve</a> *pCurve;</div>
<div class="line"><span class="lineno"> 5480</span>  <a class="code hl_class" href="../../d6/dc4/a01125.html">CIccTagCurve</a> *pInvCurve;</div>
<div class="line"><span class="lineno"> 5481</span> </div>
<div class="line"><span class="lineno"> 5482</span>  <span class="keywordflow">if</span> (!(pCurve = GetCurve(sig)))</div>
<div class="line"><span class="lineno"> 5483</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 5484</span> </div>
<div class="line"><span class="lineno"> 5485</span>  pCurve-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5486</span> </div>
<div class="line"><span class="lineno"> 5487</span>  pInvCurve = <span class="keyword">new</span> <a class="code hl_class" href="../../d6/dc4/a01125.html">CIccTagCurve</a>(2048);</div>
<div class="line"><span class="lineno"> 5488</span> </div>
<div class="line"><span class="lineno"> 5489</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 5490</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> x;</div>
<div class="line"><span class="lineno"> 5491</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *Lut = &amp;(*pInvCurve)[0];</div>
<div class="line"><span class="lineno"> 5492</span> </div>
<div class="line"><span class="lineno"> 5493</span>  <span class="keywordflow">for</span> (i=0; i&lt;2048; i++) {</div>
<div class="line"><span class="lineno"> 5494</span>    x=(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)i / 2047;</div>
<div class="line"><span class="lineno"> 5495</span> </div>
<div class="line"><span class="lineno"> 5496</span>    Lut[i] = pCurve-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#abf88e98ece3d98f0e8bc090fe7596e05">Find</a>(x);</div>
<div class="line"><span class="lineno"> 5497</span>  }</div>
<div class="line"><span class="lineno"> 5498</span> </div>
<div class="line"><span class="lineno"> 5499</span>  <span class="keywordflow">return</span> pInvCurve;</div>
<div class="line"><span class="lineno"> 5500</span>}</div>
<div class="line"><span class="lineno"> 5501</span> </div>
<div class="line"><span class="lineno"> 5516</span><a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* CIccXformMatrixTRC::ExtractInputCurves()</div>
<div class="line"><span class="lineno"> 5517</span>{</div>
<div class="line"><span class="lineno"> 5518</span>  <span class="keywordflow">if</span> (m_bInput) {</div>
<div class="line"><span class="lineno"> 5519</span>    <span class="keywordflow">if</span> (m_Curve[0]) {</div>
<div class="line"><span class="lineno"> 5520</span>            <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[3];</div>
<div class="line"><span class="lineno"> 5521</span>            Curve[0] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_Curve[0]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5522</span>            Curve[1] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_Curve[1]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5523</span>            Curve[2] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_Curve[2]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5524</span>      m_ApplyCurvePtr = NULL;</div>
<div class="line"><span class="lineno"> 5525</span>      <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 5526</span>    }</div>
<div class="line"><span class="lineno"> 5527</span>  }</div>
<div class="line"><span class="lineno"> 5528</span> </div>
<div class="line"><span class="lineno"> 5529</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 5530</span>}</div>
<div class="line"><span class="lineno"> 5531</span> </div>
<div class="line"><span class="lineno"> 5546</span><a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* CIccXformMatrixTRC::ExtractOutputCurves()</div>
<div class="line"><span class="lineno"> 5547</span>{</div>
<div class="line"><span class="lineno"> 5548</span>  <span class="keywordflow">if</span> (!m_bInput) {</div>
<div class="line"><span class="lineno"> 5549</span>    <span class="keywordflow">if</span> (m_Curve[0]) {</div>
<div class="line"><span class="lineno"> 5550</span>            <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[3];</div>
<div class="line"><span class="lineno"> 5551</span>            Curve[0] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_Curve[0]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5552</span>            Curve[1] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_Curve[1]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5553</span>            Curve[2] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_Curve[2]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5554</span>      m_ApplyCurvePtr = NULL;</div>
<div class="line"><span class="lineno"> 5555</span>      <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 5556</span>    }</div>
<div class="line"><span class="lineno"> 5557</span>  }</div>
<div class="line"><span class="lineno"> 5558</span> </div>
<div class="line"><span class="lineno"> 5559</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 5560</span>}</div>
<div class="line"><span class="lineno"> 5561</span> </div>
<div class="line"><span class="lineno"> 5573</span>CIccXform3DLut::CIccXform3DLut(<a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag)</div>
<div class="line"><span class="lineno"> 5574</span>{</div>
<div class="line"><span class="lineno"> 5575</span>  <span class="keywordflow">if</span> (pTag &amp;&amp; pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a5cf5b72ab66ca68a6c8ddfd861741bb8">IsMBBType</a>()) {</div>
<div class="line"><span class="lineno"> 5576</span>    m_pTag = (<a class="code hl_class" href="../../dc/d06/a01153.html">CIccMBB</a>*)pTag;</div>
<div class="line"><span class="lineno"> 5577</span>  }</div>
<div class="line"><span class="lineno"> 5578</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5579</span>    m_pTag = NULL;</div>
<div class="line"><span class="lineno"> 5580</span> </div>
<div class="line"><span class="lineno"> 5581</span>  m_ApplyCurvePtrA = m_ApplyCurvePtrB = m_ApplyCurvePtrM = NULL;</div>
<div class="line"><span class="lineno"> 5582</span>  m_ApplyMatrixPtr = NULL;</div>
<div class="line"><span class="lineno"> 5583</span>}</div>
<div class="line"><span class="lineno"> 5584</span> </div>
<div class="line"><span class="lineno"> 5593</span>CIccXform3DLut::~CIccXform3DLut()</div>
<div class="line"><span class="lineno"> 5594</span>{</div>
<div class="line"><span class="lineno"> 5595</span>}</div>
<div class="line"><span class="lineno"> 5596</span> </div>
<div class="line"><span class="lineno"> 5607</span> <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccXform3DLut::Begin()</div>
<div class="line"><span class="lineno"> 5608</span>{</div>
<div class="line"><span class="lineno"> 5609</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> status;</div>
<div class="line"><span class="lineno"> 5610</span>  <a class="code hl_class" href="../../dd/de4/a01121.html">CIccCurve</a> **Curve;</div>
<div class="line"><span class="lineno"> 5611</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 5612</span> </div>
<div class="line"><span class="lineno"> 5613</span>  status = CIccXform::Begin();</div>
<div class="line"><span class="lineno"> 5614</span>  <span class="keywordflow">if</span> (status != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno"> 5615</span>    <span class="keywordflow">return</span> status;</div>
<div class="line"><span class="lineno"> 5616</span> </div>
<div class="line"><span class="lineno"> 5617</span>  <span class="keywordflow">if</span> (!m_pTag ||</div>
<div class="line"><span class="lineno"> 5618</span>      m_pTag-&gt;InputChannels()!=3) {</div>
<div class="line"><span class="lineno"> 5619</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096">icCmmStatInvalidLut</a>;</div>
<div class="line"><span class="lineno"> 5620</span>  }</div>
<div class="line"><span class="lineno"> 5621</span> </div>
<div class="line"><span class="lineno"> 5622</span>  m_ApplyCurvePtrA = NULL;</div>
<div class="line"><span class="lineno"> 5623</span>  m_ApplyCurvePtrB = NULL;</div>
<div class="line"><span class="lineno"> 5624</span>  m_ApplyCurvePtrM = NULL;</div>
<div class="line"><span class="lineno"> 5625</span> </div>
<div class="line"><span class="lineno"> 5626</span>  <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 5627</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesB) {</div>
<div class="line"><span class="lineno"> 5628</span>      Curve = m_pTag-&gt;m_CurvesB;</div>
<div class="line"><span class="lineno"> 5629</span> </div>
<div class="line"><span class="lineno"> 5630</span>      Curve[0]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5631</span>      Curve[1]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5632</span>      Curve[2]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5633</span> </div>
<div class="line"><span class="lineno"> 5634</span>      <span class="keywordflow">if</span> (!Curve[0]-&gt;IsIdentity() || !Curve[1]-&gt;IsIdentity() || !Curve[2]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 5635</span>        m_ApplyCurvePtrB = Curve;</div>
<div class="line"><span class="lineno"> 5636</span>      }</div>
<div class="line"><span class="lineno"> 5637</span>    }</div>
<div class="line"><span class="lineno"> 5638</span> </div>
<div class="line"><span class="lineno"> 5639</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesM) {</div>
<div class="line"><span class="lineno"> 5640</span>      Curve = m_pTag-&gt;m_CurvesM;</div>
<div class="line"><span class="lineno"> 5641</span> </div>
<div class="line"><span class="lineno"> 5642</span>      Curve[0]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5643</span>      Curve[1]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5644</span>      Curve[2]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5645</span>      </div>
<div class="line"><span class="lineno"> 5646</span>      <span class="keywordflow">if</span> (!Curve[0]-&gt;IsIdentity() || !Curve[1]-&gt;IsIdentity() || !Curve[2]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 5647</span>        m_ApplyCurvePtrM = Curve;</div>
<div class="line"><span class="lineno"> 5648</span>      }</div>
<div class="line"><span class="lineno"> 5649</span>    }</div>
<div class="line"><span class="lineno"> 5650</span> </div>
<div class="line"><span class="lineno"> 5651</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CLUT) {</div>
<div class="line"><span class="lineno"> 5652</span>      m_pTag-&gt;m_CLUT-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5653</span>    }</div>
<div class="line"><span class="lineno"> 5654</span> </div>
<div class="line"><span class="lineno"> 5655</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesA) {</div>
<div class="line"><span class="lineno"> 5656</span>      Curve = m_pTag-&gt;m_CurvesA;</div>
<div class="line"><span class="lineno"> 5657</span> </div>
<div class="line"><span class="lineno"> 5658</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 5659</span>        Curve[i]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5660</span>      }</div>
<div class="line"><span class="lineno"> 5661</span> </div>
<div class="line"><span class="lineno"> 5662</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 5663</span>        <span class="keywordflow">if</span> (!Curve[i]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 5664</span>          m_ApplyCurvePtrA = Curve;</div>
<div class="line"><span class="lineno"> 5665</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5666</span>        }</div>
<div class="line"><span class="lineno"> 5667</span>      }</div>
<div class="line"><span class="lineno"> 5668</span>    }</div>
<div class="line"><span class="lineno"> 5669</span> </div>
<div class="line"><span class="lineno"> 5670</span>  }</div>
<div class="line"><span class="lineno"> 5671</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5672</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesA) {</div>
<div class="line"><span class="lineno"> 5673</span>      Curve = m_pTag-&gt;m_CurvesA;</div>
<div class="line"><span class="lineno"> 5674</span> </div>
<div class="line"><span class="lineno"> 5675</span>      Curve[0]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5676</span>      Curve[1]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5677</span>      Curve[2]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5678</span> </div>
<div class="line"><span class="lineno"> 5679</span>      <span class="keywordflow">if</span> (!Curve[0]-&gt;IsIdentity() || !Curve[1]-&gt;IsIdentity() || !Curve[2]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 5680</span>        m_ApplyCurvePtrA = Curve;</div>
<div class="line"><span class="lineno"> 5681</span>      }</div>
<div class="line"><span class="lineno"> 5682</span>    }</div>
<div class="line"><span class="lineno"> 5683</span> </div>
<div class="line"><span class="lineno"> 5684</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CLUT) {</div>
<div class="line"><span class="lineno"> 5685</span>      m_pTag-&gt;m_CLUT-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5686</span>    }</div>
<div class="line"><span class="lineno"> 5687</span> </div>
<div class="line"><span class="lineno"> 5688</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesM) {</div>
<div class="line"><span class="lineno"> 5689</span>      Curve = m_pTag-&gt;m_CurvesM;</div>
<div class="line"><span class="lineno"> 5690</span> </div>
<div class="line"><span class="lineno"> 5691</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 5692</span>        Curve[i]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5693</span>      }</div>
<div class="line"><span class="lineno"> 5694</span> </div>
<div class="line"><span class="lineno"> 5695</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 5696</span>        <span class="keywordflow">if</span> (!Curve[i]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 5697</span>          m_ApplyCurvePtrM = Curve;</div>
<div class="line"><span class="lineno"> 5698</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5699</span>        }</div>
<div class="line"><span class="lineno"> 5700</span>      }</div>
<div class="line"><span class="lineno"> 5701</span>    }</div>
<div class="line"><span class="lineno"> 5702</span> </div>
<div class="line"><span class="lineno"> 5703</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesB) {</div>
<div class="line"><span class="lineno"> 5704</span>      Curve = m_pTag-&gt;m_CurvesB;</div>
<div class="line"><span class="lineno"> 5705</span> </div>
<div class="line"><span class="lineno"> 5706</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 5707</span>        Curve[i]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5708</span>      }</div>
<div class="line"><span class="lineno"> 5709</span> </div>
<div class="line"><span class="lineno"> 5710</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 5711</span>        <span class="keywordflow">if</span> (!Curve[i]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 5712</span>          m_ApplyCurvePtrB = Curve;</div>
<div class="line"><span class="lineno"> 5713</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 5714</span>        }</div>
<div class="line"><span class="lineno"> 5715</span>      }</div>
<div class="line"><span class="lineno"> 5716</span>    }</div>
<div class="line"><span class="lineno"> 5717</span>  }</div>
<div class="line"><span class="lineno"> 5718</span> </div>
<div class="line"><span class="lineno"> 5719</span>  m_ApplyMatrixPtr = NULL;</div>
<div class="line"><span class="lineno"> 5720</span>  <span class="keywordflow">if</span> (m_pTag-&gt;m_Matrix) {</div>
<div class="line"><span class="lineno"> 5721</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 5722</span>      <span class="keywordflow">if</span> (m_pTag-&gt;m_nInput!=3) {</div>
<div class="line"><span class="lineno"> 5723</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860">icCmmStatInvalidProfile</a>;</div>
<div class="line"><span class="lineno"> 5724</span>      }</div>
<div class="line"><span class="lineno"> 5725</span>    }</div>
<div class="line"><span class="lineno"> 5726</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5727</span>      <span class="keywordflow">if</span> (m_pTag-&gt;m_nOutput!=3) {</div>
<div class="line"><span class="lineno"> 5728</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860">icCmmStatInvalidProfile</a>;</div>
<div class="line"><span class="lineno"> 5729</span>      }</div>
<div class="line"><span class="lineno"> 5730</span>    }</div>
<div class="line"><span class="lineno"> 5731</span> </div>
<div class="line"><span class="lineno"> 5732</span>    <span class="keywordflow">if</span> (!m_pTag-&gt;m_Matrix-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 5733</span>      m_ApplyMatrixPtr = m_pTag-&gt;m_Matrix;</div>
<div class="line"><span class="lineno"> 5734</span>    }</div>
<div class="line"><span class="lineno"> 5735</span>  }</div>
<div class="line"><span class="lineno"> 5736</span> </div>
<div class="line"><span class="lineno"> 5737</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 5738</span>}</div>
<div class="line"><span class="lineno"> 5739</span> </div>
<div class="line"><span class="lineno"> 5753</span><span class="keywordtype">void</span> CIccXform3DLut::Apply(CIccApplyXform* pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 5754</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 5755</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> Pixel[16];</div>
<div class="line"><span class="lineno"> 5756</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 5757</span> </div>
<div class="line"><span class="lineno"> 5758</span>  <span class="keywordflow">if</span> (m_bSrcPcsConversion)</div>
<div class="line"><span class="lineno"> 5759</span>    SrcPixel = CheckSrcAbs(pApply, SrcPixel);</div>
<div class="line"><span class="lineno"> 5760</span> </div>
<div class="line"><span class="lineno"> 5761</span>  Pixel[0] = SrcPixel[0];</div>
<div class="line"><span class="lineno"> 5762</span>  Pixel[1] = SrcPixel[1];</div>
<div class="line"><span class="lineno"> 5763</span>  Pixel[2] = SrcPixel[2];</div>
<div class="line"><span class="lineno"> 5764</span> </div>
<div class="line"><span class="lineno"> 5765</span>  <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 5766</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrB) {</div>
<div class="line"><span class="lineno"> 5767</span>      Pixel[0] = m_ApplyCurvePtrB[0]-&gt;Apply(Pixel[0]);</div>
<div class="line"><span class="lineno"> 5768</span>      Pixel[1] = m_ApplyCurvePtrB[1]-&gt;Apply(Pixel[1]);</div>
<div class="line"><span class="lineno"> 5769</span>      Pixel[2] = m_ApplyCurvePtrB[2]-&gt;Apply(Pixel[2]);</div>
<div class="line"><span class="lineno"> 5770</span>    }</div>
<div class="line"><span class="lineno"> 5771</span> </div>
<div class="line"><span class="lineno"> 5772</span>    <span class="keywordflow">if</span> (m_ApplyMatrixPtr) {</div>
<div class="line"><span class="lineno"> 5773</span>      m_ApplyMatrixPtr-&gt;Apply(Pixel);</div>
<div class="line"><span class="lineno"> 5774</span>    }</div>
<div class="line"><span class="lineno"> 5775</span> </div>
<div class="line"><span class="lineno"> 5776</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrM) {</div>
<div class="line"><span class="lineno"> 5777</span>      Pixel[0] = m_ApplyCurvePtrM[0]-&gt;Apply(Pixel[0]);</div>
<div class="line"><span class="lineno"> 5778</span>      Pixel[1] = m_ApplyCurvePtrM[1]-&gt;Apply(Pixel[1]);</div>
<div class="line"><span class="lineno"> 5779</span>      Pixel[2] = m_ApplyCurvePtrM[2]-&gt;Apply(Pixel[2]);</div>
<div class="line"><span class="lineno"> 5780</span>    }</div>
<div class="line"><span class="lineno"> 5781</span> </div>
<div class="line"><span class="lineno"> 5782</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CLUT) {</div>
<div class="line"><span class="lineno"> 5783</span>      <span class="keywordflow">if</span> (m_nInterp==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913af6e0f18af557a029c4dda563c3a003fb">icInterpLinear</a>)</div>
<div class="line"><span class="lineno"> 5784</span>        m_pTag-&gt;m_CLUT-&gt;Interp3d(Pixel, Pixel);</div>
<div class="line"><span class="lineno"> 5785</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5786</span>        m_pTag-&gt;m_CLUT-&gt;Interp3dTetra(Pixel, Pixel);</div>
<div class="line"><span class="lineno"> 5787</span>    }</div>
<div class="line"><span class="lineno"> 5788</span> </div>
<div class="line"><span class="lineno"> 5789</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrA) {</div>
<div class="line"><span class="lineno"> 5790</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 5791</span>        Pixel[i] = m_ApplyCurvePtrA[i]-&gt;Apply(Pixel[i]);</div>
<div class="line"><span class="lineno"> 5792</span>      }</div>
<div class="line"><span class="lineno"> 5793</span>    }</div>
<div class="line"><span class="lineno"> 5794</span> </div>
<div class="line"><span class="lineno"> 5795</span>  }</div>
<div class="line"><span class="lineno"> 5796</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5797</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrA) {</div>
<div class="line"><span class="lineno"> 5798</span>      Pixel[0] = m_ApplyCurvePtrA[0]-&gt;Apply(Pixel[0]);</div>
<div class="line"><span class="lineno"> 5799</span>      Pixel[1] = m_ApplyCurvePtrA[1]-&gt;Apply(Pixel[1]);</div>
<div class="line"><span class="lineno"> 5800</span>      Pixel[2] = m_ApplyCurvePtrA[2]-&gt;Apply(Pixel[2]);</div>
<div class="line"><span class="lineno"> 5801</span>    }</div>
<div class="line"><span class="lineno"> 5802</span> </div>
<div class="line"><span class="lineno"> 5803</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CLUT) {</div>
<div class="line"><span class="lineno"> 5804</span>      <span class="keywordflow">if</span> (m_nInterp==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913af6e0f18af557a029c4dda563c3a003fb">icInterpLinear</a>)</div>
<div class="line"><span class="lineno"> 5805</span>        m_pTag-&gt;m_CLUT-&gt;Interp3d(Pixel, Pixel);</div>
<div class="line"><span class="lineno"> 5806</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5807</span>        m_pTag-&gt;m_CLUT-&gt;Interp3dTetra(Pixel, Pixel);</div>
<div class="line"><span class="lineno"> 5808</span>    }</div>
<div class="line"><span class="lineno"> 5809</span> </div>
<div class="line"><span class="lineno"> 5810</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrM) {</div>
<div class="line"><span class="lineno"> 5811</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 5812</span>        Pixel[i] = m_ApplyCurvePtrM[i]-&gt;Apply(Pixel[i]);</div>
<div class="line"><span class="lineno"> 5813</span>      }</div>
<div class="line"><span class="lineno"> 5814</span>    }</div>
<div class="line"><span class="lineno"> 5815</span> </div>
<div class="line"><span class="lineno"> 5816</span>    <span class="keywordflow">if</span> (m_ApplyMatrixPtr) {</div>
<div class="line"><span class="lineno"> 5817</span>      m_ApplyMatrixPtr-&gt;Apply(Pixel);</div>
<div class="line"><span class="lineno"> 5818</span>    }</div>
<div class="line"><span class="lineno"> 5819</span> </div>
<div class="line"><span class="lineno"> 5820</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrB) {</div>
<div class="line"><span class="lineno"> 5821</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 5822</span>        Pixel[i] = m_ApplyCurvePtrB[i]-&gt;Apply(Pixel[i]);</div>
<div class="line"><span class="lineno"> 5823</span>      }</div>
<div class="line"><span class="lineno"> 5824</span>    }</div>
<div class="line"><span class="lineno"> 5825</span>  }</div>
<div class="line"><span class="lineno"> 5826</span> </div>
<div class="line"><span class="lineno"> 5827</span>  <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 5828</span>    DstPixel[i] = Pixel[i];</div>
<div class="line"><span class="lineno"> 5829</span>  }</div>
<div class="line"><span class="lineno"> 5830</span> </div>
<div class="line"><span class="lineno"> 5831</span>  <span class="keywordflow">if</span> (m_bDstPcsConversion)</div>
<div class="line"><span class="lineno"> 5832</span>    CheckDstAbs(DstPixel);</div>
<div class="line"><span class="lineno"> 5833</span>}</div>
<div class="line"><span class="lineno"> 5834</span> </div>
<div class="line"><span class="lineno"> 5849</span><a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* CIccXform3DLut::ExtractInputCurves()</div>
<div class="line"><span class="lineno"> 5850</span>{</div>
<div class="line"><span class="lineno"> 5851</span>  <span class="keywordflow">if</span> (m_bInput) {</div>
<div class="line"><span class="lineno"> 5852</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 5853</span>      <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesB) {</div>
<div class="line"><span class="lineno"> 5854</span>        <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[3];</div>
<div class="line"><span class="lineno"> 5855</span>                Curve[0] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesB[0]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5856</span>                Curve[1] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesB[1]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5857</span>                Curve[2] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesB[2]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5858</span>        m_ApplyCurvePtrB = NULL;</div>
<div class="line"><span class="lineno"> 5859</span>        <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 5860</span>      }</div>
<div class="line"><span class="lineno"> 5861</span>    }</div>
<div class="line"><span class="lineno"> 5862</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5863</span>      <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesA) {</div>
<div class="line"><span class="lineno"> 5864</span>        <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[3];</div>
<div class="line"><span class="lineno"> 5865</span>                Curve[0] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesA[0]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5866</span>                Curve[1] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesA[1]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5867</span>                Curve[2] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesA[2]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5868</span>        m_ApplyCurvePtrA = NULL;</div>
<div class="line"><span class="lineno"> 5869</span>        <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 5870</span>      }</div>
<div class="line"><span class="lineno"> 5871</span>    }</div>
<div class="line"><span class="lineno"> 5872</span>  }</div>
<div class="line"><span class="lineno"> 5873</span> </div>
<div class="line"><span class="lineno"> 5874</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 5875</span>}</div>
<div class="line"><span class="lineno"> 5876</span> </div>
<div class="line"><span class="lineno"> 5891</span><a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* CIccXform3DLut::ExtractOutputCurves()</div>
<div class="line"><span class="lineno"> 5892</span>{</div>
<div class="line"><span class="lineno"> 5893</span>  <span class="keywordflow">if</span> (!m_bInput) {</div>
<div class="line"><span class="lineno"> 5894</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 5895</span>      <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesA) {</div>
<div class="line"><span class="lineno"> 5896</span>        <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[m_pTag-&gt;m_nOutput];</div>
<div class="line"><span class="lineno"> 5897</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 5898</span>                    Curve[i] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesA[i]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5899</span>                }</div>
<div class="line"><span class="lineno"> 5900</span>        m_ApplyCurvePtrA = NULL;</div>
<div class="line"><span class="lineno"> 5901</span>        <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 5902</span>      }</div>
<div class="line"><span class="lineno"> 5903</span>    }</div>
<div class="line"><span class="lineno"> 5904</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 5905</span>      <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesB) {</div>
<div class="line"><span class="lineno"> 5906</span>        <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[m_pTag-&gt;m_nOutput];</div>
<div class="line"><span class="lineno"> 5907</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 5908</span>                    Curve[i] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesB[i]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 5909</span>                }</div>
<div class="line"><span class="lineno"> 5910</span>        m_ApplyCurvePtrB = NULL;</div>
<div class="line"><span class="lineno"> 5911</span>        <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 5912</span>      }</div>
<div class="line"><span class="lineno"> 5913</span>    }</div>
<div class="line"><span class="lineno"> 5914</span>  }</div>
<div class="line"><span class="lineno"> 5915</span> </div>
<div class="line"><span class="lineno"> 5916</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 5917</span>}</div>
<div class="line"><span class="lineno"> 5918</span> </div>
<div class="line"><span class="lineno"> 5930</span>CIccXform4DLut::CIccXform4DLut(<a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag)</div>
<div class="line"><span class="lineno"> 5931</span>{</div>
<div class="line"><span class="lineno"> 5932</span>  <span class="keywordflow">if</span> (pTag &amp;&amp; pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a5cf5b72ab66ca68a6c8ddfd861741bb8">IsMBBType</a>()) {</div>
<div class="line"><span class="lineno"> 5933</span>    m_pTag = (<a class="code hl_class" href="../../dc/d06/a01153.html">CIccMBB</a>*)pTag;</div>
<div class="line"><span class="lineno"> 5934</span>  }</div>
<div class="line"><span class="lineno"> 5935</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 5936</span>    m_pTag = NULL;</div>
<div class="line"><span class="lineno"> 5937</span> </div>
<div class="line"><span class="lineno"> 5938</span>  m_ApplyCurvePtrA = m_ApplyCurvePtrB = m_ApplyCurvePtrM = NULL;</div>
<div class="line"><span class="lineno"> 5939</span>  m_ApplyMatrixPtr = NULL;</div>
<div class="line"><span class="lineno"> 5940</span>}</div>
<div class="line"><span class="lineno"> 5941</span> </div>
<div class="line"><span class="lineno"> 5942</span> </div>
<div class="line"><span class="lineno"> 5951</span>CIccXform4DLut::~CIccXform4DLut()</div>
<div class="line"><span class="lineno"> 5952</span>{</div>
<div class="line"><span class="lineno"> 5953</span>}</div>
<div class="line"><span class="lineno"> 5954</span> </div>
<div class="line"><span class="lineno"> 5955</span> </div>
<div class="line"><span class="lineno"> 5966</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccXform4DLut::Begin()</div>
<div class="line"><span class="lineno"> 5967</span>{</div>
<div class="line"><span class="lineno"> 5968</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> status;</div>
<div class="line"><span class="lineno"> 5969</span>  <a class="code hl_class" href="../../dd/de4/a01121.html">CIccCurve</a> **Curve;</div>
<div class="line"><span class="lineno"> 5970</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 5971</span> </div>
<div class="line"><span class="lineno"> 5972</span>  status = CIccXform::Begin();</div>
<div class="line"><span class="lineno"> 5973</span>  <span class="keywordflow">if</span> (status != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 5974</span>    <span class="keywordflow">return</span> status;</div>
<div class="line"><span class="lineno"> 5975</span>  }</div>
<div class="line"><span class="lineno"> 5976</span> </div>
<div class="line"><span class="lineno"> 5977</span>  <span class="keywordflow">if</span> (!m_pTag ||</div>
<div class="line"><span class="lineno"> 5978</span>      m_pTag-&gt;InputChannels()!=4) {</div>
<div class="line"><span class="lineno"> 5979</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096">icCmmStatInvalidLut</a>;</div>
<div class="line"><span class="lineno"> 5980</span>  }</div>
<div class="line"><span class="lineno"> 5981</span> </div>
<div class="line"><span class="lineno"> 5982</span>  m_ApplyCurvePtrA = m_ApplyCurvePtrB = m_ApplyCurvePtrM = NULL;</div>
<div class="line"><span class="lineno"> 5983</span> </div>
<div class="line"><span class="lineno"> 5984</span>  <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 5985</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesB) {</div>
<div class="line"><span class="lineno"> 5986</span>      Curve = m_pTag-&gt;m_CurvesB;</div>
<div class="line"><span class="lineno"> 5987</span> </div>
<div class="line"><span class="lineno"> 5988</span>      Curve[0]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5989</span>      Curve[1]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5990</span>      Curve[2]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5991</span>      Curve[3]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 5992</span> </div>
<div class="line"><span class="lineno"> 5993</span>      <span class="keywordflow">if</span> (!Curve[0]-&gt;IsIdentity() || !Curve[1]-&gt;IsIdentity() ||</div>
<div class="line"><span class="lineno"> 5994</span>          !Curve[2]-&gt;IsIdentity() || !Curve[3]-&gt;IsIdentity()) </div>
<div class="line"><span class="lineno"> 5995</span>      {</div>
<div class="line"><span class="lineno"> 5996</span>        m_ApplyCurvePtrB = Curve;</div>
<div class="line"><span class="lineno"> 5997</span>      }</div>
<div class="line"><span class="lineno"> 5998</span>    }</div>
<div class="line"><span class="lineno"> 5999</span> </div>
<div class="line"><span class="lineno"> 6000</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CLUT) {</div>
<div class="line"><span class="lineno"> 6001</span>      m_pTag-&gt;m_CLUT-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 6002</span>    }</div>
<div class="line"><span class="lineno"> 6003</span> </div>
<div class="line"><span class="lineno"> 6004</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesA) {</div>
<div class="line"><span class="lineno"> 6005</span>      Curve = m_pTag-&gt;m_CurvesA;</div>
<div class="line"><span class="lineno"> 6006</span> </div>
<div class="line"><span class="lineno"> 6007</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6008</span>        Curve[i]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 6009</span>      }</div>
<div class="line"><span class="lineno"> 6010</span> </div>
<div class="line"><span class="lineno"> 6011</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6012</span>        <span class="keywordflow">if</span> (!Curve[i]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 6013</span>          m_ApplyCurvePtrA = Curve;</div>
<div class="line"><span class="lineno"> 6014</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6015</span>        }</div>
<div class="line"><span class="lineno"> 6016</span>      }</div>
<div class="line"><span class="lineno"> 6017</span>    }</div>
<div class="line"><span class="lineno"> 6018</span> </div>
<div class="line"><span class="lineno"> 6019</span>  }</div>
<div class="line"><span class="lineno"> 6020</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6021</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesA) {</div>
<div class="line"><span class="lineno"> 6022</span>      Curve = m_pTag-&gt;m_CurvesA;</div>
<div class="line"><span class="lineno"> 6023</span> </div>
<div class="line"><span class="lineno"> 6024</span>      Curve[0]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 6025</span>      Curve[1]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 6026</span>      Curve[2]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 6027</span>      Curve[3]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 6028</span> </div>
<div class="line"><span class="lineno"> 6029</span>      <span class="keywordflow">if</span> (!Curve[0]-&gt;IsIdentity() || !Curve[1]-&gt;IsIdentity() ||</div>
<div class="line"><span class="lineno"> 6030</span>          !Curve[2]-&gt;IsIdentity() || !Curve[3]-&gt;IsIdentity()) </div>
<div class="line"><span class="lineno"> 6031</span>      {</div>
<div class="line"><span class="lineno"> 6032</span>        m_ApplyCurvePtrA = Curve;</div>
<div class="line"><span class="lineno"> 6033</span>      }</div>
<div class="line"><span class="lineno"> 6034</span>    }</div>
<div class="line"><span class="lineno"> 6035</span> </div>
<div class="line"><span class="lineno"> 6036</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CLUT) {</div>
<div class="line"><span class="lineno"> 6037</span>      m_pTag-&gt;m_CLUT-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 6038</span>    }</div>
<div class="line"><span class="lineno"> 6039</span> </div>
<div class="line"><span class="lineno"> 6040</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesM) {</div>
<div class="line"><span class="lineno"> 6041</span>      Curve = m_pTag-&gt;m_CurvesM;</div>
<div class="line"><span class="lineno"> 6042</span> </div>
<div class="line"><span class="lineno"> 6043</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6044</span>        Curve[i]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 6045</span>      }</div>
<div class="line"><span class="lineno"> 6046</span> </div>
<div class="line"><span class="lineno"> 6047</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6048</span>        <span class="keywordflow">if</span> (!Curve[i]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 6049</span>          m_ApplyCurvePtrM = Curve;</div>
<div class="line"><span class="lineno"> 6050</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6051</span>        }</div>
<div class="line"><span class="lineno"> 6052</span>      }</div>
<div class="line"><span class="lineno"> 6053</span>    }</div>
<div class="line"><span class="lineno"> 6054</span> </div>
<div class="line"><span class="lineno"> 6055</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesB) {</div>
<div class="line"><span class="lineno"> 6056</span>      Curve = m_pTag-&gt;m_CurvesB;</div>
<div class="line"><span class="lineno"> 6057</span> </div>
<div class="line"><span class="lineno"> 6058</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6059</span>        Curve[i]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 6060</span>      }</div>
<div class="line"><span class="lineno"> 6061</span> </div>
<div class="line"><span class="lineno"> 6062</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6063</span>        <span class="keywordflow">if</span> (!Curve[i]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 6064</span>          m_ApplyCurvePtrB = Curve;</div>
<div class="line"><span class="lineno"> 6065</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6066</span>        }</div>
<div class="line"><span class="lineno"> 6067</span>      }</div>
<div class="line"><span class="lineno"> 6068</span>    }</div>
<div class="line"><span class="lineno"> 6069</span>  }</div>
<div class="line"><span class="lineno"> 6070</span> </div>
<div class="line"><span class="lineno"> 6071</span>  m_ApplyMatrixPtr = NULL;</div>
<div class="line"><span class="lineno"> 6072</span>  <span class="keywordflow">if</span> (m_pTag-&gt;m_Matrix) {</div>
<div class="line"><span class="lineno"> 6073</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 6074</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860">icCmmStatInvalidProfile</a>;</div>
<div class="line"><span class="lineno"> 6075</span>    }</div>
<div class="line"><span class="lineno"> 6076</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6077</span>      <span class="keywordflow">if</span> (m_pTag-&gt;m_nOutput!=3) {</div>
<div class="line"><span class="lineno"> 6078</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860">icCmmStatInvalidProfile</a>;</div>
<div class="line"><span class="lineno"> 6079</span>      }</div>
<div class="line"><span class="lineno"> 6080</span>    }</div>
<div class="line"><span class="lineno"> 6081</span> </div>
<div class="line"><span class="lineno"> 6082</span>    <span class="keywordflow">if</span> (!m_pTag-&gt;m_Matrix-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 6083</span>      m_ApplyMatrixPtr = m_pTag-&gt;m_Matrix;</div>
<div class="line"><span class="lineno"> 6084</span>    }</div>
<div class="line"><span class="lineno"> 6085</span>  }</div>
<div class="line"><span class="lineno"> 6086</span> </div>
<div class="line"><span class="lineno"> 6087</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 6088</span>}</div>
<div class="line"><span class="lineno"> 6089</span> </div>
<div class="line"><span class="lineno"> 6090</span> </div>
<div class="line"><span class="lineno"> 6104</span><span class="keywordtype">void</span> CIccXform4DLut::Apply(CIccApplyXform* pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 6105</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 6106</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> Pixel[16];</div>
<div class="line"><span class="lineno"> 6107</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 6108</span> </div>
<div class="line"><span class="lineno"> 6109</span>  <span class="keywordflow">if</span> (m_bSrcPcsConversion)</div>
<div class="line"><span class="lineno"> 6110</span>    SrcPixel = CheckSrcAbs(pApply, SrcPixel);</div>
<div class="line"><span class="lineno"> 6111</span> </div>
<div class="line"><span class="lineno"> 6112</span>  Pixel[0] = SrcPixel[0];</div>
<div class="line"><span class="lineno"> 6113</span>  Pixel[1] = SrcPixel[1];</div>
<div class="line"><span class="lineno"> 6114</span>  Pixel[2] = SrcPixel[2];</div>
<div class="line"><span class="lineno"> 6115</span>  Pixel[3] = SrcPixel[3];</div>
<div class="line"><span class="lineno"> 6116</span> </div>
<div class="line"><span class="lineno"> 6117</span>  <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 6118</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrB) {</div>
<div class="line"><span class="lineno"> 6119</span>      Pixel[0] = m_ApplyCurvePtrB[0]-&gt;Apply(Pixel[0]);</div>
<div class="line"><span class="lineno"> 6120</span>      Pixel[1] = m_ApplyCurvePtrB[1]-&gt;Apply(Pixel[1]);</div>
<div class="line"><span class="lineno"> 6121</span>      Pixel[2] = m_ApplyCurvePtrB[2]-&gt;Apply(Pixel[2]);</div>
<div class="line"><span class="lineno"> 6122</span>      Pixel[3] = m_ApplyCurvePtrB[3]-&gt;Apply(Pixel[3]);</div>
<div class="line"><span class="lineno"> 6123</span>    }</div>
<div class="line"><span class="lineno"> 6124</span> </div>
<div class="line"><span class="lineno"> 6125</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CLUT) {</div>
<div class="line"><span class="lineno"> 6126</span>      m_pTag-&gt;m_CLUT-&gt;Interp4d(Pixel, Pixel);</div>
<div class="line"><span class="lineno"> 6127</span>    }</div>
<div class="line"><span class="lineno"> 6128</span> </div>
<div class="line"><span class="lineno"> 6129</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrA) {</div>
<div class="line"><span class="lineno"> 6130</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6131</span>        Pixel[i] = m_ApplyCurvePtrA[i]-&gt;Apply(Pixel[i]);</div>
<div class="line"><span class="lineno"> 6132</span>      }</div>
<div class="line"><span class="lineno"> 6133</span>    }</div>
<div class="line"><span class="lineno"> 6134</span> </div>
<div class="line"><span class="lineno"> 6135</span>  }</div>
<div class="line"><span class="lineno"> 6136</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6137</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrA) {</div>
<div class="line"><span class="lineno"> 6138</span>      Pixel[0] = m_ApplyCurvePtrA[0]-&gt;Apply(Pixel[0]);</div>
<div class="line"><span class="lineno"> 6139</span>      Pixel[1] = m_ApplyCurvePtrA[1]-&gt;Apply(Pixel[1]);</div>
<div class="line"><span class="lineno"> 6140</span>      Pixel[2] = m_ApplyCurvePtrA[2]-&gt;Apply(Pixel[2]);</div>
<div class="line"><span class="lineno"> 6141</span>      Pixel[3] = m_ApplyCurvePtrA[3]-&gt;Apply(Pixel[3]);</div>
<div class="line"><span class="lineno"> 6142</span>    }</div>
<div class="line"><span class="lineno"> 6143</span> </div>
<div class="line"><span class="lineno"> 6144</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CLUT) {</div>
<div class="line"><span class="lineno"> 6145</span>      m_pTag-&gt;m_CLUT-&gt;Interp4d(Pixel, Pixel);</div>
<div class="line"><span class="lineno"> 6146</span>    }</div>
<div class="line"><span class="lineno"> 6147</span> </div>
<div class="line"><span class="lineno"> 6148</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrM) {</div>
<div class="line"><span class="lineno"> 6149</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6150</span>        Pixel[i] = m_ApplyCurvePtrM[i]-&gt;Apply(Pixel[i]);</div>
<div class="line"><span class="lineno"> 6151</span>      }</div>
<div class="line"><span class="lineno"> 6152</span>    }</div>
<div class="line"><span class="lineno"> 6153</span> </div>
<div class="line"><span class="lineno"> 6154</span>    <span class="keywordflow">if</span> (m_ApplyMatrixPtr) {</div>
<div class="line"><span class="lineno"> 6155</span>      m_ApplyMatrixPtr-&gt;Apply(Pixel);</div>
<div class="line"><span class="lineno"> 6156</span>    }</div>
<div class="line"><span class="lineno"> 6157</span> </div>
<div class="line"><span class="lineno"> 6158</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrB) {</div>
<div class="line"><span class="lineno"> 6159</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6160</span>        Pixel[i] = m_ApplyCurvePtrB[i]-&gt;Apply(Pixel[i]);</div>
<div class="line"><span class="lineno"> 6161</span>      }</div>
<div class="line"><span class="lineno"> 6162</span>    }</div>
<div class="line"><span class="lineno"> 6163</span>  }</div>
<div class="line"><span class="lineno"> 6164</span> </div>
<div class="line"><span class="lineno"> 6165</span>  <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6166</span>    DstPixel[i] = Pixel[i];</div>
<div class="line"><span class="lineno"> 6167</span>  }</div>
<div class="line"><span class="lineno"> 6168</span> </div>
<div class="line"><span class="lineno"> 6169</span>  <span class="keywordflow">if</span> (m_bDstPcsConversion)</div>
<div class="line"><span class="lineno"> 6170</span>    CheckDstAbs(DstPixel);</div>
<div class="line"><span class="lineno"> 6171</span>}</div>
<div class="line"><span class="lineno"> 6172</span> </div>
<div class="line"><span class="lineno"> 6187</span><a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* CIccXform4DLut::ExtractInputCurves()</div>
<div class="line"><span class="lineno"> 6188</span>{</div>
<div class="line"><span class="lineno"> 6189</span>    <span class="keywordflow">if</span> (m_bInput) {</div>
<div class="line"><span class="lineno"> 6190</span>        <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 6191</span>            <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesB) {</div>
<div class="line"><span class="lineno"> 6192</span>                <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[4];</div>
<div class="line"><span class="lineno"> 6193</span>                Curve[0] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesB[0]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 6194</span>                Curve[1] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesB[1]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 6195</span>                Curve[2] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesB[2]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 6196</span>                Curve[3] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesB[3]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 6197</span>                m_ApplyCurvePtrB = NULL;</div>
<div class="line"><span class="lineno"> 6198</span>                <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 6199</span>            }</div>
<div class="line"><span class="lineno"> 6200</span>        }</div>
<div class="line"><span class="lineno"> 6201</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6202</span>            <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesA) {</div>
<div class="line"><span class="lineno"> 6203</span>                <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[4];</div>
<div class="line"><span class="lineno"> 6204</span>                Curve[0] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesA[0]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 6205</span>                Curve[1] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesA[1]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 6206</span>                Curve[2] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesA[2]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 6207</span>                Curve[3] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesA[3]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 6208</span>                m_ApplyCurvePtrA = NULL;</div>
<div class="line"><span class="lineno"> 6209</span>                <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 6210</span>            }</div>
<div class="line"><span class="lineno"> 6211</span>        }</div>
<div class="line"><span class="lineno"> 6212</span>    }</div>
<div class="line"><span class="lineno"> 6213</span> </div>
<div class="line"><span class="lineno"> 6214</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 6215</span>}</div>
<div class="line"><span class="lineno"> 6216</span> </div>
<div class="line"><span class="lineno"> 6231</span><a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* CIccXform4DLut::ExtractOutputCurves()</div>
<div class="line"><span class="lineno"> 6232</span>{</div>
<div class="line"><span class="lineno"> 6233</span>    <span class="keywordflow">if</span> (!m_bInput) {</div>
<div class="line"><span class="lineno"> 6234</span>        <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 6235</span>            <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesA) {</div>
<div class="line"><span class="lineno"> 6236</span>                <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[m_pTag-&gt;m_nOutput];</div>
<div class="line"><span class="lineno"> 6237</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6238</span>                    Curve[i] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesA[i]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 6239</span>                }</div>
<div class="line"><span class="lineno"> 6240</span>                m_ApplyCurvePtrA = NULL;</div>
<div class="line"><span class="lineno"> 6241</span>                <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 6242</span>            }</div>
<div class="line"><span class="lineno"> 6243</span>        }</div>
<div class="line"><span class="lineno"> 6244</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6245</span>            <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesB) {</div>
<div class="line"><span class="lineno"> 6246</span>                <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[m_pTag-&gt;m_nOutput];</div>
<div class="line"><span class="lineno"> 6247</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6248</span>                    Curve[i] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesB[i]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 6249</span>                }</div>
<div class="line"><span class="lineno"> 6250</span>                m_ApplyCurvePtrB = NULL;</div>
<div class="line"><span class="lineno"> 6251</span>                <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 6252</span>            }</div>
<div class="line"><span class="lineno"> 6253</span>        }</div>
<div class="line"><span class="lineno"> 6254</span>    }</div>
<div class="line"><span class="lineno"> 6255</span> </div>
<div class="line"><span class="lineno"> 6256</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 6257</span>}</div>
<div class="line"><span class="lineno"> 6258</span> </div>
<div class="line"><span class="lineno"> 6259</span> </div>
<div class="line"><span class="lineno"> 6271</span>CIccXformNDLut::CIccXformNDLut(<a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag)</div>
<div class="line"><span class="lineno"> 6272</span>{</div>
<div class="line"><span class="lineno"> 6273</span>  <span class="keywordflow">if</span> (pTag &amp;&amp; pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a5cf5b72ab66ca68a6c8ddfd861741bb8">IsMBBType</a>()) {</div>
<div class="line"><span class="lineno"> 6274</span>    m_pTag = (<a class="code hl_class" href="../../dc/d06/a01153.html">CIccMBB</a>*)pTag;</div>
<div class="line"><span class="lineno"> 6275</span>  }</div>
<div class="line"><span class="lineno"> 6276</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 6277</span>    m_pTag = NULL;</div>
<div class="line"><span class="lineno"> 6278</span> </div>
<div class="line"><span class="lineno"> 6279</span>  m_ApplyCurvePtrA = m_ApplyCurvePtrB = m_ApplyCurvePtrM = NULL;</div>
<div class="line"><span class="lineno"> 6280</span>  m_ApplyMatrixPtr = NULL;</div>
<div class="line"><span class="lineno"> 6281</span>  m_nNumInput = 0;</div>
<div class="line"><span class="lineno"> 6282</span>}</div>
<div class="line"><span class="lineno"> 6283</span> </div>
<div class="line"><span class="lineno"> 6284</span> </div>
<div class="line"><span class="lineno"> 6293</span>CIccXformNDLut::~CIccXformNDLut()</div>
<div class="line"><span class="lineno"> 6294</span>{</div>
<div class="line"><span class="lineno"> 6295</span>}</div>
<div class="line"><span class="lineno"> 6296</span> </div>
<div class="line"><span class="lineno"> 6297</span> </div>
<div class="line"><span class="lineno"> 6308</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccXformNDLut::Begin()</div>
<div class="line"><span class="lineno"> 6309</span>{</div>
<div class="line"><span class="lineno"> 6310</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> status;</div>
<div class="line"><span class="lineno"> 6311</span>  <a class="code hl_class" href="../../dd/de4/a01121.html">CIccCurve</a> **Curve;</div>
<div class="line"><span class="lineno"> 6312</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 6313</span> </div>
<div class="line"><span class="lineno"> 6314</span>  status = CIccXform::Begin();</div>
<div class="line"><span class="lineno"> 6315</span>  <span class="keywordflow">if</span> (status != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 6316</span>    <span class="keywordflow">return</span> status;</div>
<div class="line"><span class="lineno"> 6317</span>  }</div>
<div class="line"><span class="lineno"> 6318</span> </div>
<div class="line"><span class="lineno"> 6319</span>  <span class="keywordflow">if</span> (!m_pTag || (m_pTag-&gt;InputChannels()&gt;2 &amp;&amp; m_pTag-&gt;InputChannels()&lt;5)) {</div>
<div class="line"><span class="lineno"> 6320</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096">icCmmStatInvalidLut</a>;</div>
<div class="line"><span class="lineno"> 6321</span>  }</div>
<div class="line"><span class="lineno"> 6322</span> </div>
<div class="line"><span class="lineno"> 6323</span>  m_nNumInput = m_pTag-&gt;m_nInput;</div>
<div class="line"><span class="lineno"> 6324</span> </div>
<div class="line"><span class="lineno"> 6325</span>  m_ApplyCurvePtrA = m_ApplyCurvePtrB = m_ApplyCurvePtrM = NULL;</div>
<div class="line"><span class="lineno"> 6326</span> </div>
<div class="line"><span class="lineno"> 6327</span>  <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 6328</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesB) {</div>
<div class="line"><span class="lineno"> 6329</span>      Curve = m_pTag-&gt;m_CurvesB;</div>
<div class="line"><span class="lineno"> 6330</span> </div>
<div class="line"><span class="lineno"> 6331</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_nNumInput; i++)</div>
<div class="line"><span class="lineno"> 6332</span>        Curve[i]-&gt;Begin();</div>
<div class="line"><span class="lineno"> 6333</span> </div>
<div class="line"><span class="lineno"> 6334</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_nNumInput; i++) {</div>
<div class="line"><span class="lineno"> 6335</span>        <span class="keywordflow">if</span> (!Curve[i]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 6336</span>          m_ApplyCurvePtrB = Curve;</div>
<div class="line"><span class="lineno"> 6337</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6338</span>        }</div>
<div class="line"><span class="lineno"> 6339</span>      }</div>
<div class="line"><span class="lineno"> 6340</span>    }</div>
<div class="line"><span class="lineno"> 6341</span> </div>
<div class="line"><span class="lineno"> 6342</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CLUT) {</div>
<div class="line"><span class="lineno"> 6343</span>      m_pTag-&gt;m_CLUT-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 6344</span>    }</div>
<div class="line"><span class="lineno"> 6345</span> </div>
<div class="line"><span class="lineno"> 6346</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesA) {</div>
<div class="line"><span class="lineno"> 6347</span>      Curve = m_pTag-&gt;m_CurvesA;</div>
<div class="line"><span class="lineno"> 6348</span> </div>
<div class="line"><span class="lineno"> 6349</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6350</span>        Curve[i]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 6351</span>      }</div>
<div class="line"><span class="lineno"> 6352</span> </div>
<div class="line"><span class="lineno"> 6353</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6354</span>        <span class="keywordflow">if</span> (!Curve[i]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 6355</span>          m_ApplyCurvePtrA = Curve;</div>
<div class="line"><span class="lineno"> 6356</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6357</span>        }</div>
<div class="line"><span class="lineno"> 6358</span>      }</div>
<div class="line"><span class="lineno"> 6359</span>    }</div>
<div class="line"><span class="lineno"> 6360</span> </div>
<div class="line"><span class="lineno"> 6361</span>  }</div>
<div class="line"><span class="lineno"> 6362</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6363</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesA) {</div>
<div class="line"><span class="lineno"> 6364</span>      Curve = m_pTag-&gt;m_CurvesA;</div>
<div class="line"><span class="lineno"> 6365</span> </div>
<div class="line"><span class="lineno"> 6366</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_nNumInput; i++)</div>
<div class="line"><span class="lineno"> 6367</span>        Curve[i]-&gt;Begin();</div>
<div class="line"><span class="lineno"> 6368</span> </div>
<div class="line"><span class="lineno"> 6369</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_nNumInput; i++) {</div>
<div class="line"><span class="lineno"> 6370</span>        <span class="keywordflow">if</span> (!Curve[i]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 6371</span>          m_ApplyCurvePtrA = Curve;</div>
<div class="line"><span class="lineno"> 6372</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6373</span>        }</div>
<div class="line"><span class="lineno"> 6374</span>      }</div>
<div class="line"><span class="lineno"> 6375</span>    }</div>
<div class="line"><span class="lineno"> 6376</span> </div>
<div class="line"><span class="lineno"> 6377</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CLUT) {</div>
<div class="line"><span class="lineno"> 6378</span>      m_pTag-&gt;m_CLUT-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 6379</span>    }</div>
<div class="line"><span class="lineno"> 6380</span> </div>
<div class="line"><span class="lineno"> 6381</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesM) {</div>
<div class="line"><span class="lineno"> 6382</span>      Curve = m_pTag-&gt;m_CurvesM;</div>
<div class="line"><span class="lineno"> 6383</span> </div>
<div class="line"><span class="lineno"> 6384</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6385</span>        Curve[i]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 6386</span>      }</div>
<div class="line"><span class="lineno"> 6387</span> </div>
<div class="line"><span class="lineno"> 6388</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6389</span>        <span class="keywordflow">if</span> (!Curve[i]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 6390</span>          m_ApplyCurvePtrM = Curve;</div>
<div class="line"><span class="lineno"> 6391</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6392</span>        }</div>
<div class="line"><span class="lineno"> 6393</span>      }</div>
<div class="line"><span class="lineno"> 6394</span>    }</div>
<div class="line"><span class="lineno"> 6395</span> </div>
<div class="line"><span class="lineno"> 6396</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesB) {</div>
<div class="line"><span class="lineno"> 6397</span>      Curve = m_pTag-&gt;m_CurvesB;</div>
<div class="line"><span class="lineno"> 6398</span> </div>
<div class="line"><span class="lineno"> 6399</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6400</span>        Curve[i]-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">Begin</a>();</div>
<div class="line"><span class="lineno"> 6401</span>      }</div>
<div class="line"><span class="lineno"> 6402</span> </div>
<div class="line"><span class="lineno"> 6403</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6404</span>        <span class="keywordflow">if</span> (!Curve[i]-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 6405</span>          m_ApplyCurvePtrB = Curve;</div>
<div class="line"><span class="lineno"> 6406</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6407</span>        }</div>
<div class="line"><span class="lineno"> 6408</span>      }</div>
<div class="line"><span class="lineno"> 6409</span>    }</div>
<div class="line"><span class="lineno"> 6410</span>  }</div>
<div class="line"><span class="lineno"> 6411</span> </div>
<div class="line"><span class="lineno"> 6412</span>  m_ApplyMatrixPtr = NULL;</div>
<div class="line"><span class="lineno"> 6413</span>  <span class="keywordflow">if</span> (m_pTag-&gt;m_Matrix) {</div>
<div class="line"><span class="lineno"> 6414</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 6415</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860">icCmmStatInvalidProfile</a>;</div>
<div class="line"><span class="lineno"> 6416</span>    }</div>
<div class="line"><span class="lineno"> 6417</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6418</span>      <span class="keywordflow">if</span> (m_pTag-&gt;m_nOutput!=3) {</div>
<div class="line"><span class="lineno"> 6419</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860">icCmmStatInvalidProfile</a>;</div>
<div class="line"><span class="lineno"> 6420</span>      }</div>
<div class="line"><span class="lineno"> 6421</span>    }</div>
<div class="line"><span class="lineno"> 6422</span> </div>
<div class="line"><span class="lineno"> 6423</span>    <span class="keywordflow">if</span> (!m_pTag-&gt;m_Matrix-&gt;IsIdentity()) {</div>
<div class="line"><span class="lineno"> 6424</span>      m_ApplyMatrixPtr = m_pTag-&gt;m_Matrix;</div>
<div class="line"><span class="lineno"> 6425</span>    }</div>
<div class="line"><span class="lineno"> 6426</span>  }</div>
<div class="line"><span class="lineno"> 6427</span> </div>
<div class="line"><span class="lineno"> 6428</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 6429</span>}</div>
<div class="line"><span class="lineno"> 6430</span> </div>
<div class="line"><span class="lineno"> 6431</span> </div>
<div class="line"><span class="lineno"> 6443</span>CIccApplyXform* CIccXformNDLut::GetNewApply(<a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a>&amp; status)</div>
<div class="line"><span class="lineno"> 6444</span>{</div>
<div class="line"><span class="lineno"> 6445</span>  <span class="keywordflow">if</span> (!m_pTag)</div>
<div class="line"><span class="lineno"> 6446</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 6447</span> </div>
<div class="line"><span class="lineno"> 6448</span>  <a class="code hl_class" href="../../d8/d02/a01149.html">CIccCLUT</a>* pCLUT = m_pTag-&gt;GetCLUT();</div>
<div class="line"><span class="lineno"> 6449</span>  <a class="code hl_class" href="../../d9/d65/a01145.html">CIccApplyCLUT</a>* pApply = NULL;</div>
<div class="line"><span class="lineno"> 6450</span> </div>
<div class="line"><span class="lineno"> 6451</span>  <span class="keywordflow">if</span> (pCLUT &amp;&amp; m_nNumInput &gt; 6) {</div>
<div class="line"><span class="lineno"> 6452</span>    pApply = pCLUT-&gt;<a class="code hl_function" href="../../d8/d02/a01149.html#af5d5680c45af970ec254e32f06b15c41">GetNewApply</a>();</div>
<div class="line"><span class="lineno"> 6453</span>    <span class="keywordflow">if</span> (!pApply) {</div>
<div class="line"><span class="lineno"> 6454</span>      status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 6455</span>      <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 6456</span>    }</div>
<div class="line"><span class="lineno"> 6457</span>  }</div>
<div class="line"><span class="lineno"> 6458</span> </div>
<div class="line"><span class="lineno"> 6459</span>  CIccApplyNDLutXform* rv = <span class="keyword">new</span> CIccApplyNDLutXform(<span class="keyword">this</span>, pApply);</div>
<div class="line"><span class="lineno"> 6460</span>  </div>
<div class="line"><span class="lineno"> 6461</span>  <span class="keywordflow">if</span> (!rv) {</div>
<div class="line"><span class="lineno"> 6462</span>    <span class="keywordflow">if</span> (pApply)</div>
<div class="line"><span class="lineno"> 6463</span>      <span class="keyword">delete</span> pApply;</div>
<div class="line"><span class="lineno"> 6464</span>    status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 6465</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 6466</span>  }</div>
<div class="line"><span class="lineno"> 6467</span> </div>
<div class="line"><span class="lineno"> 6468</span>  status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 6469</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 6470</span>}</div>
<div class="line"><span class="lineno"> 6471</span> </div>
<div class="line"><span class="lineno"> 6485</span><span class="keywordtype">void</span> CIccXformNDLut::Apply(CIccApplyXform* pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 6486</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 6487</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> Pixel[16] = {0};</div>
<div class="line"><span class="lineno"> 6488</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno"> 6489</span> </div>
<div class="line"><span class="lineno"> 6490</span>  <span class="keywordflow">if</span> (m_bSrcPcsConversion)</div>
<div class="line"><span class="lineno"> 6491</span>    SrcPixel = CheckSrcAbs(pApply, SrcPixel);</div>
<div class="line"><span class="lineno"> 6492</span> </div>
<div class="line"><span class="lineno"> 6493</span>  <span class="keywordflow">for</span> (i=0; i&lt;m_nNumInput; i++)</div>
<div class="line"><span class="lineno"> 6494</span>    Pixel[i] = SrcPixel[i];</div>
<div class="line"><span class="lineno"> 6495</span> </div>
<div class="line"><span class="lineno"> 6496</span>  <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 6497</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrB) {</div>
<div class="line"><span class="lineno"> 6498</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_nNumInput; i++)</div>
<div class="line"><span class="lineno"> 6499</span>        Pixel[i] = m_ApplyCurvePtrB[i]-&gt;Apply(Pixel[i]);</div>
<div class="line"><span class="lineno"> 6500</span>    }</div>
<div class="line"><span class="lineno"> 6501</span> </div>
<div class="line"><span class="lineno"> 6502</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CLUT) {</div>
<div class="line"><span class="lineno"> 6503</span>      <span class="keywordflow">switch</span>(m_nNumInput) {</div>
<div class="line"><span class="lineno"> 6504</span>      <span class="keywordflow">case</span> 5:</div>
<div class="line"><span class="lineno"> 6505</span>        m_pTag-&gt;m_CLUT-&gt;Interp5d(Pixel, Pixel);</div>
<div class="line"><span class="lineno"> 6506</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6507</span>      <span class="keywordflow">case</span> 6:</div>
<div class="line"><span class="lineno"> 6508</span>        m_pTag-&gt;m_CLUT-&gt;Interp6d(Pixel, Pixel);</div>
<div class="line"><span class="lineno"> 6509</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6510</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 6511</span>        {</div>
<div class="line"><span class="lineno"> 6512</span>          CIccApplyNDLutXform* pNDApply = (CIccApplyNDLutXform*)pApply;</div>
<div class="line"><span class="lineno"> 6513</span>          m_pTag-&gt;m_CLUT-&gt;InterpND(Pixel, Pixel, pNDApply-&gt;m_pApply);</div>
<div class="line"><span class="lineno"> 6514</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6515</span>        }</div>
<div class="line"><span class="lineno"> 6516</span>      }</div>
<div class="line"><span class="lineno"> 6517</span>    }</div>
<div class="line"><span class="lineno"> 6518</span> </div>
<div class="line"><span class="lineno"> 6519</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrA) {</div>
<div class="line"><span class="lineno"> 6520</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6521</span>        Pixel[i] = m_ApplyCurvePtrA[i]-&gt;Apply(Pixel[i]);</div>
<div class="line"><span class="lineno"> 6522</span>      }</div>
<div class="line"><span class="lineno"> 6523</span>    }</div>
<div class="line"><span class="lineno"> 6524</span> </div>
<div class="line"><span class="lineno"> 6525</span>  }</div>
<div class="line"><span class="lineno"> 6526</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6527</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrA) {</div>
<div class="line"><span class="lineno"> 6528</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_nNumInput; i++)</div>
<div class="line"><span class="lineno"> 6529</span>        Pixel[i] = m_ApplyCurvePtrA[i]-&gt;Apply(Pixel[i]);</div>
<div class="line"><span class="lineno"> 6530</span>    }</div>
<div class="line"><span class="lineno"> 6531</span> </div>
<div class="line"><span class="lineno"> 6532</span>    <span class="keywordflow">if</span> (m_pTag-&gt;m_CLUT) {</div>
<div class="line"><span class="lineno"> 6533</span>      <span class="keywordflow">switch</span>(m_nNumInput) {</div>
<div class="line"><span class="lineno"> 6534</span>      <span class="keywordflow">case</span> 5:</div>
<div class="line"><span class="lineno"> 6535</span>        m_pTag-&gt;m_CLUT-&gt;Interp5d(Pixel, Pixel);</div>
<div class="line"><span class="lineno"> 6536</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6537</span>      <span class="keywordflow">case</span> 6:</div>
<div class="line"><span class="lineno"> 6538</span>        m_pTag-&gt;m_CLUT-&gt;Interp6d(Pixel, Pixel);</div>
<div class="line"><span class="lineno"> 6539</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6540</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 6541</span>      {</div>
<div class="line"><span class="lineno"> 6542</span>        CIccApplyNDLutXform* pNDApply = (CIccApplyNDLutXform*)pApply;</div>
<div class="line"><span class="lineno"> 6543</span>        m_pTag-&gt;m_CLUT-&gt;InterpND(Pixel, Pixel, pNDApply-&gt;m_pApply);</div>
<div class="line"><span class="lineno"> 6544</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6545</span>      }</div>
<div class="line"><span class="lineno"> 6546</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 6547</span>      }</div>
<div class="line"><span class="lineno"> 6548</span>    }</div>
<div class="line"><span class="lineno"> 6549</span> </div>
<div class="line"><span class="lineno"> 6550</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrM) {</div>
<div class="line"><span class="lineno"> 6551</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6552</span>        Pixel[i] = m_ApplyCurvePtrM[i]-&gt;Apply(Pixel[i]);</div>
<div class="line"><span class="lineno"> 6553</span>      }</div>
<div class="line"><span class="lineno"> 6554</span>    }</div>
<div class="line"><span class="lineno"> 6555</span> </div>
<div class="line"><span class="lineno"> 6556</span>    <span class="keywordflow">if</span> (m_ApplyMatrixPtr) {</div>
<div class="line"><span class="lineno"> 6557</span>      m_ApplyMatrixPtr-&gt;Apply(Pixel);</div>
<div class="line"><span class="lineno"> 6558</span>    }</div>
<div class="line"><span class="lineno"> 6559</span> </div>
<div class="line"><span class="lineno"> 6560</span>    <span class="keywordflow">if</span> (m_ApplyCurvePtrB) {</div>
<div class="line"><span class="lineno"> 6561</span>      <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6562</span>        Pixel[i] = m_ApplyCurvePtrB[i]-&gt;Apply(Pixel[i]);</div>
<div class="line"><span class="lineno"> 6563</span>      }</div>
<div class="line"><span class="lineno"> 6564</span>    }</div>
<div class="line"><span class="lineno"> 6565</span>  }</div>
<div class="line"><span class="lineno"> 6566</span> </div>
<div class="line"><span class="lineno"> 6567</span>  <span class="keywordflow">for</span> (i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6568</span>    DstPixel[i] = Pixel[i];</div>
<div class="line"><span class="lineno"> 6569</span>  }</div>
<div class="line"><span class="lineno"> 6570</span> </div>
<div class="line"><span class="lineno"> 6571</span>  <span class="keywordflow">if</span> (m_bDstPcsConversion)</div>
<div class="line"><span class="lineno"> 6572</span>    CheckDstAbs(DstPixel);</div>
<div class="line"><span class="lineno"> 6573</span>}</div>
<div class="line"><span class="lineno"> 6574</span> </div>
<div class="line"><span class="lineno"> 6589</span><a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* CIccXformNDLut::ExtractInputCurves()</div>
<div class="line"><span class="lineno"> 6590</span>{</div>
<div class="line"><span class="lineno"> 6591</span>    <span class="keywordflow">if</span> (m_bInput) {</div>
<div class="line"><span class="lineno"> 6592</span>        <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 6593</span>            <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesB) {</div>
<div class="line"><span class="lineno"> 6594</span>                <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[m_pTag-&gt;m_nInput];</div>
<div class="line"><span class="lineno"> 6595</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;m_pTag-&gt;m_nInput; i++) {</div>
<div class="line"><span class="lineno"> 6596</span>                    Curve[i] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesB[i]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 6597</span>                }</div>
<div class="line"><span class="lineno"> 6598</span>                m_ApplyCurvePtrB = NULL;</div>
<div class="line"><span class="lineno"> 6599</span>                <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 6600</span>            }</div>
<div class="line"><span class="lineno"> 6601</span>        }</div>
<div class="line"><span class="lineno"> 6602</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6603</span>            <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesA) {</div>
<div class="line"><span class="lineno"> 6604</span>                <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[m_pTag-&gt;m_nInput];</div>
<div class="line"><span class="lineno"> 6605</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;m_pTag-&gt;m_nInput; i++) {</div>
<div class="line"><span class="lineno"> 6606</span>                    Curve[i] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesA[i]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 6607</span>                }</div>
<div class="line"><span class="lineno"> 6608</span>                m_ApplyCurvePtrA = NULL;</div>
<div class="line"><span class="lineno"> 6609</span>                <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 6610</span>            }</div>
<div class="line"><span class="lineno"> 6611</span>        }</div>
<div class="line"><span class="lineno"> 6612</span>    }</div>
<div class="line"><span class="lineno"> 6613</span> </div>
<div class="line"><span class="lineno"> 6614</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 6615</span>}</div>
<div class="line"><span class="lineno"> 6616</span> </div>
<div class="line"><span class="lineno"> 6631</span><a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* CIccXformNDLut::ExtractOutputCurves()</div>
<div class="line"><span class="lineno"> 6632</span>{</div>
<div class="line"><span class="lineno"> 6633</span>    <span class="keywordflow">if</span> (!m_bInput) {</div>
<div class="line"><span class="lineno"> 6634</span>        <span class="keywordflow">if</span> (m_pTag-&gt;m_bInputMatrix) {</div>
<div class="line"><span class="lineno"> 6635</span>            <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesA) {</div>
<div class="line"><span class="lineno"> 6636</span>                <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[m_pTag-&gt;m_nOutput];</div>
<div class="line"><span class="lineno"> 6637</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6638</span>                    Curve[i] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesA[i]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 6639</span>                }</div>
<div class="line"><span class="lineno"> 6640</span>                m_ApplyCurvePtrA = NULL;</div>
<div class="line"><span class="lineno"> 6641</span>                <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 6642</span>            }</div>
<div class="line"><span class="lineno"> 6643</span>        }</div>
<div class="line"><span class="lineno"> 6644</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6645</span>            <span class="keywordflow">if</span> (m_pTag-&gt;m_CurvesB) {</div>
<div class="line"><span class="lineno"> 6646</span>                <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>* Curve = <span class="keyword">new</span> <a class="code hl_class" href="../../dd/de4/a01121.html">LPIccCurve</a>[m_pTag-&gt;m_nOutput];</div>
<div class="line"><span class="lineno"> 6647</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;m_pTag-&gt;m_nOutput; i++) {</div>
<div class="line"><span class="lineno"> 6648</span>                    Curve[i] = (<a class="code hl_typedef" href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a>)(m_pTag-&gt;m_CurvesB[i]-&gt;NewCopy());</div>
<div class="line"><span class="lineno"> 6649</span>                }</div>
<div class="line"><span class="lineno"> 6650</span>                m_ApplyCurvePtrB = NULL;</div>
<div class="line"><span class="lineno"> 6651</span>                <span class="keywordflow">return</span> Curve;</div>
<div class="line"><span class="lineno"> 6652</span>            }</div>
<div class="line"><span class="lineno"> 6653</span>        }</div>
<div class="line"><span class="lineno"> 6654</span>    }</div>
<div class="line"><span class="lineno"> 6655</span> </div>
<div class="line"><span class="lineno"> 6656</span>  <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 6657</span>}</div>
<div class="line"><span class="lineno"> 6658</span> </div>
<div class="line"><span class="lineno"> 6672</span>CIccXformNamedColor::CIccXformNamedColor(<a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag, <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> csPcs, <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> csDevice, </div>
<div class="line"><span class="lineno"> 6673</span>                                         <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a852cf5d81aa3d65ff6a08c3eaafcd0dc">icSpectralColorSignature</a> csSpectralPcs<span class="comment">/* =icSigNoSpectralData */</span>,</div>
<div class="line"><span class="lineno"> 6674</span>                                         <span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> *pSpectralRange <span class="comment">/* = NULL */</span>,</div>
<div class="line"><span class="lineno"> 6675</span>                                         <span class="keyword">const</span> <a class="code hl_struct" href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a> *pBiSpectralRange <span class="comment">/* = NULL */</span>)</div>
<div class="line"><span class="lineno"> 6676</span>{</div>
<div class="line"><span class="lineno"> 6677</span>  m_nApplyInterface = icApplyPixel2Pixel; <span class="comment">// was uninitialized</span></div>
<div class="line"><span class="lineno"> 6678</span>  m_pTag = NULL;</div>
<div class="line"><span class="lineno"> 6679</span>  <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno"> 6680</span>    <span class="keywordflow">if</span> (pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">GetType</a>()==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddeabd3b6889c64ac3ffb16f1c48be950dc8">icSigNamedColor2Type</a>) {</div>
<div class="line"><span class="lineno"> 6681</span>      m_pTag = (<a class="code hl_class" href="../../d7/d59/a01013.html">CIccTagNamedColor2</a>*)pTag;</div>
<div class="line"><span class="lineno"> 6682</span>      m_pArray = NULL;</div>
<div class="line"><span class="lineno"> 6683</span> </div>
<div class="line"><span class="lineno"> 6684</span>      m_pTag-&gt;SetColorSpaces(csPcs, csDevice);</div>
<div class="line"><span class="lineno"> 6685</span>    }</div>
<div class="line"><span class="lineno"> 6686</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#acc454c2f425b8619187fc75f682d7aa4">GetTagArrayType</a>()==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a97bb6c6d4e1859ba7290162215ac8beba58bd0f3ca3c177aacc2b9fd1cbc0009b">icSigNamedColorArray</a>) {</div>
<div class="line"><span class="lineno"> 6687</span>      <a class="code hl_class" href="../../db/de0/a00465.html">CIccTagArray</a> *pArray = (<a class="code hl_class" href="../../db/de0/a00465.html">CIccTagArray</a>*)pTag;</div>
<div class="line"><span class="lineno"> 6688</span>      <a class="code hl_class" href="../../d5/d05/a00385.html">CIccArrayNamedColor</a> *pNamed = (<a class="code hl_class" href="../../d5/d05/a00385.html">CIccArrayNamedColor</a>*)pArray-&gt;<a class="code hl_function" href="../../db/de0/a00465.html#ab040f1c5616c6b39dc92a5d2516f7709">GetArrayHandler</a>();</div>
<div class="line"><span class="lineno"> 6689</span> </div>
<div class="line"><span class="lineno"> 6690</span>      <span class="keywordflow">if</span> (pNamed) {</div>
<div class="line"><span class="lineno"> 6691</span>        m_pTag = NULL;</div>
<div class="line"><span class="lineno"> 6692</span>        m_pArray = pNamed;</div>
<div class="line"><span class="lineno"> 6693</span>        pNamed-&gt;<a class="code hl_function" href="../../d5/d05/a00385.html#a823d6f29347e6f86de07de8bfad1ba89">SetColorSpaces</a>(csPcs, csDevice, csSpectralPcs, pSpectralRange, pBiSpectralRange);</div>
<div class="line"><span class="lineno"> 6694</span>      }</div>
<div class="line"><span class="lineno"> 6695</span>    }</div>
<div class="line"><span class="lineno"> 6696</span>  }</div>
<div class="line"><span class="lineno"> 6697</span> </div>
<div class="line"><span class="lineno"> 6698</span>  m_nSrcSpace = <a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a>;</div>
<div class="line"><span class="lineno"> 6699</span>  m_nDestSpace = <a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a>;</div>
<div class="line"><span class="lineno"> 6700</span>  m_pArray = NULL;</div>
<div class="line"><span class="lineno"> 6701</span>}</div>
<div class="line"><span class="lineno"> 6702</span> </div>
<div class="line"><span class="lineno"> 6703</span> </div>
<div class="line"><span class="lineno"> 6712</span>CIccXformNamedColor::~CIccXformNamedColor()</div>
<div class="line"><span class="lineno"> 6713</span>{</div>
<div class="line"><span class="lineno"> 6714</span>}</div>
<div class="line"><span class="lineno"> 6715</span> </div>
<div class="line"><span class="lineno"> 6726</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccXformNamedColor::Begin()</div>
<div class="line"><span class="lineno"> 6727</span>{</div>
<div class="line"><span class="lineno"> 6728</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> status;</div>
<div class="line"><span class="lineno"> 6729</span> </div>
<div class="line"><span class="lineno"> 6730</span>  status = CIccXform::Begin();</div>
<div class="line"><span class="lineno"> 6731</span>  <span class="keywordflow">if</span> (status != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno"> 6732</span>    <span class="keywordflow">return</span> status;</div>
<div class="line"><span class="lineno"> 6733</span> </div>
<div class="line"><span class="lineno"> 6734</span>  <span class="keywordflow">if</span> (m_pTag==NULL &amp;&amp; m_pArray==NULL) {</div>
<div class="line"><span class="lineno"> 6735</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a">icCmmStatProfileMissingTag</a>;</div>
<div class="line"><span class="lineno"> 6736</span>  }</div>
<div class="line"><span class="lineno"> 6737</span> </div>
<div class="line"><span class="lineno"> 6738</span>  <span class="keywordflow">if</span> (m_nSrcSpace==<a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a> ||</div>
<div class="line"><span class="lineno"> 6739</span>      m_nDestSpace==<a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a>) {</div>
<div class="line"><span class="lineno"> 6740</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno"> 6741</span>  }</div>
<div class="line"><span class="lineno"> 6742</span> </div>
<div class="line"><span class="lineno"> 6743</span>  <span class="keywordflow">if</span> (m_nSrcSpace != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>) {</div>
<div class="line"><span class="lineno"> 6744</span>    <span class="keywordflow">if</span> (m_nDestSpace != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>) {</div>
<div class="line"><span class="lineno"> 6745</span>      m_nApplyInterface = icApplyPixel2Pixel;</div>
<div class="line"><span class="lineno"> 6746</span>    }</div>
<div class="line"><span class="lineno"> 6747</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6748</span>      m_nApplyInterface = icApplyPixel2Named;</div>
<div class="line"><span class="lineno"> 6749</span>    }</div>
<div class="line"><span class="lineno"> 6750</span>  }</div>
<div class="line"><span class="lineno"> 6751</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6752</span>    <span class="keywordflow">if</span> (m_nDestSpace != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>) {</div>
<div class="line"><span class="lineno"> 6753</span>      m_nApplyInterface = icApplyNamed2Pixel;</div>
<div class="line"><span class="lineno"> 6754</span>    }</div>
<div class="line"><span class="lineno"> 6755</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6756</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno"> 6757</span>    }</div>
<div class="line"><span class="lineno"> 6758</span>  }</div>
<div class="line"><span class="lineno"> 6759</span> </div>
<div class="line"><span class="lineno"> 6760</span>  <span class="keywordflow">if</span> (m_pTag &amp;&amp; !m_pTag-&gt;InitFindCachedPCSColor())</div>
<div class="line"><span class="lineno"> 6761</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 6762</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_pArray &amp;&amp; !m_pArray-&gt;Begin())</div>
<div class="line"><span class="lineno"> 6763</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 6764</span> </div>
<div class="line"><span class="lineno"> 6765</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 6766</span>}</div>
<div class="line"><span class="lineno"> 6767</span> </div>
<div class="line"><span class="lineno"> 6768</span> </div>
<div class="line"><span class="lineno"> 6769</span> </div>
<div class="line"><span class="lineno"> 6783</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccXformNamedColor::Apply(CIccApplyXform* pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a> *DstColorName, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 6784</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 6785</span> </div>
<div class="line"><span class="lineno"> 6786</span>  <span class="keywordflow">if</span> (m_pArray) {</div>
<div class="line"><span class="lineno"> 6787</span>    <span class="keyword">const</span> <a class="code hl_class" href="../../d5/d05/a00385.html">CIccArrayNamedColor</a> *pArray = m_pArray;</div>
<div class="line"><span class="lineno"> 6788</span>    <a class="code hl_class" href="../../d7/d93/a00397.html">CIccStructNamedColor</a> *pColor;</div>
<div class="line"><span class="lineno"> 6789</span> </div>
<div class="line"><span class="lineno"> 6790</span>    std::string NamedColor;</div>
<div class="line"><span class="lineno"> 6791</span> </div>
<div class="line"><span class="lineno"> 6792</span>    <span class="keywordflow">if</span> (IsSrcPCS()) {</div>
<div class="line"><span class="lineno"> 6793</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/df8/a00155.html#a05df9b9a2f56c907e676a0efc3e9219d">IsSpaceSpectralPCS</a>(m_nSrcSpace)) {</div>
<div class="line"><span class="lineno"> 6794</span>        pColor = pArray-&gt;<a class="code hl_function" href="../../d5/d05/a00385.html#a6c3143e1f5a2433144786f86e7d9becc">FindSpectralColor</a>(SrcPixel);</div>
<div class="line"><span class="lineno"> 6795</span>        <span class="keywordflow">if</span> (pColor)</div>
<div class="line"><span class="lineno"> 6796</span>          NamedColor = pColor-&gt;<a class="code hl_function" href="../../d7/d93/a00397.html#a5e4aa1c33ed61d8d91ca597e57ab7177">getName</a>();</div>
<div class="line"><span class="lineno"> 6797</span>        <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 6798</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16">icCmmStatColorNotFound</a>;</div>
<div class="line"><span class="lineno"> 6799</span>      }</div>
<div class="line"><span class="lineno"> 6800</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6801</span>        <span class="keywordflow">if</span> (m_bSrcPcsConversion)</div>
<div class="line"><span class="lineno"> 6802</span>          SrcPixel = CheckSrcAbs(pApply, SrcPixel);</div>
<div class="line"><span class="lineno"> 6803</span> </div>
<div class="line"><span class="lineno"> 6804</span>        <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> pix[3];</div>
<div class="line"><span class="lineno"> 6805</span>        memcpy(pix, SrcPixel, 3*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 6806</span> </div>
<div class="line"><span class="lineno"> 6807</span>        <span class="keywordflow">if</span> (m_nSrcSpace == <a class="code hl_define" href="../../d7/d46/a00002.html#a043048bd0c63d3bd54d35e8b5743d226">icSigLabPcsData</a>)</div>
<div class="line"><span class="lineno"> 6808</span>          <a class="code hl_function" href="../../d7/dce/a00143.html#ac5de02865f572ea243f6da8c144c02fa">icLabFromPcs</a>(pix);</div>
<div class="line"><span class="lineno"> 6809</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6810</span>          <a class="code hl_function" href="../../d7/dce/a00143.html#a78841df2e0aea059520ce71944c4c3bb">icXyzFromPcs</a>(pix);</div>
<div class="line"><span class="lineno"> 6811</span>          <a class="code hl_function" href="../../d7/dce/a00143.html#a4ff45349385af6c19d5b3f68150a27b5">icXYZtoLab</a>(pix, pix);</div>
<div class="line"><span class="lineno"> 6812</span>        }</div>
<div class="line"><span class="lineno"> 6813</span> </div>
<div class="line"><span class="lineno"> 6814</span>        pColor = pArray-&gt;<a class="code hl_function" href="../../d5/d05/a00385.html#a94b8521face8ca8e1df119db8d7abeeb">FindPcsColor</a>(pix);</div>
<div class="line"><span class="lineno"> 6815</span>        <span class="keywordflow">if</span> (pColor) </div>
<div class="line"><span class="lineno"> 6816</span>          NamedColor = pColor-&gt;<a class="code hl_function" href="../../d7/d93/a00397.html#a5e4aa1c33ed61d8d91ca597e57ab7177">getName</a>();</div>
<div class="line"><span class="lineno"> 6817</span>        <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 6818</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16">icCmmStatColorNotFound</a>;</div>
<div class="line"><span class="lineno"> 6819</span>      }</div>
<div class="line"><span class="lineno"> 6820</span>    }</div>
<div class="line"><span class="lineno"> 6821</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6822</span>      pColor = pArray-&gt;<a class="code hl_function" href="../../d5/d05/a00385.html#a9425c5f4e45f89e119c7dd5add27f69a">FindDeviceColor</a>(SrcPixel);</div>
<div class="line"><span class="lineno"> 6823</span>      <span class="keywordflow">if</span> (pColor)</div>
<div class="line"><span class="lineno"> 6824</span>        NamedColor = pColor-&gt;<a class="code hl_function" href="../../d7/d93/a00397.html#a5e4aa1c33ed61d8d91ca597e57ab7177">getName</a>();</div>
<div class="line"><span class="lineno"> 6825</span>      <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 6826</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16">icCmmStatColorNotFound</a>;</div>
<div class="line"><span class="lineno"> 6827</span>    }</div>
<div class="line"><span class="lineno"> 6828</span> </div>
<div class="line"><span class="lineno"> 6829</span>    sprintf(DstColorName, <span class="stringliteral">&quot;%s&quot;</span>, NamedColor.c_str());</div>
<div class="line"><span class="lineno"> 6830</span>  }</div>
<div class="line"><span class="lineno"> 6831</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_pTag) {</div>
<div class="line"><span class="lineno"> 6832</span>    <span class="keyword">const</span> <a class="code hl_class" href="../../d7/d59/a01013.html">CIccTagNamedColor2</a> *pTag = m_pTag;</div>
<div class="line"><span class="lineno"> 6833</span> </div>
<div class="line"><span class="lineno"> 6834</span>    <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> DevicePix[16], PCSPix[3];</div>
<div class="line"><span class="lineno"> 6835</span>    std::string NamedColor;</div>
<div class="line"><span class="lineno"> 6836</span>    <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> i, j;</div>
<div class="line"><span class="lineno"> 6837</span> </div>
<div class="line"><span class="lineno"> 6838</span>    <span class="keywordflow">if</span> (IsSrcPCS()) {</div>
<div class="line"><span class="lineno"> 6839</span>      <span class="keywordflow">if</span> (m_bSrcPcsConversion)</div>
<div class="line"><span class="lineno"> 6840</span>        SrcPixel = CheckSrcAbs(pApply, SrcPixel);</div>
<div class="line"><span class="lineno"> 6841</span> </div>
<div class="line"><span class="lineno"> 6842</span>      <span class="keywordflow">for</span>(i=0; i&lt;3; i++)</div>
<div class="line"><span class="lineno"> 6843</span>        PCSPix[i] = SrcPixel[i];</div>
<div class="line"><span class="lineno"> 6844</span> </div>
<div class="line"><span class="lineno"> 6845</span>      j = pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#ac2fef9b4b97a913ce966f86d934c5ce4">FindCachedPCSColor</a>(PCSPix);</div>
<div class="line"><span class="lineno"> 6846</span>      pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#a2a06050ccddbf173a2fe355cdf6fa098">GetColorName</a>(NamedColor, j);</div>
<div class="line"><span class="lineno"> 6847</span>    }</div>
<div class="line"><span class="lineno"> 6848</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6849</span>      <span class="keywordflow">for</span>(i=0; i&lt;m_pTag-&gt;GetDeviceCoords(); i++)</div>
<div class="line"><span class="lineno"> 6850</span>        DevicePix[i] = SrcPixel[i];</div>
<div class="line"><span class="lineno"> 6851</span> </div>
<div class="line"><span class="lineno"> 6852</span>      j = pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#a0149970e81173a7e6136404d07bf7f5f">FindDeviceColor</a>(DevicePix);</div>
<div class="line"><span class="lineno"> 6853</span>      pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#a2a06050ccddbf173a2fe355cdf6fa098">GetColorName</a>(NamedColor, j);</div>
<div class="line"><span class="lineno"> 6854</span>    }</div>
<div class="line"><span class="lineno"> 6855</span> </div>
<div class="line"><span class="lineno"> 6856</span>    sprintf(DstColorName, <span class="stringliteral">&quot;%s&quot;</span>, NamedColor.c_str());</div>
<div class="line"><span class="lineno"> 6857</span>  }</div>
<div class="line"><span class="lineno"> 6858</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 6859</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno"> 6860</span> </div>
<div class="line"><span class="lineno"> 6861</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 6862</span>}</div>
<div class="line"><span class="lineno"> 6863</span> </div>
<div class="line"><span class="lineno"> 6864</span> </div>
<div class="line"><span class="lineno"> 6878</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccXformNamedColor::Apply(CIccApplyXform* pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a> *SrcColorName, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> tint)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 6879</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 6880</span> </div>
<div class="line"><span class="lineno"> 6881</span>  <span class="keywordflow">if</span> (m_pArray) {</div>
<div class="line"><span class="lineno"> 6882</span>    <span class="keyword">const</span> <a class="code hl_class" href="../../d5/d05/a00385.html">CIccArrayNamedColor</a> *pArray = m_pArray;</div>
<div class="line"><span class="lineno"> 6883</span> </div>
<div class="line"><span class="lineno"> 6884</span>    <a class="code hl_class" href="../../d7/d93/a00397.html">CIccStructNamedColor</a> *pColor;</div>
<div class="line"><span class="lineno"> 6885</span> </div>
<div class="line"><span class="lineno"> 6886</span>    <span class="keywordflow">if</span> (m_nSrcSpace != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>)</div>
<div class="line"><span class="lineno"> 6887</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 6888</span> </div>
<div class="line"><span class="lineno"> 6889</span>    pColor = pArray-&gt;<a class="code hl_function" href="../../d5/d05/a00385.html#a1304a41486d0a0f39ce483c1efdc5664">FindColor</a>(SrcColorName);</div>
<div class="line"><span class="lineno"> 6890</span>    <span class="keywordflow">if</span> (!pColor)</div>
<div class="line"><span class="lineno"> 6891</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16">icCmmStatColorNotFound</a>;</div>
<div class="line"><span class="lineno"> 6892</span> </div>
<div class="line"><span class="lineno"> 6893</span>    <span class="keywordflow">if</span> (IsDestPCS()) {</div>
<div class="line"><span class="lineno"> 6894</span>      <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/df8/a00155.html#a05df9b9a2f56c907e676a0efc3e9219d">IsSpaceSpectralPCS</a>(m_nDestSpace)) {</div>
<div class="line"><span class="lineno"> 6895</span>        <span class="keywordflow">if</span> (!pArray-&gt;<a class="code hl_function" href="../../d5/d05/a00385.html#a2aa8f9d61c012d05d22381c42d7c6b35">GetSpectralTint</a>(DstPixel, pColor, tint))</div>
<div class="line"><span class="lineno"> 6896</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6aacc0b85d049e6d79aa0704d2054e62be">icCmmStatBadTintXform</a>;</div>
<div class="line"><span class="lineno"> 6897</span>      }</div>
<div class="line"><span class="lineno"> 6898</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6899</span>        <span class="keywordflow">if</span> (!pArray-&gt;<a class="code hl_function" href="../../d5/d05/a00385.html#afd4f2f9a44dc33fa6f8d517f43949d09">GetPcsTint</a>(DstPixel, pColor, tint))</div>
<div class="line"><span class="lineno"> 6900</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6aacc0b85d049e6d79aa0704d2054e62be">icCmmStatBadTintXform</a>;</div>
<div class="line"><span class="lineno"> 6901</span> </div>
<div class="line"><span class="lineno"> 6902</span>        <span class="keywordflow">if</span> (m_nDestSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>) {</div>
<div class="line"><span class="lineno"> 6903</span>          <a class="code hl_function" href="../../d7/dce/a00143.html#a5768271d491af79a433e52722ed0a189">icLabToPcs</a>(DstPixel);</div>
<div class="line"><span class="lineno"> 6904</span>        }</div>
<div class="line"><span class="lineno"> 6905</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6906</span>          <a class="code hl_function" href="../../d7/dce/a00143.html#a4b4cfb7788c3a780f19f2f104677a5b8">icXyzToPcs</a>(DstPixel);</div>
<div class="line"><span class="lineno"> 6907</span>        }</div>
<div class="line"><span class="lineno"> 6908</span>        <span class="keywordflow">if</span> (m_bDstPcsConversion)</div>
<div class="line"><span class="lineno"> 6909</span>          CheckDstAbs(DstPixel);</div>
<div class="line"><span class="lineno"> 6910</span>      }</div>
<div class="line"><span class="lineno"> 6911</span>    }</div>
<div class="line"><span class="lineno"> 6912</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6913</span>      <span class="keywordflow">if</span> (!pArray-&gt;<a class="code hl_function" href="../../d5/d05/a00385.html#af4f89dcbac98bad8077327211a88b096">GetDeviceTint</a>(DstPixel, pColor, tint))</div>
<div class="line"><span class="lineno"> 6914</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6aacc0b85d049e6d79aa0704d2054e62be">icCmmStatBadTintXform</a>;</div>
<div class="line"><span class="lineno"> 6915</span>    }</div>
<div class="line"><span class="lineno"> 6916</span>  }</div>
<div class="line"><span class="lineno"> 6917</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_pTag) {</div>
<div class="line"><span class="lineno"> 6918</span>    <span class="keyword">const</span> <a class="code hl_class" href="../../d7/d59/a01013.html">CIccTagNamedColor2</a> *pTag = m_pTag;</div>
<div class="line"><span class="lineno"> 6919</span> </div>
<div class="line"><span class="lineno"> 6920</span>    <a class="code hl_typedef" href="../../d7/d46/a00002.html#a1663bd430c0c31a708d9a141fc6b6c45">icInt32Number</a> j;</div>
<div class="line"><span class="lineno"> 6921</span> </div>
<div class="line"><span class="lineno"> 6922</span>    <span class="keywordflow">if</span> (m_nSrcSpace != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>)</div>
<div class="line"><span class="lineno"> 6923</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 6924</span> </div>
<div class="line"><span class="lineno"> 6925</span>    <span class="keywordflow">if</span> (IsDestPCS()) {</div>
<div class="line"><span class="lineno"> 6926</span> </div>
<div class="line"><span class="lineno"> 6927</span>      j = pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#a2a76002d604136358d1adb711faf6e90">FindColor</a>(SrcColorName);</div>
<div class="line"><span class="lineno"> 6928</span>      <span class="keywordflow">if</span> (j&lt;0)</div>
<div class="line"><span class="lineno"> 6929</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16">icCmmStatColorNotFound</a>;</div>
<div class="line"><span class="lineno"> 6930</span> </div>
<div class="line"><span class="lineno"> 6931</span>      <span class="keywordflow">if</span> (m_nDestSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>) {</div>
<div class="line"><span class="lineno"> 6932</span>        memcpy(DstPixel, pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#acfa051e5560291e61af31c3ccf3b28e3">GetEntry</a>(j)-&gt;<a class="code hl_variable" href="../../da/dec/a00080.html#ad4725f789754651c67c722de12f52936">pcsCoords</a>, 3*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 6933</span>      }</div>
<div class="line"><span class="lineno"> 6934</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6935</span>        memcpy(DstPixel, pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#acfa051e5560291e61af31c3ccf3b28e3">GetEntry</a>(j)-&gt;<a class="code hl_variable" href="../../da/dec/a00080.html#ad4725f789754651c67c722de12f52936">pcsCoords</a>, 3*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 6936</span>      }</div>
<div class="line"><span class="lineno"> 6937</span>      <span class="keywordflow">if</span> (m_bDstPcsConversion)</div>
<div class="line"><span class="lineno"> 6938</span>        CheckDstAbs(DstPixel);</div>
<div class="line"><span class="lineno"> 6939</span>    }</div>
<div class="line"><span class="lineno"> 6940</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 6941</span>      j = pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#a2a76002d604136358d1adb711faf6e90">FindColor</a>(SrcColorName);</div>
<div class="line"><span class="lineno"> 6942</span>      <span class="keywordflow">if</span> (j&lt;0)</div>
<div class="line"><span class="lineno"> 6943</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16">icCmmStatColorNotFound</a>;</div>
<div class="line"><span class="lineno"> 6944</span>      memcpy(DstPixel, pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#acfa051e5560291e61af31c3ccf3b28e3">GetEntry</a>(j)-&gt;<a class="code hl_variable" href="../../da/dec/a00080.html#a0a9b0ffa6221220cf476616062b5c928">deviceCoords</a>, pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#a6b6ed7f3550c3939ce66094d97173fdb">GetDeviceCoords</a>()*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 6945</span>    }</div>
<div class="line"><span class="lineno"> 6946</span>  }</div>
<div class="line"><span class="lineno"> 6947</span> </div>
<div class="line"><span class="lineno"> 6948</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 6949</span>}</div>
<div class="line"><span class="lineno"> 6950</span> </div>
<div class="line"><span class="lineno"> 6962</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccXformNamedColor::SetSrcSpace(<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nSrcSpace)</div>
<div class="line"><span class="lineno"> 6963</span>{</div>
<div class="line"><span class="lineno"> 6964</span>  <span class="keywordflow">if</span> (m_pArray) {</div>
<div class="line"><span class="lineno"> 6965</span> </div>
<div class="line"><span class="lineno"> 6966</span>  }</div>
<div class="line"><span class="lineno"> 6967</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_pTag) {</div>
<div class="line"><span class="lineno"> 6968</span>    <a class="code hl_class" href="../../d7/d59/a01013.html">CIccTagNamedColor2</a> *pTag = m_pTag;</div>
<div class="line"><span class="lineno"> 6969</span> </div>
<div class="line"><span class="lineno"> 6970</span>    <span class="keywordflow">if</span> (nSrcSpace!=pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#a2ea2db6f07f694b094360198c3fa3c8e">GetPCS</a>())</div>
<div class="line"><span class="lineno"> 6971</span>      <span class="keywordflow">if</span> (nSrcSpace!=pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#ab6ec797d2fdea65e273f2c484fa260ce">GetDeviceSpace</a>())</div>
<div class="line"><span class="lineno"> 6972</span>        <span class="keywordflow">if</span> (nSrcSpace!=<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>)</div>
<div class="line"><span class="lineno"> 6973</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 6974</span>  }</div>
<div class="line"><span class="lineno"> 6975</span> </div>
<div class="line"><span class="lineno"> 6976</span>  m_nSrcSpace = nSrcSpace;</div>
<div class="line"><span class="lineno"> 6977</span> </div>
<div class="line"><span class="lineno"> 6978</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 6979</span>}</div>
<div class="line"><span class="lineno"> 6980</span> </div>
<div class="line"><span class="lineno"> 6992</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccXformNamedColor::SetDestSpace(<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nDestSpace)</div>
<div class="line"><span class="lineno"> 6993</span>{</div>
<div class="line"><span class="lineno"> 6994</span>  <span class="keywordflow">if</span> (m_nSrcSpace == nDestSpace)</div>
<div class="line"><span class="lineno"> 6995</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 6996</span> </div>
<div class="line"><span class="lineno"> 6997</span>  <span class="keywordflow">if</span> (m_pArray) {</div>
<div class="line"><span class="lineno"> 6998</span> </div>
<div class="line"><span class="lineno"> 6999</span>  }</div>
<div class="line"><span class="lineno"> 7000</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_pTag) {</div>
<div class="line"><span class="lineno"> 7001</span>    <a class="code hl_class" href="../../d7/d59/a01013.html">CIccTagNamedColor2</a> *pTag = (<a class="code hl_class" href="../../d7/d59/a01013.html">CIccTagNamedColor2</a>*)m_pTag;</div>
<div class="line"><span class="lineno"> 7002</span> </div>
<div class="line"><span class="lineno"> 7003</span>    <span class="keywordflow">if</span> (nDestSpace!=pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#a2ea2db6f07f694b094360198c3fa3c8e">GetPCS</a>())</div>
<div class="line"><span class="lineno"> 7004</span>      <span class="keywordflow">if</span> (nDestSpace!=pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#ab6ec797d2fdea65e273f2c484fa260ce">GetDeviceSpace</a>())</div>
<div class="line"><span class="lineno"> 7005</span>        <span class="keywordflow">if</span> (nDestSpace!=<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>)</div>
<div class="line"><span class="lineno"> 7006</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 7007</span>  }</div>
<div class="line"><span class="lineno"> 7008</span> </div>
<div class="line"><span class="lineno"> 7009</span>  m_nDestSpace = nDestSpace;</div>
<div class="line"><span class="lineno"> 7010</span> </div>
<div class="line"><span class="lineno"> 7011</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 7012</span>}</div>
<div class="line"><span class="lineno"> 7013</span> </div>
<div class="line"><span class="lineno"> 7022</span><span class="keywordtype">bool</span> CIccXformNamedColor::IsSrcPCS()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 7023</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 7024</span>  <span class="keywordflow">if</span> (m_pTag) {</div>
<div class="line"><span class="lineno"> 7025</span>    <span class="keywordflow">return</span> m_nSrcSpace == m_pTag-&gt;<a class="code hl_function" href="../../d7/d59/a01013.html#a2ea2db6f07f694b094360198c3fa3c8e">GetPCS</a>();</div>
<div class="line"><span class="lineno"> 7026</span>  }</div>
<div class="line"><span class="lineno"> 7027</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_pArray) {</div>
<div class="line"><span class="lineno"> 7028</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/df8/a00155.html#af2bf8c7d947cb795089de5f391f91d4d">IsSpacePCS</a>(m_nSrcSpace);</div>
<div class="line"><span class="lineno"> 7029</span>  }</div>
<div class="line"><span class="lineno"> 7030</span>  <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 7031</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7032</span>}</div>
<div class="line"><span class="lineno"> 7033</span> </div>
<div class="line"><span class="lineno"> 7034</span> </div>
<div class="line"><span class="lineno"> 7043</span><span class="keywordtype">bool</span> CIccXformNamedColor::IsDestPCS()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 7044</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 7045</span>  <span class="keywordflow">if</span> (m_pTag) {</div>
<div class="line"><span class="lineno"> 7046</span>    <span class="keywordflow">return</span> m_nDestSpace == m_pTag-&gt;GetPCS();</div>
<div class="line"><span class="lineno"> 7047</span>  }</div>
<div class="line"><span class="lineno"> 7048</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (m_pArray) {</div>
<div class="line"><span class="lineno"> 7049</span>    <span class="keywordflow">return</span> <a class="code hl_define" href="../../d3/df8/a00155.html#af2bf8c7d947cb795089de5f391f91d4d">IsSpacePCS</a>(m_nDestSpace);</div>
<div class="line"><span class="lineno"> 7050</span>  }</div>
<div class="line"><span class="lineno"> 7051</span>  <span class="keywordflow">else</span> </div>
<div class="line"><span class="lineno"> 7052</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7053</span>}</div>
<div class="line"><span class="lineno"> 7054</span> </div>
<div class="line"><span class="lineno"> 7055</span> </div>
<div class="line"><span class="lineno"> 7064</span>CIccXformMpe::CIccXformMpe(<a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag)</div>
<div class="line"><span class="lineno"> 7065</span>{</div>
<div class="line"><span class="lineno"> 7066</span>  <span class="keywordflow">if</span> (pTag &amp;&amp; pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">GetType</a>()==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481">icSigMultiProcessElementType</a>)</div>
<div class="line"><span class="lineno"> 7067</span>    m_pTag = (<a class="code hl_class" href="../../d5/d54/a01213.html">CIccTagMultiProcessElement</a>*)pTag;</div>
<div class="line"><span class="lineno"> 7068</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 7069</span>    m_pTag = NULL;</div>
<div class="line"><span class="lineno"> 7070</span> </div>
<div class="line"><span class="lineno"> 7071</span>  m_bUsingAcs = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7072</span>  m_pAppliedPCC = NULL;</div>
<div class="line"><span class="lineno"> 7073</span>  m_bDeleteAppliedPCC = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7074</span>}</div>
<div class="line"><span class="lineno"> 7075</span> </div>
<div class="line"><span class="lineno"> 7084</span>CIccXformMpe::~CIccXformMpe()</div>
<div class="line"><span class="lineno"> 7085</span>{</div>
<div class="line"><span class="lineno"> 7086</span>  <span class="keywordflow">if</span> (m_pAppliedPCC &amp;&amp; m_bDeleteAppliedPCC)</div>
<div class="line"><span class="lineno"> 7087</span>    <span class="keyword">delete</span> m_pAppliedPCC;</div>
<div class="line"><span class="lineno"> 7088</span>}</div>
<div class="line"><span class="lineno"> 7089</span> </div>
<div class="line"><span class="lineno"> 7112</span>CIccXform *CIccXformMpe::Create(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile, <span class="keywordtype">bool</span> bInput<span class="comment">/* =true */</span>, <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nIntent<span class="comment">/* =icUnknownIntent */</span>,</div>
<div class="line"><span class="lineno"> 7113</span>                                                                <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913">icXformInterp</a> nInterp<span class="comment">/* =icInterpLinear */</span>, <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7b">icXformLutType</a> nLutType<span class="comment">/* =icXformLutColor */</span>, </div>
<div class="line"><span class="lineno"> 7114</span>                                                                CIccCreateXformHintManager *pHintManager<span class="comment">/* =NULL */</span>)</div>
<div class="line"><span class="lineno"> 7115</span>{</div>
<div class="line"><span class="lineno"> 7116</span>  CIccXform *rv = NULL;</div>
<div class="line"><span class="lineno"> 7117</span>  <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nTagIntent = nIntent;</div>
<div class="line"><span class="lineno"> 7118</span>  <span class="keywordtype">bool</span> bUseSpectralPCS = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7119</span>  <span class="keywordtype">bool</span> bAbsToRel = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7120</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7b">icXformLutType</a> nUseLutType = nLutType;</div>
<div class="line"><span class="lineno"> 7121</span>  <span class="keywordtype">bool</span> bUseColorimeticTags = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 7122</span>  <span class="keywordtype">bool</span> bUseDToB = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 7123</span> </div>
<div class="line"><span class="lineno"> 7124</span>  <span class="keywordflow">if</span> (nLutType == <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262">icXformLutSpectral</a>) {</div>
<div class="line"><span class="lineno"> 7125</span>    nUseLutType = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614">icXformLutColor</a>;</div>
<div class="line"><span class="lineno"> 7126</span>    bUseColorimeticTags = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7127</span>  }</div>
<div class="line"><span class="lineno"> 7128</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nLutType == <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013">icXformLutColorimetric</a>) {</div>
<div class="line"><span class="lineno"> 7129</span>    nUseLutType = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614">icXformLutColor</a>;</div>
<div class="line"><span class="lineno"> 7130</span>    bUseDToB = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7131</span>  }</div>
<div class="line"><span class="lineno"> 7132</span> </div>
<div class="line"><span class="lineno"> 7133</span>  <span class="keywordflow">if</span> (nTagIntent == <a class="code hl_define" href="../../d7/d46/a00002.html#a0fbdbf76357f4ad739b1df71bd87ef8a">icUnknownIntent</a>)</div>
<div class="line"><span class="lineno"> 7134</span>    nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a>;</div>
<div class="line"><span class="lineno"> 7135</span> </div>
<div class="line"><span class="lineno"> 7136</span>  <span class="keywordflow">switch</span> (nUseLutType) {</div>
<div class="line"><span class="lineno"> 7137</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614">icXformLutColor</a>:</div>
<div class="line"><span class="lineno"> 7138</span>      <span class="keywordflow">if</span> (bInput) {</div>
<div class="line"><span class="lineno"> 7139</span>        <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = NULL;</div>
<div class="line"><span class="lineno"> 7140</span>        <span class="keywordflow">if</span> (bUseDToB) {</div>
<div class="line"><span class="lineno"> 7141</span>          pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a703f1866ed4cc98f623090b38917bc8e">icSigDToB0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno"> 7142</span> </div>
<div class="line"><span class="lineno"> 7143</span>          <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno"> 7144</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ae185d0e91c27dc49b2a4a328de2fbb92">icSigDToB1Tag</a>);</div>
<div class="line"><span class="lineno"> 7145</span>            <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno"> 7146</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno"> 7147</span>          }</div>
<div class="line"><span class="lineno"> 7148</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno"> 7149</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a585329dfc33381a67de302149941bd38">icSigDToB3Tag</a>);</div>
<div class="line"><span class="lineno"> 7150</span>            <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno"> 7151</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno"> 7152</span>              bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 7153</span>            }</div>
<div class="line"><span class="lineno"> 7154</span>          }</div>
<div class="line"><span class="lineno"> 7155</span> </div>
<div class="line"><span class="lineno"> 7156</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 7157</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a703f1866ed4cc98f623090b38917bc8e">icSigDToB0Tag</a>);</div>
<div class="line"><span class="lineno"> 7158</span>          }</div>
<div class="line"><span class="lineno"> 7159</span>        }</div>
<div class="line"><span class="lineno"> 7160</span> </div>
<div class="line"><span class="lineno"> 7161</span>        <span class="comment">//Unsupported elements cause fall back behavior</span></div>
<div class="line"><span class="lineno"> 7162</span>        <span class="keywordflow">if</span> (pTag &amp;&amp; !pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a3415307280dc7b871cc1797704008991">IsSupported</a>())</div>
<div class="line"><span class="lineno"> 7163</span>          pTag = NULL;</div>
<div class="line"><span class="lineno"> 7164</span> </div>
<div class="line"><span class="lineno"> 7165</span>        <span class="keywordflow">if</span> (pTag &amp;&amp; pProfile-&gt;m_Header.spectralPCS) {</div>
<div class="line"><span class="lineno"> 7166</span>          bUseSpectralPCS = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 7167</span>        }</div>
<div class="line"><span class="lineno"> 7168</span> </div>
<div class="line"><span class="lineno"> 7169</span>        <span class="keywordflow">if</span> (bUseColorimeticTags) {</div>
<div class="line"><span class="lineno"> 7170</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 7171</span>            <span class="keywordflow">if</span> (nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>)</div>
<div class="line"><span class="lineno"> 7172</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno"> 7173</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a48a680ba3049e0c37a44da9f08e411c7">icSigAToB0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno"> 7174</span>          }</div>
<div class="line"><span class="lineno"> 7175</span> </div>
<div class="line"><span class="lineno"> 7176</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 7177</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a48a680ba3049e0c37a44da9f08e411c7">icSigAToB0Tag</a>);</div>
<div class="line"><span class="lineno"> 7178</span>          }</div>
<div class="line"><span class="lineno"> 7179</span>        }</div>
<div class="line"><span class="lineno"> 7180</span> </div>
<div class="line"><span class="lineno"> 7181</span>        <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 7182</span>          <span class="keywordflow">if</span> (bUseColorimeticTags &amp;&amp; pProfile-&gt;m_Header.colorSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30">icSigRgbData</a> &amp;&amp; pProfile-&gt;m_Header.version &lt; <a class="code hl_define" href="../../d7/d46/a00002.html#a802c8f93248af9679280a8c10705807c">icVersionNumberV5</a>) {</div>
<div class="line"><span class="lineno"> 7183</span>            rv = <span class="keyword">new</span> CIccXformMatrixTRC();</div>
<div class="line"><span class="lineno"> 7184</span>          }</div>
<div class="line"><span class="lineno"> 7185</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 7186</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 7187</span>        }</div>
<div class="line"><span class="lineno"> 7188</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">GetType</a>()==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481">icSigMultiProcessElementType</a>) {</div>
<div class="line"><span class="lineno"> 7189</span>          rv = <span class="keyword">new</span> CIccXformMpe(pTag);</div>
<div class="line"><span class="lineno"> 7190</span>        }</div>
<div class="line"><span class="lineno"> 7191</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7192</span>          <span class="keywordflow">switch</span>(pProfile-&gt;m_Header.colorSpace) {</div>
<div class="line"><span class="lineno"> 7193</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>:</div>
<div class="line"><span class="lineno"> 7194</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>:</div>
<div class="line"><span class="lineno"> 7195</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0ab090e1f79d31e78c006c6ab25933dd">icSigLuvData</a>:</div>
<div class="line"><span class="lineno"> 7196</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ae02a4b86c48a9b85be92fdfc2114e496">icSigYCbCrData</a>:</div>
<div class="line"><span class="lineno"> 7197</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917afc7f319f261280fc48d7510c3a8bc330">icSigYxyData</a>:</div>
<div class="line"><span class="lineno"> 7198</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30">icSigRgbData</a>:</div>
<div class="line"><span class="lineno"> 7199</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917afc7cddf72b4d83ee5cb3568143580828">icSigHsvData</a>:</div>
<div class="line"><span class="lineno"> 7200</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad4a717752d16d5fcf92e1fdd892b8bd8">icSigHlsData</a>:</div>
<div class="line"><span class="lineno"> 7201</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917af20259a5702129c41fd08e21c7e94a74">icSigCmyData</a>:</div>
<div class="line"><span class="lineno"> 7202</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917afa0686ad8f20f604e7e52807087f04da">icSig3colorData</a>:</div>
<div class="line"><span class="lineno"> 7203</span>              rv = <span class="keyword">new</span> CIccXform3DLut(pTag);</div>
<div class="line"><span class="lineno"> 7204</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7205</span> </div>
<div class="line"><span class="lineno"> 7206</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661">icSigCmykData</a>:</div>
<div class="line"><span class="lineno"> 7207</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917addb4c9db388eda46c3ec7fdaa8824cf5">icSig4colorData</a>:</div>
<div class="line"><span class="lineno"> 7208</span>              rv = <span class="keyword">new</span> CIccXform4DLut(pTag);</div>
<div class="line"><span class="lineno"> 7209</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7210</span> </div>
<div class="line"><span class="lineno"> 7211</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 7212</span>              rv = <span class="keyword">new</span> CIccXformNDLut(pTag);</div>
<div class="line"><span class="lineno"> 7213</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7214</span>          }</div>
<div class="line"><span class="lineno"> 7215</span>        }</div>
<div class="line"><span class="lineno"> 7216</span>      }</div>
<div class="line"><span class="lineno"> 7217</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7218</span>        <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = NULL; </div>
<div class="line"><span class="lineno"> 7219</span>        </div>
<div class="line"><span class="lineno"> 7220</span>        <span class="keywordflow">if</span> (bUseDToB) {</div>
<div class="line"><span class="lineno"> 7221</span>          pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a0247611a0b2a3faa49a0df2dfc8420cc">icSigBToD0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno"> 7222</span> </div>
<div class="line"><span class="lineno"> 7223</span>          <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno"> 7224</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a8a66e2d1402c9f9796a902cd2f0ac0eb">icSigBToD1Tag</a>);</div>
<div class="line"><span class="lineno"> 7225</span>            <span class="keywordflow">if</span> (pTag)</div>
<div class="line"><span class="lineno"> 7226</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno"> 7227</span>          }</div>
<div class="line"><span class="lineno"> 7228</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!pTag &amp;&amp; nTagIntent != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>) {</div>
<div class="line"><span class="lineno"> 7229</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a740cafe42e07749bbe3b36d881325801">icSigBToD3Tag</a>);</div>
<div class="line"><span class="lineno"> 7230</span>            <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno"> 7231</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>;</div>
<div class="line"><span class="lineno"> 7232</span>              bAbsToRel = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 7233</span>            }</div>
<div class="line"><span class="lineno"> 7234</span>          }</div>
<div class="line"><span class="lineno"> 7235</span> </div>
<div class="line"><span class="lineno"> 7236</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 7237</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a0247611a0b2a3faa49a0df2dfc8420cc">icSigBToD0Tag</a>);</div>
<div class="line"><span class="lineno"> 7238</span>          }</div>
<div class="line"><span class="lineno"> 7239</span>        }</div>
<div class="line"><span class="lineno"> 7240</span> </div>
<div class="line"><span class="lineno"> 7241</span>        <span class="comment">//Unsupported elements cause fall back behavior</span></div>
<div class="line"><span class="lineno"> 7242</span>        <span class="keywordflow">if</span> (pTag &amp;&amp; !pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a3415307280dc7b871cc1797704008991">IsSupported</a>())</div>
<div class="line"><span class="lineno"> 7243</span>          pTag = NULL;</div>
<div class="line"><span class="lineno"> 7244</span> </div>
<div class="line"><span class="lineno"> 7245</span>        <span class="keywordflow">if</span> (bUseColorimeticTags) {</div>
<div class="line"><span class="lineno"> 7246</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 7247</span>            <span class="keywordflow">if</span> (nTagIntent == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a>)</div>
<div class="line"><span class="lineno"> 7248</span>              nTagIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a>;</div>
<div class="line"><span class="lineno"> 7249</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a78413df8b7d634ae4e0ec02f006e5bd0">icSigBToA0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno"> 7250</span>          }</div>
<div class="line"><span class="lineno"> 7251</span> </div>
<div class="line"><span class="lineno"> 7252</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 7253</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a78413df8b7d634ae4e0ec02f006e5bd0">icSigBToA0Tag</a>);</div>
<div class="line"><span class="lineno"> 7254</span>          }</div>
<div class="line"><span class="lineno"> 7255</span>        }</div>
<div class="line"><span class="lineno"> 7256</span> </div>
<div class="line"><span class="lineno"> 7257</span>        <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 7258</span>          <span class="keywordflow">if</span> (bUseColorimeticTags &amp;&amp; pProfile-&gt;m_Header.colorSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30">icSigRgbData</a> &amp;&amp; pProfile-&gt;m_Header.version&lt;<a class="code hl_define" href="../../d7/d46/a00002.html#a802c8f93248af9679280a8c10705807c">icVersionNumberV5</a>) {</div>
<div class="line"><span class="lineno"> 7259</span>            rv = <span class="keyword">new</span> CIccXformMatrixTRC();</div>
<div class="line"><span class="lineno"> 7260</span>          }</div>
<div class="line"><span class="lineno"> 7261</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 7262</span>            <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 7263</span>        }</div>
<div class="line"><span class="lineno"> 7264</span> </div>
<div class="line"><span class="lineno"> 7265</span>        <span class="keywordflow">if</span> (pTag &amp;&amp; pTag-&gt;<a class="code hl_function" href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">GetType</a>()==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481">icSigMultiProcessElementType</a>) {</div>
<div class="line"><span class="lineno"> 7266</span>          rv = <span class="keyword">new</span> CIccXformMpe(pTag);</div>
<div class="line"><span class="lineno"> 7267</span>        }</div>
<div class="line"><span class="lineno"> 7268</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7269</span>          <span class="keywordflow">switch</span>(pProfile-&gt;m_Header.pcs) {</div>
<div class="line"><span class="lineno"> 7270</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>:</div>
<div class="line"><span class="lineno"> 7271</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>:</div>
<div class="line"><span class="lineno"> 7272</span>              rv = <span class="keyword">new</span> CIccXform3DLut(pTag);</div>
<div class="line"><span class="lineno"> 7273</span> </div>
<div class="line"><span class="lineno"> 7274</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 7275</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7276</span>          }</div>
<div class="line"><span class="lineno"> 7277</span>        }</div>
<div class="line"><span class="lineno"> 7278</span>      }</div>
<div class="line"><span class="lineno"> 7279</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7280</span> </div>
<div class="line"><span class="lineno"> 7281</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba0b1f2aadd55b74ea25adc32e3cadf4c0">icXformLutNamedColor</a>:</div>
<div class="line"><span class="lineno"> 7282</span>      {</div>
<div class="line"><span class="lineno"> 7283</span>        <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ac9a9457a436bbfaa9212552f337d2beb">icSigNamedColor2Tag</a>);</div>
<div class="line"><span class="lineno"> 7284</span>        <span class="keywordflow">if</span> (!pTag)</div>
<div class="line"><span class="lineno"> 7285</span>          <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 7286</span> </div>
<div class="line"><span class="lineno"> 7287</span>        rv = <span class="keyword">new</span> CIccXformNamedColor(pTag, pProfile-&gt;m_Header.pcs, pProfile-&gt;m_Header.colorSpace,</div>
<div class="line"><span class="lineno"> 7288</span>                                     pProfile-&gt;m_Header.spectralPCS,</div>
<div class="line"><span class="lineno"> 7289</span>                                     &amp;pProfile-&gt;m_Header.spectralRange,</div>
<div class="line"><span class="lineno"> 7290</span>                                     &amp;pProfile-&gt;m_Header.biSpectralRange);</div>
<div class="line"><span class="lineno"> 7291</span>      }</div>
<div class="line"><span class="lineno"> 7292</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7293</span> </div>
<div class="line"><span class="lineno"> 7294</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7baeb0501fdc1dcc7f1388f0fdca9b17356">icXformLutPreview</a>:</div>
<div class="line"><span class="lineno"> 7295</span>      {</div>
<div class="line"><span class="lineno"> 7296</span>        bInput = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7297</span>        <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ac5ae9a8a0d00acc2b7ec4f2da4ccc3f8">icSigPreview0Tag</a> + nTagIntent);</div>
<div class="line"><span class="lineno"> 7298</span>        <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 7299</span>          pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ac5ae9a8a0d00acc2b7ec4f2da4ccc3f8">icSigPreview0Tag</a>);</div>
<div class="line"><span class="lineno"> 7300</span>        }</div>
<div class="line"><span class="lineno"> 7301</span>        <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 7302</span>          <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 7303</span>        }</div>
<div class="line"><span class="lineno"> 7304</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7305</span>          <span class="keywordflow">switch</span>(pProfile-&gt;m_Header.pcs) {</div>
<div class="line"><span class="lineno"> 7306</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>:</div>
<div class="line"><span class="lineno"> 7307</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>:</div>
<div class="line"><span class="lineno"> 7308</span>              rv = <span class="keyword">new</span> CIccXform3DLut(pTag);</div>
<div class="line"><span class="lineno"> 7309</span> </div>
<div class="line"><span class="lineno"> 7310</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 7311</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7312</span>          }</div>
<div class="line"><span class="lineno"> 7313</span>        }</div>
<div class="line"><span class="lineno"> 7314</span>      }</div>
<div class="line"><span class="lineno"> 7315</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7316</span> </div>
<div class="line"><span class="lineno"> 7317</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba6df311bd7dc6c9c9284ad186b15f53de">icXformLutGamut</a>:</div>
<div class="line"><span class="lineno"> 7318</span>      {</div>
<div class="line"><span class="lineno"> 7319</span>        bInput = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7320</span>        <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ad57d49a829f89f04159908e21ffe9d01">icSigGamutTag</a>);</div>
<div class="line"><span class="lineno"> 7321</span>        <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 7322</span>          <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 7323</span>        }</div>
<div class="line"><span class="lineno"> 7324</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7325</span>          <span class="keywordflow">switch</span>(pProfile-&gt;m_Header.pcs) {</div>
<div class="line"><span class="lineno"> 7326</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>:</div>
<div class="line"><span class="lineno"> 7327</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>:</div>
<div class="line"><span class="lineno"> 7328</span>              rv = <span class="keyword">new</span> CIccXform3DLut(pTag);</div>
<div class="line"><span class="lineno"> 7329</span> </div>
<div class="line"><span class="lineno"> 7330</span>            <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 7331</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7332</span>          }</div>
<div class="line"><span class="lineno"> 7333</span>        }</div>
<div class="line"><span class="lineno"> 7334</span>      }</div>
<div class="line"><span class="lineno"> 7335</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7336</span>  }</div>
<div class="line"><span class="lineno"> 7337</span> </div>
<div class="line"><span class="lineno"> 7338</span>  <span class="keywordflow">if</span> (rv) {</div>
<div class="line"><span class="lineno"> 7339</span>    rv-&gt;SetParams(pProfile, bInput, nIntent, nTagIntent, bUseSpectralPCS, nInterp, pHintManager, bAbsToRel);</div>
<div class="line"><span class="lineno"> 7340</span>  }</div>
<div class="line"><span class="lineno"> 7341</span> </div>
<div class="line"><span class="lineno"> 7342</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 7343</span>}</div>
<div class="line"><span class="lineno"> 7344</span> </div>
<div class="line"><span class="lineno"> 7354</span><span class="keywordtype">bool</span> CIccXformMpe::IsLateBinding()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 7355</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 7356</span>  <span class="keywordflow">if</span> (m_pTag)</div>
<div class="line"><span class="lineno"> 7357</span>    <span class="keywordflow">return</span> m_pTag-&gt;IsLateBinding();</div>
<div class="line"><span class="lineno"> 7358</span> </div>
<div class="line"><span class="lineno"> 7359</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7360</span>}</div>
<div class="line"><span class="lineno"> 7361</span> </div>
<div class="line"><span class="lineno"> 7371</span><span class="keywordtype">bool</span> CIccXformMpe::IsLateBindingReflectance()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 7372</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 7373</span>  <span class="keywordflow">if</span> (m_pTag)</div>
<div class="line"><span class="lineno"> 7374</span>    <span class="keywordflow">return</span> m_pTag-&gt;IsLateBindingReflectance();</div>
<div class="line"><span class="lineno"> 7375</span> </div>
<div class="line"><span class="lineno"> 7376</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7377</span>}</div>
<div class="line"><span class="lineno"> 7378</span> </div>
<div class="line"><span class="lineno"> 7387</span><a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *CIccXformMpe::GetConnectionConditions()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 7388</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 7389</span>  <span class="keywordflow">if</span> (m_pAppliedPCC)</div>
<div class="line"><span class="lineno"> 7390</span>    <span class="keywordflow">return</span> m_pAppliedPCC;</div>
<div class="line"><span class="lineno"> 7391</span> </div>
<div class="line"><span class="lineno"> 7392</span>  <span class="keywordflow">return</span> m_pConnectionConditions;</div>
<div class="line"><span class="lineno"> 7393</span>}</div>
<div class="line"><span class="lineno"> 7394</span> </div>
<div class="line"><span class="lineno"> 7405</span><span class="keywordtype">void</span> CIccXformMpe::SetAppliedCC(<a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPCC)</div>
<div class="line"><span class="lineno"> 7406</span>{</div>
<div class="line"><span class="lineno"> 7407</span>  <span class="keywordflow">if</span> (!pPCC) {</div>
<div class="line"><span class="lineno"> 7408</span>    <span class="keywordflow">if</span> (m_pAppliedPCC &amp;&amp; m_bDeleteAppliedPCC) {</div>
<div class="line"><span class="lineno"> 7409</span>      <span class="keyword">delete</span> m_pAppliedPCC;</div>
<div class="line"><span class="lineno"> 7410</span>    }</div>
<div class="line"><span class="lineno"> 7411</span>    m_pAppliedPCC = NULL;</div>
<div class="line"><span class="lineno"> 7412</span>    m_bDeleteAppliedPCC = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7413</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 7414</span>  }</div>
<div class="line"><span class="lineno"> 7415</span> </div>
<div class="line"><span class="lineno"> 7416</span>  <span class="keywordflow">if</span> (m_pTag) {</div>
<div class="line"><span class="lineno"> 7417</span>    <span class="keywordtype">bool</span> bReflectance = m_pTag-&gt;IsLateBindingReflectance();</div>
<div class="line"><span class="lineno"> 7418</span> </div>
<div class="line"><span class="lineno"> 7419</span>    <span class="keywordflow">if</span> (pPCC != (<a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *)m_pProfile) {</div>
<div class="line"><span class="lineno"> 7420</span>      <span class="keywordflow">if</span> (!bReflectance) {</div>
<div class="line"><span class="lineno"> 7421</span>        <span class="keyword">const</span> <a class="code hl_class" href="../../d8/dbf/a01109.html">CIccTagSpectralViewingConditions</a> *pViewPCC = pPCC ? pPCC-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a41d44184a1e66e1f7bd46e60fc69fda6">getPccViewingConditions</a>() : NULL;</div>
<div class="line"><span class="lineno"> 7422</span>        <span class="keyword">const</span> <a class="code hl_class" href="../../d8/dbf/a01109.html">CIccTagSpectralViewingConditions</a> *pViewProfile = m_pProfile ? m_pProfile-&gt;<a class="code hl_function" href="../../db/d18/a00885.html#a41d44184a1e66e1f7bd46e60fc69fda6">getPccViewingConditions</a>() : NULL;</div>
<div class="line"><span class="lineno"> 7423</span> </div>
<div class="line"><span class="lineno"> 7424</span>        <span class="keywordflow">if</span> (pViewPCC &amp;&amp; pViewProfile &amp;&amp;</div>
<div class="line"><span class="lineno"> 7425</span>          pViewPCC-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#a8877a21252b3f70c761e049765cfb10e">getStdIllumiant</a>() == pViewProfile-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#a8877a21252b3f70c761e049765cfb10e">getStdIllumiant</a>() &amp;&amp;</div>
<div class="line"><span class="lineno"> 7426</span>          pViewPCC-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#a339a66cb30a03163f17861f8c704df51">getIlluminantCCT</a>() == pViewProfile-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#a339a66cb30a03163f17861f8c704df51">getIlluminantCCT</a>() &amp;&amp;</div>
<div class="line"><span class="lineno"> 7427</span>          pViewPCC-&gt;<a class="code hl_function" href="../../d8/dbf/a01109.html#a8877a21252b3f70c761e049765cfb10e">getStdIllumiant</a>() != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a2146034a274143b2ffbb868845d93e17ab1c241e8a8bf7f4843c929227113ac84">icIlluminantUnknown</a>) {</div>
<div class="line"><span class="lineno"> 7428</span>          m_pAppliedPCC = pPCC;</div>
<div class="line"><span class="lineno"> 7429</span>          m_bDeleteAppliedPCC = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7430</span>        }</div>
<div class="line"><span class="lineno"> 7431</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7432</span>          m_pAppliedPCC = <span class="keyword">new</span> <a class="code hl_class" href="../../de/dc8/a00889.html">CIccCombinedConnectionConditions</a>(m_pProfile, pPCC, bReflectance);</div>
<div class="line"><span class="lineno"> 7433</span>          m_bDeleteAppliedPCC = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 7434</span>        }</div>
<div class="line"><span class="lineno"> 7435</span>      }</div>
<div class="line"><span class="lineno"> 7436</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7437</span>        m_pAppliedPCC = <span class="keyword">new</span> <a class="code hl_class" href="../../de/dc8/a00889.html">CIccCombinedConnectionConditions</a>(m_pProfile, pPCC, bReflectance);</div>
<div class="line"><span class="lineno"> 7438</span>        m_bDeleteAppliedPCC = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 7439</span>      }</div>
<div class="line"><span class="lineno"> 7440</span>    }</div>
<div class="line"><span class="lineno"> 7441</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7442</span>      m_pAppliedPCC = NULL;</div>
<div class="line"><span class="lineno"> 7443</span>    }</div>
<div class="line"><span class="lineno"> 7444</span>  }</div>
<div class="line"><span class="lineno"> 7445</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7446</span>    m_pAppliedPCC = pPCC;</div>
<div class="line"><span class="lineno"> 7447</span>    m_bDeleteAppliedPCC = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7448</span>  }</div>
<div class="line"><span class="lineno"> 7449</span>}</div>
<div class="line"><span class="lineno"> 7450</span> </div>
<div class="line"><span class="lineno"> 7451</span> </div>
<div class="line"><span class="lineno"> 7463</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccXformMpe::Begin()</div>
<div class="line"><span class="lineno"> 7464</span>{</div>
<div class="line"><span class="lineno"> 7465</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> status;</div>
<div class="line"><span class="lineno"> 7466</span>  status = CIccXform::Begin();</div>
<div class="line"><span class="lineno"> 7467</span> </div>
<div class="line"><span class="lineno"> 7468</span>  <span class="keywordflow">if</span> (status != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno"> 7469</span>    <span class="keywordflow">return</span> status;</div>
<div class="line"><span class="lineno"> 7470</span> </div>
<div class="line"><span class="lineno"> 7471</span>  <span class="keywordflow">if</span> (!m_pTag) {</div>
<div class="line"><span class="lineno"> 7472</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096">icCmmStatInvalidLut</a>;</div>
<div class="line"><span class="lineno"> 7473</span>  }</div>
<div class="line"><span class="lineno"> 7474</span> </div>
<div class="line"><span class="lineno"> 7475</span>  <span class="keywordflow">if</span> (!m_pTag-&gt;Begin(<a class="code hl_enumvalue" href="../../d7/d25/a00182.html#ac2d11f72d4c98d21c3b2ca1509a52ee8adcc63bbed9191bd244da51839e152065">icElemInterpLinear</a>, GetProfileCC(), GetConnectionConditions(), GetCmmEnvVarLookup())) {</div>
<div class="line"><span class="lineno"> 7476</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860">icCmmStatInvalidProfile</a>;</div>
<div class="line"><span class="lineno"> 7477</span>  }</div>
<div class="line"><span class="lineno"> 7478</span> </div>
<div class="line"><span class="lineno"> 7479</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 7480</span>}</div>
<div class="line"><span class="lineno"> 7481</span> </div>
<div class="line"><span class="lineno"> 7482</span> </div>
<div class="line"><span class="lineno"> 7492</span>CIccApplyXform *CIccXformMpe::GetNewApply(<a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> &amp;status)</div>
<div class="line"><span class="lineno"> 7493</span>{</div>
<div class="line"><span class="lineno"> 7494</span>  <span class="keywordflow">if</span> (!m_pTag)</div>
<div class="line"><span class="lineno"> 7495</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 7496</span> </div>
<div class="line"><span class="lineno"> 7497</span>  CIccApplyXformMpe *rv= <span class="keyword">new</span> CIccApplyXformMpe(<span class="keyword">this</span>); </div>
<div class="line"><span class="lineno"> 7498</span> </div>
<div class="line"><span class="lineno"> 7499</span>  <span class="keywordflow">if</span> (!rv) {</div>
<div class="line"><span class="lineno"> 7500</span>    status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 7501</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 7502</span>  }</div>
<div class="line"><span class="lineno"> 7503</span> </div>
<div class="line"><span class="lineno"> 7504</span>  rv-&gt;m_pApply = m_pTag-&gt;GetNewApply();</div>
<div class="line"><span class="lineno"> 7505</span>  <span class="keywordflow">if</span> (!rv-&gt;m_pApply) {</div>
<div class="line"><span class="lineno"> 7506</span>    status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 7507</span>    <span class="keyword">delete</span> rv;</div>
<div class="line"><span class="lineno"> 7508</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 7509</span>  }</div>
<div class="line"><span class="lineno"> 7510</span> </div>
<div class="line"><span class="lineno"> 7511</span>  status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 7512</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 7513</span>}</div>
<div class="line"><span class="lineno"> 7514</span> </div>
<div class="line"><span class="lineno"> 7515</span> </div>
<div class="line"><span class="lineno"> 7529</span><span class="keywordtype">void</span> CIccXformMpe::Apply(CIccApplyXform* pApply, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 7530</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 7531</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d5/d54/a01213.html">CIccTagMultiProcessElement</a> *pTag = m_pTag;</div>
<div class="line"><span class="lineno"> 7532</span> </div>
<div class="line"><span class="lineno"> 7533</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> temp[3];</div>
<div class="line"><span class="lineno"> 7534</span>  <span class="keywordflow">if</span> (!m_bInput || m_bPcsAdjustXform) { <span class="comment">//PCS comming in?</span></div>
<div class="line"><span class="lineno"> 7535</span>    <span class="keywordflow">if</span> (m_nIntent != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a> || m_nIntent != m_nTagIntent) {  <span class="comment">//B2D3 tags don&#39;t need abs conversion</span></div>
<div class="line"><span class="lineno"> 7536</span>      <span class="keywordflow">if</span> (m_bSrcPcsConversion)</div>
<div class="line"><span class="lineno"> 7537</span>        SrcPixel = CheckSrcAbs(pApply, SrcPixel);</div>
<div class="line"><span class="lineno"> 7538</span>    }</div>
<div class="line"><span class="lineno"> 7539</span> </div>
<div class="line"><span class="lineno"> 7540</span>    <span class="comment">//Since MPE tags use &quot;real&quot; values for PCS we need to convert from </span></div>
<div class="line"><span class="lineno"> 7541</span>    <span class="comment">//internal encoding used by IccProfLib</span></div>
<div class="line"><span class="lineno"> 7542</span>    <span class="keywordflow">switch</span> (GetSrcSpace()) {</div>
<div class="line"><span class="lineno"> 7543</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>:</div>
<div class="line"><span class="lineno"> 7544</span>        memcpy(&amp;temp[0], SrcPixel, 3*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 7545</span>        <a class="code hl_function" href="../../d7/dce/a00143.html#a78841df2e0aea059520ce71944c4c3bb">icXyzFromPcs</a>(temp);</div>
<div class="line"><span class="lineno"> 7546</span>        SrcPixel = &amp;temp[0];</div>
<div class="line"><span class="lineno"> 7547</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7548</span> </div>
<div class="line"><span class="lineno"> 7549</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>:</div>
<div class="line"><span class="lineno"> 7550</span>        memcpy(&amp;temp[0], SrcPixel, 3*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 7551</span>        <a class="code hl_function" href="../../d7/dce/a00143.html#ac5de02865f572ea243f6da8c144c02fa">icLabFromPcs</a>(temp);</div>
<div class="line"><span class="lineno"> 7552</span>        SrcPixel = &amp;temp[0];</div>
<div class="line"><span class="lineno"> 7553</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7554</span> </div>
<div class="line"><span class="lineno"> 7555</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 7556</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7557</span>    }</div>
<div class="line"><span class="lineno"> 7558</span>  }</div>
<div class="line"><span class="lineno"> 7559</span> </div>
<div class="line"><span class="lineno"> 7560</span>  <span class="comment">//Note: pApply should be a CIccApplyXformMpe type here</span></div>
<div class="line"><span class="lineno"> 7561</span>  CIccApplyXformMpe *pApplyMpe = (CIccApplyXformMpe *)pApply;</div>
<div class="line"><span class="lineno"> 7562</span> </div>
<div class="line"><span class="lineno"> 7563</span>  pTag-&gt;<a class="code hl_function" href="../../d5/d54/a01213.html#a8e6ad3114229992a0c1df3d1d30e02ef">Apply</a>(pApplyMpe-&gt;m_pApply, DstPixel, SrcPixel);</div>
<div class="line"><span class="lineno"> 7564</span> </div>
<div class="line"><span class="lineno"> 7565</span>  <span class="keywordflow">if</span> (m_bInput) { <span class="comment">//PCS going out?</span></div>
<div class="line"><span class="lineno"> 7566</span>    <span class="comment">//Since MPE tags use &quot;real&quot; values for PCS we need to convert to</span></div>
<div class="line"><span class="lineno"> 7567</span>    <span class="comment">//internal encoding used by IccProfLib</span></div>
<div class="line"><span class="lineno"> 7568</span>    <span class="keywordflow">switch</span>(GetDstSpace()) {</div>
<div class="line"><span class="lineno"> 7569</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>:</div>
<div class="line"><span class="lineno"> 7570</span>        <a class="code hl_function" href="../../d7/dce/a00143.html#a4b4cfb7788c3a780f19f2f104677a5b8">icXyzToPcs</a>(DstPixel);</div>
<div class="line"><span class="lineno"> 7571</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7572</span> </div>
<div class="line"><span class="lineno"> 7573</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>:</div>
<div class="line"><span class="lineno"> 7574</span>        <a class="code hl_function" href="../../d7/dce/a00143.html#a5768271d491af79a433e52722ed0a189">icLabToPcs</a>(DstPixel);</div>
<div class="line"><span class="lineno"> 7575</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7576</span> </div>
<div class="line"><span class="lineno"> 7577</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 7578</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 7579</span>    }</div>
<div class="line"><span class="lineno"> 7580</span> </div>
<div class="line"><span class="lineno"> 7581</span>    <span class="keywordflow">if</span> (m_nIntent != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a> || m_nIntent != m_nTagIntent) { <span class="comment">//D2B3 tags don&#39;t need abs conversion</span></div>
<div class="line"><span class="lineno"> 7582</span>      <span class="keywordflow">if</span> (m_bDstPcsConversion)</div>
<div class="line"><span class="lineno"> 7583</span>        CheckDstAbs(DstPixel);</div>
<div class="line"><span class="lineno"> 7584</span>    }</div>
<div class="line"><span class="lineno"> 7585</span>  }</div>
<div class="line"><span class="lineno"> 7586</span>}</div>
<div class="line"><span class="lineno"> 7587</span> </div>
<div class="line"><span class="lineno"> 7596</span>CIccApplyXformMpe::CIccApplyXformMpe(CIccXformMpe *pXform) : CIccApplyXform(pXform)</div>
<div class="line"><span class="lineno"> 7597</span>{</div>
<div class="line"><span class="lineno"> 7598</span>    m_pApply = NULL;</div>
<div class="line"><span class="lineno"> 7599</span>}</div>
<div class="line"><span class="lineno"> 7600</span> </div>
<div class="line"><span class="lineno"> 7609</span>CIccApplyXformMpe::~CIccApplyXformMpe()</div>
<div class="line"><span class="lineno"> 7610</span>{</div>
<div class="line"><span class="lineno"> 7611</span>}</div>
<div class="line"><span class="lineno"> 7612</span> </div>
<div class="line"><span class="lineno"> 7613</span> </div>
<div class="line"><span class="lineno"> 7625</span>CIccApplyCmm::CIccApplyCmm(CIccCmm *pCmm)</div>
<div class="line"><span class="lineno"> 7626</span>{</div>
<div class="line"><span class="lineno"> 7627</span>  m_pCmm = pCmm;</div>
<div class="line"><span class="lineno"> 7628</span>  <span class="comment">//m_pPCS = m_pCmm-&gt;GetPCS();</span></div>
<div class="line"><span class="lineno"> 7629</span> </div>
<div class="line"><span class="lineno"> 7630</span>  m_Xforms = <span class="keyword">new</span> CIccApplyXformList;</div>
<div class="line"><span class="lineno"> 7631</span>  m_Xforms-&gt;clear();</div>
<div class="line"><span class="lineno"> 7632</span> </div>
<div class="line"><span class="lineno"> 7633</span>  m_Pixel = NULL;</div>
<div class="line"><span class="lineno"> 7634</span>  m_Pixel2 = NULL;</div>
<div class="line"><span class="lineno"> 7635</span>}</div>
<div class="line"><span class="lineno"> 7636</span> </div>
<div class="line"><span class="lineno"> 7645</span>CIccApplyCmm::~CIccApplyCmm()</div>
<div class="line"><span class="lineno"> 7646</span>{</div>
<div class="line"><span class="lineno"> 7647</span>  <span class="keywordflow">if</span> (m_Xforms) {</div>
<div class="line"><span class="lineno"> 7648</span>    CIccApplyXformList::iterator i;</div>
<div class="line"><span class="lineno"> 7649</span> </div>
<div class="line"><span class="lineno"> 7650</span>    <span class="keywordflow">for</span> (i=m_Xforms-&gt;begin(); i!=m_Xforms-&gt;end(); i++) {</div>
<div class="line"><span class="lineno"> 7651</span>      <span class="keywordflow">if</span> (i-&gt;ptr)</div>
<div class="line"><span class="lineno"> 7652</span>        <span class="keyword">delete</span> i-&gt;ptr;</div>
<div class="line"><span class="lineno"> 7653</span>    }</div>
<div class="line"><span class="lineno"> 7654</span> </div>
<div class="line"><span class="lineno"> 7655</span>    <span class="keyword">delete</span> m_Xforms;</div>
<div class="line"><span class="lineno"> 7656</span>  }</div>
<div class="line"><span class="lineno"> 7657</span> </div>
<div class="line"><span class="lineno"> 7658</span><span class="comment">//   if (m_pPCS)</span></div>
<div class="line"><span class="lineno"> 7659</span><span class="comment">//     delete m_pPCS;</span></div>
<div class="line"><span class="lineno"> 7660</span> </div>
<div class="line"><span class="lineno"> 7661</span>  <span class="keywordflow">if</span> (m_Pixel)</div>
<div class="line"><span class="lineno"> 7662</span>    free(m_Pixel);</div>
<div class="line"><span class="lineno"> 7663</span>  <span class="keywordflow">if</span> (m_Pixel2)</div>
<div class="line"><span class="lineno"> 7664</span>    free(m_Pixel2);</div>
<div class="line"><span class="lineno"> 7665</span>}</div>
<div class="line"><span class="lineno"> 7666</span> </div>
<div class="line"><span class="lineno"> 7667</span><span class="keywordtype">bool</span> CIccApplyCmm::InitPixel()</div>
<div class="line"><span class="lineno"> 7668</span>{</div>
<div class="line"><span class="lineno"> 7669</span>  <span class="keywordflow">if</span> (m_Pixel &amp;&amp; m_Pixel2)</div>
<div class="line"><span class="lineno"> 7670</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 7671</span> </div>
<div class="line"><span class="lineno"> 7672</span>  <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nSamples = 16;</div>
<div class="line"><span class="lineno"> 7673</span>  CIccApplyXformList::iterator i;</div>
<div class="line"><span class="lineno"> 7674</span> </div>
<div class="line"><span class="lineno"> 7675</span>  <span class="keywordflow">for</span> (i=m_Xforms-&gt;begin(); i!=m_Xforms-&gt;end(); i++) {</div>
<div class="line"><span class="lineno"> 7676</span>    <span class="keywordflow">if</span> (i-&gt;ptr-&gt;GetXform()) {</div>
<div class="line"><span class="lineno"> 7677</span>      <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nXformSamples = i-&gt;ptr-&gt;GetXform()-&gt;GetNumDstSamples();</div>
<div class="line"><span class="lineno"> 7678</span>      <span class="keywordflow">if</span> (nXformSamples&gt;nSamples)</div>
<div class="line"><span class="lineno"> 7679</span>        nSamples=nXformSamples;</div>
<div class="line"><span class="lineno"> 7680</span>    }</div>
<div class="line"><span class="lineno"> 7681</span>  }</div>
<div class="line"><span class="lineno"> 7682</span>  m_Pixel = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>*)malloc(nSamples*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 7683</span>  m_Pixel2 = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>*)malloc(nSamples*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 7684</span> </div>
<div class="line"><span class="lineno"> 7685</span>  <span class="keywordflow">if</span> (!m_Pixel || !m_Pixel2)</div>
<div class="line"><span class="lineno"> 7686</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7687</span> </div>
<div class="line"><span class="lineno"> 7688</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 7689</span>}</div>
<div class="line"><span class="lineno"> 7690</span> </div>
<div class="line"><span class="lineno"> 7691</span><span class="comment">//#define DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 7692</span> </div>
<div class="line"><span class="lineno"> 7693</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 7694</span><span class="keyword">static</span> <span class="keywordtype">void</span> DumpCmmApplyPixel(<span class="keywordtype">int</span> nCount, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>* pPixel, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nSamples)</div>
<div class="line"><span class="lineno"> 7695</span>{</div>
<div class="line"><span class="lineno"> 7696</span>  printf(<span class="stringliteral">&quot;Xfm%d:&quot;</span>, nCount);</div>
<div class="line"><span class="lineno"> 7697</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> i = 0; i &lt; nSamples; i++) {</div>
<div class="line"><span class="lineno"> 7698</span>    <span class="keywordflow">if</span> (i)</div>
<div class="line"><span class="lineno"> 7699</span>      printf(<span class="stringliteral">&quot;,&quot;</span>);</div>
<div class="line"><span class="lineno"> 7700</span>    printf(<span class="stringliteral">&quot; %.3f&quot;</span>, pPixel[i]);</div>
<div class="line"><span class="lineno"> 7701</span>  }</div>
<div class="line"><span class="lineno"> 7702</span>  printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 7703</span> </div>
<div class="line"><span class="lineno"> 7704</span>}</div>
<div class="line"><span class="lineno"> 7705</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 7706</span> </div>
<div class="line"><span class="lineno"> 7719</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccApplyCmm::Apply(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)</div>
<div class="line"><span class="lineno"> 7720</span>{</div>
<div class="line"><span class="lineno"> 7721</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, *pTmp;</div>
<div class="line"><span class="lineno"> 7722</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc;</div>
<div class="line"><span class="lineno"> 7723</span>  CIccApplyXformList::iterator i;</div>
<div class="line"><span class="lineno"> 7724</span>  <span class="keyword">const</span> CIccXform *pLastXform;</div>
<div class="line"><span class="lineno"> 7725</span>  <span class="keywordtype">int</span> j, n = (int)m_Xforms-&gt;size();</div>
<div class="line"><span class="lineno"> 7726</span>  <span class="keywordtype">bool</span> bNoClip;</div>
<div class="line"><span class="lineno"> 7727</span> </div>
<div class="line"><span class="lineno"> 7728</span>  <span class="keywordflow">if</span> (!n)</div>
<div class="line"><span class="lineno"> 7729</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno"> 7730</span> </div>
<div class="line"><span class="lineno"> 7731</span>  <span class="keywordflow">if</span> (!m_Pixel &amp;&amp; !InitPixel()) {</div>
<div class="line"><span class="lineno"> 7732</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 7733</span>  }</div>
<div class="line"><span class="lineno"> 7734</span> </div>
<div class="line"><span class="lineno"> 7735</span>  pSrc = SrcPixel;</div>
<div class="line"><span class="lineno"> 7736</span>  pDst = m_Pixel;</div>
<div class="line"><span class="lineno"> 7737</span> </div>
<div class="line"><span class="lineno"> 7738</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 7739</span>  <span class="keywordtype">int</span> nCount = 0;</div>
<div class="line"><span class="lineno"> 7740</span>  printf(<span class="stringliteral">&quot;Start ApplyCmm\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 7741</span>  DumpCmmApplyPixel(nCount++, pSrc, <a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(m_pCmm-&gt;m_nSrcSpace));</div>
<div class="line"><span class="lineno"> 7742</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 7743</span> </div>
<div class="line"><span class="lineno"> 7744</span>  <span class="keywordflow">if</span> (n&gt;1) {</div>
<div class="line"><span class="lineno"> 7745</span>    <span class="keywordflow">for</span> (j=0, i=m_Xforms-&gt;begin(); j&lt;n-1 &amp;&amp; i!=m_Xforms-&gt;end(); i++, j++) {</div>
<div class="line"><span class="lineno"> 7746</span> </div>
<div class="line"><span class="lineno"> 7747</span>      i-&gt;ptr-&gt;Apply(pDst, pSrc);</div>
<div class="line"><span class="lineno"> 7748</span> </div>
<div class="line"><span class="lineno"> 7749</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 7750</span>      DumpCmmApplyPixel(nCount++, pDst, i-&gt;ptr-&gt;GetXform()-&gt;GetNumDstSamples());</div>
<div class="line"><span class="lineno"> 7751</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 7752</span> </div>
<div class="line"><span class="lineno"> 7753</span>      pTmp = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>*)pSrc;</div>
<div class="line"><span class="lineno"> 7754</span>      pSrc = pDst;</div>
<div class="line"><span class="lineno"> 7755</span>      <span class="keywordflow">if</span> (pTmp == SrcPixel)</div>
<div class="line"><span class="lineno"> 7756</span>        pDst = m_Pixel2;</div>
<div class="line"><span class="lineno"> 7757</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 7758</span>        pDst = pTmp;</div>
<div class="line"><span class="lineno"> 7759</span>    }</div>
<div class="line"><span class="lineno"> 7760</span> </div>
<div class="line"><span class="lineno"> 7761</span>    pLastXform = i-&gt;ptr-&gt;GetXform();   </div>
<div class="line"><span class="lineno"> 7762</span>    i-&gt;ptr-&gt;Apply(DstPixel, pSrc);</div>
<div class="line"><span class="lineno"> 7763</span>    bNoClip = pLastXform-&gt;NoClipPCS();</div>
<div class="line"><span class="lineno"> 7764</span>  }</div>
<div class="line"><span class="lineno"> 7765</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n==1) {</div>
<div class="line"><span class="lineno"> 7766</span>    i = m_Xforms-&gt;begin();</div>
<div class="line"><span class="lineno"> 7767</span> </div>
<div class="line"><span class="lineno"> 7768</span>    pLastXform = i-&gt;ptr-&gt;GetXform();</div>
<div class="line"><span class="lineno"> 7769</span>    i-&gt;ptr-&gt;Apply(DstPixel, SrcPixel);</div>
<div class="line"><span class="lineno"> 7770</span> </div>
<div class="line"><span class="lineno"> 7771</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 7772</span>    DumpCmmApplyPixel(nCount++, pDst, i-&gt;ptr-&gt;GetXform()-&gt;GetNumDstSamples());</div>
<div class="line"><span class="lineno"> 7773</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 7774</span> </div>
<div class="line"><span class="lineno"> 7775</span>    bNoClip = pLastXform-&gt;NoClipPCS();</div>
<div class="line"><span class="lineno"> 7776</span>  }</div>
<div class="line"><span class="lineno"> 7777</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 7778</span>    bNoClip = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 7779</span>  }</div>
<div class="line"><span class="lineno"> 7780</span> </div>
<div class="line"><span class="lineno"> 7781</span>  <span class="comment">//m_pPCS-&gt;CheckLast(DstPixel, m_pCmm-&gt;m_nDestSpace, bNoClip);</span></div>
<div class="line"><span class="lineno"> 7782</span> </div>
<div class="line"><span class="lineno"> 7783</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 7784</span>  DumpCmmApplyPixel(nCount, DstPixel, <a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(m_pCmm-&gt;m_nDestSpace));</div>
<div class="line"><span class="lineno"> 7785</span>  printf(<span class="stringliteral">&quot;End ApplyCmm\n\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 7786</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 7787</span> </div>
<div class="line"><span class="lineno"> 7788</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 7789</span>}</div>
<div class="line"><span class="lineno"> 7790</span> </div>
<div class="line"><span class="lineno"> 7803</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccApplyCmm::Apply(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> nPixels)</div>
<div class="line"><span class="lineno"> 7804</span>{</div>
<div class="line"><span class="lineno"> 7805</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, *pTmp;</div>
<div class="line"><span class="lineno"> 7806</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc;</div>
<div class="line"><span class="lineno"> 7807</span>  CIccApplyXformList::iterator i;</div>
<div class="line"><span class="lineno"> 7808</span>  <span class="keywordtype">int</span> j, n = (int)m_Xforms-&gt;size();</div>
<div class="line"><span class="lineno"> 7809</span>  <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> k;</div>
<div class="line"><span class="lineno"> 7810</span> </div>
<div class="line"><span class="lineno"> 7811</span>  <span class="keywordflow">if</span> (!n)</div>
<div class="line"><span class="lineno"> 7812</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno"> 7813</span> </div>
<div class="line"><span class="lineno"> 7814</span>  <span class="keywordflow">if</span> (!m_Pixel &amp;&amp; !InitPixel()) {</div>
<div class="line"><span class="lineno"> 7815</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 7816</span>  }</div>
<div class="line"><span class="lineno"> 7817</span> </div>
<div class="line"><span class="lineno"> 7818</span>  <span class="keywordflow">for</span> (k=0; k&lt;nPixels; k++) {</div>
<div class="line"><span class="lineno"> 7819</span>    pSrc = SrcPixel;</div>
<div class="line"><span class="lineno"> 7820</span>    pDst = m_Pixel;</div>
<div class="line"><span class="lineno"> 7821</span> </div>
<div class="line"><span class="lineno"> 7822</span>    <span class="keywordflow">if</span> (n&gt;1) {</div>
<div class="line"><span class="lineno"> 7823</span>      <span class="keywordflow">for</span> (j=0, i=m_Xforms-&gt;begin(); j&lt;n-1 &amp;&amp; i!=m_Xforms-&gt;end(); i++, j++) {</div>
<div class="line"><span class="lineno"> 7824</span> </div>
<div class="line"><span class="lineno"> 7825</span>        i-&gt;ptr-&gt;Apply(pDst, pSrc);</div>
<div class="line"><span class="lineno"> 7826</span>        pTmp = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>*)pSrc;</div>
<div class="line"><span class="lineno"> 7827</span>        pSrc = pDst;</div>
<div class="line"><span class="lineno"> 7828</span>        <span class="keywordflow">if</span> (pTmp==SrcPixel)</div>
<div class="line"><span class="lineno"> 7829</span>          pDst = m_Pixel2;</div>
<div class="line"><span class="lineno"> 7830</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 7831</span>          pDst = pTmp;</div>
<div class="line"><span class="lineno"> 7832</span>      }</div>
<div class="line"><span class="lineno"> 7833</span> </div>
<div class="line"><span class="lineno"> 7834</span>      i-&gt;ptr-&gt;Apply(DstPixel, pSrc);</div>
<div class="line"><span class="lineno"> 7835</span>    }</div>
<div class="line"><span class="lineno"> 7836</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n==1) {</div>
<div class="line"><span class="lineno"> 7837</span>      i = m_Xforms-&gt;begin();</div>
<div class="line"><span class="lineno"> 7838</span>      i-&gt;ptr-&gt;Apply(DstPixel, SrcPixel);</div>
<div class="line"><span class="lineno"> 7839</span>    }</div>
<div class="line"><span class="lineno"> 7840</span> </div>
<div class="line"><span class="lineno"> 7841</span>    DstPixel += m_pCmm-&gt;GetDestSamples();</div>
<div class="line"><span class="lineno"> 7842</span>    SrcPixel += m_pCmm-&gt;GetSourceSamples();</div>
<div class="line"><span class="lineno"> 7843</span>  }</div>
<div class="line"><span class="lineno"> 7844</span> </div>
<div class="line"><span class="lineno"> 7845</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 7846</span>}</div>
<div class="line"><span class="lineno"> 7847</span> </div>
<div class="line"><span class="lineno"> 7848</span><span class="keywordtype">void</span> CIccApplyCmm::AppendApplyXform(CIccApplyXform *pApplyXform)</div>
<div class="line"><span class="lineno"> 7849</span>{</div>
<div class="line"><span class="lineno"> 7850</span>  CIccApplyXformPtr ptr;</div>
<div class="line"><span class="lineno"> 7851</span>  ptr.ptr = pApplyXform;</div>
<div class="line"><span class="lineno"> 7852</span> </div>
<div class="line"><span class="lineno"> 7853</span>  m_Xforms-&gt;push_back(ptr);</div>
<div class="line"><span class="lineno"> 7854</span>}</div>
<div class="line"><span class="lineno"> 7855</span> </div>
<div class="line"><span class="lineno"> 7869</span>CIccCmm::CIccCmm(<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nSrcSpace <span class="comment">/*=icSigUnknownData*/</span>,</div>
<div class="line"><span class="lineno"> 7870</span>                 <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nDestSpace <span class="comment">/*=icSigUnknownData*/</span>,</div>
<div class="line"><span class="lineno"> 7871</span>                 <span class="keywordtype">bool</span> bFirstInput <span class="comment">/*=true*/</span>)</div>
<div class="line"><span class="lineno"> 7872</span>{</div>
<div class="line"><span class="lineno"> 7873</span>  m_bValid = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 7874</span> </div>
<div class="line"><span class="lineno"> 7875</span>  m_bLastInput = !bFirstInput;</div>
<div class="line"><span class="lineno"> 7876</span>  m_nSrcSpace = nSrcSpace;</div>
<div class="line"><span class="lineno"> 7877</span>  m_nDestSpace = nDestSpace;</div>
<div class="line"><span class="lineno"> 7878</span> </div>
<div class="line"><span class="lineno"> 7879</span>  m_nLastSpace = nSrcSpace;</div>
<div class="line"><span class="lineno"> 7880</span>  m_nLastIntent = <a class="code hl_define" href="../../d7/d46/a00002.html#a0fbdbf76357f4ad739b1df71bd87ef8a">icUnknownIntent</a>;</div>
<div class="line"><span class="lineno"> 7881</span> </div>
<div class="line"><span class="lineno"> 7882</span>  m_Xforms = <span class="keyword">new</span> CIccXformList;</div>
<div class="line"><span class="lineno"> 7883</span>  m_Xforms-&gt;clear();</div>
<div class="line"><span class="lineno"> 7884</span> </div>
<div class="line"><span class="lineno"> 7885</span>  m_pApply = NULL;</div>
<div class="line"><span class="lineno"> 7886</span>}</div>
<div class="line"><span class="lineno"> 7887</span> </div>
<div class="line"><span class="lineno"> 7896</span>CIccCmm::~CIccCmm()</div>
<div class="line"><span class="lineno"> 7897</span>{</div>
<div class="line"><span class="lineno"> 7898</span>  <span class="keywordflow">if</span> (m_Xforms) {</div>
<div class="line"><span class="lineno"> 7899</span>    CIccXformList::iterator i;</div>
<div class="line"><span class="lineno"> 7900</span> </div>
<div class="line"><span class="lineno"> 7901</span>    <span class="keywordflow">for</span> (i=m_Xforms-&gt;begin(); i!=m_Xforms-&gt;end(); i++) {</div>
<div class="line"><span class="lineno"> 7902</span>      <span class="keywordflow">if</span> (i-&gt;ptr)</div>
<div class="line"><span class="lineno"> 7903</span>        <span class="keyword">delete</span> i-&gt;ptr;</div>
<div class="line"><span class="lineno"> 7904</span>    }</div>
<div class="line"><span class="lineno"> 7905</span> </div>
<div class="line"><span class="lineno"> 7906</span>    <span class="keyword">delete</span> m_Xforms;</div>
<div class="line"><span class="lineno"> 7907</span>  }</div>
<div class="line"><span class="lineno"> 7908</span> </div>
<div class="line"><span class="lineno"> 7909</span>  <span class="keywordflow">if</span> (m_pApply)</div>
<div class="line"><span class="lineno"> 7910</span>    <span class="keyword">delete</span> m_pApply;</div>
<div class="line"><span class="lineno"> 7911</span>}</div>
<div class="line"><span class="lineno"> 7912</span> </div>
<div class="line"><span class="lineno"> 7913</span><span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a>* CIccCmm::GetStatusText(<a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> stat)</div>
<div class="line"><span class="lineno"> 7914</span>{</div>
<div class="line"><span class="lineno"> 7915</span>  <span class="keywordflow">switch</span> (stat) {</div>
<div class="line"><span class="lineno"> 7916</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6aa1b3e92b9f8f78ad52846a217a262f72">icCmmStatBad</a>:</div>
<div class="line"><span class="lineno"> 7917</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Bad CMM&quot;</span>;</div>
<div class="line"><span class="lineno"> 7918</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>:</div>
<div class="line"><span class="lineno"> 7919</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;OK&quot;</span>;</div>
<div class="line"><span class="lineno"> 7920</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a94a1cd52eec49dc84eac5993164c5be0">icCmmStatCantOpenProfile</a>:</div>
<div class="line"><span class="lineno"> 7921</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Cannot open profile&quot;</span>;</div>
<div class="line"><span class="lineno"> 7922</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>:</div>
<div class="line"><span class="lineno"> 7923</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Invalid space link&quot;</span>;</div>
<div class="line"><span class="lineno"> 7924</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860">icCmmStatInvalidProfile</a>:</div>
<div class="line"><span class="lineno"> 7925</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Invalid profile&quot;</span>;</div>
<div class="line"><span class="lineno"> 7926</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>:</div>
<div class="line"><span class="lineno"> 7927</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Invalid profile transform&quot;</span>;</div>
<div class="line"><span class="lineno"> 7928</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096">icCmmStatInvalidLut</a>:</div>
<div class="line"><span class="lineno"> 7929</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Invalid Look-Up Table&quot;</span>;</div>
<div class="line"><span class="lineno"> 7930</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a">icCmmStatProfileMissingTag</a>:</div>
<div class="line"><span class="lineno"> 7931</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Missing tag in profile&quot;</span>;</div>
<div class="line"><span class="lineno"> 7932</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16">icCmmStatColorNotFound</a>:</div>
<div class="line"><span class="lineno"> 7933</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Color not found&quot;</span>;</div>
<div class="line"><span class="lineno"> 7934</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>:</div>
<div class="line"><span class="lineno"> 7935</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Incorrect Apply object&quot;</span>;</div>
<div class="line"><span class="lineno"> 7936</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26">icCmmStatBadColorEncoding</a>:</div>
<div class="line"><span class="lineno"> 7937</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Invalid color encoding used&quot;</span>;</div>
<div class="line"><span class="lineno"> 7938</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>:</div>
<div class="line"><span class="lineno"> 7939</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Memory allocation error&quot;</span>;</div>
<div class="line"><span class="lineno"> 7940</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a0a3d499218e996db890cba097db15f3b">icCmmStatBadLutType</a>:</div>
<div class="line"><span class="lineno"> 7941</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Invalid Look-Up Table type&quot;</span>;</div>
<div class="line"><span class="lineno"> 7942</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10">icCmmStatIdentityXform</a>:</div>
<div class="line"><span class="lineno"> 7943</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Identity transform used&quot;</span>;</div>
<div class="line"><span class="lineno"> 7944</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281">icCmmStatUnsupportedPcsLink</a>:</div>
<div class="line"><span class="lineno"> 7945</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Unsupported PCS Link used&quot;</span>;</div>
<div class="line"><span class="lineno"> 7946</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9d8efd1c91aa512d46f51cd30a7927f5">icCmmStatBadConnection</a>:</div>
<div class="line"><span class="lineno"> 7947</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Invalid profile connection&quot;</span>;</div>
<div class="line"><span class="lineno"> 7948</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6aacc0b85d049e6d79aa0704d2054e62be">icCmmStatBadTintXform</a>:</div>
<div class="line"><span class="lineno"> 7949</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Invalid tint transform&quot;</span>;</div>
<div class="line"><span class="lineno"> 7950</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a4af396c1421581f2a51027630e4bfb42">icCmmStatTooManySamples</a>:</div>
<div class="line"><span class="lineno"> 7951</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Too many samples used&quot;</span>;</div>
<div class="line"><span class="lineno"> 7952</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a6bd126a39f8787a82bf08db1af1fcb9b">icCmmStatBadMCSLink</a>:</div>
<div class="line"><span class="lineno"> 7953</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Invalid MCS link connection&quot;</span>;</div>
<div class="line"><span class="lineno"> 7954</span>  <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 7955</span>    <span class="keywordflow">return</span> <span class="stringliteral">&quot;Unknown CMM Status value&quot;</span>;</div>
<div class="line"><span class="lineno"> 7956</span> </div>
<div class="line"><span class="lineno"> 7957</span>  }</div>
<div class="line"><span class="lineno"> 7958</span>}</div>
<div class="line"><span class="lineno"> 7959</span> </div>
<div class="line"><span class="lineno"> 7978</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::AddXform(<span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a> *szProfilePath,</div>
<div class="line"><span class="lineno"> 7979</span>                              <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nIntent <span class="comment">/*=icUnknownIntent*/</span>,</div>
<div class="line"><span class="lineno"> 7980</span>                              <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913">icXformInterp</a> nInterp <span class="comment">/*icXformInterp*/</span>,</div>
<div class="line"><span class="lineno"> 7981</span>                              <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc<span class="comment">/*=NULL*/</span>,</div>
<div class="line"><span class="lineno"> 7982</span>                              <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7b">icXformLutType</a> nLutType <span class="comment">/*=icXformLutColor*/</span>,</div>
<div class="line"><span class="lineno"> 7983</span>                              <span class="keywordtype">bool</span> bUseD2BxB2DxTags <span class="comment">/*=true*/</span>,</div>
<div class="line"><span class="lineno"> 7984</span>                              CIccCreateXformHintManager *pHintManager <span class="comment">/*=NULL*/</span>,</div>
<div class="line"><span class="lineno"> 7985</span>                              <span class="keywordtype">bool</span> bUseSubProfile <span class="comment">/*=false*/</span>)</div>
<div class="line"><span class="lineno"> 7986</span>{</div>
<div class="line"><span class="lineno"> 7987</span>  <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile = <a class="code hl_function" href="../../d0/dc2/a00104.html#a97134bdd4b4bf5e8a43ef018bba0917e">OpenIccProfile</a>(szProfilePath, bUseSubProfile);</div>
<div class="line"><span class="lineno"> 7988</span> </div>
<div class="line"><span class="lineno"> 7989</span>  <span class="keywordflow">if</span> (!pProfile) </div>
<div class="line"><span class="lineno"> 7990</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a94a1cd52eec49dc84eac5993164c5be0">icCmmStatCantOpenProfile</a>;</div>
<div class="line"><span class="lineno"> 7991</span> </div>
<div class="line"><span class="lineno"> 7992</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv = AddXform(pProfile, nIntent, nInterp, pPcc, nLutType, bUseD2BxB2DxTags, pHintManager);</div>
<div class="line"><span class="lineno"> 7993</span> </div>
<div class="line"><span class="lineno"> 7994</span>  <span class="keywordflow">if</span> (rv != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno"> 7995</span>    <span class="keyword">delete</span> pProfile;</div>
<div class="line"><span class="lineno"> 7996</span> </div>
<div class="line"><span class="lineno"> 7997</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 7998</span>}</div>
<div class="line"><span class="lineno"> 7999</span> </div>
<div class="line"><span class="lineno"> 8000</span> </div>
<div class="line"><span class="lineno"> 8022</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::AddXform(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a0462ca2992be7c80b056e640a192b325">icUInt8Number</a> *pProfileMem,</div>
<div class="line"><span class="lineno"> 8023</span>                              <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> nProfileLen,</div>
<div class="line"><span class="lineno"> 8024</span>                              <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nIntent <span class="comment">/*=icUnknownIntent*/</span>,</div>
<div class="line"><span class="lineno"> 8025</span>                              <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913">icXformInterp</a> nInterp <span class="comment">/*icXformInterp*/</span>,</div>
<div class="line"><span class="lineno"> 8026</span>                              <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc<span class="comment">/*=NULL*/</span>,</div>
<div class="line"><span class="lineno"> 8027</span>                              <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7b">icXformLutType</a> nLutType <span class="comment">/*=icXformLutColor*/</span>,</div>
<div class="line"><span class="lineno"> 8028</span>                              <span class="keywordtype">bool</span> bUseD2BxB2DxTags <span class="comment">/*=true*/</span>,</div>
<div class="line"><span class="lineno"> 8029</span>                              CIccCreateXformHintManager *pHintManager <span class="comment">/*=NULL*/</span>,</div>
<div class="line"><span class="lineno"> 8030</span>                              <span class="keywordtype">bool</span> bUseSubProfile <span class="comment">/*=false*/</span>)</div>
<div class="line"><span class="lineno"> 8031</span>{</div>
<div class="line"><span class="lineno"> 8032</span>  <a class="code hl_class" href="../../da/d5b/a00905.html">CIccMemIO</a> *pFile = <span class="keyword">new</span> <a class="code hl_class" href="../../da/d5b/a00905.html">CIccMemIO</a>;</div>
<div class="line"><span class="lineno"> 8033</span> </div>
<div class="line"><span class="lineno"> 8034</span>  <span class="keywordflow">if</span> (!pFile || !pFile-&gt;<a class="code hl_function" href="../../da/d5b/a00905.html#ae20403295a31727fe9f77ce46ea57c8e">Attach</a>(pProfileMem, nProfileLen, bUseSubProfile))</div>
<div class="line"><span class="lineno"> 8035</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a94a1cd52eec49dc84eac5993164c5be0">icCmmStatCantOpenProfile</a>;</div>
<div class="line"><span class="lineno"> 8036</span> </div>
<div class="line"><span class="lineno"> 8037</span>  <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile = <span class="keyword">new</span> <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a>;</div>
<div class="line"><span class="lineno"> 8038</span> </div>
<div class="line"><span class="lineno"> 8039</span>  <span class="keywordflow">if</span> (!pProfile)</div>
<div class="line"><span class="lineno"> 8040</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a94a1cd52eec49dc84eac5993164c5be0">icCmmStatCantOpenProfile</a>;</div>
<div class="line"><span class="lineno"> 8041</span> </div>
<div class="line"><span class="lineno"> 8042</span>  <span class="keywordflow">if</span> (!pProfile-&gt;Attach(pFile)) {</div>
<div class="line"><span class="lineno"> 8043</span>    <span class="keyword">delete</span> pFile;</div>
<div class="line"><span class="lineno"> 8044</span>    <span class="keyword">delete</span> pProfile;</div>
<div class="line"><span class="lineno"> 8045</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a94a1cd52eec49dc84eac5993164c5be0">icCmmStatCantOpenProfile</a>;</div>
<div class="line"><span class="lineno"> 8046</span>  }</div>
<div class="line"><span class="lineno"> 8047</span> </div>
<div class="line"><span class="lineno"> 8048</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv = AddXform(pProfile, nIntent, nInterp, pPcc, nLutType, bUseD2BxB2DxTags, pHintManager);</div>
<div class="line"><span class="lineno"> 8049</span> </div>
<div class="line"><span class="lineno"> 8050</span>  <span class="keywordflow">if</span> (rv != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno"> 8051</span>    <span class="keyword">delete</span> pProfile;</div>
<div class="line"><span class="lineno"> 8052</span> </div>
<div class="line"><span class="lineno"> 8053</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 8054</span>}</div>
<div class="line"><span class="lineno"> 8055</span> </div>
<div class="line"><span class="lineno"> 8056</span> </div>
<div class="line"><span class="lineno"> 8076</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::AddXform(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile,</div>
<div class="line"><span class="lineno"> 8077</span>                              <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nIntent <span class="comment">/*=icUnknownIntent*/</span>,</div>
<div class="line"><span class="lineno"> 8078</span>                              <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913">icXformInterp</a> nInterp <span class="comment">/*=icInterpLinear*/</span>,</div>
<div class="line"><span class="lineno"> 8079</span>                              <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc<span class="comment">/*=NULL*/</span>,</div>
<div class="line"><span class="lineno"> 8080</span>                              <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7b">icXformLutType</a> nLutType <span class="comment">/*=icXformLutColor*/</span>,</div>
<div class="line"><span class="lineno"> 8081</span>                              <span class="keywordtype">bool</span> bUseD2BxB2DxTags <span class="comment">/*=true*/</span>,</div>
<div class="line"><span class="lineno"> 8082</span>                              CIccCreateXformHintManager *pHintManager <span class="comment">/*=NULL*/</span>)</div>
<div class="line"><span class="lineno"> 8083</span>{</div>
<div class="line"><span class="lineno"> 8084</span>  <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nSrcSpace, nDstSpace;</div>
<div class="line"><span class="lineno"> 8085</span>  <span class="keywordtype">bool</span> bInput = !m_bLastInput;</div>
<div class="line"><span class="lineno"> 8086</span> </div>
<div class="line"><span class="lineno"> 8087</span>  <span class="keywordflow">if</span> (!pProfile)</div>
<div class="line"><span class="lineno"> 8088</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860">icCmmStatInvalidProfile</a>;</div>
<div class="line"><span class="lineno"> 8089</span> </div>
<div class="line"><span class="lineno"> 8090</span>  <span class="keywordflow">switch</span>(pProfile-&gt;m_Header.deviceClass) {</div>
<div class="line"><span class="lineno"> 8091</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0aeb74955777b1abe38df700474c7be5ce">icSigMaterialIdentificationClass</a>:</div>
<div class="line"><span class="lineno"> 8092</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f">icSigMaterialVisualizationClass</a>:</div>
<div class="line"><span class="lineno"> 8093</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a8b2deae24b9246ac33314b42ad02ac48">icSigMaterialLinkClass</a>:</div>
<div class="line"><span class="lineno"> 8094</span>      nIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a>;</div>
<div class="line"><span class="lineno"> 8095</span>      nLutType = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153">icXformLutMCS</a>;</div>
<div class="line"><span class="lineno"> 8096</span> </div>
<div class="line"><span class="lineno"> 8097</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 8098</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8099</span>  }</div>
<div class="line"><span class="lineno"> 8100</span> </div>
<div class="line"><span class="lineno"> 8101</span>  <span class="keywordflow">switch</span> (nLutType) {</div>
<div class="line"><span class="lineno"> 8102</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614">icXformLutColor</a>:</div>
<div class="line"><span class="lineno"> 8103</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013">icXformLutColorimetric</a>:</div>
<div class="line"><span class="lineno"> 8104</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262">icXformLutSpectral</a>:</div>
<div class="line"><span class="lineno"> 8105</span>    {</div>
<div class="line"><span class="lineno"> 8106</span>      <span class="comment">//Check pProfile if nIntent and input can be found.</span></div>
<div class="line"><span class="lineno"> 8107</span>      <span class="keywordflow">if</span> (bInput) {</div>
<div class="line"><span class="lineno"> 8108</span>        nSrcSpace = pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno"> 8109</span> </div>
<div class="line"><span class="lineno"> 8110</span>        <span class="keywordflow">if</span> (nLutType == <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262">icXformLutSpectral</a> || (bUseD2BxB2DxTags &amp;&amp; pProfile-&gt;m_Header.spectralPCS &amp;&amp; nLutType != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013">icXformLutColorimetric</a>))</div>
<div class="line"><span class="lineno"> 8111</span>          nDstSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.spectralPCS;</div>
<div class="line"><span class="lineno"> 8112</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8113</span>          nDstSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 8114</span>      }</div>
<div class="line"><span class="lineno"> 8115</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8116</span>        <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0af50c13fdfab9fcc0a7b831ac86d1fe3b">icSigLinkClass</a>) {</div>
<div class="line"><span class="lineno"> 8117</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 8118</span>        }</div>
<div class="line"><span class="lineno"> 8119</span>        <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a200e4fc8dcec29c6d411cae0c9a0483c">icSigAbstractClass</a>) {</div>
<div class="line"><span class="lineno"> 8120</span>          bInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 8121</span>          nIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a>; <span class="comment">// Note: icPerceptualIntent = 0</span></div>
<div class="line"><span class="lineno"> 8122</span>        }</div>
<div class="line"><span class="lineno"> 8123</span> </div>
<div class="line"><span class="lineno"> 8124</span>        <span class="keywordflow">if</span> (nLutType == <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262">icXformLutSpectral</a> || (bUseD2BxB2DxTags &amp;&amp; pProfile-&gt;m_Header.spectralPCS &amp;&amp; nLutType != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013">icXformLutColorimetric</a>))</div>
<div class="line"><span class="lineno"> 8125</span>          nSrcSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.spectralPCS;</div>
<div class="line"><span class="lineno"> 8126</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8127</span>          nSrcSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 8128</span> </div>
<div class="line"><span class="lineno"> 8129</span>        nDstSpace = pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno"> 8130</span>      }</div>
<div class="line"><span class="lineno"> 8131</span>    }</div>
<div class="line"><span class="lineno"> 8132</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8133</span> </div>
<div class="line"><span class="lineno"> 8134</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7baeb0501fdc1dcc7f1388f0fdca9b17356">icXformLutPreview</a>:</div>
<div class="line"><span class="lineno"> 8135</span>      nSrcSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 8136</span>      nDstSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 8137</span>      bInput = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 8138</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8139</span> </div>
<div class="line"><span class="lineno"> 8140</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba6df311bd7dc6c9c9284ad186b15f53de">icXformLutGamut</a>:</div>
<div class="line"><span class="lineno"> 8141</span>      nSrcSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 8142</span>      nDstSpace = <a class="code hl_define" href="../../d7/d46/a00002.html#af63f30724bd4cfbb6b7e3e2d7b1b602e">icSigGamutData</a>;</div>
<div class="line"><span class="lineno"> 8143</span>      bInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 8144</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8145</span> </div>
<div class="line"><span class="lineno"> 8146</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7baf26b30e0e73bf289c23075e2f6106e6d">icXformLutBRDFParam</a>:</div>
<div class="line"><span class="lineno"> 8147</span>      <span class="keywordflow">if</span> (!bInput)</div>
<div class="line"><span class="lineno"> 8148</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 8149</span>      nSrcSpace = pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno"> 8150</span>      nDstSpace = <a class="code hl_define" href="../../d7/d46/a00002.html#ab9fb37bd0a4bf923692592a8b0565043">icSigBRDFParameters</a>;</div>
<div class="line"><span class="lineno"> 8151</span>      bInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 8152</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8153</span> </div>
<div class="line"><span class="lineno"> 8154</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba1109d56a39fd11938962b487d6f965b8">icXformLutBRDFDirect</a>:</div>
<div class="line"><span class="lineno"> 8155</span>      <span class="keywordflow">if</span> (!bInput)</div>
<div class="line"><span class="lineno"> 8156</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 8157</span>      nSrcSpace = <a class="code hl_define" href="../../d7/d46/a00002.html#a11a26c7a39b8bcb49fe0468959d60a7c">icSigBRDFDirect</a>;</div>
<div class="line"><span class="lineno"> 8158</span>      nDstSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 8159</span>      bInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 8160</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8161</span> </div>
<div class="line"><span class="lineno"> 8162</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba1765210771d77678d0600381557d8bba">icXformLutBRDFMcsParam</a>:</div>
<div class="line"><span class="lineno"> 8163</span>      <span class="keywordflow">if</span> (!bInput)</div>
<div class="line"><span class="lineno"> 8164</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 8165</span>      nSrcSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.mcs;</div>
<div class="line"><span class="lineno"> 8166</span>      nDstSpace = <a class="code hl_define" href="../../d7/d46/a00002.html#ab9fb37bd0a4bf923692592a8b0565043">icSigBRDFParameters</a>;</div>
<div class="line"><span class="lineno"> 8167</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8168</span> </div>
<div class="line"><span class="lineno"> 8169</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153">icXformLutMCS</a>:</div>
<div class="line"><span class="lineno"> 8170</span>      <span class="keywordflow">if</span> (bInput) {</div>
<div class="line"><span class="lineno"> 8171</span>        nSrcSpace = pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno"> 8172</span>        nDstSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.mcs;</div>
<div class="line"><span class="lineno"> 8173</span>      }</div>
<div class="line"><span class="lineno"> 8174</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8175</span>        <span class="keywordflow">if</span> (m_Xforms-&gt;size()) {</div>
<div class="line"><span class="lineno"> 8176</span>          CIccXformList::iterator prev = --(m_Xforms-&gt;end());</div>
<div class="line"><span class="lineno"> 8177</span>          </div>
<div class="line"><span class="lineno"> 8178</span>          <span class="comment">//Make sure previous profile connects with an icXformLutMCS</span></div>
<div class="line"><span class="lineno"> 8179</span>          <span class="keywordflow">if</span> (prev-&gt;ptr-&gt;GetXformType()!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153">icXformLutMCS</a>) {</div>
<div class="line"><span class="lineno"> 8180</span>            <span class="comment">//check to see if we can convert previous xform to connect via an MCS</span></div>
<div class="line"><span class="lineno"> 8181</span>            <span class="keywordflow">if</span> (!prev-&gt;ptr-&gt;GetProfile()-&gt;m_Header.mcs) {</div>
<div class="line"><span class="lineno"> 8182</span>              <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a6bd126a39f8787a82bf08db1af1fcb9b">icCmmStatBadMCSLink</a>;</div>
<div class="line"><span class="lineno"> 8183</span>            }</div>
<div class="line"><span class="lineno"> 8184</span> </div>
<div class="line"><span class="lineno"> 8185</span>            CIccXform *pPrev = prev-&gt;ptr;</div>
<div class="line"><span class="lineno"> 8186</span>            CIccXform *pNew = CIccXform::Create(pPrev-&gt;GetProfilePtr(), pPrev-&gt;IsInput(), pPrev-&gt;GetIntent(), pPrev-&gt;GetInterp(),</div>
<div class="line"><span class="lineno"> 8187</span>                                                pPrev-&gt;GetConnectionConditions(), <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153">icXformLutMCS</a>, bUseD2BxB2DxTags, pHintManager);</div>
<div class="line"><span class="lineno"> 8188</span> </div>
<div class="line"><span class="lineno"> 8189</span>            <span class="keywordflow">if</span> (pNew) {</div>
<div class="line"><span class="lineno"> 8190</span>              pPrev-&gt;DetachAll();</div>
<div class="line"><span class="lineno"> 8191</span>              <span class="keyword">delete</span> pPrev;</div>
<div class="line"><span class="lineno"> 8192</span>            }</div>
<div class="line"><span class="lineno"> 8193</span> </div>
<div class="line"><span class="lineno"> 8194</span>            prev-&gt;ptr = pNew;</div>
<div class="line"><span class="lineno"> 8195</span> </div>
<div class="line"><span class="lineno"> 8196</span>          }</div>
<div class="line"><span class="lineno"> 8197</span>        }</div>
<div class="line"><span class="lineno"> 8198</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8199</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a6bd126a39f8787a82bf08db1af1fcb9b">icCmmStatBadMCSLink</a>;</div>
<div class="line"><span class="lineno"> 8200</span>        }</div>
<div class="line"><span class="lineno"> 8201</span> </div>
<div class="line"><span class="lineno"> 8202</span>        nSrcSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.mcs;</div>
<div class="line"><span class="lineno"> 8203</span>        <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f">icSigMaterialVisualizationClass</a>) {</div>
<div class="line"><span class="lineno"> 8204</span>          <span class="keywordflow">if</span> (bUseD2BxB2DxTags &amp;&amp; pProfile-&gt;m_Header.spectralPCS) {</div>
<div class="line"><span class="lineno"> 8205</span>            nDstSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.spectralPCS;</div>
<div class="line"><span class="lineno"> 8206</span>          }</div>
<div class="line"><span class="lineno"> 8207</span>          <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8208</span>            nDstSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 8209</span>          }</div>
<div class="line"><span class="lineno"> 8210</span>        }</div>
<div class="line"><span class="lineno"> 8211</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a8b2deae24b9246ac33314b42ad02ac48">icSigMaterialLinkClass</a>) {</div>
<div class="line"><span class="lineno"> 8212</span>          nDstSpace = pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno"> 8213</span>        }</div>
<div class="line"><span class="lineno"> 8214</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8215</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 8216</span>        }</div>
<div class="line"><span class="lineno"> 8217</span>      }</div>
<div class="line"><span class="lineno"> 8218</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8219</span> </div>
<div class="line"><span class="lineno"> 8220</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 8221</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a0a3d499218e996db890cba097db15f3b">icCmmStatBadLutType</a>;</div>
<div class="line"><span class="lineno"> 8222</span>  }</div>
<div class="line"><span class="lineno"> 8223</span> </div>
<div class="line"><span class="lineno"> 8224</span>  <span class="comment">//Make sure colorspaces match with previous xforms</span></div>
<div class="line"><span class="lineno"> 8225</span>  <span class="keywordflow">if</span> (!m_Xforms-&gt;size()) {</div>
<div class="line"><span class="lineno"> 8226</span>    <span class="keywordflow">if</span> (m_nSrcSpace == <a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a>) {</div>
<div class="line"><span class="lineno"> 8227</span>      m_nLastSpace = nSrcSpace;</div>
<div class="line"><span class="lineno"> 8228</span>      m_nSrcSpace = nSrcSpace;</div>
<div class="line"><span class="lineno"> 8229</span>    }</div>
<div class="line"><span class="lineno"> 8230</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d3/df8/a00155.html#a1376d1bc8bb70237fde226cb6f49872c">IsCompatSpace</a>(m_nSrcSpace, nSrcSpace)) {</div>
<div class="line"><span class="lineno"> 8231</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 8232</span>    }</div>
<div class="line"><span class="lineno"> 8233</span>  }</div>
<div class="line"><span class="lineno"> 8234</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d3/df8/a00155.html#a1376d1bc8bb70237fde226cb6f49872c">IsCompatSpace</a>(m_nLastSpace, nSrcSpace)) {</div>
<div class="line"><span class="lineno"> 8235</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 8236</span>  }</div>
<div class="line"><span class="lineno"> 8237</span> </div>
<div class="line"><span class="lineno"> 8238</span>  <span class="keywordflow">if</span> (nSrcSpace==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>)</div>
<div class="line"><span class="lineno"> 8239</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 8240</span>  </div>
<div class="line"><span class="lineno"> 8241</span>  <span class="comment">//Automatic creation of intent from header/last profile</span></div>
<div class="line"><span class="lineno"> 8242</span>  <span class="keywordflow">if</span> (nIntent==<a class="code hl_define" href="../../d7/d46/a00002.html#a0fbdbf76357f4ad739b1df71bd87ef8a">icUnknownIntent</a>) {</div>
<div class="line"><span class="lineno"> 8243</span>    <span class="keywordflow">if</span> (bInput) {</div>
<div class="line"><span class="lineno"> 8244</span>      nIntent = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a>)pProfile-&gt;m_Header.renderingIntent;</div>
<div class="line"><span class="lineno"> 8245</span>    }</div>
<div class="line"><span class="lineno"> 8246</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8247</span>      nIntent = m_nLastIntent;</div>
<div class="line"><span class="lineno"> 8248</span>    }</div>
<div class="line"><span class="lineno"> 8249</span>    <span class="keywordflow">if</span> (nIntent == <a class="code hl_define" href="../../d7/d46/a00002.html#a0fbdbf76357f4ad739b1df71bd87ef8a">icUnknownIntent</a>)</div>
<div class="line"><span class="lineno"> 8250</span>      nIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a>;</div>
<div class="line"><span class="lineno"> 8251</span>  }</div>
<div class="line"><span class="lineno"> 8252</span> </div>
<div class="line"><span class="lineno"> 8253</span>  CIccXformPtr Xform;</div>
<div class="line"><span class="lineno"> 8254</span>  </div>
<div class="line"><span class="lineno"> 8255</span>  Xform.ptr = CIccXform::Create(pProfile, bInput, nIntent, nInterp, pPcc, nLutType, bUseD2BxB2DxTags, pHintManager);</div>
<div class="line"><span class="lineno"> 8256</span> </div>
<div class="line"><span class="lineno"> 8257</span>  <span class="keywordflow">if</span> (!Xform.ptr) {</div>
<div class="line"><span class="lineno"> 8258</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno"> 8259</span>  }</div>
<div class="line"><span class="lineno"> 8260</span> </div>
<div class="line"><span class="lineno"> 8261</span>  <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f">icSigMaterialVisualizationClass</a>) {</div>
<div class="line"><span class="lineno"> 8262</span>    bInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 8263</span>  }</div>
<div class="line"><span class="lineno"> 8264</span> </div>
<div class="line"><span class="lineno"> 8265</span>  m_nLastSpace = nDstSpace;</div>
<div class="line"><span class="lineno"> 8266</span>  m_nLastIntent = nIntent;</div>
<div class="line"><span class="lineno"> 8267</span>  m_bLastInput = bInput;</div>
<div class="line"><span class="lineno"> 8268</span> </div>
<div class="line"><span class="lineno"> 8269</span>  m_Xforms-&gt;push_back(Xform);</div>
<div class="line"><span class="lineno"> 8270</span> </div>
<div class="line"><span class="lineno"> 8271</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 8272</span>}</div>
<div class="line"><span class="lineno"> 8273</span> </div>
<div class="line"><span class="lineno"> 8293</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::AddXform(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile,</div>
<div class="line"><span class="lineno"> 8294</span>                              <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pXformTag,</div>
<div class="line"><span class="lineno"> 8295</span>                              <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nIntent<span class="comment">/*= icUnknownIntent*/</span>,</div>
<div class="line"><span class="lineno"> 8296</span>                              <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913">icXformInterp</a> nInterp <span class="comment">/*=icInterpLinear*/</span>,</div>
<div class="line"><span class="lineno"> 8297</span>                              <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc<span class="comment">/*=NULL*/</span>,</div>
<div class="line"><span class="lineno"> 8298</span>                              <span class="keywordtype">bool</span> bUseSpectralPCS <span class="comment">/*=false*/</span>,</div>
<div class="line"><span class="lineno"> 8299</span>                              CIccCreateXformHintManager *pHintManager <span class="comment">/*=NULL*/</span>)</div>
<div class="line"><span class="lineno"> 8300</span>{</div>
<div class="line"><span class="lineno"> 8301</span>  <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nSrcSpace, nDstSpace;</div>
<div class="line"><span class="lineno"> 8302</span>  <span class="keywordtype">bool</span> bInput = !m_bLastInput;</div>
<div class="line"><span class="lineno"> 8303</span> </div>
<div class="line"><span class="lineno"> 8304</span>  <span class="keywordflow">if</span> (!pProfile)</div>
<div class="line"><span class="lineno"> 8305</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860">icCmmStatInvalidProfile</a>;</div>
<div class="line"><span class="lineno"> 8306</span> </div>
<div class="line"><span class="lineno"> 8307</span>  <span class="keywordflow">switch</span> (pProfile-&gt;m_Header.deviceClass) {</div>
<div class="line"><span class="lineno"> 8308</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0aeb74955777b1abe38df700474c7be5ce">icSigMaterialIdentificationClass</a>:</div>
<div class="line"><span class="lineno"> 8309</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f">icSigMaterialVisualizationClass</a>:</div>
<div class="line"><span class="lineno"> 8310</span>  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a8b2deae24b9246ac33314b42ad02ac48">icSigMaterialLinkClass</a>:</div>
<div class="line"><span class="lineno"> 8311</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a0a3d499218e996db890cba097db15f3b">icCmmStatBadLutType</a>;</div>
<div class="line"><span class="lineno"> 8312</span> </div>
<div class="line"><span class="lineno"> 8313</span>  <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 8314</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8315</span>  }</div>
<div class="line"><span class="lineno"> 8316</span> </div>
<div class="line"><span class="lineno"> 8317</span>  <span class="comment">//Check pProfile if nIntent and input can be found.</span></div>
<div class="line"><span class="lineno"> 8318</span>  <span class="keywordflow">if</span> (bInput) {</div>
<div class="line"><span class="lineno"> 8319</span>    nSrcSpace = pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno"> 8320</span> </div>
<div class="line"><span class="lineno"> 8321</span>    <span class="keywordflow">if</span> (bUseSpectralPCS &amp;&amp; pProfile-&gt;m_Header.spectralPCS)</div>
<div class="line"><span class="lineno"> 8322</span>      nDstSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.spectralPCS;</div>
<div class="line"><span class="lineno"> 8323</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8324</span>      nDstSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 8325</span>      bUseSpectralPCS = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 8326</span>    }</div>
<div class="line"><span class="lineno"> 8327</span>  }</div>
<div class="line"><span class="lineno"> 8328</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8329</span>    <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0af50c13fdfab9fcc0a7b831ac86d1fe3b">icSigLinkClass</a>) {</div>
<div class="line"><span class="lineno"> 8330</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 8331</span>    }</div>
<div class="line"><span class="lineno"> 8332</span>    <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a200e4fc8dcec29c6d411cae0c9a0483c">icSigAbstractClass</a>) {</div>
<div class="line"><span class="lineno"> 8333</span>      bInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 8334</span>      nIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a>; <span class="comment">// Note: icPerceptualIntent = 0</span></div>
<div class="line"><span class="lineno"> 8335</span>    }</div>
<div class="line"><span class="lineno"> 8336</span> </div>
<div class="line"><span class="lineno"> 8337</span>    <span class="keywordflow">if</span> (bUseSpectralPCS &amp;&amp; pProfile-&gt;m_Header.spectralPCS)</div>
<div class="line"><span class="lineno"> 8338</span>      nSrcSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.spectralPCS;</div>
<div class="line"><span class="lineno"> 8339</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8340</span>      nSrcSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno"> 8341</span>      bUseSpectralPCS = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 8342</span>    }</div>
<div class="line"><span class="lineno"> 8343</span> </div>
<div class="line"><span class="lineno"> 8344</span>    nDstSpace = pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno"> 8345</span>  }</div>
<div class="line"><span class="lineno"> 8346</span> </div>
<div class="line"><span class="lineno"> 8347</span>  <span class="comment">//Make sure colorspaces match with previous xforms</span></div>
<div class="line"><span class="lineno"> 8348</span>  <span class="keywordflow">if</span> (!m_Xforms-&gt;size()) {</div>
<div class="line"><span class="lineno"> 8349</span>    <span class="keywordflow">if</span> (m_nSrcSpace == <a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a>) {</div>
<div class="line"><span class="lineno"> 8350</span>      m_nLastSpace = nSrcSpace;</div>
<div class="line"><span class="lineno"> 8351</span>      m_nSrcSpace = nSrcSpace;</div>
<div class="line"><span class="lineno"> 8352</span>    }</div>
<div class="line"><span class="lineno"> 8353</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d3/df8/a00155.html#a1376d1bc8bb70237fde226cb6f49872c">IsCompatSpace</a>(m_nSrcSpace, nSrcSpace)) {</div>
<div class="line"><span class="lineno"> 8354</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 8355</span>    }</div>
<div class="line"><span class="lineno"> 8356</span>  }</div>
<div class="line"><span class="lineno"> 8357</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d3/df8/a00155.html#a1376d1bc8bb70237fde226cb6f49872c">IsCompatSpace</a>(m_nLastSpace, nSrcSpace)) {</div>
<div class="line"><span class="lineno"> 8358</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 8359</span>  }</div>
<div class="line"><span class="lineno"> 8360</span> </div>
<div class="line"><span class="lineno"> 8361</span>  <span class="keywordflow">if</span> (nSrcSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>)</div>
<div class="line"><span class="lineno"> 8362</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 8363</span> </div>
<div class="line"><span class="lineno"> 8364</span>  <span class="comment">//Automatic creation of intent from header/last profile</span></div>
<div class="line"><span class="lineno"> 8365</span>  <span class="keywordflow">if</span> (nIntent == <a class="code hl_define" href="../../d7/d46/a00002.html#a0fbdbf76357f4ad739b1df71bd87ef8a">icUnknownIntent</a>) {</div>
<div class="line"><span class="lineno"> 8366</span>    <span class="keywordflow">if</span> (bInput) {</div>
<div class="line"><span class="lineno"> 8367</span>      nIntent = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a>)pProfile-&gt;m_Header.renderingIntent;</div>
<div class="line"><span class="lineno"> 8368</span>    }</div>
<div class="line"><span class="lineno"> 8369</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8370</span>      nIntent = m_nLastIntent;</div>
<div class="line"><span class="lineno"> 8371</span>    }</div>
<div class="line"><span class="lineno"> 8372</span>    <span class="keywordflow">if</span> (nIntent == <a class="code hl_define" href="../../d7/d46/a00002.html#a0fbdbf76357f4ad739b1df71bd87ef8a">icUnknownIntent</a>)</div>
<div class="line"><span class="lineno"> 8373</span>      nIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a>;</div>
<div class="line"><span class="lineno"> 8374</span>  }</div>
<div class="line"><span class="lineno"> 8375</span> </div>
<div class="line"><span class="lineno"> 8376</span>  CIccXformPtr Xform;</div>
<div class="line"><span class="lineno"> 8377</span> </div>
<div class="line"><span class="lineno"> 8378</span>  Xform.ptr = CIccXform::Create(pProfile, pXformTag, bInput, nIntent, nInterp, pPcc, bUseSpectralPCS, pHintManager);</div>
<div class="line"><span class="lineno"> 8379</span> </div>
<div class="line"><span class="lineno"> 8380</span>  <span class="keywordflow">if</span> (!Xform.ptr) {</div>
<div class="line"><span class="lineno"> 8381</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno"> 8382</span>  }</div>
<div class="line"><span class="lineno"> 8383</span> </div>
<div class="line"><span class="lineno"> 8384</span>  m_nLastSpace = nDstSpace;</div>
<div class="line"><span class="lineno"> 8385</span>  m_nLastIntent = nIntent;</div>
<div class="line"><span class="lineno"> 8386</span>  m_bLastInput = bInput;</div>
<div class="line"><span class="lineno"> 8387</span> </div>
<div class="line"><span class="lineno"> 8388</span>  m_Xforms-&gt;push_back(Xform);</div>
<div class="line"><span class="lineno"> 8389</span> </div>
<div class="line"><span class="lineno"> 8390</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 8391</span>}</div>
<div class="line"><span class="lineno"> 8392</span> </div>
<div class="line"><span class="lineno"> 8412</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::AddXform(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> &amp;Profile,</div>
<div class="line"><span class="lineno"> 8413</span>                              <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nIntent <span class="comment">/*=icUnknownIntent*/</span>,</div>
<div class="line"><span class="lineno"> 8414</span>                              <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913">icXformInterp</a> nInterp <span class="comment">/*=icInterpLinear*/</span>,</div>
<div class="line"><span class="lineno"> 8415</span>                              <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc<span class="comment">/*=NULL*/</span>,</div>
<div class="line"><span class="lineno"> 8416</span>                              <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7b">icXformLutType</a> nLutType <span class="comment">/*=icXformLutColor*/</span>,</div>
<div class="line"><span class="lineno"> 8417</span>                              <span class="keywordtype">bool</span> bUseD2BxB2DxTags <span class="comment">/*=true*/</span>,</div>
<div class="line"><span class="lineno"> 8418</span>                              CIccCreateXformHintManager *pHintManager <span class="comment">/*=NULL*/</span>)</div>
<div class="line"><span class="lineno"> 8419</span>{</div>
<div class="line"><span class="lineno"> 8420</span>  <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile = <span class="keyword">new</span> <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a>(Profile);</div>
<div class="line"><span class="lineno"> 8421</span> </div>
<div class="line"><span class="lineno"> 8422</span>  <span class="keywordflow">if</span> (!pProfile) </div>
<div class="line"><span class="lineno"> 8423</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 8424</span> </div>
<div class="line"><span class="lineno"> 8425</span> <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> stat = AddXform(pProfile, nIntent, nInterp, pPcc, nLutType, bUseD2BxB2DxTags, pHintManager);</div>
<div class="line"><span class="lineno"> 8426</span> </div>
<div class="line"><span class="lineno"> 8427</span>  <span class="keywordflow">if</span> (stat != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno"> 8428</span>    <span class="keyword">delete</span> pProfile;</div>
<div class="line"><span class="lineno"> 8429</span> </div>
<div class="line"><span class="lineno"> 8430</span>  <span class="keywordflow">return</span> stat;</div>
<div class="line"><span class="lineno"> 8431</span>}</div>
<div class="line"><span class="lineno"> 8432</span> </div>
<div class="line"><span class="lineno"> 8433</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::CheckPCSConnections(<span class="keywordtype">bool</span> bUsePCSConversions<span class="comment">/*=false*/</span>)</div>
<div class="line"><span class="lineno"> 8434</span>{</div>
<div class="line"><span class="lineno"> 8435</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 8436</span> </div>
<div class="line"><span class="lineno"> 8437</span>  CIccXformList::iterator last, next;</div>
<div class="line"><span class="lineno"> 8438</span>  CIccXformList xforms;</div>
<div class="line"><span class="lineno"> 8439</span>  CIccXformPtr ptr;</div>
<div class="line"><span class="lineno"> 8440</span>  <span class="keywordtype">bool</span> bUsesPcsXforms = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 8441</span> </div>
<div class="line"><span class="lineno"> 8442</span>  next=m_Xforms-&gt;begin();</div>
<div class="line"><span class="lineno"> 8443</span> </div>
<div class="line"><span class="lineno"> 8444</span>  <span class="keywordflow">if</span> (next!=m_Xforms-&gt;end()) {</div>
<div class="line"><span class="lineno"> 8445</span>    last = next;</div>
<div class="line"><span class="lineno"> 8446</span>    next++;</div>
<div class="line"><span class="lineno"> 8447</span> </div>
<div class="line"><span class="lineno"> 8448</span>    <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> lastSpace = last-&gt;ptr-&gt;GetSrcSpace();</div>
<div class="line"><span class="lineno"> 8449</span>    <span class="keywordflow">if</span> (!last-&gt;ptr-&gt;IsInput() &amp;&amp; <a class="code hl_define" href="../../d3/df8/a00155.html#aaacd6d45813e2697ad238b12befa5719">IsSpaceColorimetricPCS</a>(lastSpace) &amp;&amp; (GetSourceSpace() !=lastSpace || last-&gt;ptr-&gt;UseLegacyPCS())) {</div>
<div class="line"><span class="lineno"> 8450</span>      CIccPcsXform* pPcs = <span class="keyword">new</span> CIccPcsXform();</div>
<div class="line"><span class="lineno"> 8451</span> </div>
<div class="line"><span class="lineno"> 8452</span>      <span class="keywordflow">if</span> (!pPcs) {</div>
<div class="line"><span class="lineno"> 8453</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 8454</span>      }</div>
<div class="line"><span class="lineno"> 8455</span> </div>
<div class="line"><span class="lineno"> 8456</span>      rv = pPcs-&gt;ConnectFirst(last-&gt;ptr, GetSourceSpace());</div>
<div class="line"><span class="lineno"> 8457</span> </div>
<div class="line"><span class="lineno"> 8458</span>      <span class="keywordflow">if</span> (rv != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a> &amp;&amp; rv != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10">icCmmStatIdentityXform</a>) {</div>
<div class="line"><span class="lineno"> 8459</span>        <span class="keyword">delete</span> pPcs;</div>
<div class="line"><span class="lineno"> 8460</span>        <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 8461</span>      }</div>
<div class="line"><span class="lineno"> 8462</span> </div>
<div class="line"><span class="lineno"> 8463</span>      <span class="keywordflow">if</span> (rv != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10">icCmmStatIdentityXform</a>) {</div>
<div class="line"><span class="lineno"> 8464</span>        ptr.ptr = pPcs;</div>
<div class="line"><span class="lineno"> 8465</span>        xforms.push_back(ptr);</div>
<div class="line"><span class="lineno"> 8466</span> </div>
<div class="line"><span class="lineno"> 8467</span>        bUsesPcsXforms = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 8468</span>      }</div>
<div class="line"><span class="lineno"> 8469</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8470</span>        <span class="keyword">delete</span> pPcs;</div>
<div class="line"><span class="lineno"> 8471</span>      }</div>
<div class="line"><span class="lineno"> 8472</span>    }</div>
<div class="line"><span class="lineno"> 8473</span> </div>
<div class="line"><span class="lineno"> 8474</span>    xforms.push_back(*last);</div>
<div class="line"><span class="lineno"> 8475</span> </div>
<div class="line"><span class="lineno"> 8476</span>    <span class="keywordflow">for</span> (;next!=m_Xforms-&gt;end(); last=next, next++) {</div>
<div class="line"><span class="lineno"> 8477</span>      <span class="keywordflow">if</span> ((last-&gt;ptr-&gt;IsInput() &amp;&amp; last-&gt;ptr-&gt;IsMCS() &amp;&amp; next-&gt;ptr-&gt;IsMCS()) ||</div>
<div class="line"><span class="lineno"> 8478</span>          (<a class="code hl_function" href="../../d3/df8/a00155.html#a05df9b9a2f56c907e676a0efc3e9219d">IsSpaceSpectralPCS</a>(last-&gt;ptr-&gt;GetDstSpace()) || <a class="code hl_function" href="../../d3/df8/a00155.html#a05df9b9a2f56c907e676a0efc3e9219d">IsSpaceSpectralPCS</a>(next-&gt;ptr-&gt;GetSrcSpace())) ||</div>
<div class="line"><span class="lineno"> 8479</span>          (!bUsePCSConversions &amp;&amp; </div>
<div class="line"><span class="lineno"> 8480</span>           (<a class="code hl_define" href="../../d3/df8/a00155.html#aaacd6d45813e2697ad238b12befa5719">IsSpaceColorimetricPCS</a>(last-&gt;ptr-&gt;GetDstSpace()) || <a class="code hl_define" href="../../d3/df8/a00155.html#aaacd6d45813e2697ad238b12befa5719">IsSpaceColorimetricPCS</a>(next-&gt;ptr-&gt;GetSrcSpace())))) {</div>
<div class="line"><span class="lineno"> 8481</span>        last-&gt;ptr-&gt;SetDstPCSConversion(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 8482</span>        next-&gt;ptr-&gt;SetSrcPCSConversion(<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 8483</span>        CIccPcsXform *pPcs = <span class="keyword">new</span> CIccPcsXform();</div>
<div class="line"><span class="lineno"> 8484</span> </div>
<div class="line"><span class="lineno"> 8485</span>        <span class="keywordflow">if</span> (!pPcs) {</div>
<div class="line"><span class="lineno"> 8486</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 8487</span>        }</div>
<div class="line"><span class="lineno"> 8488</span> </div>
<div class="line"><span class="lineno"> 8489</span>        rv = pPcs-&gt;Connect(last-&gt;ptr, next-&gt;ptr);</div>
<div class="line"><span class="lineno"> 8490</span> </div>
<div class="line"><span class="lineno"> 8491</span>        <span class="keywordflow">if</span> (rv!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a> &amp;&amp; rv!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10">icCmmStatIdentityXform</a>)</div>
<div class="line"><span class="lineno"> 8492</span>          <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 8493</span> </div>
<div class="line"><span class="lineno"> 8494</span>        <span class="keywordflow">if</span> (rv!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10">icCmmStatIdentityXform</a>) {</div>
<div class="line"><span class="lineno"> 8495</span>          ptr.ptr = pPcs;</div>
<div class="line"><span class="lineno"> 8496</span>          xforms.push_back(ptr);</div>
<div class="line"><span class="lineno"> 8497</span> </div>
<div class="line"><span class="lineno"> 8498</span>          bUsesPcsXforms = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 8499</span>        }</div>
<div class="line"><span class="lineno"> 8500</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8501</span>          <span class="keyword">delete</span> pPcs;</div>
<div class="line"><span class="lineno"> 8502</span>        }</div>
<div class="line"><span class="lineno"> 8503</span>      }</div>
<div class="line"><span class="lineno"> 8504</span>      xforms.push_back(*next);</div>
<div class="line"><span class="lineno"> 8505</span>    }</div>
<div class="line"><span class="lineno"> 8506</span> </div>
<div class="line"><span class="lineno"> 8507</span>    lastSpace = last-&gt;ptr-&gt;GetDstSpace();</div>
<div class="line"><span class="lineno"> 8508</span>    <span class="keywordflow">if</span> (last-&gt;ptr-&gt;IsInput() &amp;&amp; <a class="code hl_define" href="../../d3/df8/a00155.html#aaacd6d45813e2697ad238b12befa5719">IsSpaceColorimetricPCS</a>(lastSpace) &amp;&amp; </div>
<div class="line"><span class="lineno"> 8509</span>        (last-&gt;ptr-&gt;NeedAdjustPCS() || GetDestSpace() != lastSpace || last-&gt;ptr-&gt;UseLegacyPCS())) {</div>
<div class="line"><span class="lineno"> 8510</span>      CIccPcsXform* pPcs = <span class="keyword">new</span> CIccPcsXform();</div>
<div class="line"><span class="lineno"> 8511</span> </div>
<div class="line"><span class="lineno"> 8512</span>      <span class="keywordflow">if</span> (!pPcs) {</div>
<div class="line"><span class="lineno"> 8513</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 8514</span>      }</div>
<div class="line"><span class="lineno"> 8515</span>      rv = pPcs-&gt;ConnectLast(last-&gt;ptr, GetDestSpace());</div>
<div class="line"><span class="lineno"> 8516</span> </div>
<div class="line"><span class="lineno"> 8517</span>      <span class="keywordflow">if</span> (rv != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a> &amp;&amp; rv != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10">icCmmStatIdentityXform</a>) {</div>
<div class="line"><span class="lineno"> 8518</span>        <span class="keyword">delete</span> pPcs;</div>
<div class="line"><span class="lineno"> 8519</span>        <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 8520</span>      }</div>
<div class="line"><span class="lineno"> 8521</span> </div>
<div class="line"><span class="lineno"> 8522</span>      <span class="keywordflow">if</span> (rv != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10">icCmmStatIdentityXform</a>) {</div>
<div class="line"><span class="lineno"> 8523</span>        ptr.ptr = pPcs;</div>
<div class="line"><span class="lineno"> 8524</span>        xforms.push_back(ptr);</div>
<div class="line"><span class="lineno"> 8525</span> </div>
<div class="line"><span class="lineno"> 8526</span>        bUsesPcsXforms = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 8527</span>      }</div>
<div class="line"><span class="lineno"> 8528</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8529</span>        <span class="keyword">delete</span> pPcs;</div>
<div class="line"><span class="lineno"> 8530</span>      }</div>
<div class="line"><span class="lineno"> 8531</span>    }</div>
<div class="line"><span class="lineno"> 8532</span>  }</div>
<div class="line"><span class="lineno"> 8533</span> </div>
<div class="line"><span class="lineno"> 8534</span> </div>
<div class="line"><span class="lineno"> 8535</span>  <span class="keywordflow">if</span> (bUsesPcsXforms) {</div>
<div class="line"><span class="lineno"> 8536</span>    *m_Xforms = xforms;</div>
<div class="line"><span class="lineno"> 8537</span>  }</div>
<div class="line"><span class="lineno"> 8538</span> </div>
<div class="line"><span class="lineno"> 8539</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 8540</span>}</div>
<div class="line"><span class="lineno"> 8541</span> </div>
<div class="line"><span class="lineno"> 8542</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::CheckPCSRangeConversions()</div>
<div class="line"><span class="lineno"> 8543</span>{</div>
<div class="line"><span class="lineno"> 8544</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 8545</span> </div>
<div class="line"><span class="lineno"> 8546</span>  CIccXformList::iterator last, next;</div>
<div class="line"><span class="lineno"> 8547</span>  CIccXformList xforms;</div>
<div class="line"><span class="lineno"> 8548</span>  CIccXformPtr ptr;</div>
<div class="line"><span class="lineno"> 8549</span>  <span class="keywordtype">bool</span> bUsesRangeConversion = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 8550</span> </div>
<div class="line"><span class="lineno"> 8551</span>  next = m_Xforms-&gt;begin();</div>
<div class="line"><span class="lineno"> 8552</span> </div>
<div class="line"><span class="lineno"> 8553</span>  <span class="keywordflow">if</span> (next != m_Xforms-&gt;end()) {</div>
<div class="line"><span class="lineno"> 8554</span>    last = next;</div>
<div class="line"><span class="lineno"> 8555</span>    next++;</div>
<div class="line"><span class="lineno"> 8556</span> </div>
<div class="line"><span class="lineno"> 8557</span>    xforms.push_back(*last);</div>
<div class="line"><span class="lineno"> 8558</span> </div>
<div class="line"><span class="lineno"> 8559</span>    <span class="keywordflow">for</span> (; next != m_Xforms-&gt;end(); last = next, next++) {</div>
<div class="line"><span class="lineno"> 8560</span>      <span class="comment">//Add extended PCS to standard PCS conversion as needed</span></div>
<div class="line"><span class="lineno"> 8561</span>      <span class="keywordflow">if</span> (last-&gt;ptr-&gt;IsInput() &amp;&amp; last-&gt;ptr-&gt;IsExtendedPCS() &amp;&amp; <a class="code hl_define" href="../../d3/df8/a00155.html#aaacd6d45813e2697ad238b12befa5719">IsSpaceColorimetricPCS</a>(last-&gt;ptr-&gt;GetDstSpace()) &amp;&amp;</div>
<div class="line"><span class="lineno"> 8562</span>        !next-&gt;ptr-&gt;IsExtendedPCS()) {</div>
<div class="line"><span class="lineno"> 8563</span>        <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a>* pProfile = last-&gt;ptr-&gt;GetProfilePtr();</div>
<div class="line"><span class="lineno"> 8564</span>        <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a>* pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a91088345233e12514ec483327a00dbe8">icSigHToS0Tag</a> + last-&gt;ptr-&gt;GetIntent());</div>
<div class="line"><span class="lineno"> 8565</span>        <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 8566</span>          pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a91088345233e12514ec483327a00dbe8">icSigHToS0Tag</a>);</div>
<div class="line"><span class="lineno"> 8567</span>          <span class="keywordflow">if</span> (!pTag) {</div>
<div class="line"><span class="lineno"> 8568</span>            pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a85d24fc4ed8a193b8718b540ecfd003d">icSigHToS1Tag</a>);</div>
<div class="line"><span class="lineno"> 8569</span>          }</div>
<div class="line"><span class="lineno"> 8570</span>        }</div>
<div class="line"><span class="lineno"> 8571</span>        <span class="comment">//If we find the HToSxTag then create a transform for it and inject it into the transform list</span></div>
<div class="line"><span class="lineno"> 8572</span>        <span class="keywordflow">if</span> (pTag) {</div>
<div class="line"><span class="lineno"> 8573</span>          ptr.ptr = CIccXform::Create(pProfile, pTag, <span class="keyword">true</span>, last-&gt;ptr-&gt;GetIntent(), last-&gt;ptr-&gt;GetInterp(),</div>
<div class="line"><span class="lineno"> 8574</span>                                      last-&gt;ptr-&gt;GetConnectionConditions(), <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 8575</span>          <span class="keywordflow">if</span> (ptr.ptr) {</div>
<div class="line"><span class="lineno"> 8576</span>            ptr.ptr-&gt;ShareProfile(); <span class="comment">//Indicate that profile is shared (so it won&#39;t be deleted)</span></div>
<div class="line"><span class="lineno"> 8577</span>            ptr.ptr-&gt;SetPcsAdjustXform(); <span class="comment">// Indicates that transform should be treated as abstract</span></div>
<div class="line"><span class="lineno"> 8578</span>            ptr.ptr-&gt;AttachCmmEnvVarLookup(last-&gt;ptr-&gt;GetCmmEnvVarLookup());</div>
<div class="line"><span class="lineno"> 8579</span>            xforms.push_back(ptr);</div>
<div class="line"><span class="lineno"> 8580</span>            bUsesRangeConversion = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 8581</span>          }</div>
<div class="line"><span class="lineno"> 8582</span>        }</div>
<div class="line"><span class="lineno"> 8583</span>      }</div>
<div class="line"><span class="lineno"> 8584</span> </div>
<div class="line"><span class="lineno"> 8585</span>      xforms.push_back(*next);</div>
<div class="line"><span class="lineno"> 8586</span>    }</div>
<div class="line"><span class="lineno"> 8587</span>  }</div>
<div class="line"><span class="lineno"> 8588</span>  </div>
<div class="line"><span class="lineno"> 8589</span>  <span class="keywordflow">if</span> (bUsesRangeConversion) {</div>
<div class="line"><span class="lineno"> 8590</span>    *m_Xforms = xforms;</div>
<div class="line"><span class="lineno"> 8591</span>  }</div>
<div class="line"><span class="lineno"> 8592</span> </div>
<div class="line"><span class="lineno"> 8593</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 8594</span>}</div>
<div class="line"><span class="lineno"> 8595</span> </div>
<div class="line"><span class="lineno"> 8596</span> </div>
<div class="line"><span class="lineno"> 8607</span><span class="keywordtype">void</span> CIccCmm::SetLateBindingCC()</div>
<div class="line"><span class="lineno"> 8608</span>{</div>
<div class="line"><span class="lineno"> 8609</span>  CIccXformList::iterator i;</div>
<div class="line"><span class="lineno"> 8610</span>  CIccXform *pLastXform = NULL;</div>
<div class="line"><span class="lineno"> 8611</span> </div>
<div class="line"><span class="lineno"> 8612</span>  <span class="keywordflow">for</span> (i=m_Xforms-&gt;begin(); i!=m_Xforms-&gt;end(); i++) {</div>
<div class="line"><span class="lineno"> 8613</span>    <span class="keywordflow">if</span> (i-&gt;ptr-&gt;IsInput()) {</div>
<div class="line"><span class="lineno"> 8614</span>      <span class="keywordflow">if</span> (i-&gt;ptr-&gt;IsLateBinding()) {</div>
<div class="line"><span class="lineno"> 8615</span>        CIccXformList::iterator j=i;</div>
<div class="line"><span class="lineno"> 8616</span>        j++;</div>
<div class="line"><span class="lineno"> 8617</span>        <span class="keywordflow">if</span> (j!=m_Xforms-&gt;end()) {</div>
<div class="line"><span class="lineno"> 8618</span>          <span class="keywordflow">if</span> (j-&gt;ptr-&gt;IsLateBinding()) {</div>
<div class="line"><span class="lineno"> 8619</span>            i-&gt;ptr-&gt;SetAppliedCC(i-&gt;ptr-&gt;GetConnectionConditions());</div>
<div class="line"><span class="lineno"> 8620</span>            j-&gt;ptr-&gt;SetAppliedCC(i-&gt;ptr-&gt;GetConnectionConditions());</div>
<div class="line"><span class="lineno"> 8621</span>            pLastXform = i-&gt;ptr;</div>
<div class="line"><span class="lineno"> 8622</span>          }</div>
<div class="line"><span class="lineno"> 8623</span>          <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8624</span>            i-&gt;ptr-&gt;SetAppliedCC(i-&gt;ptr-&gt;GetConnectionConditions());</div>
<div class="line"><span class="lineno"> 8625</span>            j-&gt;ptr-&gt;SetAppliedCC(j-&gt;ptr-&gt;GetConnectionConditions());</div>
<div class="line"><span class="lineno"> 8626</span>            pLastXform = NULL;</div>
<div class="line"><span class="lineno"> 8627</span>          }</div>
<div class="line"><span class="lineno"> 8628</span>        }</div>
<div class="line"><span class="lineno"> 8629</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8630</span>          i-&gt;ptr-&gt;SetAppliedCC(i-&gt;ptr-&gt;GetConnectionConditions());</div>
<div class="line"><span class="lineno"> 8631</span>          pLastXform = NULL;</div>
<div class="line"><span class="lineno"> 8632</span>        }</div>
<div class="line"><span class="lineno"> 8633</span>      }</div>
<div class="line"><span class="lineno"> 8634</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d3/df8/a00155.html#a05df9b9a2f56c907e676a0efc3e9219d">IsSpaceSpectralPCS</a>(i-&gt;ptr-&gt;GetDstSpace())) {</div>
<div class="line"><span class="lineno"> 8635</span>        CIccXformList::iterator j=i;</div>
<div class="line"><span class="lineno"> 8636</span>        j++;</div>
<div class="line"><span class="lineno"> 8637</span>        <span class="keywordflow">if</span> (j!=m_Xforms-&gt;end()) {</div>
<div class="line"><span class="lineno"> 8638</span>          <span class="keywordflow">if</span> (j-&gt;ptr-&gt;IsLateBinding()) {</div>
<div class="line"><span class="lineno"> 8639</span>            j-&gt;ptr-&gt;SetAppliedCC(i-&gt;ptr-&gt;GetConnectionConditions());</div>
<div class="line"><span class="lineno"> 8640</span>            pLastXform = i-&gt;ptr;</div>
<div class="line"><span class="lineno"> 8641</span>          }</div>
<div class="line"><span class="lineno"> 8642</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!j-&gt;ptr-&gt;IsAbstract()){</div>
<div class="line"><span class="lineno"> 8643</span>            j-&gt;ptr-&gt;SetAppliedCC(j-&gt;ptr-&gt;GetConnectionConditions());</div>
<div class="line"><span class="lineno"> 8644</span>            pLastXform = NULL;</div>
<div class="line"><span class="lineno"> 8645</span>          }</div>
<div class="line"><span class="lineno"> 8646</span>        }</div>
<div class="line"><span class="lineno"> 8647</span>      }</div>
<div class="line"><span class="lineno"> 8648</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8649</span>        pLastXform = NULL;</div>
<div class="line"><span class="lineno"> 8650</span>      }</div>
<div class="line"><span class="lineno"> 8651</span>    }</div>
<div class="line"><span class="lineno"> 8652</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8653</span>      <span class="keywordflow">if</span> (!pLastXform) </div>
<div class="line"><span class="lineno"> 8654</span>        i-&gt;ptr-&gt;SetAppliedCC(i-&gt;ptr-&gt;GetConnectionConditions());</div>
<div class="line"><span class="lineno"> 8655</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8656</span>        pLastXform = NULL;</div>
<div class="line"><span class="lineno"> 8657</span>    }</div>
<div class="line"><span class="lineno"> 8658</span>  }</div>
<div class="line"><span class="lineno"> 8659</span>}</div>
<div class="line"><span class="lineno"> 8660</span> </div>
<div class="line"><span class="lineno"> 8661</span> </div>
<div class="line"><span class="lineno"> 8672</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::Begin(<span class="keywordtype">bool</span> bAllocApplyCmm<span class="comment">/*=true*/</span>, <span class="keywordtype">bool</span> bUsePCSConversions<span class="comment">/*=false*/</span>)</div>
<div class="line"><span class="lineno"> 8673</span>{</div>
<div class="line"><span class="lineno"> 8674</span>  <span class="keywordflow">if</span> (m_pApply)</div>
<div class="line"><span class="lineno"> 8675</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 8676</span> </div>
<div class="line"><span class="lineno"> 8677</span>  <span class="keywordflow">if</span> (m_nDestSpace==<a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a>) {</div>
<div class="line"><span class="lineno"> 8678</span>    m_nDestSpace = m_nLastSpace;</div>
<div class="line"><span class="lineno"> 8679</span>  }</div>
<div class="line"><span class="lineno"> 8680</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d3/df8/a00155.html#a1376d1bc8bb70237fde226cb6f49872c">IsCompatSpace</a>(m_nDestSpace, m_nLastSpace)) {</div>
<div class="line"><span class="lineno"> 8681</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 8682</span>  }</div>
<div class="line"><span class="lineno"> 8683</span> </div>
<div class="line"><span class="lineno"> 8684</span>  <span class="keywordflow">if</span> (m_nSrcSpace==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a> || m_nDestSpace==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>) {</div>
<div class="line"><span class="lineno"> 8685</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno"> 8686</span>  }</div>
<div class="line"><span class="lineno"> 8687</span> </div>
<div class="line"><span class="lineno"> 8688</span>  CheckPCSRangeConversions();</div>
<div class="line"><span class="lineno"> 8689</span>  SetLateBindingCC();</div>
<div class="line"><span class="lineno"> 8690</span> </div>
<div class="line"><span class="lineno"> 8691</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv;</div>
<div class="line"><span class="lineno"> 8692</span>  CIccXformList::iterator i;</div>
<div class="line"><span class="lineno"> 8693</span> </div>
<div class="line"><span class="lineno"> 8694</span>  <span class="keywordflow">for</span> (i=m_Xforms-&gt;begin(); i!=m_Xforms-&gt;end(); i++) {</div>
<div class="line"><span class="lineno"> 8695</span> </div>
<div class="line"><span class="lineno"> 8696</span>    rv = i-&gt;ptr-&gt;Begin();</div>
<div class="line"><span class="lineno"> 8697</span> </div>
<div class="line"><span class="lineno"> 8698</span>    <span class="keywordflow">if</span> (rv!= <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno"> 8699</span>      <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 8700</span>  }</div>
<div class="line"><span class="lineno"> 8701</span> </div>
<div class="line"><span class="lineno"> 8702</span>  rv = CheckPCSConnections(bUsePCSConversions);</div>
<div class="line"><span class="lineno"> 8703</span>  <span class="keywordflow">if</span> (rv != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a> &amp;&amp; rv!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10">icCmmStatIdentityXform</a>)</div>
<div class="line"><span class="lineno"> 8704</span>    <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 8705</span> </div>
<div class="line"><span class="lineno"> 8706</span>  <span class="keywordflow">if</span> (bAllocApplyCmm) {</div>
<div class="line"><span class="lineno"> 8707</span>    m_pApply = GetNewApplyCmm(rv);</div>
<div class="line"><span class="lineno"> 8708</span>  }</div>
<div class="line"><span class="lineno"> 8709</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 8710</span>    rv = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 8711</span> </div>
<div class="line"><span class="lineno"> 8712</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 8713</span>}</div>
<div class="line"><span class="lineno"> 8714</span> </div>
<div class="line"><span class="lineno"> 8715</span> </div>
<div class="line"><span class="lineno"> 8727</span>CIccApplyCmm *CIccCmm::GetNewApplyCmm(<a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> &amp;status)</div>
<div class="line"><span class="lineno"> 8728</span>{</div>
<div class="line"><span class="lineno"> 8729</span>  CIccApplyCmm *pApply = <span class="keyword">new</span> CIccApplyCmm(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno"> 8730</span> </div>
<div class="line"><span class="lineno"> 8731</span>  <span class="keywordflow">if</span> (!pApply) {</div>
<div class="line"><span class="lineno"> 8732</span>    status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 8733</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 8734</span>  }</div>
<div class="line"><span class="lineno"> 8735</span> </div>
<div class="line"><span class="lineno"> 8736</span>  CIccXformList::iterator i;</div>
<div class="line"><span class="lineno"> 8737</span>  CIccApplyXform *pXform;</div>
<div class="line"><span class="lineno"> 8738</span> </div>
<div class="line"><span class="lineno"> 8739</span>  <span class="keywordflow">for</span> (i=m_Xforms-&gt;begin(); i!=m_Xforms-&gt;end(); i++) {</div>
<div class="line"><span class="lineno"> 8740</span>    pXform = i-&gt;ptr-&gt;GetNewApply(status);</div>
<div class="line"><span class="lineno"> 8741</span>    <span class="keywordflow">if</span> (!pXform || status != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno"> 8742</span>      <span class="keyword">delete</span> pApply;</div>
<div class="line"><span class="lineno"> 8743</span>      <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno"> 8744</span>    }</div>
<div class="line"><span class="lineno"> 8745</span>    pApply-&gt;AppendApplyXform(pXform);</div>
<div class="line"><span class="lineno"> 8746</span>  }</div>
<div class="line"><span class="lineno"> 8747</span> </div>
<div class="line"><span class="lineno"> 8748</span>  m_bValid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 8749</span> </div>
<div class="line"><span class="lineno"> 8750</span>  status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 8751</span> </div>
<div class="line"><span class="lineno"> 8752</span>  <span class="keywordflow">return</span> pApply;</div>
<div class="line"><span class="lineno"> 8753</span>}</div>
<div class="line"><span class="lineno"> 8754</span> </div>
<div class="line"><span class="lineno"> 8755</span> </div>
<div class="line"><span class="lineno"> 8766</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::Apply(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)</div>
<div class="line"><span class="lineno"> 8767</span>{</div>
<div class="line"><span class="lineno"> 8768</span>  <span class="keywordflow">return</span> m_pApply-&gt;Apply(DstPixel, SrcPixel);</div>
<div class="line"><span class="lineno"> 8769</span>}</div>
<div class="line"><span class="lineno"> 8770</span> </div>
<div class="line"><span class="lineno"> 8771</span> </div>
<div class="line"><span class="lineno"> 8782</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::Apply(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> nPixels)</div>
<div class="line"><span class="lineno"> 8783</span>{</div>
<div class="line"><span class="lineno"> 8784</span>  <span class="keywordflow">return</span> m_pApply-&gt;Apply(DstPixel, SrcPixel, nPixels);</div>
<div class="line"><span class="lineno"> 8785</span>}</div>
<div class="line"><span class="lineno"> 8786</span> </div>
<div class="line"><span class="lineno"> 8787</span> </div>
<div class="line"><span class="lineno"> 8802</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::RemoveAllIO()</div>
<div class="line"><span class="lineno"> 8803</span>{</div>
<div class="line"><span class="lineno"> 8804</span>  <span class="keywordflow">if</span> (!Valid())</div>
<div class="line"><span class="lineno"> 8805</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno"> 8806</span> </div>
<div class="line"><span class="lineno"> 8807</span>  CIccXformList::iterator i;</div>
<div class="line"><span class="lineno"> 8808</span> </div>
<div class="line"><span class="lineno"> 8809</span>  <span class="keywordflow">for</span> (i=m_Xforms-&gt;begin(); i!=m_Xforms-&gt;end(); i++) {</div>
<div class="line"><span class="lineno"> 8810</span>    i-&gt;ptr-&gt;RemoveIO();</div>
<div class="line"><span class="lineno"> 8811</span>  }</div>
<div class="line"><span class="lineno"> 8812</span> </div>
<div class="line"><span class="lineno"> 8813</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 8814</span>}</div>
<div class="line"><span class="lineno"> 8815</span> </div>
<div class="line"><span class="lineno"> 8832</span><span class="keywordtype">bool</span> CIccCmm::IsInGamut(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pInternal)</div>
<div class="line"><span class="lineno"> 8833</span>{</div>
<div class="line"><span class="lineno"> 8834</span>  <span class="keywordflow">if</span> (!((<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)((*pInternal)*255.0)))</div>
<div class="line"><span class="lineno"> 8835</span>    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 8836</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 8837</span>}</div>
<div class="line"><span class="lineno"> 8838</span> </div>
<div class="line"><span class="lineno"> 8839</span> </div>
<div class="line"><span class="lineno"> 8855</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::ToInternalEncoding(<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nSpace, icFloatColorEncoding nEncode,</div>
<div class="line"><span class="lineno"> 8856</span>                                        <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pInternal, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pData,</div>
<div class="line"><span class="lineno"> 8857</span>                                        <span class="keywordtype">bool</span> bClip)</div>
<div class="line"><span class="lineno"> 8858</span>{</div>
<div class="line"><span class="lineno"> 8859</span>  <span class="keywordtype">int</span> nSamples = <a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(nSpace);</div>
<div class="line"><span class="lineno"> 8860</span>  <span class="keywordflow">if</span> (!nSamples)</div>
<div class="line"><span class="lineno"> 8861</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26">icCmmStatBadColorEncoding</a>;</div>
<div class="line"><span class="lineno"> 8862</span> </div>
<div class="line"><span class="lineno"> 8863</span> </div>
<div class="line"><span class="lineno"> 8864</span>  <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> i;</div>
<div class="line"><span class="lineno"> 8865</span>  <a class="code hl_class" href="../../d4/d53/a00429.html">CIccPixelBuf</a> pInput(nSamples);</div>
<div class="line"><span class="lineno"> 8866</span> </div>
<div class="line"><span class="lineno"> 8867</span>  <span class="keywordflow">if</span> (!pInput.get())</div>
<div class="line"><span class="lineno"> 8868</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 8869</span> </div>
<div class="line"><span class="lineno"> 8870</span>  memcpy(pInput, pData, nSamples*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 8871</span>  <span class="keywordtype">bool</span> bCLRspace = <a class="code hl_function" href="../../d7/dce/a00143.html#a2685f9528dab905cc6b2b071625709e1">icIsSpaceCLR</a>(nSpace);</div>
<div class="line"><span class="lineno"> 8872</span> </div>
<div class="line"><span class="lineno"> 8873</span>  <span class="keywordflow">switch</span>(<a class="code hl_define" href="../../d7/d46/a00002.html#a47e4f847bd0bc609907b5fea4daf3e75">icGetColorSpaceType</a>(nSpace))</div>
<div class="line"><span class="lineno"> 8874</span>  {</div>
<div class="line"><span class="lineno"> 8875</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#aa9cd4477816537fbf648a155f6b78eda">icSigReflectanceSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 8876</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#af5df74ebff3f8247e1c7c88844c1f140">icSigTransmissionSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 8877</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#ae84d222edd132ad7741c628c1d4729d9">icSigBiDirReflectanceSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 8878</span>    <span class="keywordflow">case</span> <a class="code hl_define" href="../../d7/d46/a00002.html#a1b59192d9fcc1aee71b8cc523b4978ca">icSigSparseMatrixSpectralPcsData</a>:</div>
<div class="line"><span class="lineno"> 8879</span>      bCLRspace = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 8880</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8881</span>  }</div>
<div class="line"><span class="lineno"> 8882</span> </div>
<div class="line"><span class="lineno"> 8883</span>  <span class="keywordflow">switch</span>(nSpace) {</div>
<div class="line"><span class="lineno"> 8884</span> </div>
<div class="line"><span class="lineno"> 8885</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>:</div>
<div class="line"><span class="lineno"> 8886</span>      {</div>
<div class="line"><span class="lineno"> 8887</span>        <span class="keywordflow">switch</span>(nEncode) {</div>
<div class="line"><span class="lineno"> 8888</span>        <span class="keywordflow">case</span> icEncodeValue:</div>
<div class="line"><span class="lineno"> 8889</span>          {</div>
<div class="line"><span class="lineno"> 8890</span>            <a class="code hl_function" href="../../d7/dce/a00143.html#a5768271d491af79a433e52722ed0a189">icLabToPcs</a>(pInput);</div>
<div class="line"><span class="lineno"> 8891</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8892</span>          }</div>
<div class="line"><span class="lineno"> 8893</span>        <span class="keywordflow">case</span> icEncodeFloat:</div>
<div class="line"><span class="lineno"> 8894</span>          {</div>
<div class="line"><span class="lineno"> 8895</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8896</span>          }</div>
<div class="line"><span class="lineno"> 8897</span>        <span class="keywordflow">case</span> icEncode8Bit:</div>
<div class="line"><span class="lineno"> 8898</span>          {</div>
<div class="line"><span class="lineno"> 8899</span>            pInput[0] = <a class="code hl_function" href="../../d7/dce/a00143.html#a0bb667680a93b0dec39e21647ffda760">icU8toF</a>((<a class="code hl_typedef" href="../../d7/d46/a00002.html#a0462ca2992be7c80b056e640a192b325">icUInt8Number</a>)pInput[0])*100.0f;</div>
<div class="line"><span class="lineno"> 8900</span>            pInput[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#abf5738013ad9c2bafb3a0c7a810ecf19">icU8toAB</a>((<a class="code hl_typedef" href="../../d7/d46/a00002.html#a0462ca2992be7c80b056e640a192b325">icUInt8Number</a>)pInput[1]);</div>
<div class="line"><span class="lineno"> 8901</span>            pInput[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#abf5738013ad9c2bafb3a0c7a810ecf19">icU8toAB</a>((<a class="code hl_typedef" href="../../d7/d46/a00002.html#a0462ca2992be7c80b056e640a192b325">icUInt8Number</a>)pInput[2]);</div>
<div class="line"><span class="lineno"> 8902</span> </div>
<div class="line"><span class="lineno"> 8903</span>            <a class="code hl_function" href="../../d7/dce/a00143.html#a5768271d491af79a433e52722ed0a189">icLabToPcs</a>(pInput);</div>
<div class="line"><span class="lineno"> 8904</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8905</span>          }</div>
<div class="line"><span class="lineno"> 8906</span>        <span class="keywordflow">case</span> icEncode16Bit:</div>
<div class="line"><span class="lineno"> 8907</span>          {</div>
<div class="line"><span class="lineno"> 8908</span>            pInput[0] = <a class="code hl_function" href="../../d7/dce/a00143.html#aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78">icU16toF</a>((<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)pInput[0]);</div>
<div class="line"><span class="lineno"> 8909</span>            pInput[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78">icU16toF</a>((<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)pInput[1]);</div>
<div class="line"><span class="lineno"> 8910</span>            pInput[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78">icU16toF</a>((<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)pInput[2]);</div>
<div class="line"><span class="lineno"> 8911</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8912</span>          }</div>
<div class="line"><span class="lineno"> 8913</span>        <span class="keywordflow">case</span> icEncode16BitV2:</div>
<div class="line"><span class="lineno"> 8914</span>          {</div>
<div class="line"><span class="lineno"> 8915</span>            pInput[0] = <a class="code hl_function" href="../../d7/dce/a00143.html#aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78">icU16toF</a>((<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)pInput[0]);</div>
<div class="line"><span class="lineno"> 8916</span>            pInput[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78">icU16toF</a>((<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)pInput[1]);</div>
<div class="line"><span class="lineno"> 8917</span>            pInput[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78">icU16toF</a>((<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)pInput[2]);</div>
<div class="line"><span class="lineno"> 8918</span> </div>
<div class="line"><span class="lineno"> 8919</span>            CIccPCSUtil::Lab2ToLab4(pInput, pInput);</div>
<div class="line"><span class="lineno"> 8920</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8921</span>          }</div>
<div class="line"><span class="lineno"> 8922</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 8923</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26">icCmmStatBadColorEncoding</a>;</div>
<div class="line"><span class="lineno"> 8924</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8925</span>        }</div>
<div class="line"><span class="lineno"> 8926</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8927</span>      }</div>
<div class="line"><span class="lineno"> 8928</span> </div>
<div class="line"><span class="lineno"> 8929</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>:</div>
<div class="line"><span class="lineno"> 8930</span>      {</div>
<div class="line"><span class="lineno"> 8931</span>        <span class="keywordflow">switch</span>(nEncode) {</div>
<div class="line"><span class="lineno"> 8932</span>        <span class="keywordflow">case</span> icEncodeValue:</div>
<div class="line"><span class="lineno"> 8933</span>          {</div>
<div class="line"><span class="lineno"> 8934</span>            pInput[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pInput[0];</div>
<div class="line"><span class="lineno"> 8935</span>            pInput[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pInput[1];</div>
<div class="line"><span class="lineno"> 8936</span>            pInput[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pInput[2];</div>
<div class="line"><span class="lineno"> 8937</span>            <a class="code hl_function" href="../../d7/dce/a00143.html#a4b4cfb7788c3a780f19f2f104677a5b8">icXyzToPcs</a>(pInput);</div>
<div class="line"><span class="lineno"> 8938</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8939</span>          }</div>
<div class="line"><span class="lineno"> 8940</span>        <span class="keywordflow">case</span> icEncodePercent:</div>
<div class="line"><span class="lineno"> 8941</span>          {</div>
<div class="line"><span class="lineno"> 8942</span>            pInput[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pInput[0] / 100.0);</div>
<div class="line"><span class="lineno"> 8943</span>            pInput[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pInput[1] / 100.0);</div>
<div class="line"><span class="lineno"> 8944</span>            pInput[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pInput[2] / 100.0);</div>
<div class="line"><span class="lineno"> 8945</span>            <a class="code hl_function" href="../../d7/dce/a00143.html#a4b4cfb7788c3a780f19f2f104677a5b8">icXyzToPcs</a>(pInput);</div>
<div class="line"><span class="lineno"> 8946</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8947</span>          }</div>
<div class="line"><span class="lineno"> 8948</span>        <span class="keywordflow">case</span> icEncodeFloat:</div>
<div class="line"><span class="lineno"> 8949</span>          {</div>
<div class="line"><span class="lineno"> 8950</span>            <a class="code hl_function" href="../../d7/dce/a00143.html#a4b4cfb7788c3a780f19f2f104677a5b8">icXyzToPcs</a>(pInput);</div>
<div class="line"><span class="lineno"> 8951</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8952</span>          }</div>
<div class="line"><span class="lineno"> 8953</span>          </div>
<div class="line"><span class="lineno"> 8954</span>        <span class="keywordflow">case</span> icEncode16Bit:</div>
<div class="line"><span class="lineno"> 8955</span>        <span class="keywordflow">case</span> icEncode16BitV2:</div>
<div class="line"><span class="lineno"> 8956</span>          {</div>
<div class="line"><span class="lineno"> 8957</span>            pInput[0] = <a class="code hl_function" href="../../d7/dce/a00143.html#aca284d408f443ba0b4161698077f88b1">icUSFtoD</a>((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a37f1be5fcf46e05e4078a7f9e6b8b3a5">icU1Fixed15Number</a>)pInput[0]);</div>
<div class="line"><span class="lineno"> 8958</span>            pInput[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#aca284d408f443ba0b4161698077f88b1">icUSFtoD</a>((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a37f1be5fcf46e05e4078a7f9e6b8b3a5">icU1Fixed15Number</a>)pInput[1]);</div>
<div class="line"><span class="lineno"> 8959</span>            pInput[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#aca284d408f443ba0b4161698077f88b1">icUSFtoD</a>((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a37f1be5fcf46e05e4078a7f9e6b8b3a5">icU1Fixed15Number</a>)pInput[2]);</div>
<div class="line"><span class="lineno"> 8960</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8961</span>          }</div>
<div class="line"><span class="lineno"> 8962</span>          </div>
<div class="line"><span class="lineno"> 8963</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 8964</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26">icCmmStatBadColorEncoding</a>;</div>
<div class="line"><span class="lineno"> 8965</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8966</span>        }</div>
<div class="line"><span class="lineno"> 8967</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8968</span>      }</div>
<div class="line"><span class="lineno"> 8969</span> </div>
<div class="line"><span class="lineno"> 8970</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>:</div>
<div class="line"><span class="lineno"> 8971</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26">icCmmStatBadColorEncoding</a>;</div>
<div class="line"><span class="lineno"> 8972</span> </div>
<div class="line"><span class="lineno"> 8973</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 8974</span>      {</div>
<div class="line"><span class="lineno"> 8975</span>        <span class="keywordflow">switch</span>(nEncode) {</div>
<div class="line"><span class="lineno"> 8976</span>        <span class="keywordflow">case</span> icEncodeValue:</div>
<div class="line"><span class="lineno"> 8977</span>          {</div>
<div class="line"><span class="lineno"> 8978</span>            <span class="keywordflow">if</span> (!bCLRspace || nSamples&lt;3) {</div>
<div class="line"><span class="lineno"> 8979</span>              <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26">icCmmStatBadColorEncoding</a>;</div>
<div class="line"><span class="lineno"> 8980</span>            }</div>
<div class="line"><span class="lineno"> 8981</span>            <span class="keywordflow">if</span> (nSamples==3)</div>
<div class="line"><span class="lineno"> 8982</span>              <a class="code hl_function" href="../../d7/dce/a00143.html#a5768271d491af79a433e52722ed0a189">icLabToPcs</a>(pInput);</div>
<div class="line"><span class="lineno"> 8983</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 8984</span>          }</div>
<div class="line"><span class="lineno"> 8985</span> </div>
<div class="line"><span class="lineno"> 8986</span>        <span class="keywordflow">case</span> icEncodePercent:</div>
<div class="line"><span class="lineno"> 8987</span>          {</div>
<div class="line"><span class="lineno"> 8988</span>            <span class="keywordflow">if</span> (bClip) {</div>
<div class="line"><span class="lineno"> 8989</span>              <span class="keywordflow">for</span>(i=0; i&lt;nSamples; i++) {</div>
<div class="line"><span class="lineno"> 8990</span>                pInput[i] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pInput[i]/100.0);</div>
<div class="line"><span class="lineno"> 8991</span>                <span class="keywordflow">if</span> (pInput[i] &lt; 0.0) pInput[i] = 0.0;</div>
<div class="line"><span class="lineno"> 8992</span>                <span class="keywordflow">if</span> (pInput[i] &gt; 1.0) pInput[i] = 1.0;</div>
<div class="line"><span class="lineno"> 8993</span>              }</div>
<div class="line"><span class="lineno"> 8994</span>            }</div>
<div class="line"><span class="lineno"> 8995</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 8996</span>              <span class="keywordflow">for</span>(i=0; i&lt;nSamples; i++) {</div>
<div class="line"><span class="lineno"> 8997</span>                pInput[i] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pInput[i]/100.0);</div>
<div class="line"><span class="lineno"> 8998</span>              }</div>
<div class="line"><span class="lineno"> 8999</span>            }</div>
<div class="line"><span class="lineno"> 9000</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9001</span>          }</div>
<div class="line"><span class="lineno"> 9002</span>        </div>
<div class="line"><span class="lineno"> 9003</span>        <span class="keywordflow">case</span> icEncodeFloat:</div>
<div class="line"><span class="lineno"> 9004</span>          {</div>
<div class="line"><span class="lineno"> 9005</span>            <span class="keywordflow">if</span> (bClip) {</div>
<div class="line"><span class="lineno"> 9006</span>              <span class="keywordflow">for</span>(i=0; i&lt;nSamples; i++) {</div>
<div class="line"><span class="lineno"> 9007</span>                <span class="keywordflow">if</span> (pInput[i] &lt; 0.0) pInput[i] = 0.0;</div>
<div class="line"><span class="lineno"> 9008</span>                <span class="keywordflow">if</span> (pInput[i] &gt; 1.0) pInput[i] = 1.0;</div>
<div class="line"><span class="lineno"> 9009</span>              }</div>
<div class="line"><span class="lineno"> 9010</span>            }</div>
<div class="line"><span class="lineno"> 9011</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9012</span>          }</div>
<div class="line"><span class="lineno"> 9013</span>          </div>
<div class="line"><span class="lineno"> 9014</span>        <span class="keywordflow">case</span> icEncode8Bit:</div>
<div class="line"><span class="lineno"> 9015</span>          {</div>
<div class="line"><span class="lineno"> 9016</span>            <span class="keywordflow">for</span>(i=0; i&lt;nSamples; i++) {</div>
<div class="line"><span class="lineno"> 9017</span>              pInput[i] = <a class="code hl_function" href="../../d7/dce/a00143.html#a0bb667680a93b0dec39e21647ffda760">icU8toF</a>((<a class="code hl_typedef" href="../../d7/d46/a00002.html#a0462ca2992be7c80b056e640a192b325">icUInt8Number</a>)pInput[i]);</div>
<div class="line"><span class="lineno"> 9018</span>            }</div>
<div class="line"><span class="lineno"> 9019</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9020</span>          }</div>
<div class="line"><span class="lineno"> 9021</span>          </div>
<div class="line"><span class="lineno"> 9022</span>        <span class="keywordflow">case</span> icEncode16Bit:</div>
<div class="line"><span class="lineno"> 9023</span>        <span class="keywordflow">case</span> icEncode16BitV2:</div>
<div class="line"><span class="lineno"> 9024</span>          {</div>
<div class="line"><span class="lineno"> 9025</span>            <span class="keywordflow">for</span>(i=0; i&lt;nSamples; i++) {</div>
<div class="line"><span class="lineno"> 9026</span>              pInput[i] = <a class="code hl_function" href="../../d7/dce/a00143.html#aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78">icU16toF</a>((<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)pInput[i]);</div>
<div class="line"><span class="lineno"> 9027</span>            }</div>
<div class="line"><span class="lineno"> 9028</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9029</span>          }</div>
<div class="line"><span class="lineno"> 9030</span>        </div>
<div class="line"><span class="lineno"> 9031</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9032</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26">icCmmStatBadColorEncoding</a>;</div>
<div class="line"><span class="lineno"> 9033</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9034</span>        }</div>
<div class="line"><span class="lineno"> 9035</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9036</span>      }</div>
<div class="line"><span class="lineno"> 9037</span>  }</div>
<div class="line"><span class="lineno"> 9038</span> </div>
<div class="line"><span class="lineno"> 9039</span>  memcpy(pInternal, pInput, nSamples*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 9040</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 9041</span>}</div>
<div class="line"><span class="lineno"> 9042</span> </div>
<div class="line"><span class="lineno"> 9043</span> </div>
<div class="line"><span class="lineno"> 9059</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::ToInternalEncoding(<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nSpace, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pInternal,</div>
<div class="line"><span class="lineno"> 9060</span>                                        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d7/d46/a00002.html#a0462ca2992be7c80b056e640a192b325">icUInt8Number</a> *pData)</div>
<div class="line"><span class="lineno"> 9061</span>{</div>
<div class="line"><span class="lineno"> 9062</span>  <span class="keywordflow">switch</span>(nSpace) {</div>
<div class="line"><span class="lineno"> 9063</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30">icSigRgbData</a>:</div>
<div class="line"><span class="lineno"> 9064</span>    {</div>
<div class="line"><span class="lineno"> 9065</span>      pInternal[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[0] / 255.0);</div>
<div class="line"><span class="lineno"> 9066</span>      pInternal[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[1] / 255.0);</div>
<div class="line"><span class="lineno"> 9067</span>      pInternal[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[2] / 255.0);</div>
<div class="line"><span class="lineno"> 9068</span> </div>
<div class="line"><span class="lineno"> 9069</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 9070</span>    }</div>
<div class="line"><span class="lineno"> 9071</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661">icSigCmykData</a>:</div>
<div class="line"><span class="lineno"> 9072</span>    {</div>
<div class="line"><span class="lineno"> 9073</span>      pInternal[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[0] / 255.0);</div>
<div class="line"><span class="lineno"> 9074</span>      pInternal[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[1] / 255.0);</div>
<div class="line"><span class="lineno"> 9075</span>      pInternal[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[2] / 255.0);</div>
<div class="line"><span class="lineno"> 9076</span>      pInternal[3] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[3] / 255.0);</div>
<div class="line"><span class="lineno"> 9077</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 9078</span>    }</div>
<div class="line"><span class="lineno"> 9079</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9080</span>    {</div>
<div class="line"><span class="lineno"> 9081</span>      <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> i;</div>
<div class="line"><span class="lineno"> 9082</span>      <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> nSamples = <a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(nSpace);</div>
<div class="line"><span class="lineno"> 9083</span>      <a class="code hl_class" href="../../d4/d53/a00429.html">CIccPixelBuf</a> FloatPixel(nSamples);</div>
<div class="line"><span class="lineno"> 9084</span>      <span class="keywordflow">if</span> (!FloatPixel.get())</div>
<div class="line"><span class="lineno"> 9085</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 9086</span> </div>
<div class="line"><span class="lineno"> 9087</span>      <span class="keywordflow">for</span>(i=0; i&lt;nSamples; i++) {</div>
<div class="line"><span class="lineno"> 9088</span>        FloatPixel[i] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[i];    </div>
<div class="line"><span class="lineno"> 9089</span>      }</div>
<div class="line"><span class="lineno"> 9090</span>      <span class="keywordflow">return</span> ToInternalEncoding(nSpace, icEncode8Bit, pInternal, FloatPixel);</div>
<div class="line"><span class="lineno"> 9091</span>    }</div>
<div class="line"><span class="lineno"> 9092</span>  }</div>
<div class="line"><span class="lineno"> 9093</span> </div>
<div class="line"><span class="lineno"> 9094</span>}</div>
<div class="line"><span class="lineno"> 9095</span> </div>
<div class="line"><span class="lineno"> 9096</span> </div>
<div class="line"><span class="lineno"> 9112</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::ToInternalEncoding(<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nSpace, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pInternal,</div>
<div class="line"><span class="lineno"> 9113</span>                                        <span class="keyword">const</span> <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> *pData)</div>
<div class="line"><span class="lineno"> 9114</span>{</div>
<div class="line"><span class="lineno"> 9115</span>  <span class="keywordflow">switch</span>(nSpace) {</div>
<div class="line"><span class="lineno"> 9116</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30">icSigRgbData</a>:</div>
<div class="line"><span class="lineno"> 9117</span>    {</div>
<div class="line"><span class="lineno"> 9118</span>      pInternal[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[0] / 65535.0);</div>
<div class="line"><span class="lineno"> 9119</span>      pInternal[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[1] / 65535.0);</div>
<div class="line"><span class="lineno"> 9120</span>      pInternal[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[2] / 65535.0);</div>
<div class="line"><span class="lineno"> 9121</span> </div>
<div class="line"><span class="lineno"> 9122</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 9123</span>    }</div>
<div class="line"><span class="lineno"> 9124</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661">icSigCmykData</a>:</div>
<div class="line"><span class="lineno"> 9125</span>    {</div>
<div class="line"><span class="lineno"> 9126</span>      pInternal[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[0] / 65535.0);</div>
<div class="line"><span class="lineno"> 9127</span>      pInternal[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[1] / 65535.0);</div>
<div class="line"><span class="lineno"> 9128</span>      pInternal[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[2] / 65535.0);</div>
<div class="line"><span class="lineno"> 9129</span>      pInternal[3] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)((<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[3] / 65535.0);</div>
<div class="line"><span class="lineno"> 9130</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 9131</span>    }</div>
<div class="line"><span class="lineno"> 9132</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9133</span>    {</div>
<div class="line"><span class="lineno"> 9134</span>      <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> i;</div>
<div class="line"><span class="lineno"> 9135</span>      <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> nSamples = <a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(nSpace);</div>
<div class="line"><span class="lineno"> 9136</span>      <a class="code hl_class" href="../../d4/d53/a00429.html">CIccPixelBuf</a> pFloatPixel(nSamples);</div>
<div class="line"><span class="lineno"> 9137</span>      <span class="keywordflow">if</span> (!pFloatPixel.get())</div>
<div class="line"><span class="lineno"> 9138</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 9139</span> </div>
<div class="line"><span class="lineno"> 9140</span>      <span class="keywordflow">for</span>(i=0; i&lt;nSamples; i++) {</div>
<div class="line"><span class="lineno"> 9141</span>        pFloatPixel[i] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)pData[i];    </div>
<div class="line"><span class="lineno"> 9142</span>      }</div>
<div class="line"><span class="lineno"> 9143</span>      <span class="keywordflow">return</span> ToInternalEncoding(nSpace, icEncode16Bit, pInternal, pFloatPixel);</div>
<div class="line"><span class="lineno"> 9144</span>    }</div>
<div class="line"><span class="lineno"> 9145</span>  }</div>
<div class="line"><span class="lineno"> 9146</span>}</div>
<div class="line"><span class="lineno"> 9147</span> </div>
<div class="line"><span class="lineno"> 9148</span> </div>
<div class="line"><span class="lineno"> 9164</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::FromInternalEncoding(<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nSpace, icFloatColorEncoding nEncode,</div>
<div class="line"><span class="lineno"> 9165</span>                                          <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pData, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pInternal, <span class="keywordtype">bool</span> bClip)</div>
<div class="line"><span class="lineno"> 9166</span>{</div>
<div class="line"><span class="lineno"> 9167</span>  <span class="keywordtype">int</span> nSamples = <a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(nSpace);</div>
<div class="line"><span class="lineno"> 9168</span>  <span class="keywordflow">if</span> (!nSamples)</div>
<div class="line"><span class="lineno"> 9169</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26">icCmmStatBadColorEncoding</a>;</div>
<div class="line"><span class="lineno"> 9170</span> </div>
<div class="line"><span class="lineno"> 9171</span>  <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> i;</div>
<div class="line"><span class="lineno"> 9172</span>  <a class="code hl_class" href="../../d4/d53/a00429.html">CIccPixelBuf</a> pInput(nSamples);</div>
<div class="line"><span class="lineno"> 9173</span> </div>
<div class="line"><span class="lineno"> 9174</span>  <span class="keywordflow">if</span> (!pInput.get())</div>
<div class="line"><span class="lineno"> 9175</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 9176</span> </div>
<div class="line"><span class="lineno"> 9177</span>  memcpy(pInput, pInternal, nSamples*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 9178</span>  <span class="keywordtype">bool</span> bCLRspace = (<a class="code hl_function" href="../../d7/dce/a00143.html#a2685f9528dab905cc6b2b071625709e1">icIsSpaceCLR</a>(nSpace) || (nSpace == <a class="code hl_define" href="../../d4/d81/a00110.html#a92d563abc2c24efa8ccad672a9dfd14f">icSigDevLabData</a>) || (nSpace==<a class="code hl_define" href="../../d4/d81/a00110.html#a550e980dd884839e33548afbd55b4277">icSigDevXYZData</a>));</div>
<div class="line"><span class="lineno"> 9179</span> </div>
<div class="line"><span class="lineno"> 9180</span>  <span class="keywordflow">switch</span>(nSpace) {</div>
<div class="line"><span class="lineno"> 9181</span> </div>
<div class="line"><span class="lineno"> 9182</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f">icSigLabData</a>:</div>
<div class="line"><span class="lineno"> 9183</span>      {</div>
<div class="line"><span class="lineno"> 9184</span>        <span class="keywordflow">switch</span>(nEncode) {</div>
<div class="line"><span class="lineno"> 9185</span>        <span class="keywordflow">case</span> icEncodeValue:</div>
<div class="line"><span class="lineno"> 9186</span>          {</div>
<div class="line"><span class="lineno"> 9187</span>            <a class="code hl_function" href="../../d7/dce/a00143.html#ac5de02865f572ea243f6da8c144c02fa">icLabFromPcs</a>(pInput);</div>
<div class="line"><span class="lineno"> 9188</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9189</span>          }</div>
<div class="line"><span class="lineno"> 9190</span>        <span class="keywordflow">case</span> icEncodeUnitFloat:</div>
<div class="line"><span class="lineno"> 9191</span>        <span class="keywordflow">case</span> icEncodeFloat:</div>
<div class="line"><span class="lineno"> 9192</span>          {</div>
<div class="line"><span class="lineno"> 9193</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9194</span>          }</div>
<div class="line"><span class="lineno"> 9195</span>        <span class="keywordflow">case</span> icEncode8Bit:</div>
<div class="line"><span class="lineno"> 9196</span>          {</div>
<div class="line"><span class="lineno"> 9197</span>            <a class="code hl_function" href="../../d7/dce/a00143.html#ac5de02865f572ea243f6da8c144c02fa">icLabFromPcs</a>(pInput);</div>
<div class="line"><span class="lineno"> 9198</span> </div>
<div class="line"><span class="lineno"> 9199</span>            pInput[0] = (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a0462ca2992be7c80b056e640a192b325">icUInt8Number</a>)(pInput[0]/100.0 * 255.0 + 0.5);</div>
<div class="line"><span class="lineno"> 9200</span>            pInput[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#a9851a529e0246e58ba462a4c3074388d">icABtoU8</a>(pInput[1]);</div>
<div class="line"><span class="lineno"> 9201</span>            pInput[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#a9851a529e0246e58ba462a4c3074388d">icABtoU8</a>(pInput[2]);</div>
<div class="line"><span class="lineno"> 9202</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9203</span>          }</div>
<div class="line"><span class="lineno"> 9204</span>        <span class="keywordflow">case</span> icEncode16Bit:</div>
<div class="line"><span class="lineno"> 9205</span>          {</div>
<div class="line"><span class="lineno"> 9206</span>            pInput[0] = <a class="code hl_function" href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a>(pInput[0]);</div>
<div class="line"><span class="lineno"> 9207</span>            pInput[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a>(pInput[1]);</div>
<div class="line"><span class="lineno"> 9208</span>            pInput[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a>(pInput[2]);</div>
<div class="line"><span class="lineno"> 9209</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9210</span>          }</div>
<div class="line"><span class="lineno"> 9211</span>        <span class="keywordflow">case</span> icEncode16BitV2:</div>
<div class="line"><span class="lineno"> 9212</span>          {</div>
<div class="line"><span class="lineno"> 9213</span>            CIccPCSUtil::Lab4ToLab2(pInput, pInput);</div>
<div class="line"><span class="lineno"> 9214</span> </div>
<div class="line"><span class="lineno"> 9215</span>            pInput[0] = <a class="code hl_function" href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a>(pInput[0]);</div>
<div class="line"><span class="lineno"> 9216</span>            pInput[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a>(pInput[1]);</div>
<div class="line"><span class="lineno"> 9217</span>            pInput[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a>(pInput[2]);</div>
<div class="line"><span class="lineno"> 9218</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9219</span>          }</div>
<div class="line"><span class="lineno"> 9220</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9221</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26">icCmmStatBadColorEncoding</a>;</div>
<div class="line"><span class="lineno"> 9222</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9223</span>        }</div>
<div class="line"><span class="lineno"> 9224</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9225</span>      }</div>
<div class="line"><span class="lineno"> 9226</span> </div>
<div class="line"><span class="lineno"> 9227</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8">icSigXYZData</a>:</div>
<div class="line"><span class="lineno"> 9228</span>    {</div>
<div class="line"><span class="lineno"> 9229</span>        <span class="keywordflow">switch</span>(nEncode) {</div>
<div class="line"><span class="lineno"> 9230</span>        <span class="keywordflow">case</span> icEncodeValue:</div>
<div class="line"><span class="lineno"> 9231</span>          {</div>
<div class="line"><span class="lineno"> 9232</span>            <a class="code hl_function" href="../../d7/dce/a00143.html#a78841df2e0aea059520ce71944c4c3bb">icXyzFromPcs</a>(pInput);</div>
<div class="line"><span class="lineno"> 9233</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9234</span>          }</div>
<div class="line"><span class="lineno"> 9235</span>        <span class="keywordflow">case</span> icEncodePercent:</div>
<div class="line"><span class="lineno"> 9236</span>          {</div>
<div class="line"><span class="lineno"> 9237</span>            <a class="code hl_function" href="../../d7/dce/a00143.html#a78841df2e0aea059520ce71944c4c3bb">icXyzFromPcs</a>(pInput);</div>
<div class="line"><span class="lineno"> 9238</span>            pInput[0] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pInput[0] * 100.0);</div>
<div class="line"><span class="lineno"> 9239</span>            pInput[1] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pInput[1] * 100.0);</div>
<div class="line"><span class="lineno"> 9240</span>            pInput[2] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pInput[2] * 100.0);            </div>
<div class="line"><span class="lineno"> 9241</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9242</span>          }</div>
<div class="line"><span class="lineno"> 9243</span>        <span class="keywordflow">case</span> icEncodeFloat:</div>
<div class="line"><span class="lineno"> 9244</span>        <span class="keywordflow">case</span> icEncodeUnitFloat:</div>
<div class="line"><span class="lineno"> 9245</span>          {</div>
<div class="line"><span class="lineno"> 9246</span>            <a class="code hl_function" href="../../d7/dce/a00143.html#a78841df2e0aea059520ce71944c4c3bb">icXyzFromPcs</a>(pInput);</div>
<div class="line"><span class="lineno"> 9247</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9248</span>          }</div>
<div class="line"><span class="lineno"> 9249</span>          </div>
<div class="line"><span class="lineno"> 9250</span>        <span class="keywordflow">case</span> icEncode16Bit:</div>
<div class="line"><span class="lineno"> 9251</span>        <span class="keywordflow">case</span> icEncode16BitV2:</div>
<div class="line"><span class="lineno"> 9252</span>          {</div>
<div class="line"><span class="lineno"> 9253</span>            <a class="code hl_function" href="../../d7/dce/a00143.html#a78841df2e0aea059520ce71944c4c3bb">icXyzFromPcs</a>(pInput);</div>
<div class="line"><span class="lineno"> 9254</span>            pInput[0] = <a class="code hl_function" href="../../d7/dce/a00143.html#a48d114d730666238b19cefd80187a629">icDtoUSF</a>(pInput[0]);</div>
<div class="line"><span class="lineno"> 9255</span>            pInput[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#a48d114d730666238b19cefd80187a629">icDtoUSF</a>(pInput[1]);</div>
<div class="line"><span class="lineno"> 9256</span>            pInput[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#a48d114d730666238b19cefd80187a629">icDtoUSF</a>(pInput[2]);</div>
<div class="line"><span class="lineno"> 9257</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9258</span>          }</div>
<div class="line"><span class="lineno"> 9259</span>          </div>
<div class="line"><span class="lineno"> 9260</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9261</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26">icCmmStatBadColorEncoding</a>;</div>
<div class="line"><span class="lineno"> 9262</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9263</span>        }</div>
<div class="line"><span class="lineno"> 9264</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9265</span>      }</div>
<div class="line"><span class="lineno"> 9266</span> </div>
<div class="line"><span class="lineno"> 9267</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>:</div>
<div class="line"><span class="lineno"> 9268</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26">icCmmStatBadColorEncoding</a>;</div>
<div class="line"><span class="lineno"> 9269</span> </div>
<div class="line"><span class="lineno"> 9270</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9271</span>      {</div>
<div class="line"><span class="lineno"> 9272</span>        <span class="keywordflow">switch</span>(nEncode) {</div>
<div class="line"><span class="lineno"> 9273</span>        <span class="keywordflow">case</span> icEncodeValue:</div>
<div class="line"><span class="lineno"> 9274</span>          {</div>
<div class="line"><span class="lineno"> 9275</span>            <span class="keywordflow">if</span> (nSpace == <a class="code hl_define" href="../../d4/d81/a00110.html#a550e980dd884839e33548afbd55b4277">icSigDevXYZData</a>) {</div>
<div class="line"><span class="lineno"> 9276</span>              <a class="code hl_function" href="../../d7/dce/a00143.html#a78841df2e0aea059520ce71944c4c3bb">icXyzFromPcs</a>(pInput);</div>
<div class="line"><span class="lineno"> 9277</span>            }</div>
<div class="line"><span class="lineno"> 9278</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bCLRspace &amp;&amp; nSamples &gt;=3) {</div>
<div class="line"><span class="lineno"> 9279</span>              <a class="code hl_function" href="../../d7/dce/a00143.html#ac5de02865f572ea243f6da8c144c02fa">icLabFromPcs</a>(pInput);</div>
<div class="line"><span class="lineno"> 9280</span>            }</div>
<div class="line"><span class="lineno"> 9281</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9282</span>          }</div>
<div class="line"><span class="lineno"> 9283</span>        <span class="keywordflow">case</span> icEncodePercent:</div>
<div class="line"><span class="lineno"> 9284</span>          {</div>
<div class="line"><span class="lineno"> 9285</span>            <span class="keywordflow">if</span> (bClip) {</div>
<div class="line"><span class="lineno"> 9286</span>              <span class="keywordflow">for</span>(i=0; i&lt;nSamples; i++) {</div>
<div class="line"><span class="lineno"> 9287</span>                <span class="keywordflow">if</span> (pInput[i] &lt; 0.0) pInput[i] = 0.0;</div>
<div class="line"><span class="lineno"> 9288</span>                <span class="keywordflow">if</span> (pInput[i] &gt; 1.0) pInput[i] = 1.0;</div>
<div class="line"><span class="lineno"> 9289</span>                pInput[i] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pInput[i]*100.0);</div>
<div class="line"><span class="lineno"> 9290</span>              }</div>
<div class="line"><span class="lineno"> 9291</span>            }</div>
<div class="line"><span class="lineno"> 9292</span>            <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 9293</span>              <span class="keywordflow">for</span>(i=0; i&lt;nSamples; i++) {</div>
<div class="line"><span class="lineno"> 9294</span>                pInput[i] = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(pInput[i]*100.0);</div>
<div class="line"><span class="lineno"> 9295</span>              }</div>
<div class="line"><span class="lineno"> 9296</span>            }</div>
<div class="line"><span class="lineno"> 9297</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9298</span>          }</div>
<div class="line"><span class="lineno"> 9299</span>        </div>
<div class="line"><span class="lineno"> 9300</span>        <span class="keywordflow">case</span> icEncodeFloat:</div>
<div class="line"><span class="lineno"> 9301</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9302</span> </div>
<div class="line"><span class="lineno"> 9303</span>        <span class="keywordflow">case</span> icEncodeUnitFloat:</div>
<div class="line"><span class="lineno"> 9304</span>          {</div>
<div class="line"><span class="lineno"> 9305</span>            <span class="keywordflow">if</span> (bClip) {</div>
<div class="line"><span class="lineno"> 9306</span>              <span class="keywordflow">for</span>(i=0; i&lt;nSamples; i++) {</div>
<div class="line"><span class="lineno"> 9307</span>                <span class="keywordflow">if</span> (pInput[i] &lt; 0.0) pInput[i] = 0.0;</div>
<div class="line"><span class="lineno"> 9308</span>                <span class="keywordflow">if</span> (pInput[i] &gt; 1.0) pInput[i] = 1.0;</div>
<div class="line"><span class="lineno"> 9309</span>              }</div>
<div class="line"><span class="lineno"> 9310</span>            }</div>
<div class="line"><span class="lineno"> 9311</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9312</span>          }</div>
<div class="line"><span class="lineno"> 9313</span>          </div>
<div class="line"><span class="lineno"> 9314</span>        <span class="keywordflow">case</span> icEncode8Bit:</div>
<div class="line"><span class="lineno"> 9315</span>          {</div>
<div class="line"><span class="lineno"> 9316</span>            <span class="keywordflow">for</span>(i=0; i&lt;nSamples; i++) {</div>
<div class="line"><span class="lineno"> 9317</span>              pInput[i] = <a class="code hl_function" href="../../d7/dce/a00143.html#a42317dad5efb1650fa709ab01309651f">icFtoU8</a>(pInput[i]);</div>
<div class="line"><span class="lineno"> 9318</span>            }</div>
<div class="line"><span class="lineno"> 9319</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9320</span>          }</div>
<div class="line"><span class="lineno"> 9321</span>          </div>
<div class="line"><span class="lineno"> 9322</span>        <span class="keywordflow">case</span> icEncode16Bit:</div>
<div class="line"><span class="lineno"> 9323</span>        <span class="keywordflow">case</span> icEncode16BitV2:</div>
<div class="line"><span class="lineno"> 9324</span>          {</div>
<div class="line"><span class="lineno"> 9325</span>            <span class="keywordflow">for</span>(i=0; i&lt;nSamples; i++) {</div>
<div class="line"><span class="lineno"> 9326</span>              pInput[i] = <a class="code hl_function" href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a>(pInput[i]);</div>
<div class="line"><span class="lineno"> 9327</span>            }</div>
<div class="line"><span class="lineno"> 9328</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9329</span>          }</div>
<div class="line"><span class="lineno"> 9330</span>        </div>
<div class="line"><span class="lineno"> 9331</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9332</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26">icCmmStatBadColorEncoding</a>;</div>
<div class="line"><span class="lineno"> 9333</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9334</span>        }</div>
<div class="line"><span class="lineno"> 9335</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9336</span>      }</div>
<div class="line"><span class="lineno"> 9337</span>  }</div>
<div class="line"><span class="lineno"> 9338</span> </div>
<div class="line"><span class="lineno"> 9339</span>  memcpy(pData, pInput, nSamples*<span class="keyword">sizeof</span>(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>));</div>
<div class="line"><span class="lineno"> 9340</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 9341</span>}</div>
<div class="line"><span class="lineno"> 9342</span> </div>
<div class="line"><span class="lineno"> 9343</span> </div>
<div class="line"><span class="lineno"> 9359</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::FromInternalEncoding(<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nSpace, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a0462ca2992be7c80b056e640a192b325">icUInt8Number</a> *pData,</div>
<div class="line"><span class="lineno"> 9360</span>                                          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pInternal)</div>
<div class="line"><span class="lineno"> 9361</span>{</div>
<div class="line"><span class="lineno"> 9362</span>  <span class="keywordflow">switch</span>(nSpace) {</div>
<div class="line"><span class="lineno"> 9363</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30">icSigRgbData</a>:</div>
<div class="line"><span class="lineno"> 9364</span>    {</div>
<div class="line"><span class="lineno"> 9365</span>      pData[0] = <a class="code hl_function" href="../../d7/dce/a00143.html#a42317dad5efb1650fa709ab01309651f">icFtoU8</a>(pInternal[0]);</div>
<div class="line"><span class="lineno"> 9366</span>      pData[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#a42317dad5efb1650fa709ab01309651f">icFtoU8</a>(pInternal[1]);</div>
<div class="line"><span class="lineno"> 9367</span>      pData[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#a42317dad5efb1650fa709ab01309651f">icFtoU8</a>(pInternal[2]);</div>
<div class="line"><span class="lineno"> 9368</span> </div>
<div class="line"><span class="lineno"> 9369</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 9370</span>    }</div>
<div class="line"><span class="lineno"> 9371</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661">icSigCmykData</a>:</div>
<div class="line"><span class="lineno"> 9372</span>    {</div>
<div class="line"><span class="lineno"> 9373</span>      pData[0] = <a class="code hl_function" href="../../d7/dce/a00143.html#a42317dad5efb1650fa709ab01309651f">icFtoU8</a>(pInternal[0]);</div>
<div class="line"><span class="lineno"> 9374</span>      pData[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#a42317dad5efb1650fa709ab01309651f">icFtoU8</a>(pInternal[1]);</div>
<div class="line"><span class="lineno"> 9375</span>      pData[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#a42317dad5efb1650fa709ab01309651f">icFtoU8</a>(pInternal[2]);</div>
<div class="line"><span class="lineno"> 9376</span>      pData[3] = <a class="code hl_function" href="../../d7/dce/a00143.html#a42317dad5efb1650fa709ab01309651f">icFtoU8</a>(pInternal[3]);</div>
<div class="line"><span class="lineno"> 9377</span> </div>
<div class="line"><span class="lineno"> 9378</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 9379</span>    }</div>
<div class="line"><span class="lineno"> 9380</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9381</span>    {</div>
<div class="line"><span class="lineno"> 9382</span>      <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> i;</div>
<div class="line"><span class="lineno"> 9383</span>      <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> nSamples = <a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(nSpace);</div>
<div class="line"><span class="lineno"> 9384</span> </div>
<div class="line"><span class="lineno"> 9385</span>      <a class="code hl_class" href="../../d4/d53/a00429.html">CIccPixelBuf</a> pFloatPixel(nSamples);</div>
<div class="line"><span class="lineno"> 9386</span>      <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> convertStat;</div>
<div class="line"><span class="lineno"> 9387</span> </div>
<div class="line"><span class="lineno"> 9388</span>      <span class="keywordflow">if</span> (!pFloatPixel.get())</div>
<div class="line"><span class="lineno"> 9389</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 9390</span> </div>
<div class="line"><span class="lineno"> 9391</span>      convertStat = FromInternalEncoding(nSpace, icEncode8Bit, pFloatPixel, pInternal);</div>
<div class="line"><span class="lineno"> 9392</span>      <span class="keywordflow">if</span> (convertStat)</div>
<div class="line"><span class="lineno"> 9393</span>        <span class="keywordflow">return</span> convertStat;</div>
<div class="line"><span class="lineno"> 9394</span>      <span class="keywordflow">for</span>(i=0; i&lt;nSamples; i++) {</div>
<div class="line"><span class="lineno"> 9395</span>        pData[i] = (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a0462ca2992be7c80b056e640a192b325">icUInt8Number</a>)(pFloatPixel[i] + 0.5);    </div>
<div class="line"><span class="lineno"> 9396</span>      }</div>
<div class="line"><span class="lineno"> 9397</span> </div>
<div class="line"><span class="lineno"> 9398</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 9399</span>    }</div>
<div class="line"><span class="lineno"> 9400</span>  }</div>
<div class="line"><span class="lineno"> 9401</span>}</div>
<div class="line"><span class="lineno"> 9402</span> </div>
<div class="line"><span class="lineno"> 9403</span> </div>
<div class="line"><span class="lineno"> 9419</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccCmm::FromInternalEncoding(<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nSpace, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> *pData,</div>
<div class="line"><span class="lineno"> 9420</span>                                          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pInternal)</div>
<div class="line"><span class="lineno"> 9421</span>{</div>
<div class="line"><span class="lineno"> 9422</span>  <span class="keywordflow">switch</span>(nSpace) {</div>
<div class="line"><span class="lineno"> 9423</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30">icSigRgbData</a>:</div>
<div class="line"><span class="lineno"> 9424</span>    {</div>
<div class="line"><span class="lineno"> 9425</span>      pData[0] = <a class="code hl_function" href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a>(pInternal[0]);</div>
<div class="line"><span class="lineno"> 9426</span>      pData[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a>(pInternal[1]);</div>
<div class="line"><span class="lineno"> 9427</span>      pData[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a>(pInternal[2]);</div>
<div class="line"><span class="lineno"> 9428</span> </div>
<div class="line"><span class="lineno"> 9429</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 9430</span>    }</div>
<div class="line"><span class="lineno"> 9431</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661">icSigCmykData</a>:</div>
<div class="line"><span class="lineno"> 9432</span>    {</div>
<div class="line"><span class="lineno"> 9433</span>      pData[0] = <a class="code hl_function" href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a>(pInternal[0]);</div>
<div class="line"><span class="lineno"> 9434</span>      pData[1] = <a class="code hl_function" href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a>(pInternal[1]);</div>
<div class="line"><span class="lineno"> 9435</span>      pData[2] = <a class="code hl_function" href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a>(pInternal[2]);</div>
<div class="line"><span class="lineno"> 9436</span>      pData[3] = <a class="code hl_function" href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a>(pInternal[3]);</div>
<div class="line"><span class="lineno"> 9437</span> </div>
<div class="line"><span class="lineno"> 9438</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 9439</span>    }</div>
<div class="line"><span class="lineno"> 9440</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9441</span>    {</div>
<div class="line"><span class="lineno"> 9442</span>      <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> i;</div>
<div class="line"><span class="lineno"> 9443</span>      <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> nSamples = <a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(nSpace);</div>
<div class="line"><span class="lineno"> 9444</span>      <a class="code hl_class" href="../../d4/d53/a00429.html">CIccPixelBuf</a> pFloatPixel(nSamples);</div>
<div class="line"><span class="lineno"> 9445</span>      <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> convertStat;</div>
<div class="line"><span class="lineno"> 9446</span> </div>
<div class="line"><span class="lineno"> 9447</span>      <span class="keywordflow">if</span> (!pFloatPixel.get())</div>
<div class="line"><span class="lineno"> 9448</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 9449</span> </div>
<div class="line"><span class="lineno"> 9450</span>      convertStat = FromInternalEncoding(nSpace, icEncode16Bit, pFloatPixel, pInternal);</div>
<div class="line"><span class="lineno"> 9451</span>      <span class="keywordflow">if</span> (convertStat)</div>
<div class="line"><span class="lineno"> 9452</span>        <span class="keywordflow">return</span> convertStat;</div>
<div class="line"><span class="lineno"> 9453</span>      <span class="keywordflow">for</span>(i=0; i&lt;nSamples; i++) {</div>
<div class="line"><span class="lineno"> 9454</span>        pData[i] = (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a>)(pFloatPixel[i] + 0.5);    </div>
<div class="line"><span class="lineno"> 9455</span>      }</div>
<div class="line"><span class="lineno"> 9456</span> </div>
<div class="line"><span class="lineno"> 9457</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 9458</span>    }</div>
<div class="line"><span class="lineno"> 9459</span>  }</div>
<div class="line"><span class="lineno"> 9460</span>}</div>
<div class="line"><span class="lineno"> 9461</span> </div>
<div class="line"><span class="lineno"> 9462</span> </div>
<div class="line"><span class="lineno"> 9477</span><span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a>* CIccCmm::GetFloatColorEncoding(icFloatColorEncoding val)</div>
<div class="line"><span class="lineno"> 9478</span>{</div>
<div class="line"><span class="lineno"> 9479</span>  <span class="keywordflow">switch</span>(val) {</div>
<div class="line"><span class="lineno"> 9480</span> </div>
<div class="line"><span class="lineno"> 9481</span>    <span class="keywordflow">case</span> icEncodeValue:</div>
<div class="line"><span class="lineno"> 9482</span>      <span class="keywordflow">return</span> <span class="stringliteral">&quot;icEncodeValue&quot;</span>;</div>
<div class="line"><span class="lineno"> 9483</span> </div>
<div class="line"><span class="lineno"> 9484</span>    <span class="keywordflow">case</span> icEncodeFloat:</div>
<div class="line"><span class="lineno"> 9485</span>      <span class="keywordflow">return</span> <span class="stringliteral">&quot;icEncodeFloat&quot;</span>;</div>
<div class="line"><span class="lineno"> 9486</span> </div>
<div class="line"><span class="lineno"> 9487</span>    <span class="keywordflow">case</span> icEncodeUnitFloat:</div>
<div class="line"><span class="lineno"> 9488</span>      <span class="keywordflow">return</span> <span class="stringliteral">&quot;icEncodeUnitFloat&quot;</span>;</div>
<div class="line"><span class="lineno"> 9489</span> </div>
<div class="line"><span class="lineno"> 9490</span>    <span class="keywordflow">case</span> icEncodePercent:</div>
<div class="line"><span class="lineno"> 9491</span>      <span class="keywordflow">return</span> <span class="stringliteral">&quot;icEncodePercent&quot;</span>;</div>
<div class="line"><span class="lineno"> 9492</span> </div>
<div class="line"><span class="lineno"> 9493</span>    <span class="keywordflow">case</span> icEncode8Bit:</div>
<div class="line"><span class="lineno"> 9494</span>      <span class="keywordflow">return</span> <span class="stringliteral">&quot;icEncode8Bit&quot;</span>;</div>
<div class="line"><span class="lineno"> 9495</span> </div>
<div class="line"><span class="lineno"> 9496</span>    <span class="keywordflow">case</span> icEncode16Bit:</div>
<div class="line"><span class="lineno"> 9497</span>      <span class="keywordflow">return</span> <span class="stringliteral">&quot;icEncode16Bit&quot;</span>;</div>
<div class="line"><span class="lineno"> 9498</span> </div>
<div class="line"><span class="lineno"> 9499</span>    <span class="keywordflow">case</span> icEncode16BitV2:</div>
<div class="line"><span class="lineno"> 9500</span>      <span class="keywordflow">return</span> <span class="stringliteral">&quot;icEncode16BitV2&quot;</span>;</div>
<div class="line"><span class="lineno"> 9501</span> </div>
<div class="line"><span class="lineno"> 9502</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9503</span>      <span class="keywordflow">return</span> <span class="stringliteral">&quot;icEncodeUnknown&quot;</span>;</div>
<div class="line"><span class="lineno"> 9504</span>  }</div>
<div class="line"><span class="lineno"> 9505</span>}</div>
<div class="line"><span class="lineno"> 9506</span> </div>
<div class="line"><span class="lineno"> 9521</span>icFloatColorEncoding CIccCmm::GetFloatColorEncoding(<span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a>* val)</div>
<div class="line"><span class="lineno"> 9522</span>{</div>
<div class="line"><span class="lineno"> 9523</span>  <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d5/d16/a00029.html#a4e0be90a3757e352f42612d09a7d1aa5">stricmp</a>(val, <span class="stringliteral">&quot;icEncodePercent&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 9524</span>    <span class="keywordflow">return</span> icEncodePercent;</div>
<div class="line"><span class="lineno"> 9525</span>  }</div>
<div class="line"><span class="lineno"> 9526</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d5/d16/a00029.html#a4e0be90a3757e352f42612d09a7d1aa5">stricmp</a>(val, <span class="stringliteral">&quot;icEncodeUnitFloat&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 9527</span>    <span class="keywordflow">return</span> icEncodeUnitFloat;</div>
<div class="line"><span class="lineno"> 9528</span>  }</div>
<div class="line"><span class="lineno"> 9529</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d5/d16/a00029.html#a4e0be90a3757e352f42612d09a7d1aa5">stricmp</a>(val, <span class="stringliteral">&quot;icEncodeFloat&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 9530</span>    <span class="keywordflow">return</span> icEncodeFloat;</div>
<div class="line"><span class="lineno"> 9531</span>  }</div>
<div class="line"><span class="lineno"> 9532</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d5/d16/a00029.html#a4e0be90a3757e352f42612d09a7d1aa5">stricmp</a>(val, <span class="stringliteral">&quot;icEncode8Bit&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 9533</span>    <span class="keywordflow">return</span> icEncode8Bit;</div>
<div class="line"><span class="lineno"> 9534</span>  }</div>
<div class="line"><span class="lineno"> 9535</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d5/d16/a00029.html#a4e0be90a3757e352f42612d09a7d1aa5">stricmp</a>(val, <span class="stringliteral">&quot;icEncode16Bit&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 9536</span>    <span class="keywordflow">return</span> icEncode16Bit;</div>
<div class="line"><span class="lineno"> 9537</span>  }</div>
<div class="line"><span class="lineno"> 9538</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d5/d16/a00029.html#a4e0be90a3757e352f42612d09a7d1aa5">stricmp</a>(val, <span class="stringliteral">&quot;icEncode16BitV2&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 9539</span>    <span class="keywordflow">return</span> icEncode16BitV2;</div>
<div class="line"><span class="lineno"> 9540</span>  }</div>
<div class="line"><span class="lineno"> 9541</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d5/d16/a00029.html#a4e0be90a3757e352f42612d09a7d1aa5">stricmp</a>(val, <span class="stringliteral">&quot;icEncodeValue&quot;</span>)) {</div>
<div class="line"><span class="lineno"> 9542</span>    <span class="keywordflow">return</span> icEncodeValue;</div>
<div class="line"><span class="lineno"> 9543</span>  }</div>
<div class="line"><span class="lineno"> 9544</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 9545</span>    <span class="keywordflow">return</span> icEncodeUnknown;</div>
<div class="line"><span class="lineno"> 9546</span>  }</div>
<div class="line"><span class="lineno"> 9547</span> </div>
<div class="line"><span class="lineno"> 9548</span>}</div>
<div class="line"><span class="lineno"> 9549</span> </div>
<div class="line"><span class="lineno"> 9561</span><a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> CIccCmm::GetNumXforms()<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 9562</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 9563</span>  <span class="keywordflow">return</span> (<a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a>)m_Xforms-&gt;size();</div>
<div class="line"><span class="lineno"> 9564</span>}</div>
<div class="line"><span class="lineno"> 9565</span> </div>
<div class="line"><span class="lineno"> 9566</span> </div>
<div class="line"><span class="lineno"> 9576</span><span class="keywordtype">void</span> CIccCmm::IterateXforms( IXformIterator* pIterater)<span class="keyword"> const</span></div>
<div class="line"><span class="lineno"> 9577</span><span class="keyword"></span>{</div>
<div class="line"><span class="lineno"> 9578</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> x = m_Xforms-&gt;begin(); x != m_Xforms-&gt;end(); x++) {</div>
<div class="line"><span class="lineno"> 9579</span>    pIterater-&gt;iterate(x-&gt;ptr);</div>
<div class="line"><span class="lineno"> 9580</span>  }</div>
<div class="line"><span class="lineno"> 9581</span>}</div>
<div class="line"><span class="lineno"> 9582</span> </div>
<div class="line"><span class="lineno"> 9583</span> </div>
<div class="line"><span class="lineno"> 9595</span><a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> CIccCmm::GetFirstXformSource()</div>
<div class="line"><span class="lineno"> 9596</span>{</div>
<div class="line"><span class="lineno"> 9597</span>  <span class="keywordflow">if</span> (!m_Xforms-&gt;size())</div>
<div class="line"><span class="lineno"> 9598</span>    <span class="keywordflow">return</span> m_nSrcSpace;</div>
<div class="line"><span class="lineno"> 9599</span> </div>
<div class="line"><span class="lineno"> 9600</span>  <span class="keywordflow">return</span> m_Xforms-&gt;begin()-&gt;ptr-&gt;GetSrcSpace();</div>
<div class="line"><span class="lineno"> 9601</span>}</div>
<div class="line"><span class="lineno"> 9602</span> </div>
<div class="line"><span class="lineno"> 9614</span><a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> CIccCmm::GetLastXformDest()</div>
<div class="line"><span class="lineno"> 9615</span>{</div>
<div class="line"><span class="lineno"> 9616</span>  <span class="keywordflow">if</span> (!m_Xforms-&gt;size())</div>
<div class="line"><span class="lineno"> 9617</span>    <span class="keywordflow">return</span> m_nDestSpace;</div>
<div class="line"><span class="lineno"> 9618</span> </div>
<div class="line"><span class="lineno"> 9619</span>  <span class="keywordflow">return</span> m_Xforms-&gt;rbegin()-&gt;ptr-&gt;GetDstSpace();</div>
<div class="line"><span class="lineno"> 9620</span>}</div>
<div class="line"><span class="lineno"> 9621</span> </div>
<div class="line"><span class="lineno"> 9633</span>CIccApplyNamedColorCmm::CIccApplyNamedColorCmm(CIccNamedColorCmm *pCmm) : CIccApplyCmm(pCmm)</div>
<div class="line"><span class="lineno"> 9634</span>{</div>
<div class="line"><span class="lineno"> 9635</span>}</div>
<div class="line"><span class="lineno"> 9636</span> </div>
<div class="line"><span class="lineno"> 9637</span> </div>
<div class="line"><span class="lineno"> 9646</span>CIccApplyNamedColorCmm::~CIccApplyNamedColorCmm()</div>
<div class="line"><span class="lineno"> 9647</span>{</div>
<div class="line"><span class="lineno"> 9648</span>}</div>
<div class="line"><span class="lineno"> 9649</span> </div>
<div class="line"><span class="lineno"> 9650</span> </div>
<div class="line"><span class="lineno"> 9663</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccApplyNamedColorCmm::Apply(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)</div>
<div class="line"><span class="lineno"> 9664</span>{</div>
<div class="line"><span class="lineno"> 9665</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, *pTmp;</div>
<div class="line"><span class="lineno"> 9666</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc;</div>
<div class="line"><span class="lineno"> 9667</span>  CIccApplyXformList::iterator i;</div>
<div class="line"><span class="lineno"> 9668</span>  <span class="keywordtype">int</span> j, n = (int)m_Xforms-&gt;size();</div>
<div class="line"><span class="lineno"> 9669</span>  CIccApplyXform *pApply;</div>
<div class="line"><span class="lineno"> 9670</span>  <span class="keyword">const</span> CIccXform *pApplyXform;</div>
<div class="line"><span class="lineno"> 9671</span>  CIccXformNamedColor *pXform;</div>
<div class="line"><span class="lineno"> 9672</span> </div>
<div class="line"><span class="lineno"> 9673</span>  <span class="keywordflow">if</span> (!n)</div>
<div class="line"><span class="lineno"> 9674</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno"> 9675</span> </div>
<div class="line"><span class="lineno"> 9676</span>  <span class="keywordflow">if</span> (!m_Pixel &amp;&amp; !InitPixel()) {</div>
<div class="line"><span class="lineno"> 9677</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 9678</span>  }</div>
<div class="line"><span class="lineno"> 9679</span> </div>
<div class="line"><span class="lineno"> 9680</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a> NamedColor[256];</div>
<div class="line"><span class="lineno"> 9681</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv;</div>
<div class="line"><span class="lineno"> 9682</span> </div>
<div class="line"><span class="lineno"> 9683</span>  pSrc = SrcPixel;</div>
<div class="line"><span class="lineno"> 9684</span>  pDst = m_Pixel;</div>
<div class="line"><span class="lineno"> 9685</span> </div>
<div class="line"><span class="lineno"> 9686</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 9687</span>  <span class="keywordtype">int</span> nCount = 0;</div>
<div class="line"><span class="lineno"> 9688</span>  printf(<span class="stringliteral">&quot;Start ApplyNamedCmm\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 9689</span>  DumpCmmApplyPixel(nCount++, pSrc, <a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(m_pCmm-&gt;GetSourceSpace()));</div>
<div class="line"><span class="lineno"> 9690</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 9691</span> </div>
<div class="line"><span class="lineno"> 9692</span> </div>
<div class="line"><span class="lineno"> 9693</span>  <span class="keywordflow">if</span> (n&gt;1) {</div>
<div class="line"><span class="lineno"> 9694</span>    <span class="keywordflow">for</span> (j=0, i=m_Xforms-&gt;begin(); j&lt;n-1 &amp;&amp; i!=m_Xforms-&gt;end(); i++, j++) {</div>
<div class="line"><span class="lineno"> 9695</span> </div>
<div class="line"><span class="lineno"> 9696</span>      pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno"> 9697</span>      pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno"> 9698</span>      <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>) {</div>
<div class="line"><span class="lineno"> 9699</span>        pXform = (CIccXformNamedColor*)pApplyXform;</div>
<div class="line"><span class="lineno"> 9700</span> </div>
<div class="line"><span class="lineno"> 9701</span>        <span class="keywordflow">switch</span>(pXform-&gt;GetInterface()) {</div>
<div class="line"><span class="lineno"> 9702</span>        <span class="keywordflow">case</span> icApplyPixel2Pixel:</div>
<div class="line"><span class="lineno"> 9703</span>          pXform-&gt;Apply(pApply, pDst, pSrc);</div>
<div class="line"><span class="lineno"> 9704</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 9705</span>          DumpCmmApplyPixel(nCount++, pDst, pXform-&gt;GetNumDstSamples());</div>
<div class="line"><span class="lineno"> 9706</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 9707</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9708</span> </div>
<div class="line"><span class="lineno"> 9709</span>        <span class="keywordflow">case</span> icApplyPixel2Named:</div>
<div class="line"><span class="lineno"> 9710</span>          pXform-&gt;Apply(pApply, NamedColor, pSrc);</div>
<div class="line"><span class="lineno"> 9711</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 9712</span>          printf(<span class="stringliteral">&quot;Xfm%d: \&quot;%s\&quot;\n&quot;</span>, nCount++, NamedColor);</div>
<div class="line"><span class="lineno"> 9713</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 9714</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9715</span> </div>
<div class="line"><span class="lineno"> 9716</span>        <span class="keywordflow">case</span> icApplyNamed2Pixel:</div>
<div class="line"><span class="lineno"> 9717</span>          <span class="keywordflow">if</span> (j==0) {</div>
<div class="line"><span class="lineno"> 9718</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno"> 9719</span>          }</div>
<div class="line"><span class="lineno"> 9720</span> </div>
<div class="line"><span class="lineno"> 9721</span>          rv = pXform-&gt;Apply(pApply, pDst, NamedColor);</div>
<div class="line"><span class="lineno"> 9722</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 9723</span>          DumpCmmApplyPixel(nCount++, pDst, pXform-&gt;GetNumDstSamples());</div>
<div class="line"><span class="lineno"> 9724</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 9725</span> </div>
<div class="line"><span class="lineno"> 9726</span>          <span class="keywordflow">if</span> (rv) {</div>
<div class="line"><span class="lineno"> 9727</span>            <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 9728</span>          }</div>
<div class="line"><span class="lineno"> 9729</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9730</span> </div>
<div class="line"><span class="lineno"> 9731</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9732</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9733</span>        }</div>
<div class="line"><span class="lineno"> 9734</span>      }</div>
<div class="line"><span class="lineno"> 9735</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 9736</span>        pApplyXform-&gt;Apply(pApply, pDst, pSrc);</div>
<div class="line"><span class="lineno"> 9737</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 9738</span>        DumpCmmApplyPixel(nCount++, pDst, pApplyXform-&gt;GetNumDstSamples());</div>
<div class="line"><span class="lineno"> 9739</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 9740</span>      }</div>
<div class="line"><span class="lineno"> 9741</span>      pTmp = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>*)pSrc;</div>
<div class="line"><span class="lineno"> 9742</span>      pSrc = pDst;</div>
<div class="line"><span class="lineno"> 9743</span>      <span class="keywordflow">if</span> (pTmp==SrcPixel)</div>
<div class="line"><span class="lineno"> 9744</span>        pDst = m_Pixel2;</div>
<div class="line"><span class="lineno"> 9745</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 9746</span>        pDst = pTmp;</div>
<div class="line"><span class="lineno"> 9747</span>    }</div>
<div class="line"><span class="lineno"> 9748</span> </div>
<div class="line"><span class="lineno"> 9749</span>    pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno"> 9750</span>    pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno"> 9751</span>    <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>) {</div>
<div class="line"><span class="lineno"> 9752</span>      pXform = (CIccXformNamedColor*)pApplyXform;</div>
<div class="line"><span class="lineno"> 9753</span> </div>
<div class="line"><span class="lineno"> 9754</span>      <span class="keywordflow">switch</span>(pXform-&gt;GetInterface()) {</div>
<div class="line"><span class="lineno"> 9755</span>      <span class="keywordflow">case</span> icApplyPixel2Pixel:</div>
<div class="line"><span class="lineno"> 9756</span>        pXform-&gt;Apply(pApply, DstPixel, pSrc);</div>
<div class="line"><span class="lineno"> 9757</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 9758</span>        DumpCmmApplyPixel(nCount++, DstPixel, pXform-&gt;GetNumDstSamples());</div>
<div class="line"><span class="lineno"> 9759</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 9760</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9761</span> </div>
<div class="line"><span class="lineno"> 9762</span>      <span class="keywordflow">case</span> icApplyPixel2Named:</div>
<div class="line"><span class="lineno"> 9763</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9764</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno"> 9765</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9766</span> </div>
<div class="line"><span class="lineno"> 9767</span>      <span class="keywordflow">case</span> icApplyNamed2Pixel:</div>
<div class="line"><span class="lineno"> 9768</span>        rv = pXform-&gt;Apply(pApply, DstPixel, NamedColor);</div>
<div class="line"><span class="lineno"> 9769</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 9770</span>        DumpCmmApplyPixel(nCount++, DstPixel, pXform-&gt;GetNumDstSamples());</div>
<div class="line"><span class="lineno"> 9771</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 9772</span>        <span class="keywordflow">if</span> (rv) {</div>
<div class="line"><span class="lineno"> 9773</span>          <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 9774</span>        }</div>
<div class="line"><span class="lineno"> 9775</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9776</span> </div>
<div class="line"><span class="lineno"> 9777</span>      }</div>
<div class="line"><span class="lineno"> 9778</span>    }</div>
<div class="line"><span class="lineno"> 9779</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 9780</span>      pApplyXform-&gt;Apply(pApply, DstPixel, pSrc);</div>
<div class="line"><span class="lineno"> 9781</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 9782</span>      DumpCmmApplyPixel(nCount++, DstPixel, pApplyXform-&gt;GetNumDstSamples());</div>
<div class="line"><span class="lineno"> 9783</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 9784</span>    }</div>
<div class="line"><span class="lineno"> 9785</span> </div>
<div class="line"><span class="lineno"> 9786</span>  }</div>
<div class="line"><span class="lineno"> 9787</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n==1) {</div>
<div class="line"><span class="lineno"> 9788</span>    i = m_Xforms-&gt;begin();</div>
<div class="line"><span class="lineno"> 9789</span> </div>
<div class="line"><span class="lineno"> 9790</span>    pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno"> 9791</span>    pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno"> 9792</span>    <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>) {</div>
<div class="line"><span class="lineno"> 9793</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno"> 9794</span>    }</div>
<div class="line"><span class="lineno"> 9795</span> </div>
<div class="line"><span class="lineno"> 9796</span>    pApplyXform-&gt;Apply(pApply, DstPixel, pSrc);</div>
<div class="line"><span class="lineno"> 9797</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 9798</span>    DumpCmmApplyPixel(nCount++, DstPixel, pApplyXform-&gt;GetNumDstSamples());</div>
<div class="line"><span class="lineno"> 9799</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 9800</span>  }</div>
<div class="line"><span class="lineno"> 9801</span> </div>
<div class="line"><span class="lineno"> 9802</span><span class="preprocessor">#ifdef DEBUG_CMM_APPLY</span></div>
<div class="line"><span class="lineno"> 9803</span>  DumpCmmApplyPixel(nCount++, DstPixel, <a class="code hl_function" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(m_pCmm-&gt;GetDestSpace()));</div>
<div class="line"><span class="lineno"> 9804</span>  printf(<span class="stringliteral">&quot;End ApplyNamedCmm\n\n&quot;</span>);</div>
<div class="line"><span class="lineno"> 9805</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 9806</span> </div>
<div class="line"><span class="lineno"> 9807</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 9808</span>}</div>
<div class="line"><span class="lineno"> 9809</span> </div>
<div class="line"><span class="lineno"> 9810</span> </div>
<div class="line"><span class="lineno"> 9823</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccApplyNamedColorCmm::Apply(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> nPixels)</div>
<div class="line"><span class="lineno"> 9824</span>{</div>
<div class="line"><span class="lineno"> 9825</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst;</div>
<div class="line"><span class="lineno"> 9826</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc;</div>
<div class="line"><span class="lineno"> 9827</span>  CIccApplyXformList::iterator i;</div>
<div class="line"><span class="lineno"> 9828</span>  <span class="keywordtype">int</span> j, n = (int)m_Xforms-&gt;size();</div>
<div class="line"><span class="lineno"> 9829</span>  CIccApplyXform *pApply;</div>
<div class="line"><span class="lineno"> 9830</span>  <span class="keyword">const</span> CIccXform *pApplyXform;</div>
<div class="line"><span class="lineno"> 9831</span>  CIccXformNamedColor *pXform;</div>
<div class="line"><span class="lineno"> 9832</span>  <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> k; </div>
<div class="line"><span class="lineno"> 9833</span> </div>
<div class="line"><span class="lineno"> 9834</span>  <span class="keywordflow">if</span> (!n)</div>
<div class="line"><span class="lineno"> 9835</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno"> 9836</span> </div>
<div class="line"><span class="lineno"> 9837</span>  <span class="keywordflow">if</span> (!m_Pixel &amp;&amp; !InitPixel()) {</div>
<div class="line"><span class="lineno"> 9838</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 9839</span>  }</div>
<div class="line"><span class="lineno"> 9840</span> </div>
<div class="line"><span class="lineno"> 9841</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a> NamedColor[255];</div>
<div class="line"><span class="lineno"> 9842</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv;</div>
<div class="line"><span class="lineno"> 9843</span> </div>
<div class="line"><span class="lineno"> 9844</span>  <span class="keywordflow">for</span> (k=0; k&lt;nPixels; k++) {</div>
<div class="line"><span class="lineno"> 9845</span> </div>
<div class="line"><span class="lineno"> 9846</span>    pSrc = SrcPixel;</div>
<div class="line"><span class="lineno"> 9847</span>    pDst = m_Pixel;</div>
<div class="line"><span class="lineno"> 9848</span> </div>
<div class="line"><span class="lineno"> 9849</span>    <span class="keywordflow">if</span> (n&gt;1) {</div>
<div class="line"><span class="lineno"> 9850</span>      <span class="keywordflow">for</span> (j=0, i=m_Xforms-&gt;begin(); j&lt;n-1 &amp;&amp; i!=m_Xforms-&gt;end(); i++, j++) {</div>
<div class="line"><span class="lineno"> 9851</span> </div>
<div class="line"><span class="lineno"> 9852</span>        pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno"> 9853</span>        pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno"> 9854</span>        <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>) {</div>
<div class="line"><span class="lineno"> 9855</span>          pXform = (CIccXformNamedColor*)pApplyXform;</div>
<div class="line"><span class="lineno"> 9856</span> </div>
<div class="line"><span class="lineno"> 9857</span>          <span class="keywordflow">switch</span>(pXform-&gt;GetInterface()) {</div>
<div class="line"><span class="lineno"> 9858</span>          <span class="keywordflow">case</span> icApplyPixel2Pixel:</div>
<div class="line"><span class="lineno"> 9859</span>            pXform-&gt;Apply(pApply, pDst, pSrc);</div>
<div class="line"><span class="lineno"> 9860</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9861</span> </div>
<div class="line"><span class="lineno"> 9862</span>          <span class="keywordflow">case</span> icApplyPixel2Named:</div>
<div class="line"><span class="lineno"> 9863</span>            pXform-&gt;Apply(pApply, NamedColor, pSrc);</div>
<div class="line"><span class="lineno"> 9864</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9865</span> </div>
<div class="line"><span class="lineno"> 9866</span>          <span class="keywordflow">case</span> icApplyNamed2Pixel:</div>
<div class="line"><span class="lineno"> 9867</span>            <span class="keywordflow">if</span> (j==0) {</div>
<div class="line"><span class="lineno"> 9868</span>              <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno"> 9869</span>            }</div>
<div class="line"><span class="lineno"> 9870</span> </div>
<div class="line"><span class="lineno"> 9871</span>            rv = pXform-&gt;Apply(pApply, pDst, NamedColor);</div>
<div class="line"><span class="lineno"> 9872</span> </div>
<div class="line"><span class="lineno"> 9873</span>            <span class="keywordflow">if</span> (rv) {</div>
<div class="line"><span class="lineno"> 9874</span>              <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 9875</span>            }</div>
<div class="line"><span class="lineno"> 9876</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9877</span> </div>
<div class="line"><span class="lineno"> 9878</span>          <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9879</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9880</span>          }</div>
<div class="line"><span class="lineno"> 9881</span>        }</div>
<div class="line"><span class="lineno"> 9882</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 9883</span>          pApplyXform-&gt;Apply(pApply, pDst, pSrc);</div>
<div class="line"><span class="lineno"> 9884</span>        }</div>
<div class="line"><span class="lineno"> 9885</span>        pSrc = pDst;</div>
<div class="line"><span class="lineno"> 9886</span>      }</div>
<div class="line"><span class="lineno"> 9887</span> </div>
<div class="line"><span class="lineno"> 9888</span>      pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno"> 9889</span>      pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno"> 9890</span>      <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>) {</div>
<div class="line"><span class="lineno"> 9891</span>        pXform = (CIccXformNamedColor*)pApplyXform;</div>
<div class="line"><span class="lineno"> 9892</span> </div>
<div class="line"><span class="lineno"> 9893</span>        <span class="keywordflow">switch</span>(pXform-&gt;GetInterface()) {</div>
<div class="line"><span class="lineno"> 9894</span>        <span class="keywordflow">case</span> icApplyPixel2Pixel:</div>
<div class="line"><span class="lineno"> 9895</span>          pXform-&gt;Apply(pApply, DstPixel, pSrc);</div>
<div class="line"><span class="lineno"> 9896</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9897</span> </div>
<div class="line"><span class="lineno"> 9898</span>        <span class="keywordflow">case</span> icApplyPixel2Named:</div>
<div class="line"><span class="lineno"> 9899</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9900</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno"> 9901</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9902</span> </div>
<div class="line"><span class="lineno"> 9903</span>        <span class="keywordflow">case</span> icApplyNamed2Pixel:</div>
<div class="line"><span class="lineno"> 9904</span>          rv = pXform-&gt;Apply(pApply, DstPixel, NamedColor);</div>
<div class="line"><span class="lineno"> 9905</span>          <span class="keywordflow">if</span> (rv) {</div>
<div class="line"><span class="lineno"> 9906</span>            <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 9907</span>          }</div>
<div class="line"><span class="lineno"> 9908</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9909</span> </div>
<div class="line"><span class="lineno"> 9910</span>        }</div>
<div class="line"><span class="lineno"> 9911</span>      }</div>
<div class="line"><span class="lineno"> 9912</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 9913</span>        pApplyXform-&gt;Apply(pApply, DstPixel, pSrc);</div>
<div class="line"><span class="lineno"> 9914</span>      }</div>
<div class="line"><span class="lineno"> 9915</span> </div>
<div class="line"><span class="lineno"> 9916</span>    }</div>
<div class="line"><span class="lineno"> 9917</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n==1) {</div>
<div class="line"><span class="lineno"> 9918</span>      i = m_Xforms-&gt;begin();</div>
<div class="line"><span class="lineno"> 9919</span> </div>
<div class="line"><span class="lineno"> 9920</span>      pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno"> 9921</span>      pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno"> 9922</span>      <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>) {</div>
<div class="line"><span class="lineno"> 9923</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno"> 9924</span>      }</div>
<div class="line"><span class="lineno"> 9925</span> </div>
<div class="line"><span class="lineno"> 9926</span>      pApplyXform-&gt;Apply(pApply, DstPixel, pSrc);</div>
<div class="line"><span class="lineno"> 9927</span>    }</div>
<div class="line"><span class="lineno"> 9928</span> </div>
<div class="line"><span class="lineno"> 9929</span>    SrcPixel += m_pCmm-&gt;GetSourceSamples();</div>
<div class="line"><span class="lineno"> 9930</span>    DstPixel += m_pCmm-&gt;GetDestSamples();</div>
<div class="line"><span class="lineno"> 9931</span>  }</div>
<div class="line"><span class="lineno"> 9932</span> </div>
<div class="line"><span class="lineno"> 9933</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno"> 9934</span>}</div>
<div class="line"><span class="lineno"> 9935</span> </div>
<div class="line"><span class="lineno"> 9936</span> </div>
<div class="line"><span class="lineno"> 9949</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccApplyNamedColorCmm::Apply(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a>* DstColorName, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)</div>
<div class="line"><span class="lineno"> 9950</span>{</div>
<div class="line"><span class="lineno"> 9951</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, *pTmp;</div>
<div class="line"><span class="lineno"> 9952</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc;</div>
<div class="line"><span class="lineno"> 9953</span>  CIccApplyXformList::iterator i;</div>
<div class="line"><span class="lineno"> 9954</span>  <span class="keywordtype">int</span> j, n = (int)m_Xforms-&gt;size();</div>
<div class="line"><span class="lineno"> 9955</span>  CIccApplyXform *pApply;</div>
<div class="line"><span class="lineno"> 9956</span>  <span class="keyword">const</span> CIccXform *pApplyXform;</div>
<div class="line"><span class="lineno"> 9957</span>  CIccXformNamedColor *pXform;</div>
<div class="line"><span class="lineno"> 9958</span> </div>
<div class="line"><span class="lineno"> 9959</span>  <span class="keywordflow">if</span> (!n)</div>
<div class="line"><span class="lineno"> 9960</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno"> 9961</span> </div>
<div class="line"><span class="lineno"> 9962</span>  <span class="keywordflow">if</span> (!m_Pixel &amp;&amp; !InitPixel()) {</div>
<div class="line"><span class="lineno"> 9963</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno"> 9964</span>  }</div>
<div class="line"><span class="lineno"> 9965</span> </div>
<div class="line"><span class="lineno"> 9966</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a> NamedColor[256];</div>
<div class="line"><span class="lineno"> 9967</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv;</div>
<div class="line"><span class="lineno"> 9968</span> </div>
<div class="line"><span class="lineno"> 9969</span>  pSrc = SrcPixel;</div>
<div class="line"><span class="lineno"> 9970</span>  pDst = m_Pixel;</div>
<div class="line"><span class="lineno"> 9971</span> </div>
<div class="line"><span class="lineno"> 9972</span>  <span class="keywordflow">if</span> (n&gt;1) {</div>
<div class="line"><span class="lineno"> 9973</span>    <span class="keywordflow">for</span> (j=0, i=m_Xforms-&gt;begin(); j&lt;n-1 &amp;&amp; i!=m_Xforms-&gt;end(); i++, j++) {</div>
<div class="line"><span class="lineno"> 9974</span> </div>
<div class="line"><span class="lineno"> 9975</span>      pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno"> 9976</span>      pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno"> 9977</span>      <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>) {</div>
<div class="line"><span class="lineno"> 9978</span>        pXform = (CIccXformNamedColor*)pApplyXform;</div>
<div class="line"><span class="lineno"> 9979</span>        <span class="keywordflow">switch</span>(pXform-&gt;GetInterface()) {</div>
<div class="line"><span class="lineno"> 9980</span>        <span class="keywordflow">case</span> icApplyPixel2Pixel:</div>
<div class="line"><span class="lineno"> 9981</span>          pXform-&gt;Apply(pApply, pDst, pSrc);</div>
<div class="line"><span class="lineno"> 9982</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9983</span> </div>
<div class="line"><span class="lineno"> 9984</span>        <span class="keywordflow">case</span> icApplyPixel2Named:</div>
<div class="line"><span class="lineno"> 9985</span>          pXform-&gt;Apply(pApply, NamedColor, pSrc);</div>
<div class="line"><span class="lineno"> 9986</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9987</span> </div>
<div class="line"><span class="lineno"> 9988</span>        <span class="keywordflow">case</span> icApplyNamed2Pixel:</div>
<div class="line"><span class="lineno"> 9989</span>          <span class="keywordflow">if</span> (j==0) {</div>
<div class="line"><span class="lineno"> 9990</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno"> 9991</span>          }</div>
<div class="line"><span class="lineno"> 9992</span>          rv = pXform-&gt;Apply(pApply, pDst, NamedColor);</div>
<div class="line"><span class="lineno"> 9993</span>          <span class="keywordflow">if</span> (rv) {</div>
<div class="line"><span class="lineno"> 9994</span>            <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno"> 9995</span>          }</div>
<div class="line"><span class="lineno"> 9996</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 9997</span> </div>
<div class="line"><span class="lineno"> 9998</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno"> 9999</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10000</span>        }</div>
<div class="line"><span class="lineno">10001</span>      }</div>
<div class="line"><span class="lineno">10002</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10003</span>        pApplyXform-&gt;Apply(pApply, pDst, pSrc);</div>
<div class="line"><span class="lineno">10004</span>      }</div>
<div class="line"><span class="lineno">10005</span>      pTmp = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>*)pSrc;</div>
<div class="line"><span class="lineno">10006</span>      pSrc = pDst;</div>
<div class="line"><span class="lineno">10007</span>      <span class="keywordflow">if</span> (pTmp==SrcPixel)</div>
<div class="line"><span class="lineno">10008</span>        pDst = m_Pixel2;</div>
<div class="line"><span class="lineno">10009</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">10010</span>        pDst = pTmp;</div>
<div class="line"><span class="lineno">10011</span>    }</div>
<div class="line"><span class="lineno">10012</span> </div>
<div class="line"><span class="lineno">10013</span>    pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno">10014</span>    pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno">10015</span>    <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>) {</div>
<div class="line"><span class="lineno">10016</span>      pXform = (CIccXformNamedColor*)pApplyXform;</div>
<div class="line"><span class="lineno">10017</span>      <span class="keywordflow">switch</span>(pXform-&gt;GetInterface()) {</div>
<div class="line"><span class="lineno">10018</span> </div>
<div class="line"><span class="lineno">10019</span>      <span class="keywordflow">case</span> icApplyPixel2Named:</div>
<div class="line"><span class="lineno">10020</span>        pXform-&gt;Apply(pApply, DstColorName, pSrc);</div>
<div class="line"><span class="lineno">10021</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10022</span> </div>
<div class="line"><span class="lineno">10023</span>      <span class="keywordflow">case</span> icApplyPixel2Pixel:</div>
<div class="line"><span class="lineno">10024</span>      <span class="keywordflow">case</span> icApplyNamed2Pixel:</div>
<div class="line"><span class="lineno">10025</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">10026</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno">10027</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10028</span>      }</div>
<div class="line"><span class="lineno">10029</span>    }</div>
<div class="line"><span class="lineno">10030</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10031</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno">10032</span>    }</div>
<div class="line"><span class="lineno">10033</span> </div>
<div class="line"><span class="lineno">10034</span>  }</div>
<div class="line"><span class="lineno">10035</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n==1) {</div>
<div class="line"><span class="lineno">10036</span>    i = m_Xforms-&gt;begin();</div>
<div class="line"><span class="lineno">10037</span>    pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno">10038</span>    pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno">10039</span>    <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>) {</div>
<div class="line"><span class="lineno">10040</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno">10041</span>    }</div>
<div class="line"><span class="lineno">10042</span> </div>
<div class="line"><span class="lineno">10043</span>    pXform = (CIccXformNamedColor*)pApplyXform;</div>
<div class="line"><span class="lineno">10044</span>    pXform-&gt;Apply(pApply, DstColorName, pSrc);</div>
<div class="line"><span class="lineno">10045</span>  }</div>
<div class="line"><span class="lineno">10046</span> </div>
<div class="line"><span class="lineno">10047</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno">10048</span>}</div>
<div class="line"><span class="lineno">10049</span> </div>
<div class="line"><span class="lineno">10050</span> </div>
<div class="line"><span class="lineno">10063</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccApplyNamedColorCmm::Apply(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a> *SrcColorName, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> tint<span class="comment">/*=1.0*/</span>)</div>
<div class="line"><span class="lineno">10064</span>{</div>
<div class="line"><span class="lineno">10065</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, *pTmp;</div>
<div class="line"><span class="lineno">10066</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc;</div>
<div class="line"><span class="lineno">10067</span>  CIccApplyXformList::iterator i;</div>
<div class="line"><span class="lineno">10068</span>  <span class="keywordtype">int</span> j, n = (int)m_Xforms-&gt;size();</div>
<div class="line"><span class="lineno">10069</span>  CIccApplyXform *pApply;</div>
<div class="line"><span class="lineno">10070</span>  <span class="keyword">const</span> CIccXform *pApplyXform;</div>
<div class="line"><span class="lineno">10071</span>  CIccXformNamedColor *pXform;</div>
<div class="line"><span class="lineno">10072</span> </div>
<div class="line"><span class="lineno">10073</span>  <span class="keywordflow">if</span> (!n)</div>
<div class="line"><span class="lineno">10074</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno">10075</span> </div>
<div class="line"><span class="lineno">10076</span>  <span class="keywordflow">if</span> (!m_Pixel &amp;&amp; !InitPixel()) {</div>
<div class="line"><span class="lineno">10077</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno">10078</span>  }</div>
<div class="line"><span class="lineno">10079</span> </div>
<div class="line"><span class="lineno">10080</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a> NamedColor[255];</div>
<div class="line"><span class="lineno">10081</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv;</div>
<div class="line"><span class="lineno">10082</span> </div>
<div class="line"><span class="lineno">10083</span>  i=m_Xforms-&gt;begin();</div>
<div class="line"><span class="lineno">10084</span>  pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno">10085</span>  pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno">10086</span>  <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>)</div>
<div class="line"><span class="lineno">10087</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno">10088</span> </div>
<div class="line"><span class="lineno">10089</span>  pXform = (CIccXformNamedColor*)pApplyXform;  </div>
<div class="line"><span class="lineno">10090</span> </div>
<div class="line"><span class="lineno">10091</span>  pDst = m_Pixel;</div>
<div class="line"><span class="lineno">10092</span> </div>
<div class="line"><span class="lineno">10093</span>  <span class="keywordflow">if</span> (n&gt;1) {</div>
<div class="line"><span class="lineno">10094</span>    rv = pXform-&gt;Apply(pApply, pDst, SrcColorName, tint);</div>
<div class="line"><span class="lineno">10095</span>    <span class="keywordflow">if</span> (rv) {</div>
<div class="line"><span class="lineno">10096</span>      <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10097</span>    }</div>
<div class="line"><span class="lineno">10098</span> </div>
<div class="line"><span class="lineno">10099</span>    pSrc = pDst;</div>
<div class="line"><span class="lineno">10100</span>    pDst = m_Pixel2;</div>
<div class="line"><span class="lineno">10101</span> </div>
<div class="line"><span class="lineno">10102</span>    <span class="keywordflow">for</span> (j=0, i++; j&lt;n-2 &amp;&amp; i!=m_Xforms-&gt;end(); i++, j++) {</div>
<div class="line"><span class="lineno">10103</span> </div>
<div class="line"><span class="lineno">10104</span>      pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno">10105</span>      pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno">10106</span>      <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>) {</div>
<div class="line"><span class="lineno">10107</span>        CIccXformNamedColor *pXform = (CIccXformNamedColor*)pApplyXform;</div>
<div class="line"><span class="lineno">10108</span>        <span class="keywordflow">switch</span>(pXform-&gt;GetInterface()) {</div>
<div class="line"><span class="lineno">10109</span>        <span class="keywordflow">case</span> icApplyPixel2Pixel:</div>
<div class="line"><span class="lineno">10110</span>          pXform-&gt;Apply(pApply, pDst, pSrc);</div>
<div class="line"><span class="lineno">10111</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10112</span> </div>
<div class="line"><span class="lineno">10113</span>        <span class="keywordflow">case</span> icApplyPixel2Named:</div>
<div class="line"><span class="lineno">10114</span>          pXform-&gt;Apply(pApply, NamedColor, pSrc);</div>
<div class="line"><span class="lineno">10115</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10116</span> </div>
<div class="line"><span class="lineno">10117</span>        <span class="keywordflow">case</span> icApplyNamed2Pixel:</div>
<div class="line"><span class="lineno">10118</span>          rv = pXform-&gt;Apply(pApply, pDst, NamedColor);</div>
<div class="line"><span class="lineno">10119</span>          <span class="keywordflow">if</span> (rv) {</div>
<div class="line"><span class="lineno">10120</span>            <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10121</span>          }</div>
<div class="line"><span class="lineno">10122</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10123</span> </div>
<div class="line"><span class="lineno">10124</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">10125</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10126</span>        }</div>
<div class="line"><span class="lineno">10127</span>      }</div>
<div class="line"><span class="lineno">10128</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10129</span>        pApplyXform-&gt;Apply(pApply, pDst, pSrc);</div>
<div class="line"><span class="lineno">10130</span>      }</div>
<div class="line"><span class="lineno">10131</span>      pTmp = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>*)pSrc;</div>
<div class="line"><span class="lineno">10132</span>      pSrc = pDst;</div>
<div class="line"><span class="lineno">10133</span>      pDst = pTmp;</div>
<div class="line"><span class="lineno">10134</span>    }</div>
<div class="line"><span class="lineno">10135</span> </div>
<div class="line"><span class="lineno">10136</span>    pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno">10137</span>    pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno">10138</span>    <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>) {</div>
<div class="line"><span class="lineno">10139</span>      pXform = (CIccXformNamedColor*)pApplyXform;</div>
<div class="line"><span class="lineno">10140</span>      <span class="keywordflow">switch</span>(pXform-&gt;GetInterface()) {</div>
<div class="line"><span class="lineno">10141</span>      <span class="keywordflow">case</span> icApplyPixel2Pixel:</div>
<div class="line"><span class="lineno">10142</span>        pXform-&gt;Apply(pApply, DstPixel, pSrc);</div>
<div class="line"><span class="lineno">10143</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10144</span> </div>
<div class="line"><span class="lineno">10145</span>      <span class="keywordflow">case</span> icApplyPixel2Named:</div>
<div class="line"><span class="lineno">10146</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">10147</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno">10148</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10149</span> </div>
<div class="line"><span class="lineno">10150</span>      <span class="keywordflow">case</span> icApplyNamed2Pixel:</div>
<div class="line"><span class="lineno">10151</span>        rv = pXform-&gt;Apply(pApply, DstPixel, NamedColor);</div>
<div class="line"><span class="lineno">10152</span>        <span class="keywordflow">if</span> (rv) {</div>
<div class="line"><span class="lineno">10153</span>          <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10154</span>        }</div>
<div class="line"><span class="lineno">10155</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10156</span> </div>
<div class="line"><span class="lineno">10157</span>      }</div>
<div class="line"><span class="lineno">10158</span>    }</div>
<div class="line"><span class="lineno">10159</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10160</span>      pApplyXform-&gt;Apply(pApply, DstPixel, pSrc);</div>
<div class="line"><span class="lineno">10161</span>    }</div>
<div class="line"><span class="lineno">10162</span> </div>
<div class="line"><span class="lineno">10163</span>  }</div>
<div class="line"><span class="lineno">10164</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n==1) {</div>
<div class="line"><span class="lineno">10165</span>    rv = pXform-&gt;Apply(pApply, DstPixel, SrcColorName, tint);</div>
<div class="line"><span class="lineno">10166</span>    <span class="keywordflow">if</span> (rv) {</div>
<div class="line"><span class="lineno">10167</span>      <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10168</span>    }</div>
<div class="line"><span class="lineno">10169</span>  }</div>
<div class="line"><span class="lineno">10170</span> </div>
<div class="line"><span class="lineno">10171</span> </div>
<div class="line"><span class="lineno">10172</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno">10173</span>}</div>
<div class="line"><span class="lineno">10174</span> </div>
<div class="line"><span class="lineno">10187</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccApplyNamedColorCmm::Apply(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a> *DstColorName, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a> *SrcColorName, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> tint<span class="comment">/*=1.0*/</span>)</div>
<div class="line"><span class="lineno">10188</span>{</div>
<div class="line"><span class="lineno">10189</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pDst, *pTmp;</div>
<div class="line"><span class="lineno">10190</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *pSrc;</div>
<div class="line"><span class="lineno">10191</span>  CIccApplyXformList::iterator i;</div>
<div class="line"><span class="lineno">10192</span>  <span class="keywordtype">int</span> j, n = (int)m_Xforms-&gt;size();</div>
<div class="line"><span class="lineno">10193</span>  <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a> NamedColor[256];</div>
<div class="line"><span class="lineno">10194</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv;</div>
<div class="line"><span class="lineno">10195</span>  CIccApplyXform *pApply;</div>
<div class="line"><span class="lineno">10196</span>  <span class="keyword">const</span> CIccXform *pApplyXform;</div>
<div class="line"><span class="lineno">10197</span>  CIccXformNamedColor *pXform;</div>
<div class="line"><span class="lineno">10198</span> </div>
<div class="line"><span class="lineno">10199</span>  <span class="keywordflow">if</span> (!n)</div>
<div class="line"><span class="lineno">10200</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno">10201</span> </div>
<div class="line"><span class="lineno">10202</span>  <span class="keywordflow">if</span> (!m_Pixel &amp;&amp; !InitPixel()) {</div>
<div class="line"><span class="lineno">10203</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno">10204</span>  }</div>
<div class="line"><span class="lineno">10205</span> </div>
<div class="line"><span class="lineno">10206</span>  i=m_Xforms-&gt;begin();</div>
<div class="line"><span class="lineno">10207</span> </div>
<div class="line"><span class="lineno">10208</span>  pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno">10209</span>  pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno">10210</span>  <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>)</div>
<div class="line"><span class="lineno">10211</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno">10212</span> </div>
<div class="line"><span class="lineno">10213</span>  pXform = (CIccXformNamedColor*)pApplyXform;</div>
<div class="line"><span class="lineno">10214</span> </div>
<div class="line"><span class="lineno">10215</span>  pDst = m_Pixel;</div>
<div class="line"><span class="lineno">10216</span> </div>
<div class="line"><span class="lineno">10217</span>  <span class="keywordflow">if</span> (n&gt;1) {</div>
<div class="line"><span class="lineno">10218</span>    rv = pXform-&gt;Apply(pApply, pDst, SrcColorName, tint);</div>
<div class="line"><span class="lineno">10219</span> </div>
<div class="line"><span class="lineno">10220</span>    <span class="keywordflow">if</span> (rv) {</div>
<div class="line"><span class="lineno">10221</span>      <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10222</span>    }</div>
<div class="line"><span class="lineno">10223</span> </div>
<div class="line"><span class="lineno">10224</span>    pSrc = pDst;</div>
<div class="line"><span class="lineno">10225</span>    pDst = m_Pixel2;</div>
<div class="line"><span class="lineno">10226</span> </div>
<div class="line"><span class="lineno">10227</span>    <span class="keywordflow">for</span> (j=0, i++; j&lt;n-2 &amp;&amp; i!=m_Xforms-&gt;end(); i++, j++) {</div>
<div class="line"><span class="lineno">10228</span> </div>
<div class="line"><span class="lineno">10229</span>      pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno">10230</span>      pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno">10231</span>      <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>) {</div>
<div class="line"><span class="lineno">10232</span>        pXform = (CIccXformNamedColor*)pApplyXform;</div>
<div class="line"><span class="lineno">10233</span>        <span class="keywordflow">switch</span>(pXform-&gt;GetInterface()) {</div>
<div class="line"><span class="lineno">10234</span>        <span class="keywordflow">case</span> icApplyPixel2Pixel:</div>
<div class="line"><span class="lineno">10235</span>          pXform-&gt;Apply(pApply, pDst, pSrc);</div>
<div class="line"><span class="lineno">10236</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10237</span> </div>
<div class="line"><span class="lineno">10238</span> </div>
<div class="line"><span class="lineno">10239</span>        <span class="keywordflow">case</span> icApplyPixel2Named:</div>
<div class="line"><span class="lineno">10240</span>          pXform-&gt;Apply(pApply, NamedColor, pSrc);</div>
<div class="line"><span class="lineno">10241</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10242</span> </div>
<div class="line"><span class="lineno">10243</span>        <span class="keywordflow">case</span> icApplyNamed2Pixel:</div>
<div class="line"><span class="lineno">10244</span>          rv = pXform-&gt;Apply(pApply, pDst, NamedColor);</div>
<div class="line"><span class="lineno">10245</span>          <span class="keywordflow">if</span> (rv) {</div>
<div class="line"><span class="lineno">10246</span>            <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10247</span>          }</div>
<div class="line"><span class="lineno">10248</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10249</span> </div>
<div class="line"><span class="lineno">10250</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">10251</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10252</span>        }</div>
<div class="line"><span class="lineno">10253</span>      }</div>
<div class="line"><span class="lineno">10254</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10255</span>        pApplyXform-&gt;Apply(pApply, pDst, pSrc);</div>
<div class="line"><span class="lineno">10256</span>      }</div>
<div class="line"><span class="lineno">10257</span>      pTmp = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>*)pSrc;</div>
<div class="line"><span class="lineno">10258</span>      pSrc = pDst;</div>
<div class="line"><span class="lineno">10259</span>      pDst = pTmp;</div>
<div class="line"><span class="lineno">10260</span>    }</div>
<div class="line"><span class="lineno">10261</span> </div>
<div class="line"><span class="lineno">10262</span>    pApply = i-&gt;ptr;</div>
<div class="line"><span class="lineno">10263</span>    pApplyXform = pApply-&gt;GetXform();</div>
<div class="line"><span class="lineno">10264</span>    <span class="keywordflow">if</span> (pApplyXform-&gt;GetXformType()==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>) {</div>
<div class="line"><span class="lineno">10265</span>      pXform = (CIccXformNamedColor*)pApplyXform;</div>
<div class="line"><span class="lineno">10266</span>      <span class="keywordflow">switch</span>(pXform-&gt;GetInterface()) {</div>
<div class="line"><span class="lineno">10267</span>      <span class="keywordflow">case</span> icApplyPixel2Named:</div>
<div class="line"><span class="lineno">10268</span>        pXform-&gt;Apply(pApply, DstColorName, pSrc);</div>
<div class="line"><span class="lineno">10269</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10270</span> </div>
<div class="line"><span class="lineno">10271</span>      <span class="keywordflow">case</span> icApplyPixel2Pixel:</div>
<div class="line"><span class="lineno">10272</span>      <span class="keywordflow">case</span> icApplyNamed2Pixel:</div>
<div class="line"><span class="lineno">10273</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">10274</span>        <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno">10275</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10276</span>      }</div>
<div class="line"><span class="lineno">10277</span>    }</div>
<div class="line"><span class="lineno">10278</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10279</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno">10280</span>    }</div>
<div class="line"><span class="lineno">10281</span> </div>
<div class="line"><span class="lineno">10282</span>  }</div>
<div class="line"><span class="lineno">10283</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (n==1) {</div>
<div class="line"><span class="lineno">10284</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a>;</div>
<div class="line"><span class="lineno">10285</span>  }</div>
<div class="line"><span class="lineno">10286</span> </div>
<div class="line"><span class="lineno">10287</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno">10288</span>}</div>
<div class="line"><span class="lineno">10289</span> </div>
<div class="line"><span class="lineno">10303</span>CIccNamedColorCmm::CIccNamedColorCmm(<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nSrcSpace, <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nDestSpace,</div>
<div class="line"><span class="lineno">10304</span>                                     <span class="keywordtype">bool</span> bFirstInput) : CIccCmm(nSrcSpace, nDestSpace, bFirstInput)</div>
<div class="line"><span class="lineno">10305</span>{</div>
<div class="line"><span class="lineno">10306</span>  m_nApplyInterface = icApplyPixel2Pixel;</div>
<div class="line"><span class="lineno">10307</span>}</div>
<div class="line"><span class="lineno">10308</span> </div>
<div class="line"><span class="lineno">10317</span>CIccNamedColorCmm::~CIccNamedColorCmm()</div>
<div class="line"><span class="lineno">10318</span>{</div>
<div class="line"><span class="lineno">10319</span>}</div>
<div class="line"><span class="lineno">10320</span> </div>
<div class="line"><span class="lineno">10321</span> </div>
<div class="line"><span class="lineno">10339</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccNamedColorCmm::AddXform(<span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a> *szProfilePath,</div>
<div class="line"><span class="lineno">10340</span>                                        <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nIntent <span class="comment">/*=icUnknownIntent*/</span>,</div>
<div class="line"><span class="lineno">10341</span>                                        <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913">icXformInterp</a> nInterp <span class="comment">/*icXformInterp*/</span>,</div>
<div class="line"><span class="lineno">10342</span>                                        <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc<span class="comment">/*=NULL*/</span>,</div>
<div class="line"><span class="lineno">10343</span>                                        <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7b">icXformLutType</a> nLutType <span class="comment">/*=icXformLutColor*/</span>,</div>
<div class="line"><span class="lineno">10344</span>                                        <span class="keywordtype">bool</span> bUseD2BxB2DxTags <span class="comment">/*=true*/</span>,</div>
<div class="line"><span class="lineno">10345</span>                                        CIccCreateXformHintManager *pHintManager <span class="comment">/*=NULL*/</span>,</div>
<div class="line"><span class="lineno">10346</span>                                        <span class="keywordtype">bool</span> bUseSubProfile <span class="comment">/*=false*/</span>)</div>
<div class="line"><span class="lineno">10347</span>{</div>
<div class="line"><span class="lineno">10348</span>  <a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile = <a class="code hl_function" href="../../d0/dc2/a00104.html#a97134bdd4b4bf5e8a43ef018bba0917e">OpenIccProfile</a>(szProfilePath, bUseSubProfile);</div>
<div class="line"><span class="lineno">10349</span> </div>
<div class="line"><span class="lineno">10350</span>  <span class="keywordflow">if</span> (!pProfile) </div>
<div class="line"><span class="lineno">10351</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a94a1cd52eec49dc84eac5993164c5be0">icCmmStatCantOpenProfile</a>;</div>
<div class="line"><span class="lineno">10352</span> </div>
<div class="line"><span class="lineno">10353</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv = AddXform(pProfile, nIntent, nInterp, pPcc, nLutType, bUseD2BxB2DxTags, pHintManager);</div>
<div class="line"><span class="lineno">10354</span> </div>
<div class="line"><span class="lineno">10355</span>  <span class="keywordflow">if</span> (rv != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>)</div>
<div class="line"><span class="lineno">10356</span>    <span class="keyword">delete</span> pProfile;</div>
<div class="line"><span class="lineno">10357</span> </div>
<div class="line"><span class="lineno">10358</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10359</span>}</div>
<div class="line"><span class="lineno">10360</span> </div>
<div class="line"><span class="lineno">10379</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccNamedColorCmm::AddXform(<a class="code hl_variable" href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a> *pProfile,</div>
<div class="line"><span class="lineno">10380</span>                                        <a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a> nIntent <span class="comment">/*=icUnknownIntent*/</span>,</div>
<div class="line"><span class="lineno">10381</span>                                        <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913">icXformInterp</a> nInterp <span class="comment">/*=icInterpLinear*/</span>,</div>
<div class="line"><span class="lineno">10382</span>                                        <a class="code hl_class" href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a> *pPcc<span class="comment">/*=NULL*/</span>,</div>
<div class="line"><span class="lineno">10383</span>                                        <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7b">icXformLutType</a> nLutType <span class="comment">/*=icXformLutColor*/</span>,</div>
<div class="line"><span class="lineno">10384</span>                                        <span class="keywordtype">bool</span> bUseD2BxB2DxTags <span class="comment">/*=true*/</span>,</div>
<div class="line"><span class="lineno">10385</span>                                        CIccCreateXformHintManager *pHintManager <span class="comment">/*=NULL*/</span>)</div>
<div class="line"><span class="lineno">10386</span>{</div>
<div class="line"><span class="lineno">10387</span>  <a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nSrcSpace, nDstSpace;</div>
<div class="line"><span class="lineno">10388</span>  CIccXformPtr Xform;</div>
<div class="line"><span class="lineno">10389</span>  <span class="keywordtype">bool</span> bInput = !m_bLastInput;</div>
<div class="line"><span class="lineno">10390</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv;</div>
<div class="line"><span class="lineno">10391</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7b">icXformLutType</a> nUseLutType = nLutType;</div>
<div class="line"><span class="lineno">10392</span> </div>
<div class="line"><span class="lineno">10393</span>  <span class="keywordflow">switch</span>(pProfile-&gt;m_Header.deviceClass) {</div>
<div class="line"><span class="lineno">10394</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0aeb74955777b1abe38df700474c7be5ce">icSigMaterialIdentificationClass</a>:</div>
<div class="line"><span class="lineno">10395</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a8b2deae24b9246ac33314b42ad02ac48">icSigMaterialLinkClass</a>:</div>
<div class="line"><span class="lineno">10396</span>      nIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a>;</div>
<div class="line"><span class="lineno">10397</span>      nLutType = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153">icXformLutMCS</a>;</div>
<div class="line"><span class="lineno">10398</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10399</span> </div>
<div class="line"><span class="lineno">10400</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f">icSigMaterialVisualizationClass</a>:</div>
<div class="line"><span class="lineno">10401</span>      nLutType = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153">icXformLutMCS</a>;</div>
<div class="line"><span class="lineno">10402</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10403</span> </div>
<div class="line"><span class="lineno">10404</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">10405</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10406</span>  }</div>
<div class="line"><span class="lineno">10407</span> </div>
<div class="line"><span class="lineno">10408</span>  Xform.ptr = NULL;</div>
<div class="line"><span class="lineno">10409</span>  <span class="keywordflow">switch</span> (nUseLutType) {</div>
<div class="line"><span class="lineno">10410</span>    <span class="comment">//Automatically choose which one</span></div>
<div class="line"><span class="lineno">10411</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614">icXformLutColor</a>:</div>
<div class="line"><span class="lineno">10412</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013">icXformLutColorimetric</a>:</div>
<div class="line"><span class="lineno">10413</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262">icXformLutSpectral</a>:</div>
<div class="line"><span class="lineno">10414</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba0b1f2aadd55b74ea25adc32e3cadf4c0">icXformLutNamedColor</a>:</div>
<div class="line"><span class="lineno">10415</span>    {</div>
<div class="line"><span class="lineno">10416</span>      <a class="code hl_class" href="../../d7/dfd/a00969.html">CIccTag</a> *pTag = pProfile-&gt;FindTag(<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ac9a9457a436bbfaa9212552f337d2beb">icSigNamedColor2Tag</a>);</div>
<div class="line"><span class="lineno">10417</span> </div>
<div class="line"><span class="lineno">10418</span>      <span class="keywordflow">if</span> (pTag &amp;&amp; (pProfile-&gt;m_Header.deviceClass==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0ac1881705b3792813f8ef0745b7a12170">icSigNamedColorClass</a> || nLutType == <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba0b1f2aadd55b74ea25adc32e3cadf4c0">icXformLutNamedColor</a>)) {</div>
<div class="line"><span class="lineno">10419</span>        <span class="keywordflow">if</span> (bInput) {</div>
<div class="line"><span class="lineno">10420</span>          nSrcSpace = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>;</div>
<div class="line"><span class="lineno">10421</span>        }</div>
<div class="line"><span class="lineno">10422</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (nLutType == <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262">icXformLutSpectral</a> || ((bUseD2BxB2DxTags || !pProfile-&gt;m_Header.pcs) &amp;&amp; pProfile-&gt;m_Header.spectralPCS &amp;&amp; nLutType != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013">icXformLutColorimetric</a>)) {</div>
<div class="line"><span class="lineno">10423</span>          nSrcSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.spectralPCS;</div>
<div class="line"><span class="lineno">10424</span>          bUseD2BxB2DxTags = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">10425</span>        }</div>
<div class="line"><span class="lineno">10426</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10427</span>          nSrcSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno">10428</span>        }</div>
<div class="line"><span class="lineno">10429</span> </div>
<div class="line"><span class="lineno">10430</span>        <span class="keywordflow">if</span> (!m_Xforms-&gt;size()) {</div>
<div class="line"><span class="lineno">10431</span>          <span class="keywordflow">if</span> (m_nSrcSpace==<a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a>) {</div>
<div class="line"><span class="lineno">10432</span>            m_nSrcSpace = nSrcSpace;</div>
<div class="line"><span class="lineno">10433</span>          }</div>
<div class="line"><span class="lineno">10434</span>          <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10435</span>            nSrcSpace = m_nSrcSpace;</div>
<div class="line"><span class="lineno">10436</span>          }</div>
<div class="line"><span class="lineno">10437</span>        }</div>
<div class="line"><span class="lineno">10438</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10439</span>          <span class="keywordflow">if</span> (m_nLastSpace==<a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a>) {</div>
<div class="line"><span class="lineno">10440</span>            m_nLastSpace = nSrcSpace;</div>
<div class="line"><span class="lineno">10441</span>          }</div>
<div class="line"><span class="lineno">10442</span>          <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10443</span>            nSrcSpace = m_nLastSpace;</div>
<div class="line"><span class="lineno">10444</span>          }</div>
<div class="line"><span class="lineno">10445</span>        }</div>
<div class="line"><span class="lineno">10446</span> </div>
<div class="line"><span class="lineno">10447</span>        <span class="keywordflow">if</span> (nSrcSpace==<a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>) {</div>
<div class="line"><span class="lineno">10448</span>          <span class="keywordflow">if</span> (nLutType == <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262">icXformLutSpectral</a> || (bUseD2BxB2DxTags &amp;&amp; pProfile-&gt;m_Header.spectralPCS &amp;&amp; nLutType != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013">icXformLutColorimetric</a>)) {</div>
<div class="line"><span class="lineno">10449</span>            nDstSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.spectralPCS; </div>
<div class="line"><span class="lineno">10450</span>            bUseD2BxB2DxTags = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">10451</span>          }</div>
<div class="line"><span class="lineno">10452</span>          <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10453</span>            nDstSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno">10454</span>          }</div>
<div class="line"><span class="lineno">10455</span>          bInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">10456</span>        }</div>
<div class="line"><span class="lineno">10457</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10458</span>          nDstSpace = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>;</div>
<div class="line"><span class="lineno">10459</span>          bInput = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">10460</span>        }</div>
<div class="line"><span class="lineno">10461</span> </div>
<div class="line"><span class="lineno">10462</span>        Xform.ptr = CIccXform::Create(pProfile, bInput, nIntent, nInterp, pPcc, <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba0b1f2aadd55b74ea25adc32e3cadf4c0">icXformLutNamedColor</a>, bUseD2BxB2DxTags, pHintManager);</div>
<div class="line"><span class="lineno">10463</span>        <span class="keywordflow">if</span> (!Xform.ptr) {</div>
<div class="line"><span class="lineno">10464</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno">10465</span>        }</div>
<div class="line"><span class="lineno">10466</span>        CIccXformNamedColor *pXform = (CIccXformNamedColor *)Xform.ptr;</div>
<div class="line"><span class="lineno">10467</span>        rv = pXform-&gt;SetSrcSpace(nSrcSpace);</div>
<div class="line"><span class="lineno">10468</span>        <span class="keywordflow">if</span> (rv)</div>
<div class="line"><span class="lineno">10469</span>          <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10470</span> </div>
<div class="line"><span class="lineno">10471</span>        rv = pXform-&gt;SetDestSpace(nDstSpace);</div>
<div class="line"><span class="lineno">10472</span>        <span class="keywordflow">if</span> (rv)</div>
<div class="line"><span class="lineno">10473</span>          <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10474</span>      }</div>
<div class="line"><span class="lineno">10475</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10476</span>        <span class="comment">//It isn&#39;t named color so make we will use color lut.</span></div>
<div class="line"><span class="lineno">10477</span>        <span class="keywordflow">if</span> (nUseLutType==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba0b1f2aadd55b74ea25adc32e3cadf4c0">icXformLutNamedColor</a>)</div>
<div class="line"><span class="lineno">10478</span>          nUseLutType = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614">icXformLutColor</a>;</div>
<div class="line"><span class="lineno">10479</span> </div>
<div class="line"><span class="lineno">10480</span>        <span class="comment">//Check pProfile if nIntent and input can be found.</span></div>
<div class="line"><span class="lineno">10481</span>        <span class="keywordflow">if</span> (bInput) {</div>
<div class="line"><span class="lineno">10482</span>          nSrcSpace = pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno">10483</span> </div>
<div class="line"><span class="lineno">10484</span>          <span class="keywordflow">if</span> (nLutType == <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262">icXformLutSpectral</a> || ((bUseD2BxB2DxTags || !pProfile-&gt;m_Header.pcs) &amp;&amp; pProfile-&gt;m_Header.spectralPCS &amp;&amp; nLutType != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013">icXformLutColorimetric</a>)) {</div>
<div class="line"><span class="lineno">10485</span>            nDstSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.spectralPCS;</div>
<div class="line"><span class="lineno">10486</span>            bUseD2BxB2DxTags = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">10487</span>          }</div>
<div class="line"><span class="lineno">10488</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">10489</span>            nDstSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno">10490</span>        }</div>
<div class="line"><span class="lineno">10491</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10492</span>          <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0af50c13fdfab9fcc0a7b831ac86d1fe3b">icSigLinkClass</a>) {</div>
<div class="line"><span class="lineno">10493</span>            <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno">10494</span>          }</div>
<div class="line"><span class="lineno">10495</span>          <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a200e4fc8dcec29c6d411cae0c9a0483c">icSigAbstractClass</a>) {</div>
<div class="line"><span class="lineno">10496</span>            bInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">10497</span>            nIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a>; <span class="comment">// Note: icPerceptualIntent = 0</span></div>
<div class="line"><span class="lineno">10498</span>          }</div>
<div class="line"><span class="lineno">10499</span> </div>
<div class="line"><span class="lineno">10500</span>          <span class="keywordflow">if</span> (nLutType == <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262">icXformLutSpectral</a> || ((bUseD2BxB2DxTags || !pProfile-&gt;m_Header.pcs) &amp;&amp; pProfile-&gt;m_Header.spectralPCS &amp;&amp; nLutType != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013">icXformLutColorimetric</a>)) {</div>
<div class="line"><span class="lineno">10501</span>            nSrcSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.spectralPCS;</div>
<div class="line"><span class="lineno">10502</span>            bUseD2BxB2DxTags = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">10503</span>          }</div>
<div class="line"><span class="lineno">10504</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">10505</span>            nSrcSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno">10506</span> </div>
<div class="line"><span class="lineno">10507</span>          nDstSpace = pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno">10508</span>        }</div>
<div class="line"><span class="lineno">10509</span>      }</div>
<div class="line"><span class="lineno">10510</span>    }</div>
<div class="line"><span class="lineno">10511</span>    <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10512</span> </div>
<div class="line"><span class="lineno">10513</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7baeb0501fdc1dcc7f1388f0fdca9b17356">icXformLutPreview</a>:</div>
<div class="line"><span class="lineno">10514</span>      nSrcSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno">10515</span>      nDstSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno">10516</span>      bInput = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">10517</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10518</span> </div>
<div class="line"><span class="lineno">10519</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba6df311bd7dc6c9c9284ad186b15f53de">icXformLutGamut</a>:</div>
<div class="line"><span class="lineno">10520</span>      nSrcSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno">10521</span>      nDstSpace = <a class="code hl_define" href="../../d7/d46/a00002.html#af63f30724bd4cfbb6b7e3e2d7b1b602e">icSigGamutData</a>;</div>
<div class="line"><span class="lineno">10522</span>      bInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">10523</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10524</span> </div>
<div class="line"><span class="lineno">10525</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7baf26b30e0e73bf289c23075e2f6106e6d">icXformLutBRDFParam</a>:</div>
<div class="line"><span class="lineno">10526</span>      nSrcSpace = pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno">10527</span>      nDstSpace = <a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a>;</div>
<div class="line"><span class="lineno">10528</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10529</span> </div>
<div class="line"><span class="lineno">10530</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba1109d56a39fd11938962b487d6f965b8">icXformLutBRDFDirect</a>:</div>
<div class="line"><span class="lineno">10531</span>      nSrcSpace = pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno">10532</span>      nDstSpace = <a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a>;</div>
<div class="line"><span class="lineno">10533</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10534</span> </div>
<div class="line"><span class="lineno">10535</span>    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153">icXformLutMCS</a>:</div>
<div class="line"><span class="lineno">10536</span>      <span class="keywordflow">switch</span>(pProfile-&gt;m_Header.deviceClass)</div>
<div class="line"><span class="lineno">10537</span>      {</div>
<div class="line"><span class="lineno">10538</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a787f32c0c9368bc8c4e85a670ae91c8d">icSigInputClass</a>:</div>
<div class="line"><span class="lineno">10539</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0aeb74955777b1abe38df700474c7be5ce">icSigMaterialIdentificationClass</a>:</div>
<div class="line"><span class="lineno">10540</span>          nSrcSpace = pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno">10541</span>          nDstSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.mcs;</div>
<div class="line"><span class="lineno">10542</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10543</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f">icSigMaterialVisualizationClass</a>:</div>
<div class="line"><span class="lineno">10544</span>          nSrcSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.mcs;</div>
<div class="line"><span class="lineno">10545</span>          <span class="keywordflow">if</span> (bUseD2BxB2DxTags &amp;&amp; pProfile-&gt;m_Header.spectralPCS) {</div>
<div class="line"><span class="lineno">10546</span>            nDstSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.spectralPCS;</div>
<div class="line"><span class="lineno">10547</span>          }</div>
<div class="line"><span class="lineno">10548</span>          <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10549</span>            nDstSpace = pProfile-&gt;m_Header.pcs;</div>
<div class="line"><span class="lineno">10550</span>          }</div>
<div class="line"><span class="lineno">10551</span>          bInput = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">10552</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10553</span> </div>
<div class="line"><span class="lineno">10554</span>        <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a8b2deae24b9246ac33314b42ad02ac48">icSigMaterialLinkClass</a>:</div>
<div class="line"><span class="lineno">10555</span>          nSrcSpace = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a>)pProfile-&gt;m_Header.mcs;</div>
<div class="line"><span class="lineno">10556</span>          nDstSpace = pProfile-&gt;m_Header.colorSpace;</div>
<div class="line"><span class="lineno">10557</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10558</span> </div>
<div class="line"><span class="lineno">10559</span>        <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">10560</span>          <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a0a3d499218e996db890cba097db15f3b">icCmmStatBadLutType</a>;</div>
<div class="line"><span class="lineno">10561</span>      }</div>
<div class="line"><span class="lineno">10562</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">10563</span> </div>
<div class="line"><span class="lineno">10564</span>    <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">10565</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a0a3d499218e996db890cba097db15f3b">icCmmStatBadLutType</a>;</div>
<div class="line"><span class="lineno">10566</span>  }</div>
<div class="line"><span class="lineno">10567</span> </div>
<div class="line"><span class="lineno">10568</span>  <span class="comment">//Make sure color spaces match with previous xforms</span></div>
<div class="line"><span class="lineno">10569</span>  <span class="keywordflow">if</span> (!m_Xforms-&gt;size()) {</div>
<div class="line"><span class="lineno">10570</span>    <span class="keywordflow">if</span> (m_nSrcSpace == <a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a>) {</div>
<div class="line"><span class="lineno">10571</span>      m_nLastSpace = nSrcSpace;</div>
<div class="line"><span class="lineno">10572</span>      m_nSrcSpace = nSrcSpace;</div>
<div class="line"><span class="lineno">10573</span>    }</div>
<div class="line"><span class="lineno">10574</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d3/df8/a00155.html#a1376d1bc8bb70237fde226cb6f49872c">IsCompatSpace</a>(m_nSrcSpace, nSrcSpace) &amp;&amp; !<a class="code hl_define" href="../../d3/df8/a00155.html#ab304d4f0fe0c22e5b3e078e9ab1e7085">IsNChannelCompat</a>(m_nSrcSpace, nSrcSpace)) {</div>
<div class="line"><span class="lineno">10575</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno">10576</span>    }</div>
<div class="line"><span class="lineno">10577</span>  }</div>
<div class="line"><span class="lineno">10578</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d3/df8/a00155.html#a1376d1bc8bb70237fde226cb6f49872c">IsCompatSpace</a>(m_nLastSpace, nSrcSpace) &amp;&amp; !<a class="code hl_define" href="../../d3/df8/a00155.html#ab304d4f0fe0c22e5b3e078e9ab1e7085">IsNChannelCompat</a>(m_nSrcSpace, nSrcSpace))  {</div>
<div class="line"><span class="lineno">10579</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno">10580</span>  }</div>
<div class="line"><span class="lineno">10581</span> </div>
<div class="line"><span class="lineno">10582</span>  <span class="keywordflow">if</span> (!m_Xforms-&gt;size())</div>
<div class="line"><span class="lineno">10583</span>    m_nSrcSpace = nSrcSpace;</div>
<div class="line"><span class="lineno">10584</span> </div>
<div class="line"><span class="lineno">10585</span>  m_nDestSpace = nDstSpace;</div>
<div class="line"><span class="lineno">10586</span> </div>
<div class="line"><span class="lineno">10587</span>  <span class="comment">//Automatic creation of intent from header/last profile</span></div>
<div class="line"><span class="lineno">10588</span>  <span class="keywordflow">if</span> (nIntent==<a class="code hl_define" href="../../d7/d46/a00002.html#a0fbdbf76357f4ad739b1df71bd87ef8a">icUnknownIntent</a>) {</div>
<div class="line"><span class="lineno">10589</span>    <span class="keywordflow">if</span> (bInput) {</div>
<div class="line"><span class="lineno">10590</span>      nIntent = (<a class="code hl_enumeration" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a>)pProfile-&gt;m_Header.renderingIntent;</div>
<div class="line"><span class="lineno">10591</span>    }</div>
<div class="line"><span class="lineno">10592</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10593</span>      nIntent = m_nLastIntent;</div>
<div class="line"><span class="lineno">10594</span>    }</div>
<div class="line"><span class="lineno">10595</span>    <span class="keywordflow">if</span> (nIntent == <a class="code hl_define" href="../../d7/d46/a00002.html#a0fbdbf76357f4ad739b1df71bd87ef8a">icUnknownIntent</a>)</div>
<div class="line"><span class="lineno">10596</span>      nIntent = <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a>;</div>
<div class="line"><span class="lineno">10597</span>  }</div>
<div class="line"><span class="lineno">10598</span> </div>
<div class="line"><span class="lineno">10599</span>  <span class="keywordflow">if</span> (!Xform.ptr)</div>
<div class="line"><span class="lineno">10600</span>    Xform.ptr = CIccXform::Create(pProfile, bInput, nIntent, nInterp, pPcc, nUseLutType, bUseD2BxB2DxTags, pHintManager);</div>
<div class="line"><span class="lineno">10601</span> </div>
<div class="line"><span class="lineno">10602</span>  <span class="keywordflow">if</span> (!Xform.ptr) {</div>
<div class="line"><span class="lineno">10603</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno">10604</span>  }</div>
<div class="line"><span class="lineno">10605</span> </div>
<div class="line"><span class="lineno">10606</span>  m_nLastSpace = Xform.ptr-&gt;GetDstSpace();</div>
<div class="line"><span class="lineno">10607</span>  m_nLastIntent = nIntent;</div>
<div class="line"><span class="lineno">10608</span> </div>
<div class="line"><span class="lineno">10609</span>  <span class="keywordflow">if</span> (pProfile-&gt;m_Header.deviceClass == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0af50c13fdfab9fcc0a7b831ac86d1fe3b">icSigLinkClass</a>)</div>
<div class="line"><span class="lineno">10610</span>    bInput = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">10611</span>  m_bLastInput = bInput;</div>
<div class="line"><span class="lineno">10612</span>  </div>
<div class="line"><span class="lineno">10613</span>  m_Xforms-&gt;push_back(Xform);</div>
<div class="line"><span class="lineno">10614</span> </div>
<div class="line"><span class="lineno">10615</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno">10616</span>}</div>
<div class="line"><span class="lineno">10617</span> </div>
<div class="line"><span class="lineno">10628</span> <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccNamedColorCmm::Begin(<span class="keywordtype">bool</span> bAllocNewApply<span class="comment">/* =true */</span>, <span class="keywordtype">bool</span> bUsePcsConversion<span class="comment">/*=false*/</span>)</div>
<div class="line"><span class="lineno">10629</span>{</div>
<div class="line"><span class="lineno">10630</span>  <span class="keywordflow">if</span> (m_nDestSpace==<a class="code hl_define" href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a>) {</div>
<div class="line"><span class="lineno">10631</span>    m_nDestSpace = m_nLastSpace;</div>
<div class="line"><span class="lineno">10632</span>  }</div>
<div class="line"><span class="lineno">10633</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!<a class="code hl_define" href="../../d3/df8/a00155.html#a1376d1bc8bb70237fde226cb6f49872c">IsCompatSpace</a>(m_nDestSpace, m_nLastSpace) &amp;&amp; !<a class="code hl_define" href="../../d3/df8/a00155.html#a95cfb076604d7bea59905ba50253b1d2">IsCompatSpacePCS</a>(m_nDestSpace, m_nLastSpace)) {</div>
<div class="line"><span class="lineno">10634</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno">10635</span>  }</div>
<div class="line"><span class="lineno">10636</span> </div>
<div class="line"><span class="lineno">10637</span>  <span class="keywordflow">if</span> (m_nSrcSpace != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>) {</div>
<div class="line"><span class="lineno">10638</span>    <span class="keywordflow">if</span> (m_nDestSpace != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>) {</div>
<div class="line"><span class="lineno">10639</span>      m_nApplyInterface = icApplyPixel2Pixel;</div>
<div class="line"><span class="lineno">10640</span>    }</div>
<div class="line"><span class="lineno">10641</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10642</span>      m_nApplyInterface = icApplyPixel2Named;</div>
<div class="line"><span class="lineno">10643</span>    }</div>
<div class="line"><span class="lineno">10644</span>  }</div>
<div class="line"><span class="lineno">10645</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10646</span>    <span class="keywordflow">if</span> (m_nDestSpace != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>) {</div>
<div class="line"><span class="lineno">10647</span>      m_nApplyInterface = icApplyNamed2Pixel;</div>
<div class="line"><span class="lineno">10648</span>    }</div>
<div class="line"><span class="lineno">10649</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">10650</span>      m_nApplyInterface = icApplyNamed2Named;</div>
<div class="line"><span class="lineno">10651</span>    }</div>
<div class="line"><span class="lineno">10652</span>  }</div>
<div class="line"><span class="lineno">10653</span> </div>
<div class="line"><span class="lineno">10654</span>  CheckPCSRangeConversions();</div>
<div class="line"><span class="lineno">10655</span>  SetLateBindingCC();</div>
<div class="line"><span class="lineno">10656</span> </div>
<div class="line"><span class="lineno">10657</span>  <a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> rv;</div>
<div class="line"><span class="lineno">10658</span>  CIccXformList::iterator i;</div>
<div class="line"><span class="lineno">10659</span> </div>
<div class="line"><span class="lineno">10660</span>  <span class="keywordflow">for</span> (i=m_Xforms-&gt;begin(); i!=m_Xforms-&gt;end(); i++) {</div>
<div class="line"><span class="lineno">10661</span>    rv = i-&gt;ptr-&gt;Begin();</div>
<div class="line"><span class="lineno">10662</span> </div>
<div class="line"><span class="lineno">10663</span>    <span class="keywordflow">if</span> (rv!= <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno">10664</span>      <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10665</span>    }</div>
<div class="line"><span class="lineno">10666</span>  }</div>
<div class="line"><span class="lineno">10667</span> </div>
<div class="line"><span class="lineno">10668</span>  rv = CheckPCSConnections(bUsePcsConversion);</div>
<div class="line"><span class="lineno">10669</span>  <span class="keywordflow">if</span> (rv != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a> &amp;&amp; rv!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10">icCmmStatIdentityXform</a>)</div>
<div class="line"><span class="lineno">10670</span>    <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10671</span> </div>
<div class="line"><span class="lineno">10672</span>  <span class="keywordflow">if</span> (bAllocNewApply) {</div>
<div class="line"><span class="lineno">10673</span>    rv = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno">10674</span> </div>
<div class="line"><span class="lineno">10675</span>    m_pApply = GetNewApplyCmm(rv);</div>
<div class="line"><span class="lineno">10676</span>  }</div>
<div class="line"><span class="lineno">10677</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">10678</span>    rv = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno">10679</span> </div>
<div class="line"><span class="lineno">10680</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10681</span>}</div>
<div class="line"><span class="lineno">10682</span> </div>
<div class="line"><span class="lineno">10693</span> CIccApplyCmm *CIccNamedColorCmm::GetNewApplyCmm(<a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> &amp;status)</div>
<div class="line"><span class="lineno">10694</span> {</div>
<div class="line"><span class="lineno">10695</span>  CIccApplyCmm *pApply = <span class="keyword">new</span> CIccApplyNamedColorCmm(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno">10696</span> </div>
<div class="line"><span class="lineno">10697</span>  CIccXformList::iterator i;</div>
<div class="line"><span class="lineno">10698</span> </div>
<div class="line"><span class="lineno">10699</span>  <span class="keywordflow">for</span> (i=m_Xforms-&gt;begin(); i!=m_Xforms-&gt;end(); i++) {</div>
<div class="line"><span class="lineno">10700</span>    CIccApplyXform *pXform = i-&gt;ptr-&gt;GetNewApply(status);</div>
<div class="line"><span class="lineno">10701</span>    <span class="keywordflow">if</span> (status != <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a> || !pXform) {</div>
<div class="line"><span class="lineno">10702</span>      <span class="keyword">delete</span> pApply;</div>
<div class="line"><span class="lineno">10703</span>      <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">10704</span>    }</div>
<div class="line"><span class="lineno">10705</span>    pApply-&gt;AppendApplyXform(pXform);</div>
<div class="line"><span class="lineno">10706</span>  }</div>
<div class="line"><span class="lineno">10707</span> </div>
<div class="line"><span class="lineno">10708</span>  m_bValid = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">10709</span> </div>
<div class="line"><span class="lineno">10710</span>  status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno">10711</span>  <span class="keywordflow">return</span> pApply;</div>
<div class="line"><span class="lineno">10712</span>}</div>
<div class="line"><span class="lineno">10713</span> </div>
<div class="line"><span class="lineno">10714</span> </div>
<div class="line"><span class="lineno">10727</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccNamedColorCmm::Apply(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a>* DstColorName, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)</div>
<div class="line"><span class="lineno">10728</span>{</div>
<div class="line"><span class="lineno">10729</span>  <span class="keywordflow">return</span> ((CIccApplyNamedColorCmm*)m_pApply)-&gt;Apply(DstColorName, SrcPixel);</div>
<div class="line"><span class="lineno">10730</span>}</div>
<div class="line"><span class="lineno">10731</span> </div>
<div class="line"><span class="lineno">10732</span> </div>
<div class="line"><span class="lineno">10745</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccNamedColorCmm::Apply(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a> *SrcColorName, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> tint<span class="comment">/*=1.0*/</span>)</div>
<div class="line"><span class="lineno">10746</span>{</div>
<div class="line"><span class="lineno">10747</span>  <span class="keywordflow">return</span> ((CIccApplyNamedColorCmm*)m_pApply)-&gt;Apply(DstPixel, SrcColorName, tint);</div>
<div class="line"><span class="lineno">10748</span>}</div>
<div class="line"><span class="lineno">10749</span> </div>
<div class="line"><span class="lineno">10750</span> </div>
<div class="line"><span class="lineno">10763</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccNamedColorCmm::Apply(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a>* DstColorName, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a> *SrcColorName, <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> tint<span class="comment">/*=1.0*/</span>)</div>
<div class="line"><span class="lineno">10764</span>{</div>
<div class="line"><span class="lineno">10765</span>  <span class="keywordflow">return</span> ((CIccApplyNamedColorCmm*)m_pApply)-&gt;Apply(DstColorName, SrcColorName, tint);</div>
<div class="line"><span class="lineno">10766</span>}</div>
<div class="line"><span class="lineno">10767</span> </div>
<div class="line"><span class="lineno">10768</span> </div>
<div class="line"><span class="lineno">10780</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccNamedColorCmm::SetLastXformDest(<a class="code hl_enumeration" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a> nDestSpace)</div>
<div class="line"><span class="lineno">10781</span>{</div>
<div class="line"><span class="lineno">10782</span>  <span class="keywordtype">int</span> n = (int)m_Xforms-&gt;size();</div>
<div class="line"><span class="lineno">10783</span>  CIccXformPtr *pLastXform;</div>
<div class="line"><span class="lineno">10784</span> </div>
<div class="line"><span class="lineno">10785</span>  <span class="keywordflow">if</span> (!n)</div>
<div class="line"><span class="lineno">10786</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno">10787</span> </div>
<div class="line"><span class="lineno">10788</span>  pLastXform = &amp;m_Xforms-&gt;back();</div>
<div class="line"><span class="lineno">10789</span>  </div>
<div class="line"><span class="lineno">10790</span>  <span class="keywordflow">if</span> (pLastXform-&gt;ptr-&gt;GetXformType()==<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a>) {</div>
<div class="line"><span class="lineno">10791</span>    CIccXformNamedColor *pXform = (CIccXformNamedColor *)pLastXform-&gt;ptr;</div>
<div class="line"><span class="lineno">10792</span>    <span class="keywordflow">if</span> (pXform-&gt;GetSrcSpace() == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a> &amp;&amp;</div>
<div class="line"><span class="lineno">10793</span>        nDestSpace == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>) {</div>
<div class="line"><span class="lineno">10794</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno">10795</span>    }</div>
<div class="line"><span class="lineno">10796</span> </div>
<div class="line"><span class="lineno">10797</span>    <span class="keywordflow">if</span> (nDestSpace != <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a> &amp;&amp;</div>
<div class="line"><span class="lineno">10798</span>        pXform-&gt;GetDstSpace() == <a class="code hl_enumvalue" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a>) {</div>
<div class="line"><span class="lineno">10799</span>      <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a>;</div>
<div class="line"><span class="lineno">10800</span>    }</div>
<div class="line"><span class="lineno">10801</span>    </div>
<div class="line"><span class="lineno">10802</span>    <span class="keywordflow">return</span> pXform-&gt;SetDestSpace(nDestSpace);</div>
<div class="line"><span class="lineno">10803</span>  }</div>
<div class="line"><span class="lineno">10804</span> </div>
<div class="line"><span class="lineno">10805</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a>;</div>
<div class="line"><span class="lineno">10806</span>}</div>
<div class="line"><span class="lineno">10807</span> </div>
<div class="line"><span class="lineno">10808</span> </div>
<div class="line"><span class="lineno">10816</span>CIccMruCmm::CIccMruCmm()</div>
<div class="line"><span class="lineno">10817</span>{</div>
<div class="line"><span class="lineno">10818</span>  m_pCmm = NULL;</div>
<div class="line"><span class="lineno">10819</span>  m_bDeleteCmm = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">10820</span>  m_nCacheSize = 0;</div>
<div class="line"><span class="lineno">10821</span>}</div>
<div class="line"><span class="lineno">10822</span> </div>
<div class="line"><span class="lineno">10823</span> </div>
<div class="line"><span class="lineno">10831</span>CIccMruCmm::~CIccMruCmm()</div>
<div class="line"><span class="lineno">10832</span>{</div>
<div class="line"><span class="lineno">10833</span>   <span class="keywordflow">if</span> (m_pCmm &amp;&amp; m_bDeleteCmm)</div>
<div class="line"><span class="lineno">10834</span>     <span class="keyword">delete</span> m_pCmm;</div>
<div class="line"><span class="lineno">10835</span>}</div>
<div class="line"><span class="lineno">10836</span> </div>
<div class="line"><span class="lineno">10837</span> </div>
<div class="line"><span class="lineno">10858</span>CIccMruCmm* CIccMruCmm::Attach(CIccCmm *pCmm, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a0462ca2992be7c80b056e640a192b325">icUInt8Number</a> nCacheSize<span class="comment">/* =4 */</span>, <span class="keywordtype">bool</span> bDeleteCmm<span class="comment">/*=true*/</span>)</div>
<div class="line"><span class="lineno">10859</span>{</div>
<div class="line"><span class="lineno">10860</span>  <span class="keywordflow">if</span> (!pCmm || !nCacheSize)</div>
<div class="line"><span class="lineno">10861</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">10862</span> </div>
<div class="line"><span class="lineno">10863</span>  <span class="keywordflow">if</span> (!pCmm-&gt;Valid()) {</div>
<div class="line"><span class="lineno">10864</span>    <span class="keywordflow">if</span> (bDeleteCmm)</div>
<div class="line"><span class="lineno">10865</span>      <span class="keyword">delete</span> pCmm;</div>
<div class="line"><span class="lineno">10866</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">10867</span>  }</div>
<div class="line"><span class="lineno">10868</span> </div>
<div class="line"><span class="lineno">10869</span>  CIccMruCmm *rv = <span class="keyword">new</span> CIccMruCmm();</div>
<div class="line"><span class="lineno">10870</span> </div>
<div class="line"><span class="lineno">10871</span>  rv-&gt;m_pCmm = pCmm;</div>
<div class="line"><span class="lineno">10872</span>  rv-&gt;m_nCacheSize = nCacheSize;</div>
<div class="line"><span class="lineno">10873</span>  rv-&gt;m_bDeleteCmm = bDeleteCmm;</div>
<div class="line"><span class="lineno">10874</span> </div>
<div class="line"><span class="lineno">10875</span>  rv-&gt;m_nSrcSpace = pCmm-&gt;GetSourceSpace();</div>
<div class="line"><span class="lineno">10876</span>  rv-&gt;m_nDestSpace = pCmm-&gt;GetDestSpace();</div>
<div class="line"><span class="lineno">10877</span>  rv-&gt;m_nLastSpace = pCmm-&gt;GetLastSpace();</div>
<div class="line"><span class="lineno">10878</span>  rv-&gt;m_nLastIntent = pCmm-&gt;GetLastIntent();</div>
<div class="line"><span class="lineno">10879</span> </div>
<div class="line"><span class="lineno">10880</span>  <span class="keywordflow">if</span> (rv-&gt;Begin()!=<a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>) {</div>
<div class="line"><span class="lineno">10881</span>    <span class="keyword">delete</span> rv;</div>
<div class="line"><span class="lineno">10882</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">10883</span>  }</div>
<div class="line"><span class="lineno">10884</span> </div>
<div class="line"><span class="lineno">10885</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10886</span>}</div>
<div class="line"><span class="lineno">10887</span> </div>
<div class="line"><span class="lineno">10888</span>CIccApplyCmm *CIccMruCmm::GetNewApplyCmm(<a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> &amp;status)</div>
<div class="line"><span class="lineno">10889</span>{</div>
<div class="line"><span class="lineno">10890</span>  CIccApplyMruCmm *rv = <span class="keyword">new</span> CIccApplyMruCmm(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno">10891</span> </div>
<div class="line"><span class="lineno">10892</span>  <span class="keywordflow">if</span> (!rv) {</div>
<div class="line"><span class="lineno">10893</span>    status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a>;</div>
<div class="line"><span class="lineno">10894</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">10895</span>  }</div>
<div class="line"><span class="lineno">10896</span> </div>
<div class="line"><span class="lineno">10897</span>  <span class="keywordflow">if</span> (!rv-&gt;Init(m_pCmm, m_nCacheSize)) {</div>
<div class="line"><span class="lineno">10898</span>    <span class="keyword">delete</span> rv;</div>
<div class="line"><span class="lineno">10899</span>    status = <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6aa1b3e92b9f8f78ad52846a217a262f72">icCmmStatBad</a>;</div>
<div class="line"><span class="lineno">10900</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">10901</span>  }</div>
<div class="line"><span class="lineno">10902</span> </div>
<div class="line"><span class="lineno">10903</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10904</span>}</div>
<div class="line"><span class="lineno">10905</span> </div>
<div class="line"><span class="lineno">10913</span><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><span class="lineno">10914</span>CIccMruCache&lt;T&gt;::CIccMruCache()</div>
<div class="line"><span class="lineno">10915</span>{</div>
<div class="line"><span class="lineno">10916</span>  m_cache = NULL;</div>
<div class="line"><span class="lineno">10917</span>  m_nNumPixel = 0;</div>
<div class="line"><span class="lineno">10918</span>  m_pixelData = NULL;</div>
<div class="line"><span class="lineno">10919</span>  m_nSrcSamples = 0;</div>
<div class="line"><span class="lineno">10920</span>  m_pFirst = NULL;</div>
<div class="line"><span class="lineno">10921</span>}</div>
<div class="line"><span class="lineno">10922</span> </div>
<div class="line"><span class="lineno">10930</span><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><span class="lineno">10931</span>CIccMruCache&lt;T&gt;::~CIccMruCache()</div>
<div class="line"><span class="lineno">10932</span>{</div>
<div class="line"><span class="lineno">10933</span>  <span class="keywordflow">if</span> (m_cache)</div>
<div class="line"><span class="lineno">10934</span>    <span class="keyword">delete</span>[] m_cache;</div>
<div class="line"><span class="lineno">10935</span> </div>
<div class="line"><span class="lineno">10936</span>  <span class="keywordflow">if</span> (m_pixelData)</div>
<div class="line"><span class="lineno">10937</span>    free(m_pixelData);</div>
<div class="line"><span class="lineno">10938</span>}</div>
<div class="line"><span class="lineno">10939</span> </div>
<div class="line"><span class="lineno">10954</span><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><span class="lineno">10955</span><span class="keywordtype">bool</span> CIccMruCache&lt;T&gt;::Init(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nSrcSamples, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nDstSamples, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nCacheSize)</div>
<div class="line"><span class="lineno">10956</span>{</div>
<div class="line"><span class="lineno">10957</span>  m_nSrcSamples = nSrcSamples;</div>
<div class="line"><span class="lineno">10958</span>  m_nSrcSize = nSrcSamples * <span class="keyword">sizeof</span>(T);</div>
<div class="line"><span class="lineno">10959</span>  m_nDstSize = nDstSamples * <span class="keyword">sizeof</span>(T);</div>
<div class="line"><span class="lineno">10960</span> </div>
<div class="line"><span class="lineno">10961</span>  m_nTotalSamples = m_nSrcSamples + nDstSamples;</div>
<div class="line"><span class="lineno">10962</span> </div>
<div class="line"><span class="lineno">10963</span>  m_nNumPixel = 0;</div>
<div class="line"><span class="lineno">10964</span>  m_nCacheSize = nCacheSize;</div>
<div class="line"><span class="lineno">10965</span> </div>
<div class="line"><span class="lineno">10966</span>  m_pFirst = NULL;</div>
<div class="line"><span class="lineno">10967</span>  m_cache = <span class="keyword">new</span> CIccMruPixel&lt;T&gt;[nCacheSize];</div>
<div class="line"><span class="lineno">10968</span> </div>
<div class="line"><span class="lineno">10969</span>  <span class="keywordflow">if</span> (!m_cache)</div>
<div class="line"><span class="lineno">10970</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">10971</span> </div>
<div class="line"><span class="lineno">10972</span>  m_pixelData = (T*)malloc((<span class="keywordtype">int</span>)nCacheSize * m_nTotalSamples * <span class="keyword">sizeof</span>(T));</div>
<div class="line"><span class="lineno">10973</span> </div>
<div class="line"><span class="lineno">10974</span>  <span class="keywordflow">if</span> (!m_pixelData)</div>
<div class="line"><span class="lineno">10975</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">10976</span> </div>
<div class="line"><span class="lineno">10977</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">10978</span>}</div>
<div class="line"><span class="lineno">10979</span> </div>
<div class="line"><span class="lineno">10980</span><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><span class="lineno">10981</span>CIccMruCache&lt;T&gt; *CIccMruCache&lt;T&gt;::NewMruCache(<a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nSrcSamples, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nDstSamples, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nCacheSize <span class="comment">/* = 4 */</span>)</div>
<div class="line"><span class="lineno">10982</span>{</div>
<div class="line"><span class="lineno">10983</span>  CIccMruCache&lt;T&gt; *rv = <span class="keyword">new</span> CIccMruCache&lt;T&gt;;</div>
<div class="line"><span class="lineno">10984</span> </div>
<div class="line"><span class="lineno">10985</span>  <span class="keywordflow">if</span> (!rv-&gt;Init(nSrcSamples, nDstSamples, nCacheSize)) {</div>
<div class="line"><span class="lineno">10986</span>    <span class="keyword">delete</span> rv;</div>
<div class="line"><span class="lineno">10987</span>    <span class="keywordflow">return</span> NULL;</div>
<div class="line"><span class="lineno">10988</span>  }</div>
<div class="line"><span class="lineno">10989</span> </div>
<div class="line"><span class="lineno">10990</span>  <span class="keywordflow">return</span> rv;</div>
<div class="line"><span class="lineno">10991</span>}</div>
<div class="line"><span class="lineno">10992</span> </div>
<div class="line"><span class="lineno">11008</span><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><span class="lineno">11009</span><span class="keywordtype">bool</span> CIccMruCache&lt;T&gt;::Apply(T *DstPixel, <span class="keyword">const</span> T *SrcPixel)</div>
<div class="line"><span class="lineno">11010</span>{</div>
<div class="line"><span class="lineno">11011</span>  CIccMruPixel&lt;T&gt; *ptr, *prev = NULL, *last = NULL;</div>
<div class="line"><span class="lineno">11012</span>  <span class="keywordtype">int</span> i;</div>
<div class="line"><span class="lineno">11013</span>  T *pixel;</div>
<div class="line"><span class="lineno">11014</span> </div>
<div class="line"><span class="lineno">11015</span>  <span class="keywordflow">for</span> (ptr = m_pFirst, i = 0; ptr; ptr = ptr-&gt;pNext, i++) {</div>
<div class="line"><span class="lineno">11016</span>    <span class="keywordflow">if</span> (!memcmp(SrcPixel, ptr-&gt;pPixelData, m_nSrcSize)) {</div>
<div class="line"><span class="lineno">11017</span>      memcpy(DstPixel, &amp;ptr-&gt;pPixelData[m_nSrcSamples], m_nDstSize);</div>
<div class="line"><span class="lineno">11018</span>      <span class="keywordflow">if</span> (ptr != m_pFirst) {</div>
<div class="line"><span class="lineno">11019</span>        last-&gt;pNext = ptr-&gt;pNext;</div>
<div class="line"><span class="lineno">11020</span> </div>
<div class="line"><span class="lineno">11021</span>        ptr-&gt;pNext = m_pFirst;</div>
<div class="line"><span class="lineno">11022</span>        m_pFirst = ptr;</div>
<div class="line"><span class="lineno">11023</span>      }</div>
<div class="line"><span class="lineno">11024</span>      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">11025</span>    }</div>
<div class="line"><span class="lineno">11026</span>    prev = last;</div>
<div class="line"><span class="lineno">11027</span>    last = ptr;</div>
<div class="line"><span class="lineno">11028</span>  }</div>
<div class="line"><span class="lineno">11029</span> </div>
<div class="line"><span class="lineno">11030</span>  <span class="comment">//If we get here SrcPixel is not in the cache</span></div>
<div class="line"><span class="lineno">11031</span>  <span class="keywordflow">if</span> (i &lt; m_nCacheSize) {</div>
<div class="line"><span class="lineno">11032</span>    pixel = &amp;m_pixelData[i*m_nTotalSamples];</div>
<div class="line"><span class="lineno">11033</span> </div>
<div class="line"><span class="lineno">11034</span>    ptr = &amp;m_cache[i];</div>
<div class="line"><span class="lineno">11035</span>    ptr-&gt;pPixelData = pixel;</div>
<div class="line"><span class="lineno">11036</span> </div>
<div class="line"><span class="lineno">11037</span>    <span class="keywordflow">if</span> (m_pFirst) {</div>
<div class="line"><span class="lineno">11038</span>      ptr-&gt;pNext = m_pFirst;</div>
<div class="line"><span class="lineno">11039</span>    }</div>
<div class="line"><span class="lineno">11040</span>    m_pFirst = ptr;</div>
<div class="line"><span class="lineno">11041</span>  }</div>
<div class="line"><span class="lineno">11042</span>  <span class="keywordflow">else</span> {  <span class="comment">//Reuse oldest value and put it at the front of the list</span></div>
<div class="line"><span class="lineno">11043</span>    <span class="keywordflow">if</span> (prev)</div>
<div class="line"><span class="lineno">11044</span>      prev-&gt;pNext = NULL;</div>
<div class="line"><span class="lineno">11045</span>    last-&gt;pNext = m_pFirst;</div>
<div class="line"><span class="lineno">11046</span> </div>
<div class="line"><span class="lineno">11047</span>    m_pFirst = last;</div>
<div class="line"><span class="lineno">11048</span>    pixel = last-&gt;pPixelData;</div>
<div class="line"><span class="lineno">11049</span>  }</div>
<div class="line"><span class="lineno">11050</span>  T *dest = &amp;pixel[m_nSrcSamples];</div>
<div class="line"><span class="lineno">11051</span> </div>
<div class="line"><span class="lineno">11052</span>  memcpy(pixel, SrcPixel, m_nSrcSize);</div>
<div class="line"><span class="lineno">11053</span> </div>
<div class="line"><span class="lineno">11054</span>  <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">11055</span>}</div>
<div class="line"><span class="lineno">11056</span> </div>
<div class="line"><span class="lineno">11057</span><span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt;</div>
<div class="line"><span class="lineno">11058</span><span class="keywordtype">void</span> CIccMruCache&lt;T&gt;::Update(T* DstPixel)</div>
<div class="line"><span class="lineno">11059</span>{</div>
<div class="line"><span class="lineno">11060</span>  memcpy(&amp;m_pFirst-&gt;pPixelData[m_nSrcSamples], DstPixel, m_nDstSize);</div>
<div class="line"><span class="lineno">11061</span>}</div>
<div class="line"><span class="lineno">11062</span> </div>
<div class="line"><span class="lineno">11063</span><span class="comment">//Make sure typedef classes get built</span></div>
<div class="line"><span class="lineno">11064</span><span class="keyword">template</span> <span class="keyword">class </span>CIccMruCache&lt;icFloatNumber&gt;;</div>
<div class="line"><span class="lineno">11065</span><span class="keyword">template</span> <span class="keyword">class </span>CIccMruCache&lt;icUInt8Number&gt;;</div>
<div class="line"><span class="lineno">11066</span><span class="keyword">template</span> <span class="keyword">class </span>CIccMruCache&lt;icUInt16Number&gt;;</div>
<div class="line"><span class="lineno">11067</span> </div>
<div class="line"><span class="lineno">11068</span> </div>
<div class="line"><span class="lineno">11069</span>CIccApplyMruCmm::CIccApplyMruCmm(CIccMruCmm *pCmm) : CIccApplyCmm(pCmm)</div>
<div class="line"><span class="lineno">11070</span>{</div>
<div class="line"><span class="lineno">11071</span>  m_pCachedCmm = NULL;</div>
<div class="line"><span class="lineno">11072</span>  m_pCache = NULL;</div>
<div class="line"><span class="lineno">11073</span>}</div>
<div class="line"><span class="lineno">11074</span> </div>
<div class="line"><span class="lineno">11082</span>CIccApplyMruCmm::~CIccApplyMruCmm()</div>
<div class="line"><span class="lineno">11083</span>{</div>
<div class="line"><span class="lineno">11084</span>  <span class="keywordflow">if</span> (m_pCache)</div>
<div class="line"><span class="lineno">11085</span>    <span class="keyword">delete</span> m_pCache;</div>
<div class="line"><span class="lineno">11086</span> </div>
<div class="line"><span class="lineno">11087</span>}</div>
<div class="line"><span class="lineno">11088</span> </div>
<div class="line"><span class="lineno">11103</span><span class="keywordtype">bool</span> CIccApplyMruCmm::Init(CIccCmm *pCachedCmm, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a> nCacheSize)</div>
<div class="line"><span class="lineno">11104</span>{</div>
<div class="line"><span class="lineno">11105</span>  m_pCachedCmm = pCachedCmm;</div>
<div class="line"><span class="lineno">11106</span> </div>
<div class="line"><span class="lineno">11107</span>  m_pCache = CIccMruCacheFloat::NewMruCache(m_pCmm-&gt;GetSourceSamples(), m_pCmm-&gt;GetDestSamples(), nCacheSize);</div>
<div class="line"><span class="lineno">11108</span> </div>
<div class="line"><span class="lineno">11109</span>  <span class="keywordflow">if</span> (!m_pCache)</div>
<div class="line"><span class="lineno">11110</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">11111</span> </div>
<div class="line"><span class="lineno">11112</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">11113</span>}</div>
<div class="line"><span class="lineno">11114</span> </div>
<div class="line"><span class="lineno">11129</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccApplyMruCmm::Apply(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel)</div>
<div class="line"><span class="lineno">11130</span>{</div>
<div class="line"><span class="lineno">11131</span><span class="preprocessor">#if defined(_DEBUG)</span></div>
<div class="line"><span class="lineno">11132</span>  <span class="keywordflow">if</span> (!m_pCache)</div>
<div class="line"><span class="lineno">11133</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096">icCmmStatInvalidLut</a>;</div>
<div class="line"><span class="lineno">11134</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">11135</span> </div>
<div class="line"><span class="lineno">11136</span>  <span class="keywordflow">if</span> (!m_pCache-&gt;Apply(DstPixel, SrcPixel)) {</div>
<div class="line"><span class="lineno">11137</span> </div>
<div class="line"><span class="lineno">11138</span>    m_pCachedCmm-&gt;Apply(DstPixel, SrcPixel);</div>
<div class="line"><span class="lineno">11139</span> </div>
<div class="line"><span class="lineno">11140</span>    m_pCache-&gt;Update(DstPixel);</div>
<div class="line"><span class="lineno">11141</span>  }</div>
<div class="line"><span class="lineno">11142</span> </div>
<div class="line"><span class="lineno">11143</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno">11144</span>}</div>
<div class="line"><span class="lineno">11145</span> </div>
<div class="line"><span class="lineno">11161</span><a class="code hl_enumeration" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a> CIccApplyMruCmm::Apply(<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *DstPixel, <span class="keyword">const</span> <a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> *SrcPixel, <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> nPixels)</div>
<div class="line"><span class="lineno">11162</span>{</div>
<div class="line"><span class="lineno">11163</span>  <a class="code hl_typedef" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a> k;</div>
<div class="line"><span class="lineno">11164</span> </div>
<div class="line"><span class="lineno">11165</span><span class="preprocessor">#if defined(_DEBUG)</span></div>
<div class="line"><span class="lineno">11166</span>  <span class="keywordflow">if</span> (!m_pCache)</div>
<div class="line"><span class="lineno">11167</span>    <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096">icCmmStatInvalidLut</a>;</div>
<div class="line"><span class="lineno">11168</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">11169</span> </div>
<div class="line"><span class="lineno">11170</span>  <span class="keywordflow">for</span> (k=0; k&lt;nPixels;k++) {</div>
<div class="line"><span class="lineno">11171</span>    <span class="keywordflow">if</span> (!m_pCache-&gt;Apply(DstPixel, SrcPixel)) {</div>
<div class="line"><span class="lineno">11172</span>      m_pCachedCmm-&gt;Apply(DstPixel, SrcPixel);</div>
<div class="line"><span class="lineno">11173</span>      m_pCache-&gt;Update(DstPixel);</div>
<div class="line"><span class="lineno">11174</span>    }</div>
<div class="line"><span class="lineno">11175</span>    SrcPixel += m_pCmm-&gt;GetSourceSamples();</div>
<div class="line"><span class="lineno">11176</span>    DstPixel += m_pCmm-&gt;GetDestSamples();</div>
<div class="line"><span class="lineno">11177</span>  }</div>
<div class="line"><span class="lineno">11178</span> </div>
<div class="line"><span class="lineno">11179</span>  <span class="keywordflow">return</span> <a class="code hl_enumvalue" href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a>;</div>
<div class="line"><span class="lineno">11180</span>}</div>
<div class="line"><span class="lineno">11181</span> </div>
<div class="line"><span class="lineno">11182</span> </div>
<div class="line"><span class="lineno">11183</span><span class="preprocessor">#ifdef USEREFICCMAXNAMESPACE</span></div>
<div class="line"><span class="lineno">11184</span>} <span class="comment">//namespace refIccMAX</span></div>
<div class="line"><span class="lineno">11185</span><span class="preprocessor">#endif</span></div>
<div class="ttc" id="aa00002_html_a043048bd0c63d3bd54d35e8b5743d226"><div class="ttname"><a href="../../d7/d46/a00002.html#a043048bd0c63d3bd54d35e8b5743d226">icSigLabPcsData</a></div><div class="ttdeci">#define icSigLabPcsData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:939</div></div>
<div class="ttc" id="aa00002_html_a0462ca2992be7c80b056e640a192b325"><div class="ttname"><a href="../../d7/d46/a00002.html#a0462ca2992be7c80b056e640a192b325">icUInt8Number</a></div><div class="ttdeci">unsigned char icUInt8Number</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:250</div></div>
<div class="ttc" id="aa00002_html_a0fbdbf76357f4ad739b1df71bd87ef8a"><div class="ttname"><a href="../../d7/d46/a00002.html#a0fbdbf76357f4ad739b1df71bd87ef8a">icUnknownIntent</a></div><div class="ttdeci">#define icUnknownIntent</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1152</div></div>
<div class="ttc" id="aa00002_html_a11a26c7a39b8bcb49fe0468959d60a7c"><div class="ttname"><a href="../../d7/d46/a00002.html#a11a26c7a39b8bcb49fe0468959d60a7c">icSigBRDFDirect</a></div><div class="ttdeci">#define icSigBRDFDirect</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:902</div></div>
<div class="ttc" id="aa00002_html_a13b7fe380f7b096933ceaaa7a1e1e3ef"><div class="ttname"><a href="../../d7/d46/a00002.html#a13b7fe380f7b096933ceaaa7a1e1e3ef">icUInt16Number</a></div><div class="ttdeci">unsigned short icUInt16Number</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:256</div></div>
<div class="ttc" id="aa00002_html_a163dee4d9a8a1568dded8480a166e852"><div class="ttname"><a href="../../d7/d46/a00002.html#a163dee4d9a8a1568dded8480a166e852">icSigRadiantSpectralPcsData</a></div><div class="ttdeci">#define icSigRadiantSpectralPcsData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:943</div></div>
<div class="ttc" id="aa00002_html_a1663bd430c0c31a708d9a141fc6b6c45"><div class="ttname"><a href="../../d7/d46/a00002.html#a1663bd430c0c31a708d9a141fc6b6c45">icInt32Number</a></div><div class="ttdeci">long icInt32Number</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:291</div></div>
<div class="ttc" id="aa00002_html_a1b59192d9fcc1aee71b8cc523b4978ca"><div class="ttname"><a href="../../d7/d46/a00002.html#a1b59192d9fcc1aee71b8cc523b4978ca">icSigSparseMatrixSpectralPcsData</a></div><div class="ttdeci">#define icSigSparseMatrixSpectralPcsData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:945</div></div>
<div class="ttc" id="aa00002_html_a1cc0ddb4770d5695c83543b62afaa1a0"><div class="ttname"><a href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0">icProfileClassSignature</a></div><div class="ttdeci">icProfileClassSignature</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:951</div></div>
<div class="ttc" id="aa00002_html_a1cc0ddb4770d5695c83543b62afaa1a0a200e4fc8dcec29c6d411cae0c9a0483c"><div class="ttname"><a href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a200e4fc8dcec29c6d411cae0c9a0483c">icSigAbstractClass</a></div><div class="ttdeci">@ icSigAbstractClass</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:956</div></div>
<div class="ttc" id="aa00002_html_a1cc0ddb4770d5695c83543b62afaa1a0a24cf99d0920e4e0b4549d67311e99928"><div class="ttname"><a href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a24cf99d0920e4e0b4549d67311e99928">icSigColorEncodingClass</a></div><div class="ttdeci">@ icSigColorEncodingClass</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:959</div></div>
<div class="ttc" id="aa00002_html_a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f"><div class="ttname"><a href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f">icSigMaterialVisualizationClass</a></div><div class="ttdeci">@ icSigMaterialVisualizationClass</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:962</div></div>
<div class="ttc" id="aa00002_html_a1cc0ddb4770d5695c83543b62afaa1a0a787f32c0c9368bc8c4e85a670ae91c8d"><div class="ttname"><a href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a787f32c0c9368bc8c4e85a670ae91c8d">icSigInputClass</a></div><div class="ttdeci">@ icSigInputClass</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:952</div></div>
<div class="ttc" id="aa00002_html_a1cc0ddb4770d5695c83543b62afaa1a0a8b2deae24b9246ac33314b42ad02ac48"><div class="ttname"><a href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0a8b2deae24b9246ac33314b42ad02ac48">icSigMaterialLinkClass</a></div><div class="ttdeci">@ icSigMaterialLinkClass</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:961</div></div>
<div class="ttc" id="aa00002_html_a1cc0ddb4770d5695c83543b62afaa1a0ac1881705b3792813f8ef0745b7a12170"><div class="ttname"><a href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0ac1881705b3792813f8ef0745b7a12170">icSigNamedColorClass</a></div><div class="ttdeci">@ icSigNamedColorClass</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:958</div></div>
<div class="ttc" id="aa00002_html_a1cc0ddb4770d5695c83543b62afaa1a0aeb74955777b1abe38df700474c7be5ce"><div class="ttname"><a href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0aeb74955777b1abe38df700474c7be5ce">icSigMaterialIdentificationClass</a></div><div class="ttdeci">@ icSigMaterialIdentificationClass</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:960</div></div>
<div class="ttc" id="aa00002_html_a1cc0ddb4770d5695c83543b62afaa1a0af50c13fdfab9fcc0a7b831ac86d1fe3b"><div class="ttname"><a href="../../d7/d46/a00002.html#a1cc0ddb4770d5695c83543b62afaa1a0af50c13fdfab9fcc0a7b831ac86d1fe3b">icSigLinkClass</a></div><div class="ttdeci">@ icSigLinkClass</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:955</div></div>
<div class="ttc" id="aa00002_html_a2146034a274143b2ffbb868845d93e17ab1c241e8a8bf7f4843c929227113ac84"><div class="ttname"><a href="../../d7/d46/a00002.html#a2146034a274143b2ffbb868845d93e17ab1c241e8a8bf7f4843c929227113ac84">icIlluminantUnknown</a></div><div class="ttdeci">@ icIlluminantUnknown</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1191</div></div>
<div class="ttc" id="aa00002_html_a3cc88012894a42474b7609adbe314918"><div class="ttname"><a href="../../d7/d46/a00002.html#a3cc88012894a42474b7609adbe314918">icSigXYZPcsData</a></div><div class="ttdeci">#define icSigXYZPcsData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:940</div></div>
<div class="ttc" id="aa00002_html_a3cf7d4cc4e63f81e4480198a14bc4fd4"><div class="ttname"><a href="../../d7/d46/a00002.html#a3cf7d4cc4e63f81e4480198a14bc4fd4">icSpectralRange::steps</a></div><div class="ttdeci">icUInt16Number steps</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1469</div></div>
<div class="ttc" id="aa00002_html_a3e75b8d208a5e4c55eac077643bc7689"><div class="ttname"><a href="../../d7/d46/a00002.html#a3e75b8d208a5e4c55eac077643bc7689">icXYZNumber::Y</a></div><div class="ttdeci">icS15Fixed16Number Y</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1430</div></div>
<div class="ttc" id="aa00002_html_a47e4f847bd0bc609907b5fea4daf3e75"><div class="ttname"><a href="../../d7/d46/a00002.html#a47e4f847bd0bc609907b5fea4daf3e75">icGetColorSpaceType</a></div><div class="ttdeci">#define icGetColorSpaceType(sig)</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:932</div></div>
<div class="ttc" id="aa00002_html_a5bc58d64df71e86546c9f40fe5fefa06"><div class="ttname"><a href="../../d7/d46/a00002.html#a5bc58d64df71e86546c9f40fe5fefa06">icSparseMatrixFloatNum</a></div><div class="ttdeci">#define icSparseMatrixFloatNum</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1359</div></div>
<div class="ttc" id="aa00002_html_a5dbecf663e56b6445a7f199306ee1b4da9f1d5e498c47af2a0e0be3fa029970fe"><div class="ttname"><a href="../../d7/d46/a00002.html#a5dbecf663e56b6445a7f199306ee1b4da9f1d5e498c47af2a0e0be3fa029970fe">icSigMatrixElemType</a></div><div class="ttdeci">@ icSigMatrixElemType</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:644</div></div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917">icColorSpaceSignature</a></div><div class="ttdeci">icColorSpaceSignature</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:843</div></div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917a0ab090e1f79d31e78c006c6ab25933dd"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a0ab090e1f79d31e78c006c6ab25933dd">icSigLuvData</a></div><div class="ttdeci">@ icSigLuvData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:848</div></div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3">icSigNamedData</a></div><div class="ttdeci">@ icSigNamedData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:873</div></div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661">icSigCmykData</a></div><div class="ttdeci">@ icSigCmykData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:855</div></div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30">icSigRgbData</a></div><div class="ttdeci">@ icSigRgbData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:851</div></div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917ad4a717752d16d5fcf92e1fdd892b8bd8"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ad4a717752d16d5fcf92e1fdd892b8bd8">icSigHlsData</a></div><div class="ttdeci">@ icSigHlsData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:854</div></div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917addb4c9db388eda46c3ec7fdaa8824cf5"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917addb4c9db388eda46c3ec7fdaa8824cf5">icSig4colorData</a></div><div class="ttdeci">@ icSig4colorData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:861</div></div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917ae02a4b86c48a9b85be92fdfc2114e496"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ae02a4b86c48a9b85be92fdfc2114e496">icSigYCbCrData</a></div><div class="ttdeci">@ icSigYCbCrData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:849</div></div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917af20259a5702129c41fd08e21c7e94a74"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917af20259a5702129c41fd08e21c7e94a74">icSigCmyData</a></div><div class="ttdeci">@ icSigCmyData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:856</div></div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917af4c6afaa42216765b0431ec6ae0ba27c"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917af4c6afaa42216765b0431ec6ae0ba27c">icSigGrayData</a></div><div class="ttdeci">@ icSigGrayData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:852</div></div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917afa0686ad8f20f604e7e52807087f04da"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917afa0686ad8f20f604e7e52807087f04da">icSig3colorData</a></div><div class="ttdeci">@ icSig3colorData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:860</div></div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917afc7cddf72b4d83ee5cb3568143580828"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917afc7cddf72b4d83ee5cb3568143580828">icSigHsvData</a></div><div class="ttdeci">@ icSigHsvData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:853</div></div>
<div class="ttc" id="aa00002_html_a61e8bac86860cdefe93533feac126917afc7f319f261280fc48d7510c3a8bc330"><div class="ttname"><a href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917afc7f319f261280fc48d7510c3a8bc330">icSigYxyData</a></div><div class="ttdeci">@ icSigYxyData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:850</div></div>
<div class="ttc" id="aa00002_html_a63276cc6df51af4efa1945ecae93a182"><div class="ttname"><a href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a></div><div class="ttdeci">unsigned long icUInt32Number</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:262</div></div>
<div class="ttc" id="aa00002_html_a65d0544793f49b86857f2d54f9897446"><div class="ttname"><a href="../../d7/d46/a00002.html#a65d0544793f49b86857f2d54f9897446">icSpectralRange::start</a></div><div class="ttdeci">icFloat16Number start</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1467</div></div>
<div class="ttc" id="aa00002_html_a67fa1b773fad35303680761ee5ef9313"><div class="ttname"><a href="../../d7/d46/a00002.html#a67fa1b773fad35303680761ee5ef9313">icSignature</a></div><div class="ttdeci">icUInt32Number icSignature</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:271</div></div>
<div class="ttc" id="aa00002_html_a7ac6c9395974f6a0dc5025b7c7417ddea21dfb852fbf1b3dfa35ca6804d3d0499"><div class="ttname"><a href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea21dfb852fbf1b3dfa35ca6804d3d0499">icSigUtf8TextType</a></div><div class="ttdeci">@ icSigUtf8TextType</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:574</div></div>
<div class="ttc" id="aa00002_html_a7ac6c9395974f6a0dc5025b7c7417ddea2a4636dabf07722022104d8d112e2417"><div class="ttname"><a href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea2a4636dabf07722022104d8d112e2417">icSigTagArrayType</a></div><div class="ttdeci">@ icSigTagArrayType</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:563</div></div>
<div class="ttc" id="aa00002_html_a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481"><div class="ttname"><a href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481">icSigMultiProcessElementType</a></div><div class="ttdeci">@ icSigMultiProcessElementType</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:550</div></div>
<div class="ttc" id="aa00002_html_a7ac6c9395974f6a0dc5025b7c7417ddea5f55d7347cee83f4b7570f2c0092a3c4"><div class="ttname"><a href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea5f55d7347cee83f4b7570f2c0092a3c4">icSigParametricCurveType</a></div><div class="ttdeci">@ icSigParametricCurveType</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:552</div></div>
<div class="ttc" id="aa00002_html_a7ac6c9395974f6a0dc5025b7c7417ddea6226593792ef658c78bcab04a6fd4850"><div class="ttname"><a href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea6226593792ef658c78bcab04a6fd4850">icSigXYZType</a></div><div class="ttdeci">@ icSigXYZType</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:576</div></div>
<div class="ttc" id="aa00002_html_a7ac6c9395974f6a0dc5025b7c7417ddea96cf6489d8d5dc86691eee5d443cf337"><div class="ttname"><a href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddea96cf6489d8d5dc86691eee5d443cf337">icSigCurveType</a></div><div class="ttdeci">@ icSigCurveType</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:533</div></div>
<div class="ttc" id="aa00002_html_a7ac6c9395974f6a0dc5025b7c7417ddeabd3b6889c64ac3ffb16f1c48be950dc8"><div class="ttname"><a href="../../d7/d46/a00002.html#a7ac6c9395974f6a0dc5025b7c7417ddeabd3b6889c64ac3ffb16f1c48be950dc8">icSigNamedColor2Type</a></div><div class="ttdeci">@ icSigNamedColor2Type</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:551</div></div>
<div class="ttc" id="aa00002_html_a80236e8e78fa1f2a6351cb0af0fed8da"><div class="ttname"><a href="../../d7/d46/a00002.html#a80236e8e78fa1f2a6351cb0af0fed8da">icSigUnknownData</a></div><div class="ttdeci">#define icSigUnknownData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:903</div></div>
<div class="ttc" id="aa00002_html_a802c8f93248af9679280a8c10705807c"><div class="ttname"><a href="../../d7/d46/a00002.html#a802c8f93248af9679280a8c10705807c">icVersionNumberV5</a></div><div class="ttdeci">#define icVersionNumberV5</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:193</div></div>
<div class="ttc" id="aa00002_html_a81f6d2d938687df976c13f1f3c8d4b09"><div class="ttname"><a href="../../d7/d46/a00002.html#a81f6d2d938687df976c13f1f3c8d4b09">icSpectralRange::end</a></div><div class="ttdeci">icFloat16Number end</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1468</div></div>
<div class="ttc" id="aa00002_html_a852cf5d81aa3d65ff6a08c3eaafcd0dc"><div class="ttname"><a href="../../d7/d46/a00002.html#a852cf5d81aa3d65ff6a08c3eaafcd0dc">icSpectralColorSignature</a></div><div class="ttdeci">icSpectralColorSignature</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:907</div></div>
<div class="ttc" id="aa00002_html_a8753b09e8d550ace7d30a0af5d0e7ab3"><div class="ttname"><a href="../../d7/d46/a00002.html#a8753b09e8d550ace7d30a0af5d0e7ab3">icXYZNumber::Z</a></div><div class="ttdeci">icS15Fixed16Number Z</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1431</div></div>
<div class="ttc" id="aa00002_html_a8a82647ad953c198665aee9e3b659ea7"><div class="ttname"><a href="../../d7/d46/a00002.html#a8a82647ad953c198665aee9e3b659ea7">icXYZNumber::X</a></div><div class="ttdeci">icS15Fixed16Number X</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1429</div></div>
<div class="ttc" id="aa00002_html_a97bb6c6d4e1859ba7290162215ac8beba58bd0f3ca3c177aacc2b9fd1cbc0009b"><div class="ttname"><a href="../../d7/d46/a00002.html#a97bb6c6d4e1859ba7290162215ac8beba58bd0f3ca3c177aacc2b9fd1cbc0009b">icSigNamedColorArray</a></div><div class="ttdeci">@ icSigNamedColorArray</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:618</div></div>
<div class="ttc" id="aa00002_html_a97bb6c6d4e1859ba7290162215ac8beba89d9aedd1fa4b16ba01ee9ea41dec24f"><div class="ttname"><a href="../../d7/d46/a00002.html#a97bb6c6d4e1859ba7290162215ac8beba89d9aedd1fa4b16ba01ee9ea41dec24f">icSigUtf8TextTypeArray</a></div><div class="ttdeci">@ icSigUtf8TextTypeArray</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:620</div></div>
<div class="ttc" id="aa00002_html_aa9cd4477816537fbf648a155f6b78eda"><div class="ttname"><a href="../../d7/d46/a00002.html#aa9cd4477816537fbf648a155f6b78eda">icSigReflectanceSpectralPcsData</a></div><div class="ttdeci">#define icSigReflectanceSpectralPcsData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:941</div></div>
<div class="ttc" id="aa00002_html_ab9fb37bd0a4bf923692592a8b0565043"><div class="ttname"><a href="../../d7/d46/a00002.html#ab9fb37bd0a4bf923692592a8b0565043">icSigBRDFParameters</a></div><div class="ttdeci">#define icSigBRDFParameters</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:901</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a0247611a0b2a3faa49a0df2dfc8420cc"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a0247611a0b2a3faa49a0df2dfc8420cc">icSigBToD0Tag</a></div><div class="ttdeci">@ icSigBToD0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:408</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a046bf81412ed16e2ce5f0735bb7e7315"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a046bf81412ed16e2ce5f0735bb7e7315">icSigGrayTRCTag</a></div><div class="ttdeci">@ icSigGrayTRCTag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:421</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a078ce8e7fc1f2e78a5bcd4506216f2b7"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a078ce8e7fc1f2e78a5bcd4506216f2b7">icSigBRDFMToB1Tag</a></div><div class="ttdeci">@ icSigBRDFMToB1Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:367</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a07ee2aaf6842476471432af3cc786404"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a07ee2aaf6842476471432af3cc786404">icSigBRDFMToB3Tag</a></div><div class="ttdeci">@ icSigBRDFMToB3Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:369</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a182f63dba24e9033151133f9678f7b75"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a182f63dba24e9033151133f9678f7b75">icSigBRDFDToB0Tag</a></div><div class="ttdeci">@ icSigBRDFDToB0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:362</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a19b39e0d70b49c0c8864ec3b5ee2f1ba"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a19b39e0d70b49c0c8864ec3b5ee2f1ba">icSigAToB3Tag</a></div><div class="ttdeci">@ icSigAToB3Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:345</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a19e7177ed729ed7835222428eef4c2a3"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a19e7177ed729ed7835222428eef4c2a3">icSigBlueMatrixColumnTag</a></div><div class="ttdeci">@ icSigBlueMatrixColumnTag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:348</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a32d9a526626e93fa27620c528e48daf4"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a32d9a526626e93fa27620c528e48daf4">icSigMaterialDefaultValuesTag</a></div><div class="ttdeci">@ icSigMaterialDefaultValuesTag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:426</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a33c2ed77d7d42de199cb874ec5ad4abf"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a33c2ed77d7d42de199cb874ec5ad4abf">icSigMToS3Tag</a></div><div class="ttdeci">@ icSigMToS3Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:436</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a341a5307f022df0104358887c08c4115"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a341a5307f022df0104358887c08c4115">icSigBrdfSpectralParameter0Tag</a></div><div class="ttdeci">@ icSigBrdfSpectralParameter0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:354</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a3525a308b3af69ebe5c8888dcb80ef12"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a3525a308b3af69ebe5c8888dcb80ef12">icSigGreenTRCTag</a></div><div class="ttdeci">@ icSigGreenTRCTag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:424</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a4101fbfb53a9e422f925a0eb9b9754dc"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a4101fbfb53a9e422f925a0eb9b9754dc">icSigAToM0Tag</a></div><div class="ttdeci">@ icSigAToM0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:346</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a486e40891ee768a1331bf94d608d8400"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a486e40891ee768a1331bf94d608d8400">icSigMToB0Tag</a></div><div class="ttdeci">@ icSigMToB0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:429</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a48a680ba3049e0c37a44da9f08e411c7"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a48a680ba3049e0c37a44da9f08e411c7">icSigAToB0Tag</a></div><div class="ttdeci">@ icSigAToB0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:342</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a50703cf46b465a10ad158fbb65ac8f8e"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a50703cf46b465a10ad158fbb65ac8f8e">icSigMToB3Tag</a></div><div class="ttdeci">@ icSigMToB3Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:432</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a53147bf01d2c36339096d2f22b9c2869"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a53147bf01d2c36339096d2f22b9c2869">icSigBToA1Tag</a></div><div class="ttdeci">@ icSigBToA1Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:375</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a585329dfc33381a67de302149941bd38"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a585329dfc33381a67de302149941bd38">icSigDToB3Tag</a></div><div class="ttdeci">@ icSigDToB3Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:407</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a6a8323df91e18a157d90c1f0f27c6a22"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a6a8323df91e18a157d90c1f0f27c6a22">icSigBRDFAToB0Tag</a></div><div class="ttdeci">@ icSigBRDFAToB0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:358</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a703f1866ed4cc98f623090b38917bc8e"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a703f1866ed4cc98f623090b38917bc8e">icSigDToB0Tag</a></div><div class="ttdeci">@ icSigDToB0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:404</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a740cafe42e07749bbe3b36d881325801"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a740cafe42e07749bbe3b36d881325801">icSigBToD3Tag</a></div><div class="ttdeci">@ icSigBToD3Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:411</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a78413df8b7d634ae4e0ec02f006e5bd0"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a78413df8b7d634ae4e0ec02f006e5bd0">icSigBToA0Tag</a></div><div class="ttdeci">@ icSigBToA0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:374</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a7a93318f3fc1c8582f6b11da800a899a"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a7a93318f3fc1c8582f6b11da800a899a">icSigMToS0Tag</a></div><div class="ttdeci">@ icSigMToS0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:433</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a7fea74def2b68bdcd33cec08da4fa667"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a7fea74def2b68bdcd33cec08da4fa667">icSigRedTRCTag</a></div><div class="ttdeci">@ icSigRedTRCTag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:463</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a85d24fc4ed8a193b8718b540ecfd003d"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a85d24fc4ed8a193b8718b540ecfd003d">icSigHToS1Tag</a></div><div class="ttdeci">@ icSigHToS1Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:418</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a8a66e2d1402c9f9796a902cd2f0ac0eb"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a8a66e2d1402c9f9796a902cd2f0ac0eb">icSigBToD1Tag</a></div><div class="ttdeci">@ icSigBToD1Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:409</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a8b6202952425dbdc400d2626e650c903"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a8b6202952425dbdc400d2626e650c903">icSigBlueTRCTag</a></div><div class="ttdeci">@ icSigBlueTRCTag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:349</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a8ee39bf8d934b766ca5884899d3357a0"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a8ee39bf8d934b766ca5884899d3357a0">icSigMToB1Tag</a></div><div class="ttdeci">@ icSigMToB1Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:430</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a91088345233e12514ec483327a00dbe8"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a91088345233e12514ec483327a00dbe8">icSigHToS0Tag</a></div><div class="ttdeci">@ icSigHToS0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:417</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5a946d32df00f8fdcd52d05afdfa1ae897"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5a946d32df00f8fdcd52d05afdfa1ae897">icSigGreenMatrixColumnTag</a></div><div class="ttdeci">@ icSigGreenMatrixColumnTag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:423</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5aa000d29d0c1e0b2ed0fa49651a5efd26"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5aa000d29d0c1e0b2ed0fa49651a5efd26">icSigMediaWhitePointTag</a></div><div class="ttdeci">@ icSigMediaWhitePointTag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:439</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5aa5b272ef03d506460dbb1c5c6a6cc599"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5aa5b272ef03d506460dbb1c5c6a6cc599">icSigBRDFMToS3Tag</a></div><div class="ttdeci">@ icSigBRDFMToS3Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:373</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5ab04125e571eb02f134e54fb3b0bcdb45"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ab04125e571eb02f134e54fb3b0bcdb45">icSigAToB1Tag</a></div><div class="ttdeci">@ icSigAToB1Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:343</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5ab6a3ba830b4ac279851cb5674c83ce06"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ab6a3ba830b4ac279851cb5674c83ce06">icSigBToA3Tag</a></div><div class="ttdeci">@ icSigBToA3Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:377</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5abda57fa68ef3f179ca1728b2030da340"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5abda57fa68ef3f179ca1728b2030da340">icSigBRDFMToS1Tag</a></div><div class="ttdeci">@ icSigBRDFMToS1Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:371</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5abf1026085f40d42c8202fd1b3a8ad9b4"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5abf1026085f40d42c8202fd1b3a8ad9b4">icSigBRDFMToS0Tag</a></div><div class="ttdeci">@ icSigBRDFMToS0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:370</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5ac5ae9a8a0d00acc2b7ec4f2da4ccc3f8"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ac5ae9a8a0d00acc2b7ec4f2da4ccc3f8">icSigPreview0Tag</a></div><div class="ttdeci">@ icSigPreview0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:448</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5ac9a9457a436bbfaa9212552f337d2beb"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ac9a9457a436bbfaa9212552f337d2beb">icSigNamedColor2Tag</a></div><div class="ttdeci">@ icSigNamedColor2Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:445</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5ad3037f416da1bdbcee55755bd896db3e"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ad3037f416da1bdbcee55755bd896db3e">icSigRedMatrixColumnTag</a></div><div class="ttdeci">@ icSigRedMatrixColumnTag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:462</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5ad57d49a829f89f04159908e21ffe9d01"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ad57d49a829f89f04159908e21ffe9d01">icSigGamutTag</a></div><div class="ttdeci">@ icSigGamutTag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:412</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5ad5d6c8e49e16de86bede2c2e239b38d7"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ad5d6c8e49e16de86bede2c2e239b38d7">icSigMToA0Tag</a></div><div class="ttdeci">@ icSigMToA0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:428</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5adb1d5ba824d4d843572fe8206edad0ca"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5adb1d5ba824d4d843572fe8206edad0ca">icSigMToS1Tag</a></div><div class="ttdeci">@ icSigMToS1Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:434</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5ae185d0e91c27dc49b2a4a328de2fbb92"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ae185d0e91c27dc49b2a4a328de2fbb92">icSigDToB1Tag</a></div><div class="ttdeci">@ icSigDToB1Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:405</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5ae6f4fd41479c1274ea14e0bb432f0253"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ae6f4fd41479c1274ea14e0bb432f0253">icSigBrdfColorimetricParameter0Tag</a></div><div class="ttdeci">@ icSigBrdfColorimetricParameter0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:350</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5ae92349e1ad0bb9aab7d390df0a8c82cc"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5ae92349e1ad0bb9aab7d390df0a8c82cc">icSigMaterialTypeArrayTag</a></div><div class="ttdeci">@ icSigMaterialTypeArrayTag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:427</div></div>
<div class="ttc" id="aa00002_html_ac82636cc27ba918bd737e94a62715af5af8c5abf6686452d76ab9c0327ad5067c"><div class="ttname"><a href="../../d7/d46/a00002.html#ac82636cc27ba918bd737e94a62715af5af8c5abf6686452d76ab9c0327ad5067c">icSigBRDFMToB0Tag</a></div><div class="ttdeci">@ icSigBRDFMToB0Tag</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:366</div></div>
<div class="ttc" id="aa00002_html_ad596b62f264ef4846d435b494c8d2a77"><div class="ttname"><a href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77">icRenderingIntent</a></div><div class="ttdeci">icRenderingIntent</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1142</div></div>
<div class="ttc" id="aa00002_html_ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112"><div class="ttname"><a href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112">icPerceptual</a></div><div class="ttdeci">@ icPerceptual</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1143</div></div>
<div class="ttc" id="aa00002_html_ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb"><div class="ttname"><a href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb">icRelativeColorimetric</a></div><div class="ttdeci">@ icRelativeColorimetric</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1144</div></div>
<div class="ttc" id="aa00002_html_ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944"><div class="ttname"><a href="../../d7/d46/a00002.html#ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944">icAbsoluteColorimetric</a></div><div class="ttdeci">@ icAbsoluteColorimetric</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1147</div></div>
<div class="ttc" id="aa00002_html_ada4a40a4c4b6cd075f42e5364e90dcf7"><div class="ttname"><a href="../../d7/d46/a00002.html#ada4a40a4c4b6cd075f42e5364e90dcf7">icMCSNeedsSubsetTrue</a></div><div class="ttdeci">#define icMCSNeedsSubsetTrue</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:225</div></div>
<div class="ttc" id="aa00002_html_ae84d222edd132ad7741c628c1d4729d9"><div class="ttname"><a href="../../d7/d46/a00002.html#ae84d222edd132ad7741c628c1d4729d9">icSigBiDirReflectanceSpectralPcsData</a></div><div class="ttdeci">#define icSigBiDirReflectanceSpectralPcsData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:944</div></div>
<div class="ttc" id="aa00002_html_af46212fb10475a9822be7160951f142cadd1015e094e8b2a1f9dff66dc0271754"><div class="ttname"><a href="../../d7/d46/a00002.html#af46212fb10475a9822be7160951f142cadd1015e094e8b2a1f9dff66dc0271754">icSigBrdfTransformMbr</a></div><div class="ttdeci">@ icSigBrdfTransformMbr</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:680</div></div>
<div class="ttc" id="aa00002_html_af5df74ebff3f8247e1c7c88844c1f140"><div class="ttname"><a href="../../d7/d46/a00002.html#af5df74ebff3f8247e1c7c88844c1f140">icSigTransmissionSpectralPcsData</a></div><div class="ttdeci">#define icSigTransmissionSpectralPcsData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:942</div></div>
<div class="ttc" id="aa00002_html_af63f30724bd4cfbb6b7e3e2d7b1b602e"><div class="ttname"><a href="../../d7/d46/a00002.html#af63f30724bd4cfbb6b7e3e2d7b1b602e">icSigGamutData</a></div><div class="ttdeci">#define icSigGamutData</div><div class="ttdef"><b>Definition</b> icProfileHeader.h:900</div></div>
<div class="ttc" id="aa00002_html_d8/dc7/a00517"><div class="ttname"><a href="../../d7/d46/a00002.html#d8/dc7/a00517">icXYZNumber</a></div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1428</div></div>
<div class="ttc" id="aa00002_html_dd/d72/a00541"><div class="ttname"><a href="../../d7/d46/a00002.html#dd/d72/a00541">icSpectralRange</a></div><div class="ttdef"><b>Definition</b> icProfileHeader.h:1466</div></div>
<div class="ttc" id="aa00026_html_a1ba790142ac961bedde2898273414a7b"><div class="ttname"><a href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7b">icXformLutType</a></div><div class="ttdeci">icXformLutType</div><div class="ttdoc">CMM Xform LUT types.</div><div class="ttdef"><b>Definition</b> IccCmm.h:125</div></div>
<div class="ttc" id="aa00026_html_a1ba790142ac961bedde2898273414a7ba0b1f2aadd55b74ea25adc32e3cadf4c0"><div class="ttname"><a href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba0b1f2aadd55b74ea25adc32e3cadf4c0">icXformLutNamedColor</a></div><div class="ttdeci">@ icXformLutNamedColor</div><div class="ttdef"><b>Definition</b> IccCmm.h:127</div></div>
<div class="ttc" id="aa00026_html_a1ba790142ac961bedde2898273414a7ba1109d56a39fd11938962b487d6f965b8"><div class="ttname"><a href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba1109d56a39fd11938962b487d6f965b8">icXformLutBRDFDirect</a></div><div class="ttdeci">@ icXformLutBRDFDirect</div><div class="ttdef"><b>Definition</b> IccCmm.h:132</div></div>
<div class="ttc" id="aa00026_html_a1ba790142ac961bedde2898273414a7ba1765210771d77678d0600381557d8bba"><div class="ttname"><a href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba1765210771d77678d0600381557d8bba">icXformLutBRDFMcsParam</a></div><div class="ttdeci">@ icXformLutBRDFMcsParam</div><div class="ttdef"><b>Definition</b> IccCmm.h:133</div></div>
<div class="ttc" id="aa00026_html_a1ba790142ac961bedde2898273414a7ba6df311bd7dc6c9c9284ad186b15f53de"><div class="ttname"><a href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba6df311bd7dc6c9c9284ad186b15f53de">icXformLutGamut</a></div><div class="ttdeci">@ icXformLutGamut</div><div class="ttdef"><b>Definition</b> IccCmm.h:129</div></div>
<div class="ttc" id="aa00026_html_a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013"><div class="ttname"><a href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013">icXformLutColorimetric</a></div><div class="ttdeci">@ icXformLutColorimetric</div><div class="ttdef"><b>Definition</b> IccCmm.h:135</div></div>
<div class="ttc" id="aa00026_html_a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153"><div class="ttname"><a href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153">icXformLutMCS</a></div><div class="ttdeci">@ icXformLutMCS</div><div class="ttdef"><b>Definition</b> IccCmm.h:134</div></div>
<div class="ttc" id="aa00026_html_a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614"><div class="ttname"><a href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614">icXformLutColor</a></div><div class="ttdeci">@ icXformLutColor</div><div class="ttdef"><b>Definition</b> IccCmm.h:126</div></div>
<div class="ttc" id="aa00026_html_a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262"><div class="ttname"><a href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262">icXformLutSpectral</a></div><div class="ttdeci">@ icXformLutSpectral</div><div class="ttdef"><b>Definition</b> IccCmm.h:136</div></div>
<div class="ttc" id="aa00026_html_a1ba790142ac961bedde2898273414a7baeb0501fdc1dcc7f1388f0fdca9b17356"><div class="ttname"><a href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7baeb0501fdc1dcc7f1388f0fdca9b17356">icXformLutPreview</a></div><div class="ttdeci">@ icXformLutPreview</div><div class="ttdef"><b>Definition</b> IccCmm.h:128</div></div>
<div class="ttc" id="aa00026_html_a1ba790142ac961bedde2898273414a7baf26b30e0e73bf289c23075e2f6106e6d"><div class="ttname"><a href="../../d6/d5b/a00026.html#a1ba790142ac961bedde2898273414a7baf26b30e0e73bf289c23075e2f6106e6d">icXformLutBRDFParam</a></div><div class="ttdeci">@ icXformLutBRDFParam</div><div class="ttdef"><b>Definition</b> IccCmm.h:131</div></div>
<div class="ttc" id="aa00026_html_a2099748836172e9623ed265cf9a416fe"><div class="ttname"><a href="../../d6/d5b/a00026.html#a2099748836172e9623ed265cf9a416fe">icPerceptualRefWhiteX</a></div><div class="ttdeci">#define icPerceptualRefWhiteX</div><div class="ttdef"><b>Definition</b> IccCmm.h:143</div></div>
<div class="ttc" id="aa00026_html_a39ef4ca48f4dbb239b4e3ac0e9e8e913"><div class="ttname"><a href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913">icXformInterp</a></div><div class="ttdeci">icXformInterp</div><div class="ttdoc">CMM Interpolation types.</div><div class="ttdef"><b>Definition</b> IccCmm.h:113</div></div>
<div class="ttc" id="aa00026_html_a39ef4ca48f4dbb239b4e3ac0e9e8e913af6e0f18af557a029c4dda563c3a003fb"><div class="ttname"><a href="../../d6/d5b/a00026.html#a39ef4ca48f4dbb239b4e3ac0e9e8e913af6e0f18af557a029c4dda563c3a003fb">icInterpLinear</a></div><div class="ttdeci">@ icInterpLinear</div><div class="ttdef"><b>Definition</b> IccCmm.h:114</div></div>
<div class="ttc" id="aa00026_html_a519837a14867b2fc70159d63527bfb48"><div class="ttname"><a href="../../d6/d5b/a00026.html#a519837a14867b2fc70159d63527bfb48">icPerceptualRefBlackZ</a></div><div class="ttdeci">#define icPerceptualRefBlackZ</div><div class="ttdef"><b>Definition</b> IccCmm.h:141</div></div>
<div class="ttc" id="aa00026_html_a91d9d2e6ccc7b48d1c505eac7d472e11"><div class="ttname"><a href="../../d6/d5b/a00026.html#a91d9d2e6ccc7b48d1c505eac7d472e11">icPerceptualRefBlackY</a></div><div class="ttdeci">#define icPerceptualRefBlackY</div><div class="ttdef"><b>Definition</b> IccCmm.h:140</div></div>
<div class="ttc" id="aa00026_html_a970c241f6169898a9ae88b10fe06f91b"><div class="ttname"><a href="../../d6/d5b/a00026.html#a970c241f6169898a9ae88b10fe06f91b">icPerceptualRefWhiteZ</a></div><div class="ttdeci">#define icPerceptualRefWhiteZ</div><div class="ttdef"><b>Definition</b> IccCmm.h:145</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6">icStatusCMM</a></div><div class="ttdeci">icStatusCMM</div><div class="ttdoc">CMM return status values.</div><div class="ttdef"><b>Definition</b> IccCmm.h:90</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6a0a3d499218e996db890cba097db15f3b"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a0a3d499218e996db890cba097db15f3b">icCmmStatBadLutType</a></div><div class="ttdeci">@ icCmmStatBadLutType</div><div class="ttdef"><b>Definition</b> IccCmm.h:103</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860">icCmmStatInvalidProfile</a></div><div class="ttdeci">@ icCmmStatInvalidProfile</div><div class="ttdef"><b>Definition</b> IccCmm.h:95</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6a4af396c1421581f2a51027630e4bfb42"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a4af396c1421581f2a51027630e4bfb42">icCmmStatTooManySamples</a></div><div class="ttdeci">@ icCmmStatTooManySamples</div><div class="ttdef"><b>Definition</b> IccCmm.h:108</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a">icCmmStatProfileMissingTag</a></div><div class="ttdeci">@ icCmmStatProfileMissingTag</div><div class="ttdef"><b>Definition</b> IccCmm.h:98</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6">icCmmStatBadSpaceLink</a></div><div class="ttdeci">@ icCmmStatBadSpaceLink</div><div class="ttdef"><b>Definition</b> IccCmm.h:94</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6a6bd126a39f8787a82bf08db1af1fcb9b"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a6bd126a39f8787a82bf08db1af1fcb9b">icCmmStatBadMCSLink</a></div><div class="ttdeci">@ icCmmStatBadMCSLink</div><div class="ttdef"><b>Definition</b> IccCmm.h:109</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29">icCmmStatIncorrectApply</a></div><div class="ttdeci">@ icCmmStatIncorrectApply</div><div class="ttdef"><b>Definition</b> IccCmm.h:100</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281">icCmmStatUnsupportedPcsLink</a></div><div class="ttdeci">@ icCmmStatUnsupportedPcsLink</div><div class="ttdef"><b>Definition</b> IccCmm.h:105</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26">icCmmStatBadColorEncoding</a></div><div class="ttdeci">@ icCmmStatBadColorEncoding</div><div class="ttdef"><b>Definition</b> IccCmm.h:101</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6a94a1cd52eec49dc84eac5993164c5be0"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a94a1cd52eec49dc84eac5993164c5be0">icCmmStatCantOpenProfile</a></div><div class="ttdeci">@ icCmmStatCantOpenProfile</div><div class="ttdef"><b>Definition</b> IccCmm.h:93</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6a9d8efd1c91aa512d46f51cd30a7927f5"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9d8efd1c91aa512d46f51cd30a7927f5">icCmmStatBadConnection</a></div><div class="ttdeci">@ icCmmStatBadConnection</div><div class="ttdef"><b>Definition</b> IccCmm.h:106</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3">icCmmStatBadXform</a></div><div class="ttdeci">@ icCmmStatBadXform</div><div class="ttdef"><b>Definition</b> IccCmm.h:96</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6aa1b3e92b9f8f78ad52846a217a262f72"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6aa1b3e92b9f8f78ad52846a217a262f72">icCmmStatBad</a></div><div class="ttdeci">@ icCmmStatBad</div><div class="ttdef"><b>Definition</b> IccCmm.h:91</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6aacc0b85d049e6d79aa0704d2054e62be"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6aacc0b85d049e6d79aa0704d2054e62be">icCmmStatBadTintXform</a></div><div class="ttdeci">@ icCmmStatBadTintXform</div><div class="ttdef"><b>Definition</b> IccCmm.h:107</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16">icCmmStatColorNotFound</a></div><div class="ttdeci">@ icCmmStatColorNotFound</div><div class="ttdef"><b>Definition</b> IccCmm.h:99</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099">icCmmStatOk</a></div><div class="ttdeci">@ icCmmStatOk</div><div class="ttdef"><b>Definition</b> IccCmm.h:92</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10">icCmmStatIdentityXform</a></div><div class="ttdeci">@ icCmmStatIdentityXform</div><div class="ttdef"><b>Definition</b> IccCmm.h:104</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096">icCmmStatInvalidLut</a></div><div class="ttdeci">@ icCmmStatInvalidLut</div><div class="ttdef"><b>Definition</b> IccCmm.h:97</div></div>
<div class="ttc" id="aa00026_html_aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d"><div class="ttname"><a href="../../d6/d5b/a00026.html#aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d">icCmmStatAllocErr</a></div><div class="ttdeci">@ icCmmStatAllocErr</div><div class="ttdef"><b>Definition</b> IccCmm.h:102</div></div>
<div class="ttc" id="aa00026_html_aaaa5f9a3442f4cebec6f0d815e022393"><div class="ttname"><a href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393">icMCSConnectionType</a></div><div class="ttdeci">icMCSConnectionType</div><div class="ttdef"><b>Definition</b> IccCmm.h:118</div></div>
<div class="ttc" id="aa00026_html_aaaa5f9a3442f4cebec6f0d815e022393a7777670882f9cded205c604bbdde8b0d"><div class="ttname"><a href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393a7777670882f9cded205c604bbdde8b0d">icNoMCS</a></div><div class="ttdeci">@ icNoMCS</div><div class="ttdef"><b>Definition</b> IccCmm.h:119</div></div>
<div class="ttc" id="aa00026_html_aaaa5f9a3442f4cebec6f0d815e022393a792a9f663756385f0a63c62606fbd5b5"><div class="ttname"><a href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393a792a9f663756385f0a63c62606fbd5b5">icToMCS</a></div><div class="ttdeci">@ icToMCS</div><div class="ttdef"><b>Definition</b> IccCmm.h:120</div></div>
<div class="ttc" id="aa00026_html_aaaa5f9a3442f4cebec6f0d815e022393a9900382442b6928de2af4b116f08dd5e"><div class="ttname"><a href="../../d6/d5b/a00026.html#aaaa5f9a3442f4cebec6f0d815e022393a9900382442b6928de2af4b116f08dd5e">icFromMCS</a></div><div class="ttdeci">@ icFromMCS</div><div class="ttdef"><b>Definition</b> IccCmm.h:121</div></div>
<div class="ttc" id="aa00026_html_ac9449e1acbe4f8a51e242f04afd25361"><div class="ttname"><a href="../../d6/d5b/a00026.html#ac9449e1acbe4f8a51e242f04afd25361">icPerceptualRefWhiteY</a></div><div class="ttdeci">#define icPerceptualRefWhiteY</div><div class="ttdef"><b>Definition</b> IccCmm.h:144</div></div>
<div class="ttc" id="aa00026_html_ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d"><div class="ttname"><a href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d">icXformTypeMpe</a></div><div class="ttdeci">@ icXformTypeMpe</div><div class="ttdef"><b>Definition</b> IccCmm.h:154</div></div>
<div class="ttc" id="aa00026_html_ae7ce272997e0752433886bd1019e180fa06be3d5a167735863cb627f627c27988"><div class="ttname"><a href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa06be3d5a167735863cb627f627c27988">icXformTypeMatrixTRC</a></div><div class="ttdeci">@ icXformTypeMatrixTRC</div><div class="ttdef"><b>Definition</b> IccCmm.h:149</div></div>
<div class="ttc" id="aa00026_html_ae7ce272997e0752433886bd1019e180fa2e963058ad1caacf212b0527242ec9e1"><div class="ttname"><a href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa2e963058ad1caacf212b0527242ec9e1">icXformTypeNDLut</a></div><div class="ttdeci">@ icXformTypeNDLut</div><div class="ttdef"><b>Definition</b> IccCmm.h:152</div></div>
<div class="ttc" id="aa00026_html_ae7ce272997e0752433886bd1019e180fa4ce2fe52f1dcd97ba1d6b9ad0628e6df"><div class="ttname"><a href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa4ce2fe52f1dcd97ba1d6b9ad0628e6df">icXformTypeMonochrome</a></div><div class="ttdeci">@ icXformTypeMonochrome</div><div class="ttdef"><b>Definition</b> IccCmm.h:155</div></div>
<div class="ttc" id="aa00026_html_ae7ce272997e0752433886bd1019e180fa8f98fe94a91c4c002341c77b47ffed35"><div class="ttname"><a href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa8f98fe94a91c4c002341c77b47ffed35">icXformType3DLut</a></div><div class="ttdeci">@ icXformType3DLut</div><div class="ttdef"><b>Definition</b> IccCmm.h:150</div></div>
<div class="ttc" id="aa00026_html_ae7ce272997e0752433886bd1019e180fa9ad326943cff407bb96bdc9a53920996"><div class="ttname"><a href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fa9ad326943cff407bb96bdc9a53920996">icXformType4DLut</a></div><div class="ttdeci">@ icXformType4DLut</div><div class="ttdef"><b>Definition</b> IccCmm.h:151</div></div>
<div class="ttc" id="aa00026_html_ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb"><div class="ttname"><a href="../../d6/d5b/a00026.html#ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb">icXformTypeNamedColor</a></div><div class="ttdeci">@ icXformTypeNamedColor</div><div class="ttdef"><b>Definition</b> IccCmm.h:153</div></div>
<div class="ttc" id="aa00026_html_af707981d921fc26ac8eb85f4ff285e41"><div class="ttname"><a href="../../d6/d5b/a00026.html#af707981d921fc26ac8eb85f4ff285e41">icPerceptualRefBlackX</a></div><div class="ttdeci">#define icPerceptualRefBlackX</div><div class="ttdef"><b>Definition</b> IccCmm.h:139</div></div>
<div class="ttc" id="aa00029_html_a4e0be90a3757e352f42612d09a7d1aa5"><div class="ttname"><a href="../../d5/d16/a00029.html#a4e0be90a3757e352f42612d09a7d1aa5">stricmp</a></div><div class="ttdeci">#define stricmp</div><div class="ttdef"><b>Definition</b> IccProfLibConf.h:149</div></div>
<div class="ttc" id="aa00068_html_a39a314ab7bc07c151871d9745ed17cae"><div class="ttname"><a href="../../da/d24/a00068.html#a39a314ab7bc07c151871d9745ed17cae">LPIccCurve</a></div><div class="ttdeci">CIccCurve * LPIccCurve</div><div class="ttdef"><b>Definition</b> IccTagLut.h:112</div></div>
<div class="ttc" id="aa00080_html_a0a9b0ffa6221220cf476616062b5c928"><div class="ttname"><a href="../../da/dec/a00080.html#a0a9b0ffa6221220cf476616062b5c928">SIccNamedColorEntry::deviceCoords</a></div><div class="ttdeci">icFloatNumber deviceCoords[icAny]</div><div class="ttdef"><b>Definition</b> IccTagBasic.h:567</div></div>
<div class="ttc" id="aa00080_html_ad4725f789754651c67c722de12f52936"><div class="ttname"><a href="../../da/dec/a00080.html#ad4725f789754651c67c722de12f52936">SIccNamedColorEntry::pcsCoords</a></div><div class="ttdeci">icFloatNumber pcsCoords[3]</div><div class="ttdef"><b>Definition</b> IccTagBasic.h:566</div></div>
<div class="ttc" id="aa00101_html_a14e10b61df6e9ec7c90c5d3bc38c78d9"><div class="ttname"><a href="../../d4/d3a/a00101.html#a14e10b61df6e9ec7c90c5d3bc38c78d9">CIccProfile</a></div><div class="ttdeci">class ICCPROFLIB_API CIccProfile</div><div class="ttdef"><b>Definition</b> IccPcc.h:80</div></div>
<div class="ttc" id="aa00104_html_a97134bdd4b4bf5e8a43ef018bba0917e"><div class="ttname"><a href="../../d0/dc2/a00104.html#a97134bdd4b4bf5e8a43ef018bba0917e">OpenIccProfile</a></div><div class="ttdeci">CIccProfile * OpenIccProfile(const icChar *szFilename, bool bUseSubProfile)</div><div class="ttdef"><b>Definition</b> IccProfile.cpp:3397</div></div>
<div class="ttc" id="aa00110_html_a11ef650eb30d34d4f469f2c5db79aa50"><div class="ttname"><a href="../../d4/d81/a00110.html#a11ef650eb30d34d4f469f2c5db79aa50">icUChar</a></div><div class="ttdeci">unsigned char icUChar</div><div class="ttdef"><b>Definition</b> IccDefs.h:110</div></div>
<div class="ttc" id="aa00110_html_a2879c29939ce675796753098691799b2"><div class="ttname"><a href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a></div><div class="ttdeci">float icFloatNumber</div><div class="ttdef"><b>Definition</b> IccDefs.h:100</div></div>
<div class="ttc" id="aa00110_html_a37f1be5fcf46e05e4078a7f9e6b8b3a5"><div class="ttname"><a href="../../d4/d81/a00110.html#a37f1be5fcf46e05e4078a7f9e6b8b3a5">icU1Fixed15Number</a></div><div class="ttdeci">icUInt16Number icU1Fixed15Number</div><div class="ttdef"><b>Definition</b> IccDefs.h:82</div></div>
<div class="ttc" id="aa00110_html_a706623de1338f49b9c9cf7bed2eab0f2"><div class="ttname"><a href="../../d4/d81/a00110.html#a706623de1338f49b9c9cf7bed2eab0f2">icChar</a></div><div class="ttdeci">char icChar</div><div class="ttdef"><b>Definition</b> IccDefs.h:109</div></div>
<div class="ttc" id="aa00125_html_aa35e9dfb9d4807cbd014d00681934905"><div class="ttname"><a href="../../dc/dfe/a00125.html#aa35e9dfb9d4807cbd014d00681934905">icNearRange</a></div><div class="ttdeci">#define icNearRange</div><div class="ttdef"><b>Definition</b> IccMatrixMath.h:82</div></div>
<div class="ttc" id="aa00143_html_a0ae39400770bbc7c8be88c485167ad26"><div class="ttname"><a href="../../d7/dce/a00143.html#a0ae39400770bbc7c8be88c485167ad26">icGetSpectralSpaceSamples</a></div><div class="ttdeci">ICCPROFLIB_API icUInt32Number icGetSpectralSpaceSamples(const icHeader *pHdr)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:1367</div></div>
<div class="ttc" id="aa00143_html_a0bb667680a93b0dec39e21647ffda760"><div class="ttname"><a href="../../d7/dce/a00143.html#a0bb667680a93b0dec39e21647ffda760">icU8toF</a></div><div class="ttdeci">ICCPROFLIB_API icFloatNumber icU8toF(icUInt8Number num)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:738</div></div>
<div class="ttc" id="aa00143_html_a2685f9528dab905cc6b2b071625709e1"><div class="ttname"><a href="../../d7/dce/a00143.html#a2685f9528dab905cc6b2b071625709e1">icIsSpaceCLR</a></div><div class="ttdeci">ICCPROFLIB_API bool icIsSpaceCLR(icColorSpaceSignature sig)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:262</div></div>
<div class="ttc" id="aa00143_html_a42317dad5efb1650fa709ab01309651f"><div class="ttname"><a href="../../d7/dce/a00143.html#a42317dad5efb1650fa709ab01309651f">icFtoU8</a></div><div class="ttdeci">ICCPROFLIB_API icUInt8Number icFtoU8(icFloatNumber num)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:724</div></div>
<div class="ttc" id="aa00143_html_a48d114d730666238b19cefd80187a629"><div class="ttname"><a href="../../d7/dce/a00143.html#a48d114d730666238b19cefd80187a629">icDtoUSF</a></div><div class="ttdeci">ICCPROFLIB_API icU1Fixed15Number icDtoUSF(icFloatNumber num)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:587</div></div>
<div class="ttc" id="aa00143_html_a4a143eb09493d53cb1f7252819615498"><div class="ttname"><a href="../../d7/dce/a00143.html#a4a143eb09493d53cb1f7252819615498">icDtoF</a></div><div class="ttdeci">ICCPROFLIB_API icS15Fixed16Number icDtoF(icFloatNumber num)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:545</div></div>
<div class="ttc" id="aa00143_html_a4b4cfb7788c3a780f19f2f104677a5b8"><div class="ttname"><a href="../../d7/dce/a00143.html#a4b4cfb7788c3a780f19f2f104677a5b8">icXyzToPcs</a></div><div class="ttdeci">ICCPROFLIB_API void icXyzToPcs(icFloatNumber *XYZ)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:941</div></div>
<div class="ttc" id="aa00143_html_a4ff45349385af6c19d5b3f68150a27b5"><div class="ttname"><a href="../../d7/dce/a00143.html#a4ff45349385af6c19d5b3f68150a27b5">icXYZtoLab</a></div><div class="ttdeci">ICCPROFLIB_API void icXYZtoLab(icFloatNumber *Lab, const icFloatNumber *XYZ=NULL, const icFloatNumber *WhiteXYZ=NULL)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:846</div></div>
<div class="ttc" id="aa00143_html_a52fc751ce015924f9655f8288813a02c"><div class="ttname"><a href="../../d7/dce/a00143.html#a52fc751ce015924f9655f8288813a02c">icFtoD</a></div><div class="ttdeci">ICCPROFLIB_API icFloatNumber icFtoD(icS15Fixed16Number num)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:559</div></div>
<div class="ttc" id="aa00143_html_a5768271d491af79a433e52722ed0a189"><div class="ttname"><a href="../../d7/dce/a00143.html#a5768271d491af79a433e52722ed0a189">icLabToPcs</a></div><div class="ttdeci">ICCPROFLIB_API void icLabToPcs(icFloatNumber *Lab)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:927</div></div>
<div class="ttc" id="aa00143_html_a719dc0d47f230294e78ac9c8cbc91a89"><div class="ttname"><a href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a></div><div class="ttdeci">ICCPROFLIB_API icUInt32Number icGetSpaceSamples(icColorSpaceSignature sig)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:1303</div></div>
<div class="ttc" id="aa00143_html_a77b4912bd2106eaef10d32571c23a58a"><div class="ttname"><a href="../../d7/dce/a00143.html#a77b4912bd2106eaef10d32571c23a58a">icFtoU16</a></div><div class="ttdeci">ICCPROFLIB_API icUInt16Number icFtoU16(icFloatNumber num)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:745</div></div>
<div class="ttc" id="aa00143_html_a78841df2e0aea059520ce71944c4c3bb"><div class="ttname"><a href="../../d7/dce/a00143.html#a78841df2e0aea059520ce71944c4c3bb">icXyzFromPcs</a></div><div class="ttdeci">ICCPROFLIB_API void icXyzFromPcs(icFloatNumber *XYZ)</div><div class="ttdoc">Here are some conversion routines to convert to regular XYZ encoding.</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:934</div></div>
<div class="ttc" id="aa00143_html_a7f49bd1c3d34a4dd4199f6bb0a674f96"><div class="ttname"><a href="../../d7/dce/a00143.html#a7f49bd1c3d34a4dd4199f6bb0a674f96">icFtoF16</a></div><div class="ttdeci">ICCPROFLIB_API icFloat16Number icFtoF16(icFloat32Number num)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:673</div></div>
<div class="ttc" id="aa00143_html_a9851a529e0246e58ba462a4c3074388d"><div class="ttname"><a href="../../d7/dce/a00143.html#a9851a529e0246e58ba462a4c3074388d">icABtoU8</a></div><div class="ttdeci">ICCPROFLIB_API icUInt8Number icABtoU8(icFloatNumber num)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:766</div></div>
<div class="ttc" id="aa00143_html_aa1bb8385706c3c656575f0d6a4ae4d76"><div class="ttname"><a href="../../d7/dce/a00143.html#aa1bb8385706c3c656575f0d6a4ae4d76">icMatrixInvert3x3</a></div><div class="ttdeci">ICCPROFLIB_API bool icMatrixInvert3x3(icFloatNumber *matrix)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:391</div></div>
<div class="ttc" id="aa00143_html_aaa32c9864a601c0a28143886cadb344d"><div class="ttname"><a href="../../d7/dce/a00143.html#aaa32c9864a601c0a28143886cadb344d">icSameSpectralRange</a></div><div class="ttdeci">bool ICCPROFLIB_API icSameSpectralRange(const icSpectralRange &amp;rng1, const icSpectralRange &amp;rng2)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:1399</div></div>
<div class="ttc" id="aa00143_html_aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78"><div class="ttname"><a href="../../d7/dce/a00143.html#aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78">icU16toF</a></div><div class="ttdeci">ICCPROFLIB_API icFloatNumber icU16toF(icUInt16Number num)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:759</div></div>
<div class="ttc" id="aa00143_html_aaf617b49cf0d56a218cd52c840228705"><div class="ttname"><a href="../../d7/dce/a00143.html#aaf617b49cf0d56a218cd52c840228705">icLabtoXYZ</a></div><div class="ttdeci">ICCPROFLIB_API void icLabtoXYZ(icFloatNumber *XYZ, const icFloatNumber *Lab=NULL, const icFloatNumber *WhiteXYZ=NULL)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:830</div></div>
<div class="ttc" id="aa00143_html_abf5738013ad9c2bafb3a0c7a810ecf19"><div class="ttname"><a href="../../d7/dce/a00143.html#abf5738013ad9c2bafb3a0c7a810ecf19">icU8toAB</a></div><div class="ttdeci">ICCPROFLIB_API icFloatNumber icU8toAB(icUInt8Number num)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:777</div></div>
<div class="ttc" id="aa00143_html_ac5de02865f572ea243f6da8c144c02fa"><div class="ttname"><a href="../../d7/dce/a00143.html#ac5de02865f572ea243f6da8c144c02fa">icLabFromPcs</a></div><div class="ttdeci">ICCPROFLIB_API void icLabFromPcs(icFloatNumber *Lab)</div><div class="ttdoc">Here are some conversion routines to convert to regular Lab encoding.</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:919</div></div>
<div class="ttc" id="aa00143_html_aca284d408f443ba0b4161698077f88b1"><div class="ttname"><a href="../../d7/dce/a00143.html#aca284d408f443ba0b4161698077f88b1">icUSFtoD</a></div><div class="ttdeci">ICCPROFLIB_API icFloatNumber icUSFtoD(icU1Fixed15Number num)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:601</div></div>
<div class="ttc" id="aa00143_html_ae716aa59d818f8dda39c5a4245061336"><div class="ttname"><a href="../../d7/dce/a00143.html#ae716aa59d818f8dda39c5a4245061336">icUtf8StrCmp</a></div><div class="ttdeci">#define icUtf8StrCmp(x, y)</div><div class="ttdef"><b>Definition</b> IccUtil.h:188</div></div>
<div class="ttc" id="aa00143_html_af29908d138da11b5eb2b6174fb9020e2"><div class="ttname"><a href="../../d7/dce/a00143.html#af29908d138da11b5eb2b6174fb9020e2">icF16toF</a></div><div class="ttdeci">ICCPROFLIB_API icFloat32Number icF16toF(icFloat16Number num)</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:629</div></div>
<div class="ttc" id="aa00143_html_af798ee3250b2d1add99b57064aaf1961"><div class="ttname"><a href="../../d7/dce/a00143.html#af798ee3250b2d1add99b57064aaf1961">icNotZero</a></div><div class="ttdeci">#define icNotZero(v)</div><div class="ttdef"><b>Definition</b> IccUtil.h:89</div></div>
<div class="ttc" id="aa00155_html_a05df9b9a2f56c907e676a0efc3e9219d"><div class="ttname"><a href="../../d3/df8/a00155.html#a05df9b9a2f56c907e676a0efc3e9219d">IsSpaceSpectralPCS</a></div><div class="ttdeci">static __inline bool IsSpaceSpectralPCS(icUInt32Number sig)</div><div class="ttdef"><b>Definition</b> IccCmm.cpp:96</div></div>
<div class="ttc" id="aa00155_html_a09ef76f73cd16ef7b7c77358b527e816"><div class="ttname"><a href="../../d3/df8/a00155.html#a09ef76f73cd16ef7b7c77358b527e816">ICCPCSSTEPDUMPFMT</a></div><div class="ttdeci">#define ICCPCSSTEPDUMPFMT</div><div class="ttdef"><b>Definition</b> IccCmm.cpp:121</div></div>
<div class="ttc" id="aa00155_html_a1376d1bc8bb70237fde226cb6f49872c"><div class="ttname"><a href="../../d3/df8/a00155.html#a1376d1bc8bb70237fde226cb6f49872c">IsCompatSpace</a></div><div class="ttdeci">#define IsCompatSpace(x, y)</div><div class="ttdef"><b>Definition</b> IccCmm.cpp:116</div></div>
<div class="ttc" id="aa00155_html_a36a692db621ce2ccea49767209ab8294"><div class="ttname"><a href="../../d3/df8/a00155.html#a36a692db621ce2ccea49767209ab8294">RGBClip</a></div><div class="ttdeci">static icFloatNumber RGBClip(icFloatNumber v, CIccCurve *pCurve)</div><div class="ttdef"><b>Definition</b> IccCmm.cpp:5341</div></div>
<div class="ttc" id="aa00155_html_a95cfb076604d7bea59905ba50253b1d2"><div class="ttname"><a href="../../d3/df8/a00155.html#a95cfb076604d7bea59905ba50253b1d2">IsCompatSpacePCS</a></div><div class="ttdeci">#define IsCompatSpacePCS(x, y)</div><div class="ttdef"><b>Definition</b> IccCmm.cpp:118</div></div>
<div class="ttc" id="aa00155_html_a961f0b709819f36204e7da4148c1505e"><div class="ttname"><a href="../../d3/df8/a00155.html#a961f0b709819f36204e7da4148c1505e">icD50XYZ</a></div><div class="ttdeci">icFloatNumber icD50XYZ[3]</div><div class="ttdef"><b>Definition</b> IccUtil.cpp:782</div></div>
<div class="ttc" id="aa00155_html_aa7c8bbc66b122b6419782fbfb02d51ac"><div class="ttname"><a href="../../d3/df8/a00155.html#aa7c8bbc66b122b6419782fbfb02d51ac">XYZScale</a></div><div class="ttdeci">static icFloatNumber XYZScale(icFloatNumber v)</div><div class="ttdef"><b>Definition</b> IccCmm.cpp:5330</div></div>
<div class="ttc" id="aa00155_html_aaacd6d45813e2697ad238b12befa5719"><div class="ttname"><a href="../../d3/df8/a00155.html#aaacd6d45813e2697ad238b12befa5719">IsSpaceColorimetricPCS</a></div><div class="ttdeci">#define IsSpaceColorimetricPCS(x)</div><div class="ttdef"><b>Definition</b> IccCmm.cpp:108</div></div>
<div class="ttc" id="aa00155_html_ab304d4f0fe0c22e5b3e078e9ab1e7085"><div class="ttname"><a href="../../d3/df8/a00155.html#ab304d4f0fe0c22e5b3e078e9ab1e7085">IsNChannelCompat</a></div><div class="ttdeci">#define IsNChannelCompat(x, y)</div><div class="ttdef"><b>Definition</b> IccCmm.cpp:114</div></div>
<div class="ttc" id="aa00155_html_abb796a32bb9b930ceb2efcbb87f4a909"><div class="ttname"><a href="../../d3/df8/a00155.html#abb796a32bb9b930ceb2efcbb87f4a909">ICCDUMPPIXEL</a></div><div class="ttdeci">#define ICCDUMPPIXEL(n, pix)</div><div class="ttdef"><b>Definition</b> IccCmm.cpp:3417</div></div>
<div class="ttc" id="aa00155_html_ae5a787099f4191e4c234ca3301c9cc0a"><div class="ttname"><a href="../../d3/df8/a00155.html#ae5a787099f4191e4c234ca3301c9cc0a">XYZDescale</a></div><div class="ttdeci">static icFloatNumber XYZDescale(icFloatNumber v)</div><div class="ttdef"><b>Definition</b> IccCmm.cpp:5336</div></div>
<div class="ttc" id="aa00155_html_af2bf8c7d947cb795089de5f391f91d4d"><div class="ttname"><a href="../../d3/df8/a00155.html#af2bf8c7d947cb795089de5f391f91d4d">IsSpacePCS</a></div><div class="ttdeci">#define IsSpacePCS(x)</div><div class="ttdef"><b>Definition</b> IccCmm.cpp:110</div></div>
<div class="ttc" id="aa00182_html_ac2d11f72d4c98d21c3b2ca1509a52ee8adcc63bbed9191bd244da51839e152065"><div class="ttname"><a href="../../d7/d25/a00182.html#ac2d11f72d4c98d21c3b2ca1509a52ee8adcc63bbed9191bd244da51839e152065">icElemInterpLinear</a></div><div class="ttdeci">@ icElemInterpLinear</div><div class="ttdef"><b>Definition</b> IccTagMPE.h:94</div></div>
<div class="ttc" id="aa00215_html_aa1b934352875d96de59a8b3332dc8e1d"><div class="ttname"><a href="../../d3/dd5/a00215.html#aa1b934352875d96de59a8b3332dc8e1d">icConvertEncodingProfile</a></div><div class="ttdeci">icStatusEncConvert ICCPROFLIB_API icConvertEncodingProfile(CIccProfilePtr &amp;newIcc, CIccProfile *pEncodeIcc)</div><div class="ttdef"><b>Definition</b> IccEncoding.cpp:538</div></div>
<div class="ttc" id="aa00215_html_af0a7084e49f2f756cb1ff0cc500a9a41a3fed7724f564a3c845311a6694bc0b06"><div class="ttname"><a href="../../d3/dd5/a00215.html#af0a7084e49f2f756cb1ff0cc500a9a41a3fed7724f564a3c845311a6694bc0b06">icEncConvertOk</a></div><div class="ttdeci">@ icEncConvertOk</div><div class="ttdef"><b>Definition</b> IccEncoding.h:75</div></div>
<div class="ttc" id="aa00356_html_a6c0519738b01f52ba7341b517d3da7e4"><div class="ttname"><a href="../../d6/de1/a00356.html#a6c0519738b01f52ba7341b517d3da7e4">UnitClip</a></div><div class="ttdeci">static icFloatNumber UnitClip(icFloatNumber v)</div><div class="ttdef"><b>Definition</b> iccApplyProfiles.cpp:83</div></div>
<div class="ttc" id="aa00385_html"><div class="ttname"><a href="../../d5/d05/a00385.html">CIccArrayNamedColor</a></div><div class="ttdef"><b>Definition</b> IccArrayBasic.h:144</div></div>
<div class="ttc" id="aa00385_html_a1304a41486d0a0f39ce483c1efdc5664"><div class="ttname"><a href="../../d5/d05/a00385.html#a1304a41486d0a0f39ce483c1efdc5664">CIccArrayNamedColor::FindColor</a></div><div class="ttdeci">CIccStructNamedColor * FindColor(const icChar *szColor) const</div><div class="ttdef"><b>Definition</b> IccArrayBasic.cpp:303</div></div>
<div class="ttc" id="aa00385_html_a2aa8f9d61c012d05d22381c42d7c6b35"><div class="ttname"><a href="../../d5/d05/a00385.html#a2aa8f9d61c012d05d22381c42d7c6b35">CIccArrayNamedColor::GetSpectralTint</a></div><div class="ttdeci">bool GetSpectralTint(icFloatNumber *dstColor, const CIccStructNamedColor *pColor, icFloatNumber tint=1.0f, icNamedColorlMemberSignature sig=icSigNmclSpectralDataMbr) const</div><div class="ttdef"><b>Definition</b> IccArrayBasic.cpp:461</div></div>
<div class="ttc" id="aa00385_html_a6c3143e1f5a2433144786f86e7d9becc"><div class="ttname"><a href="../../d5/d05/a00385.html#a6c3143e1f5a2433144786f86e7d9becc">CIccArrayNamedColor::FindSpectralColor</a></div><div class="ttdeci">CIccStructNamedColor * FindSpectralColor(const icFloatNumber *pSpec, icFloatNumber dMinRms=1000.0) const</div><div class="ttdef"><b>Definition</b> IccArrayBasic.cpp:387</div></div>
<div class="ttc" id="aa00385_html_a823d6f29347e6f86de07de8bfad1ba89"><div class="ttname"><a href="../../d5/d05/a00385.html#a823d6f29347e6f86de07de8bfad1ba89">CIccArrayNamedColor::SetColorSpaces</a></div><div class="ttdeci">void SetColorSpaces(icColorSpaceSignature csPcs, icColorSpaceSignature csDevice, icSpectralColorSignature csSpectralPCS=icSigNoSpectralData, const icSpectralRange *pSpectralRange=NULL, const icSpectralRange *pBiSPectralRange=NULL)</div><div class="ttdef"><b>Definition</b> IccArrayBasic.cpp:261</div></div>
<div class="ttc" id="aa00385_html_a9425c5f4e45f89e119c7dd5add27f69a"><div class="ttname"><a href="../../d5/d05/a00385.html#a9425c5f4e45f89e119c7dd5add27f69a">CIccArrayNamedColor::FindDeviceColor</a></div><div class="ttdeci">CIccStructNamedColor * FindDeviceColor(const icFloatNumber *pDevColor) const</div><div class="ttdef"><b>Definition</b> IccArrayBasic.cpp:315</div></div>
<div class="ttc" id="aa00385_html_a94b8521face8ca8e1df119db8d7abeeb"><div class="ttname"><a href="../../d5/d05/a00385.html#a94b8521face8ca8e1df119db8d7abeeb">CIccArrayNamedColor::FindPcsColor</a></div><div class="ttdeci">CIccStructNamedColor * FindPcsColor(const icFloatNumber *pPCS, icFloatNumber dMinDE=1000.0) const</div><div class="ttdef"><b>Definition</b> IccArrayBasic.cpp:349</div></div>
<div class="ttc" id="aa00385_html_af4f89dcbac98bad8077327211a88b096"><div class="ttname"><a href="../../d5/d05/a00385.html#af4f89dcbac98bad8077327211a88b096">CIccArrayNamedColor::GetDeviceTint</a></div><div class="ttdeci">bool GetDeviceTint(icFloatNumber *dstColor, const CIccStructNamedColor *pColor, icFloatNumber tint=1.0f, icNamedColorlMemberSignature sig=icSigNmclDeviceDataMbr) const</div><div class="ttdef"><b>Definition</b> IccArrayBasic.cpp:424</div></div>
<div class="ttc" id="aa00385_html_afd4f2f9a44dc33fa6f8d517f43949d09"><div class="ttname"><a href="../../d5/d05/a00385.html#afd4f2f9a44dc33fa6f8d517f43949d09">CIccArrayNamedColor::GetPcsTint</a></div><div class="ttdeci">bool GetPcsTint(icFloatNumber *dstColor, const CIccStructNamedColor *pColor, icFloatNumber tint=1.0f, icNamedColorlMemberSignature sig=icSigNmclPcsDataMbr) const</div><div class="ttdef"><b>Definition</b> IccArrayBasic.cpp:443</div></div>
<div class="ttc" id="aa00393_html_ae59376fd46156a41bb687406b3d881d7"><div class="ttname"><a href="../../da/dbf/a00393.html#ae59376fd46156a41bb687406b3d881d7">CIccStructUnknown::GetElem</a></div><div class="ttdeci">CIccTag * GetElem(icSignature sigElem) const</div><div class="ttdef"><b>Definition</b> IccStructBasic.cpp:172</div></div>
<div class="ttc" id="aa00397_html"><div class="ttname"><a href="../../d7/d93/a00397.html">CIccStructNamedColor</a></div><div class="ttdef"><b>Definition</b> IccStructBasic.h:127</div></div>
<div class="ttc" id="aa00397_html_a5e4aa1c33ed61d8d91ca597e57ab7177"><div class="ttname"><a href="../../d7/d93/a00397.html#a5e4aa1c33ed61d8d91ca597e57ab7177">CIccStructNamedColor::getName</a></div><div class="ttdeci">std::string getName() const</div><div class="ttdef"><b>Definition</b> IccStructBasic.cpp:457</div></div>
<div class="ttc" id="aa00401_html"><div class="ttname"><a href="../../d7/d00/a00401.html">CIccStructBRDF</a></div><div class="ttdef"><b>Definition</b> IccStructBasic.h:161</div></div>
<div class="ttc" id="aa00429_html"><div class="ttname"><a href="../../d4/d53/a00429.html">CIccPixelBuf</a></div><div class="ttdef"><b>Definition</b> IccUtil.h:375</div></div>
<div class="ttc" id="aa00465_html"><div class="ttname"><a href="../../db/de0/a00465.html">CIccTagArray</a></div><div class="ttdef"><b>Definition</b> IccTagComposite.h:226</div></div>
<div class="ttc" id="aa00465_html_a0eec94cc1fea6ce5febd2d2a2c33921f"><div class="ttname"><a href="../../db/de0/a00465.html#a0eec94cc1fea6ce5febd2d2a2c33921f">CIccTagArray::AreAllOfType</a></div><div class="ttdeci">bool AreAllOfType(icTagTypeSignature sigTagType)</div><div class="ttdef"><b>Definition</b> IccTagComposite.cpp:1145</div></div>
<div class="ttc" id="aa00465_html_ab040f1c5616c6b39dc92a5d2516f7709"><div class="ttname"><a href="../../db/de0/a00465.html#ab040f1c5616c6b39dc92a5d2516f7709">CIccTagArray::GetArrayHandler</a></div><div class="ttdeci">IIccArray * GetArrayHandler()</div><div class="ttdef"><b>Definition</b> IccTagComposite.cpp:1624</div></div>
<div class="ttc" id="aa00465_html_ac30ff943da70f26a654f2e9d39c0e568"><div class="ttname"><a href="../../db/de0/a00465.html#ac30ff943da70f26a654f2e9d39c0e568">CIccTagArray::GetIndex</a></div><div class="ttdeci">CIccTag * GetIndex(icUInt32Number index) const</div><div class="ttdef"><b>Definition</b> IccTagComposite.cpp:1544</div></div>
<div class="ttc" id="aa00465_html_ad89262b326c7dde5b444599ed6d862e7"><div class="ttname"><a href="../../db/de0/a00465.html#ad89262b326c7dde5b444599ed6d862e7">CIccTagArray::GetSize</a></div><div class="ttdeci">icUInt32Number GetSize() const</div><div class="ttdoc">Returns the size of the data array.</div><div class="ttdef"><b>Definition</b> IccTagComposite.h:260</div></div>
<div class="ttc" id="aa00465_html_ae4d0c4f6859dc47d44b5b0c9c6ab4e44"><div class="ttname"><a href="../../db/de0/a00465.html#ae4d0c4f6859dc47d44b5b0c9c6ab4e44">CIccTagArray::GetTagArrayType</a></div><div class="ttdeci">virtual icArraySignature GetTagArrayType() const</div><div class="ttdef"><b>Definition</b> IccTagComposite.h:238</div></div>
<div class="ttc" id="aa00809_html_a194b94632e3d77385001a1596380d884"><div class="ttname"><a href="../../dd/d7e/a00809.html#a194b94632e3d77385001a1596380d884">CIccXformCreator::CreateXform</a></div><div class="ttdeci">static CIccXform * CreateXform(icXformType xformType, CIccTag *pTag=NULL, CIccCreateXformHintManager *pHintManager=NULL)</div><div class="ttdef"><b>Definition</b> IccXformFactory.h:185</div></div>
<div class="ttc" id="aa00857_html"><div class="ttname"><a href="../../d0/d82/a00857.html">CIccMpeMatrix</a></div><div class="ttdef"><b>Definition</b> IccMpeBasic.h:600</div></div>
<div class="ttc" id="aa00857_html_a02f8ec1722ad1f16f5ea3efa7b241f91"><div class="ttname"><a href="../../d0/d82/a00857.html#a02f8ec1722ad1f16f5ea3efa7b241f91">CIccMpeMatrix::GetConstants</a></div><div class="ttdeci">icFloatNumber * GetConstants() const</div><div class="ttdef"><b>Definition</b> IccMpeBasic.h:619</div></div>
<div class="ttc" id="aa00857_html_a6e45463a693a93771269d03b6c5ccd53"><div class="ttname"><a href="../../d0/d82/a00857.html#a6e45463a693a93771269d03b6c5ccd53">CIccMpeMatrix::Begin</a></div><div class="ttdeci">virtual bool Begin(icElemInterp nInterp, CIccTagMultiProcessElement *pMPE)</div><div class="ttdef"><b>Definition</b> IccMpeBasic.cpp:5180</div></div>
<div class="ttc" id="aa00857_html_a8caea712089acbdd830b1fa29d10aa8c"><div class="ttname"><a href="../../d0/d82/a00857.html#a8caea712089acbdd830b1fa29d10aa8c">CIccMpeMatrix::GetMatrix</a></div><div class="ttdeci">icFloatNumber * GetMatrix() const</div><div class="ttdef"><b>Definition</b> IccMpeBasic.h:618</div></div>
<div class="ttc" id="aa00857_html_adbf9791bb07086c6e6770d1914817663"><div class="ttname"><a href="../../d0/d82/a00857.html#adbf9791bb07086c6e6770d1914817663">CIccMpeMatrix::GetApplyConstants</a></div><div class="ttdeci">bool GetApplyConstants() const</div><div class="ttdef"><b>Definition</b> IccMpeBasic.h:620</div></div>
<div class="ttc" id="aa00885_html"><div class="ttname"><a href="../../db/d18/a00885.html">IIccProfileConnectionConditions</a></div><div class="ttdef"><b>Definition</b> IccPcc.h:94</div></div>
<div class="ttc" id="aa00885_html_a16094632a566d2945892046797fac4d9"><div class="ttname"><a href="../../db/d18/a00885.html#a16094632a566d2945892046797fac4d9">IIccProfileConnectionConditions::getStandardToCustomPcc</a></div><div class="ttdeci">virtual CIccTagMultiProcessElement * getStandardToCustomPcc()=0</div></div>
<div class="ttc" id="aa00885_html_a41d44184a1e66e1f7bd46e60fc69fda6"><div class="ttname"><a href="../../db/d18/a00885.html#a41d44184a1e66e1f7bd46e60fc69fda6">IIccProfileConnectionConditions::getPccViewingConditions</a></div><div class="ttdeci">virtual const CIccTagSpectralViewingConditions * getPccViewingConditions()=0</div></div>
<div class="ttc" id="aa00885_html_a6a535454f7d93b11bc5f6a83e9142331"><div class="ttname"><a href="../../db/d18/a00885.html#a6a535454f7d93b11bc5f6a83e9142331">IIccProfileConnectionConditions::getCustomToStandardPcc</a></div><div class="ttdeci">virtual CIccTagMultiProcessElement * getCustomToStandardPcc()=0</div></div>
<div class="ttc" id="aa00885_html_a6b7d53898284b4c85611c2443e14d70c"><div class="ttname"><a href="../../db/d18/a00885.html#a6b7d53898284b4c85611c2443e14d70c">IIccProfileConnectionConditions::getLumIlluminantXYZ</a></div><div class="ttdeci">virtual void getLumIlluminantXYZ(icFloatNumber *pXYZ)=0</div></div>
<div class="ttc" id="aa00885_html_a7268d05a042b582c68477e4aa956041a"><div class="ttname"><a href="../../db/d18/a00885.html#a7268d05a042b582c68477e4aa956041a">IIccProfileConnectionConditions::getMediaWhiteXYZ</a></div><div class="ttdeci">virtual bool getMediaWhiteXYZ(icFloatNumber *pXYZ)=0</div></div>
<div class="ttc" id="aa00885_html_a81fb6e4ffae390d84145d802702b6d6c"><div class="ttname"><a href="../../db/d18/a00885.html#a81fb6e4ffae390d84145d802702b6d6c">IIccProfileConnectionConditions::getObserverWhiteScaleFactor</a></div><div class="ttdeci">icFloatNumber getObserverWhiteScaleFactor(const icFloatNumber *pWhite, const icSpectralRange &amp;whiteRange)</div><div class="ttdef"><b>Definition</b> IccPcc.cpp:198</div></div>
<div class="ttc" id="aa00885_html_a91dc6e895f5fcc5cd924bcdedd5ea0b5"><div class="ttname"><a href="../../db/d18/a00885.html#a91dc6e895f5fcc5cd924bcdedd5ea0b5">IIccProfileConnectionConditions::isStandardPcc</a></div><div class="ttdeci">bool isStandardPcc()</div><div class="ttdef"><b>Definition</b> IccPcc.cpp:139</div></div>
<div class="ttc" id="aa00885_html_a9c5c38685ec6a82b97608f5571e303f2"><div class="ttname"><a href="../../db/d18/a00885.html#a9c5c38685ec6a82b97608f5571e303f2">IIccProfileConnectionConditions::getNormIlluminantXYZ</a></div><div class="ttdeci">virtual void getNormIlluminantXYZ(icFloatNumber *pXYZ)=0</div></div>
<div class="ttc" id="aa00885_html_a9ca9746d8f42338293e7570275af03d7"><div class="ttname"><a href="../../db/d18/a00885.html#a9ca9746d8f42338293e7570275af03d7">IIccProfileConnectionConditions::isEquivalentPcc</a></div><div class="ttdeci">bool isEquivalentPcc(IIccProfileConnectionConditions &amp;IPCC)</div><div class="ttdef"><b>Definition</b> IccPcc.cpp:79</div></div>
<div class="ttc" id="aa00889_html"><div class="ttname"><a href="../../de/dc8/a00889.html">CIccCombinedConnectionConditions</a></div><div class="ttdef"><b>Definition</b> IccPcc.h:135</div></div>
<div class="ttc" id="aa00905_html"><div class="ttname"><a href="../../da/d5b/a00905.html">CIccMemIO</a></div><div class="ttdef"><b>Definition</b> IccIO.h:217</div></div>
<div class="ttc" id="aa00905_html_ae20403295a31727fe9f77ce46ea57c8e"><div class="ttname"><a href="../../da/d5b/a00905.html#ae20403295a31727fe9f77ce46ea57c8e">CIccMemIO::Attach</a></div><div class="ttdeci">bool Attach(icUInt8Number *pData, icUInt32Number nSize, bool bWrite=false)</div><div class="ttdef"><b>Definition</b> IccIO.cpp:686</div></div>
<div class="ttc" id="aa00941_html"><div class="ttname"><a href="../../d6/dad/a00941.html">CIccSparseMatrix</a></div><div class="ttdef"><b>Definition</b> IccSparseMatrix.h:154</div></div>
<div class="ttc" id="aa00941_html_a966b1ee488c4648da2c84b4484e7ff4a"><div class="ttname"><a href="../../d6/dad/a00941.html#a966b1ee488c4648da2c84b4484e7ff4a">CIccSparseMatrix::MemSize</a></div><div class="ttdeci">static icUInt32Number MemSize(icUInt32Number nMaxEntries, icUInt16Number nRows, icUInt8Number nTypeSize)</div><div class="ttdef"><b>Definition</b> IccSparseMatrix.cpp:505</div></div>
<div class="ttc" id="aa00969_html"><div class="ttname"><a href="../../d7/dfd/a00969.html">CIccTag</a></div><div class="ttdef"><b>Definition</b> IccTagBasic.h:108</div></div>
<div class="ttc" id="aa00969_html_a0d6f4b6f857134bd87bfb0cd54025208"><div class="ttname"><a href="../../d7/dfd/a00969.html#a0d6f4b6f857134bd87bfb0cd54025208">CIccTag::GetType</a></div><div class="ttdeci">virtual icTagTypeSignature GetType() const</div><div class="ttdef"><b>Definition</b> IccTagBasic.h:131</div></div>
<div class="ttc" id="aa00969_html_a3415307280dc7b871cc1797704008991"><div class="ttname"><a href="../../d7/dfd/a00969.html#a3415307280dc7b871cc1797704008991">CIccTag::IsSupported</a></div><div class="ttdeci">virtual bool IsSupported()</div><div class="ttdef"><b>Definition</b> IccTagBasic.h:153</div></div>
<div class="ttc" id="aa00969_html_a5cf5b72ab66ca68a6c8ddfd861741bb8"><div class="ttname"><a href="../../d7/dfd/a00969.html#a5cf5b72ab66ca68a6c8ddfd861741bb8">CIccTag::IsMBBType</a></div><div class="ttdeci">virtual bool IsMBBType()</div><div class="ttdef"><b>Definition</b> IccTagBasic.h:136</div></div>
<div class="ttc" id="aa00969_html_aa2a3dd91bfad9cf1297300d70936121a"><div class="ttname"><a href="../../d7/dfd/a00969.html#aa2a3dd91bfad9cf1297300d70936121a">CIccTag::IsNumArrayType</a></div><div class="ttdeci">virtual bool IsNumArrayType() const</div><div class="ttdef"><b>Definition</b> IccTagBasic.h:137</div></div>
<div class="ttc" id="aa00969_html_acc454c2f425b8619187fc75f682d7aa4"><div class="ttname"><a href="../../d7/dfd/a00969.html#acc454c2f425b8619187fc75f682d7aa4">CIccTag::GetTagArrayType</a></div><div class="ttdeci">virtual icArraySignature GetTagArrayType() const</div><div class="ttdef"><b>Definition</b> IccTagBasic.h:133</div></div>
<div class="ttc" id="aa00981_html"><div class="ttname"><a href="../../dd/d24/a00981.html">CIccTagUtf8Text</a></div><div class="ttdef"><b>Definition</b> IccTagBasic.h:322</div></div>
<div class="ttc" id="aa01013_html"><div class="ttname"><a href="../../d7/d59/a01013.html">CIccTagNamedColor2</a></div><div class="ttdef"><b>Definition</b> IccTagBasic.h:582</div></div>
<div class="ttc" id="aa01013_html_a0149970e81173a7e6136404d07bf7f5f"><div class="ttname"><a href="../../d7/d59/a01013.html#a0149970e81173a7e6136404d07bf7f5f">CIccTagNamedColor2::FindDeviceColor</a></div><div class="ttdeci">icInt32Number FindDeviceColor(icFloatNumber *pDevColor) const</div><div class="ttdef"><b>Definition</b> IccTagBasic.cpp:3299</div></div>
<div class="ttc" id="aa01013_html_a2a06050ccddbf173a2fe355cdf6fa098"><div class="ttname"><a href="../../d7/d59/a01013.html#a2a06050ccddbf173a2fe355cdf6fa098">CIccTagNamedColor2::GetColorName</a></div><div class="ttdeci">bool GetColorName(std::string &amp;sColorName, icInt32Number index) const</div><div class="ttdef"><b>Definition</b> IccTagBasic.cpp:3348</div></div>
<div class="ttc" id="aa01013_html_a2a76002d604136358d1adb711faf6e90"><div class="ttname"><a href="../../d7/d59/a01013.html#a2a76002d604136358d1adb711faf6e90">CIccTagNamedColor2::FindColor</a></div><div class="ttdeci">icInt32Number FindColor(const icChar *szColor) const</div><div class="ttdef"><b>Definition</b> IccTagBasic.cpp:3255</div></div>
<div class="ttc" id="aa01013_html_a2ea2db6f07f694b094360198c3fa3c8e"><div class="ttname"><a href="../../d7/d59/a01013.html#a2ea2db6f07f694b094360198c3fa3c8e">CIccTagNamedColor2::GetPCS</a></div><div class="ttdeci">icColorSpaceSignature GetPCS() const</div><div class="ttdef"><b>Definition</b> IccTagBasic.h:633</div></div>
<div class="ttc" id="aa01013_html_a6b6ed7f3550c3939ce66094d97173fdb"><div class="ttname"><a href="../../d7/d59/a01013.html#a6b6ed7f3550c3939ce66094d97173fdb">CIccTagNamedColor2::GetDeviceCoords</a></div><div class="ttdeci">icUInt32Number GetDeviceCoords() const</div><div class="ttdef"><b>Definition</b> IccTagBasic.h:629</div></div>
<div class="ttc" id="aa01013_html_ab6ec797d2fdea65e273f2c484fa260ce"><div class="ttname"><a href="../../d7/d59/a01013.html#ab6ec797d2fdea65e273f2c484fa260ce">CIccTagNamedColor2::GetDeviceSpace</a></div><div class="ttdeci">icColorSpaceSignature GetDeviceSpace() const</div><div class="ttdef"><b>Definition</b> IccTagBasic.h:634</div></div>
<div class="ttc" id="aa01013_html_ac2fef9b4b97a913ce966f86d934c5ce4"><div class="ttname"><a href="../../d7/d59/a01013.html#ac2fef9b4b97a913ce966f86d934c5ce4">CIccTagNamedColor2::FindCachedPCSColor</a></div><div class="ttdeci">icInt32Number FindCachedPCSColor(icFloatNumber *pPCS, icFloatNumber dMinDE=1000.0) const</div><div class="ttdef"><b>Definition</b> IccTagBasic.cpp:3180</div></div>
<div class="ttc" id="aa01013_html_acfa051e5560291e61af31c3ccf3b28e3"><div class="ttname"><a href="../../d7/d59/a01013.html#acfa051e5560291e61af31c3ccf3b28e3">CIccTagNamedColor2::GetEntry</a></div><div class="ttdeci">SIccNamedColorEntry * GetEntry(icUInt32Number index) const</div><div class="ttdef"><b>Definition</b> IccTagBasic.h:626</div></div>
<div class="ttc" id="aa01017_html"><div class="ttname"><a href="../../d3/ded/a01017.html">CIccTagXYZ</a></div><div class="ttdef"><b>Definition</b> IccTagBasic.h:668</div></div>
<div class="ttc" id="aa01029_html"><div class="ttname"><a href="../../d0/daa/a01029.html">CIccTagNumArray</a></div><div class="ttdef"><b>Definition</b> IccTagBasic.h:791</div></div>
<div class="ttc" id="aa01029_html_a2c8e9e09f0916181fc93e0d5ce1817d8"><div class="ttname"><a href="../../d0/daa/a01029.html#a2c8e9e09f0916181fc93e0d5ce1817d8">CIccTagNumArray::GetValues</a></div><div class="ttdeci">virtual bool GetValues(icFloatNumber *DstVector, icUInt32Number nStart=0, icUInt32Number nVectorSize=1) const =0</div></div>
<div class="ttc" id="aa01109_html"><div class="ttname"><a href="../../d8/dbf/a01109.html">CIccTagSpectralViewingConditions</a></div><div class="ttdef"><b>Definition</b> IccTagBasic.h:1692</div></div>
<div class="ttc" id="aa01109_html_a2319ced95e40cb2493820227f54a302d"><div class="ttname"><a href="../../d8/dbf/a01109.html#a2319ced95e40cb2493820227f54a302d">CIccTagSpectralViewingConditions::getObserver</a></div><div class="ttdeci">const icFloatNumber * getObserver(icSpectralRange &amp;observerRange) const</div><div class="ttdef"><b>Definition</b> IccTagBasic.cpp:11569</div></div>
<div class="ttc" id="aa01109_html_a339a66cb30a03163f17861f8c704df51"><div class="ttname"><a href="../../d8/dbf/a01109.html#a339a66cb30a03163f17861f8c704df51">CIccTagSpectralViewingConditions::getIlluminantCCT</a></div><div class="ttdeci">icFloatNumber getIlluminantCCT() const</div><div class="ttdef"><b>Definition</b> IccTagBasic.h:1713</div></div>
<div class="ttc" id="aa01109_html_a8877a21252b3f70c761e049765cfb10e"><div class="ttname"><a href="../../d8/dbf/a01109.html#a8877a21252b3f70c761e049765cfb10e">CIccTagSpectralViewingConditions::getStdIllumiant</a></div><div class="ttdeci">icIlluminant getStdIllumiant() const</div><div class="ttdef"><b>Definition</b> IccTagBasic.h:1712</div></div>
<div class="ttc" id="aa01109_html_aa4fe6556022cceea44adf34848528245"><div class="ttname"><a href="../../d8/dbf/a01109.html#aa4fe6556022cceea44adf34848528245">CIccTagSpectralViewingConditions::getIlluminant</a></div><div class="ttdeci">const icFloatNumber * getIlluminant(icSpectralRange &amp;illumRange) const</div><div class="ttdef"><b>Definition</b> IccTagBasic.cpp:11405</div></div>
<div class="ttc" id="aa01109_html_ab70e50510cb2440171a3ba005587adff"><div class="ttname"><a href="../../d8/dbf/a01109.html#ab70e50510cb2440171a3ba005587adff">CIccTagSpectralViewingConditions::applyRangeToObserver</a></div><div class="ttdeci">icFloatNumber * applyRangeToObserver(const icSpectralRange &amp;newRange) const</div><div class="ttdef"><b>Definition</b> IccTagBasic.cpp:11301</div></div>
<div class="ttc" id="aa01121_html"><div class="ttname"><a href="../../dd/de4/a01121.html">CIccCurve</a></div><div class="ttdef"><b>Definition</b> IccTagLut.h:91</div></div>
<div class="ttc" id="aa01121_html_a0c972a2a0eacd5245a0f52993c9f501f"><div class="ttname"><a href="../../dd/de4/a01121.html#a0c972a2a0eacd5245a0f52993c9f501f">CIccCurve::Apply</a></div><div class="ttdeci">virtual icFloatNumber Apply(icFloatNumber v) const</div><div class="ttdef"><b>Definition</b> IccTagLut.h:101</div></div>
<div class="ttc" id="aa01121_html_a947c1f052a69bbfdbe3c873f3b44921d"><div class="ttname"><a href="../../dd/de4/a01121.html#a947c1f052a69bbfdbe3c873f3b44921d">CIccCurve::Begin</a></div><div class="ttdeci">virtual void Begin()</div><div class="ttdef"><b>Definition</b> IccTagLut.h:100</div></div>
<div class="ttc" id="aa01121_html_abf88e98ece3d98f0e8bc090fe7596e05"><div class="ttname"><a href="../../dd/de4/a01121.html#abf88e98ece3d98f0e8bc090fe7596e05">CIccCurve::Find</a></div><div class="ttdeci">icFloatNumber Find(icFloatNumber v)</div><div class="ttdef"><b>Definition</b> IccTagLut.h:103</div></div>
<div class="ttc" id="aa01125_html"><div class="ttname"><a href="../../d6/dc4/a01125.html">CIccTagCurve</a></div><div class="ttdef"><b>Definition</b> IccTagLut.h:128</div></div>
<div class="ttc" id="aa01145_html"><div class="ttname"><a href="../../d9/d65/a01145.html">CIccApplyCLUT</a></div><div class="ttdef"><b>Definition</b> IccTagLut.h:302</div></div>
<div class="ttc" id="aa01149_html"><div class="ttname"><a href="../../d8/d02/a01149.html">CIccCLUT</a></div><div class="ttdef"><b>Definition</b> IccTagLut.h:326</div></div>
<div class="ttc" id="aa01149_html_af5d5680c45af970ec254e32f06b15c41"><div class="ttname"><a href="../../d8/d02/a01149.html#af5d5680c45af970ec254e32f06b15c41">CIccCLUT::GetNewApply</a></div><div class="ttdeci">CIccApplyCLUT * GetNewApply()</div><div class="ttdef"><b>Definition</b> IccTagLut.cpp:2403</div></div>
<div class="ttc" id="aa01153_html"><div class="ttname"><a href="../../dc/d06/a01153.html">CIccMBB</a></div><div class="ttdef"><b>Definition</b> IccTagLut.h:428</div></div>
<div class="ttc" id="aa01193_html"><div class="ttname"><a href="../../dd/d43/a01193.html">CIccMultiProcessElement</a></div><div class="ttdef"><b>Definition</b> IccTagMPE.h:146</div></div>
<div class="ttc" id="aa01193_html_a0e7393d937cb768d52265a7ebed2b3a9"><div class="ttname"><a href="../../dd/d43/a01193.html#a0e7393d937cb768d52265a7ebed2b3a9">CIccMultiProcessElement::NumInputChannels</a></div><div class="ttdeci">virtual icUInt16Number NumInputChannels() const</div><div class="ttdef"><b>Definition</b> IccTagMPE.h:159</div></div>
<div class="ttc" id="aa01193_html_a431d2d96c834f4f9b0674dafe8609ae1"><div class="ttname"><a href="../../dd/d43/a01193.html#a431d2d96c834f4f9b0674dafe8609ae1">CIccMultiProcessElement::NumOutputChannels</a></div><div class="ttdeci">virtual icUInt16Number NumOutputChannels() const</div><div class="ttdef"><b>Definition</b> IccTagMPE.h:160</div></div>
<div class="ttc" id="aa01193_html_abc48ee629f3d2102bfdd5c03891b37e1"><div class="ttname"><a href="../../dd/d43/a01193.html#abc48ee629f3d2102bfdd5c03891b37e1">CIccMultiProcessElement::GetType</a></div><div class="ttdeci">virtual icElemTypeSignature GetType() const =0</div></div>
<div class="ttc" id="aa01213_html"><div class="ttname"><a href="../../d5/d54/a01213.html">CIccTagMultiProcessElement</a></div><div class="ttdef"><b>Definition</b> IccTagMPE.h:358</div></div>
<div class="ttc" id="aa01213_html_a1492a516235fdb066359bb5362efc89a"><div class="ttname"><a href="../../d5/d54/a01213.html#a1492a516235fdb066359bb5362efc89a">CIccTagMultiProcessElement::NumInputChannels</a></div><div class="ttdeci">icUInt16Number NumInputChannels() const</div><div class="ttdef"><b>Definition</b> IccTagMPE.h:393</div></div>
<div class="ttc" id="aa01213_html_a425dfa52f0af074b588df02d283d63f9"><div class="ttname"><a href="../../d5/d54/a01213.html#a425dfa52f0af074b588df02d283d63f9">CIccTagMultiProcessElement::NumOutputChannels</a></div><div class="ttdeci">icUInt16Number NumOutputChannels() const</div><div class="ttdef"><b>Definition</b> IccTagMPE.h:394</div></div>
<div class="ttc" id="aa01213_html_a87956fe8fd516379d8a450d057f258fb"><div class="ttname"><a href="../../d5/d54/a01213.html#a87956fe8fd516379d8a450d057f258fb">CIccTagMultiProcessElement::NewCopy</a></div><div class="ttdeci">virtual CIccTag * NewCopy() const</div><div class="ttdef"><b>Definition</b> IccTagMPE.h:363</div></div>
<div class="ttc" id="aa01213_html_a8e6ad3114229992a0c1df3d1d30e02ef"><div class="ttname"><a href="../../d5/d54/a01213.html#a8e6ad3114229992a0c1df3d1d30e02ef">CIccTagMultiProcessElement::Apply</a></div><div class="ttdeci">virtual void Apply(CIccApplyTagMpe *pApply, icFloatNumber *pDestPixel, const icFloatNumber *pSrcPixel) const</div><div class="ttdef"><b>Definition</b> IccTagMPE.cpp:1440</div></div>
<div class="ttc" id="aa01213_html_a9074a090efc10dd2470ff45594e10a11"><div class="ttname"><a href="../../d5/d54/a01213.html#a9074a090efc10dd2470ff45594e10a11">CIccTagMultiProcessElement::NumElements</a></div><div class="ttdeci">icUInt32Number NumElements() const</div><div class="ttdef"><b>Definition</b> IccTagMPE.h:398</div></div>
<div class="ttc" id="aa01213_html_ad49db93f89c409fc5aa3bd646a00beac"><div class="ttname"><a href="../../d5/d54/a01213.html#ad49db93f89c409fc5aa3bd646a00beac">CIccTagMultiProcessElement::GetElement</a></div><div class="ttdeci">CIccMultiProcessElement * GetElement(int nIndex)</div><div class="ttdef"><b>Definition</b> IccTagMPE.cpp:1189</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab304d4f0fe0c22e5b3e078e9ab1e7085" name="ab304d4f0fe0c22e5b3e078e9ab1e7085"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab304d4f0fe0c22e5b3e078e9ab1e7085">&#9670;&#160;</a></span>IsNChannelCompat</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IsNChannelCompat</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">y&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td>&#160;&#160;&#160;((<a class="el" href="../../d3/df8/a00155.html#ab99e08f792259e1107c118b20cacd1ce">IsSpaceNChannel</a>(x) &amp;&amp; <a class="el" href="../../d7/d46/a00002.html#a186dd5a24f08dc94beb7142e3872b426">icNumColorSpaceChannels</a>(x)==<a class="el" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(y)) || (<a class="el" href="../../d3/df8/a00155.html#ab99e08f792259e1107c118b20cacd1ce">IsSpaceNChannel</a>(y) &amp;&amp; <a class="el" href="../../d7/d46/a00002.html#a186dd5a24f08dc94beb7142e3872b426">icNumColorSpaceChannels</a>(y)==<a class="el" href="../../d7/dce/a00143.html#a719dc0d47f230294e78ac9c8cbc91a89">icGetSpaceSamples</a>(x)))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afc0e6f40540589cbdcd61411462e0aad" name="afc0e6f40540589cbdcd61411462e0aad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc0e6f40540589cbdcd61411462e0aad">&#9670;&#160;</a></span>IsSpaceCMYK</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IsSpaceCMYK</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((x)==<a class="el" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661">icSigCmykData</a> || (x)==<a class="el" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917addb4c9db388eda46c3ec7fdaa8824cf5">icSig4colorData</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aaacd6d45813e2697ad238b12befa5719" name="aaacd6d45813e2697ad238b12befa5719"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaacd6d45813e2697ad238b12befa5719">&#9670;&#160;</a></span>IsSpaceColorimetricPCS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IsSpaceColorimetricPCS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((x)==<a class="el" href="../../d7/d46/a00002.html#a3cc88012894a42474b7609adbe314918">icSigXYZPcsData</a> || (x)==<a class="el" href="../../d7/d46/a00002.html#a043048bd0c63d3bd54d35e8b5743d226">icSigLabPcsData</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8685fe2c409e3323ec4a11938664df34" name="a8685fe2c409e3323ec4a11938664df34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8685fe2c409e3323ec4a11938664df34">&#9670;&#160;</a></span>IsSpaceDevicePCS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IsSpaceDevicePCS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;((x)==<a class="el" href="../../d4/d81/a00110.html#a550e980dd884839e33548afbd55b4277">icSigDevXYZData</a> || (x)==<a class="el" href="../../d4/d81/a00110.html#a92d563abc2c24efa8ccad672a9dfd14f">icSigDevLabData</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac420df5122347019d9a312b07100d8de" name="ac420df5122347019d9a312b07100d8de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac420df5122347019d9a312b07100d8de">&#9670;&#160;</a></span>IsSpaceMCS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IsSpaceMCS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="../../d7/d46/a00002.html#a47e4f847bd0bc609907b5fea4daf3e75">icGetColorSpaceType</a>(x)==<a class="el" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917a79b72a0338fa6fbae9f707dd48b57f13">icSigSrcMCSChannelData</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab99e08f792259e1107c118b20cacd1ce" name="ab99e08f792259e1107c118b20cacd1ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab99e08f792259e1107c118b20cacd1ce">&#9670;&#160;</a></span>IsSpaceNChannel</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IsSpaceNChannel</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="../../d7/d46/a00002.html#a47e4f847bd0bc609907b5fea4daf3e75">icGetColorSpaceType</a>(x)==<a class="el" href="../../d7/d46/a00002.html#a61e8bac86860cdefe93533feac126917ac8919c5ac8fc3849f57bf7fd2fc1d70a">icSigNChannelData</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="af2bf8c7d947cb795089de5f391f91d4d" name="af2bf8c7d947cb795089de5f391f91d4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af2bf8c7d947cb795089de5f391f91d4d">&#9670;&#160;</a></span>IsSpacePCS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define IsSpacePCS</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;(<a class="el" href="../../d3/df8/a00155.html#aaacd6d45813e2697ad238b12befa5719">IsSpaceColorimetricPCS</a>(x) || <a class="el" href="../../d3/df8/a00155.html#a05df9b9a2f56c907e676a0efc3e9219d">IsSpaceSpectralPCS</a>(x))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a05df9b9a2f56c907e676a0efc3e9219d" name="a05df9b9a2f56c907e676a0efc3e9219d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a05df9b9a2f56c907e676a0efc3e9219d">&#9670;&#160;</a></span>IsSpaceSpectralPCS()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static __inline bool IsSpaceSpectralPCS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d7/d46/a00002.html#a63276cc6df51af4efa1945ecae93a182">icUInt32Number</a>&#160;</td>
          <td class="paramname"><em>sig</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">   97</span>{</div>
<div class="line"><span class="lineno">   98</span>  sig = <a class="code hl_define" href="../../d7/d46/a00002.html#a47e4f847bd0bc609907b5fea4daf3e75">icGetColorSpaceType</a>(sig);</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>  <span class="keywordflow">return</span> sig==<a class="code hl_define" href="../../d7/d46/a00002.html#aa9cd4477816537fbf648a155f6b78eda">icSigReflectanceSpectralPcsData</a> ||</div>
<div class="line"><span class="lineno">  101</span>         sig==<a class="code hl_define" href="../../d7/d46/a00002.html#af5df74ebff3f8247e1c7c88844c1f140">icSigTransmissionSpectralPcsData</a> ||</div>
<div class="line"><span class="lineno">  102</span>         sig==<a class="code hl_define" href="../../d7/d46/a00002.html#a163dee4d9a8a1568dded8480a166e852">icSigRadiantSpectralPcsData</a> ||</div>
<div class="line"><span class="lineno">  103</span>         sig==<a class="code hl_define" href="../../d7/d46/a00002.html#ae84d222edd132ad7741c628c1d4729d9">icSigBiDirReflectanceSpectralPcsData</a> ||</div>
<div class="line"><span class="lineno">  104</span>         sig==<a class="code hl_define" href="../../d7/d46/a00002.html#a1b59192d9fcc1aee71b8cc523b4978ca">icSigSparseMatrixSpectralPcsData</a>;</div>
<div class="line"><span class="lineno">  105</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a36a692db621ce2ccea49767209ab8294" name="a36a692db621ce2ccea49767209ab8294"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36a692db621ce2ccea49767209ab8294">&#9670;&#160;</a></span>RGBClip()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> RGBClip </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/de4/a01121.html">CIccCurve</a> *&#160;</td>
          <td class="paramname"><em>pCurve</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 5342</span>{</div>
<div class="line"><span class="lineno"> 5343</span>  <span class="keywordflow">if</span> (v&lt;=0)</div>
<div class="line"><span class="lineno"> 5344</span>    <span class="keywordflow">return</span>(pCurve-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a0c972a2a0eacd5245a0f52993c9f501f">Apply</a>(0));</div>
<div class="line"><span class="lineno"> 5345</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (v&gt;=1.0)</div>
<div class="line"><span class="lineno"> 5346</span>    <span class="keywordflow">return</span> (pCurve-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a0c972a2a0eacd5245a0f52993c9f501f">Apply</a>(1.0));</div>
<div class="line"><span class="lineno"> 5347</span> </div>
<div class="line"><span class="lineno"> 5348</span>  <span class="keywordflow">return</span> pCurve-&gt;<a class="code hl_function" href="../../dd/de4/a01121.html#a0c972a2a0eacd5245a0f52993c9f501f">Apply</a>(v);</div>
<div class="line"><span class="lineno"> 5349</span>}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="../../#l00101">CIccCurve::Apply()</a>.</p>
<div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="../../closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="../../d3/df8/a00155_a36a692db621ce2ccea49767209ab8294_cgraph.png" border="0" usemap="#ad3/df8/a00155_a36a692db621ce2ccea49767209ab8294_cgraph" alt=""/></div>
<map name="ad3/df8/a00155_a36a692db621ce2ccea49767209ab8294_cgraph" id="ad3/df8/a00155_a36a692db621ce2ccea49767209ab8294_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,80,31"/>
<area shape="rect" href="../../dd/de4/a01121.html#a0c972a2a0eacd5245a0f52993c9f501f" title=" " alt="" coords="128,5,260,31"/>
<area shape="poly" title=" " alt="" coords="80,15,114,15,114,21,80,21"/>
</map>
</div>

</div>
</div>
<a id="ae5a787099f4191e4c234ca3301c9cc0a" name="ae5a787099f4191e4c234ca3301c9cc0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5a787099f4191e4c234ca3301c9cc0a">&#9670;&#160;</a></span>XYZDescale()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> XYZDescale </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 5337</span>{</div>
<div class="line"><span class="lineno"> 5338</span>  <span class="keywordflow">return</span> (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(v * 65535.0 / 32768.0);</div>
<div class="line"><span class="lineno"> 5339</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa7c8bbc66b122b6419782fbfb02d51ac" name="aa7c8bbc66b122b6419782fbfb02d51ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7c8bbc66b122b6419782fbfb02d51ac">&#9670;&#160;</a></span>XYZScale()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static <a class="el" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> XYZScale </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno"> 5331</span>{</div>
<div class="line"><span class="lineno"> 5332</span>  v = (<a class="code hl_typedef" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a>)(v * 32768.0 / 65535.0);</div>
<div class="line"><span class="lineno"> 5333</span>  <span class="keywordflow">return</span> v;</div>
<div class="line"><span class="lineno"> 5334</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a961f0b709819f36204e7da4148c1505e" name="a961f0b709819f36204e7da4148c1505e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a961f0b709819f36204e7da4148c1505e">&#9670;&#160;</a></span>icD50XYZ</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d81/a00110.html#a2879c29939ce675796753098691799b2">icFloatNumber</a> icD50XYZ[3]</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">extern</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><span class="lineno">  782</span>{ 0.9642f, 1.0000f, 0.8249f };</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_d77fd0a8c197a6b09c227b53322d11bd.html">IccProfLib</a></li><li class="navelem"><a class="el" href="../../d3/df8/a00155.html">IccCmm.cpp</a></li>
    <li class="footer">Generated on Wed Jul 30 2025 15:11:11 for iccDEV by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
