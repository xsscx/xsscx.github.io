<?xml version='1.0' encoding='UTF-8' standalone='no'?>
<doxygen xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="compound.xsd" version="1.9.8" xml:lang="en-US">
  <compounddef id="d3/df8/a00155" kind="file" language="C++">
    <compoundname>IccCmm.cpp</compoundname>
    <includes refid="df/d98/a00107" local="yes">IccXformFactory.h</includes>
    <includes refid="d2/df5/a00137" local="yes">IccTag.h</includes>
    <includes refid="d2/de7/a00014" local="yes">IccMpeBasic.h</includes>
    <includes refid="d7/d06/a00131" local="yes">IccArrayBasic.h</includes>
    <includes refid="da/d1e/a00149" local="yes">IccStructBasic.h</includes>
    <includes refid="df/d6a/a00119" local="yes">IccIO.h</includes>
    <includes refid="d4/dee/a00008" local="yes">IccApplyBPC.h</includes>
    <includes refid="dd/d52/a00221" local="yes">IccSparseMatrix.h</includes>
    <includes refid="d3/dd5/a00215" local="yes">IccEncoding.h</includes>
    <includes refid="dc/dfe/a00125" local="yes">IccMatrixMath.h</includes>
    <incdepgraph>
      <node id="34">
        <label>IccApplyBPC.h</label>
        <link refid="d4/dee/a00008"/>
        <childnode refid="3" relation="include">
        </childnode>
      </node>
      <node id="31">
        <label>IccArrayBasic.h</label>
        <link refid="d7/d06/a00131"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="32" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="1">
        <label>IccProfLib/IccCmm.cpp</label>
        <link refid="d3/df8/a00155"/>
        <childnode refid="2" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="30" relation="include">
        </childnode>
        <childnode refid="31" relation="include">
        </childnode>
        <childnode refid="33" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="34" relation="include">
        </childnode>
        <childnode refid="35" relation="include">
        </childnode>
        <childnode refid="36" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
      </node>
      <node id="3">
        <label>IccCmm.h</label>
        <link refid="d6/d5b/a00026"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
        <childnode refid="27" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="28" relation="include">
        </childnode>
        <childnode refid="29" relation="include">
        </childnode>
      </node>
      <node id="5">
        <label>IccDefs.h</label>
        <link refid="d4/d81/a00110"/>
        <childnode refid="6" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
      </node>
      <node id="36">
        <label>IccEncoding.h</label>
        <link refid="d3/dd5/a00215"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="14">
        <label>IccIO.h</label>
        <link refid="df/d6a/a00119"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="15" relation="include">
        </childnode>
      </node>
      <node id="27">
        <label>IccMatrixMath.h</label>
        <link refid="dc/dfe/a00125"/>
        <childnode refid="4" relation="include">
        </childnode>
      </node>
      <node id="30">
        <label>IccMpeBasic.h</label>
        <link refid="d2/de7/a00014"/>
        <childnode refid="18" relation="include">
        </childnode>
      </node>
      <node id="10">
        <label>IccPcc.h</label>
        <link refid="d4/d3a/a00101"/>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="7">
        <label>IccProfLibConf.h</label>
        <link refid="d5/d16/a00029"/>
        <childnode refid="8" relation="include">
        </childnode>
      </node>
      <node id="4">
        <label>IccProfile.h</label>
        <link refid="d4/d51/a00017"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="10" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="35">
        <label>IccSparseMatrix.h</label>
        <link refid="dd/d52/a00221"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="25" relation="include">
        </childnode>
      </node>
      <node id="33">
        <label>IccStructBasic.h</label>
        <link refid="da/d1e/a00149"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
      </node>
      <node id="13">
        <label>IccTag.h</label>
        <link refid="d2/df5/a00137"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="14" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="16" relation="include">
        </childnode>
        <childnode refid="17" relation="include">
        </childnode>
        <childnode refid="18" relation="include">
        </childnode>
        <childnode refid="21" relation="include">
        </childnode>
        <childnode refid="22" relation="include">
        </childnode>
        <childnode refid="23" relation="include">
        </childnode>
        <childnode refid="24" relation="include">
        </childnode>
      </node>
      <node id="16">
        <label>IccTagBasic.h</label>
        <link refid="da/dec/a00080"/>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
      </node>
      <node id="23">
        <label>IccTagComposite.h</label>
        <link refid="d1/da8/a00230"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="22">
        <label>IccTagDict.h</label>
        <link refid="df/d03/a00062"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="24">
        <label>IccTagEmbedIcc.h</label>
        <link refid="dc/d9a/a00218"/>
        <childnode refid="16" relation="include">
        </childnode>
      </node>
      <node id="19">
        <label>IccTagFactory.h</label>
        <link refid="d8/d41/a00038"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="17">
        <label>IccTagLut.h</label>
        <link refid="da/d24/a00068"/>
        <childnode refid="16" relation="include">
        </childnode>
      </node>
      <node id="18">
        <label>IccTagMPE.h</label>
        <link refid="d7/d25/a00182"/>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="19" relation="include">
        </childnode>
        <childnode refid="9" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="21">
        <label>IccTagProfSeqId.h</label>
        <link refid="d5/df1/a00206"/>
        <childnode refid="4" relation="include">
        </childnode>
        <childnode refid="13" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
      </node>
      <node id="25">
        <label>IccUtil.h</label>
        <link refid="d7/dce/a00143"/>
        <childnode refid="5" relation="include">
        </childnode>
        <childnode refid="7" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
        <childnode refid="26" relation="include">
        </childnode>
      </node>
      <node id="2">
        <label>IccXformFactory.h</label>
        <link refid="df/d98/a00107"/>
        <childnode refid="3" relation="include">
        </childnode>
        <childnode refid="20" relation="include">
        </childnode>
        <childnode refid="11" relation="include">
        </childnode>
        <childnode refid="12" relation="include">
        </childnode>
      </node>
      <node id="9">
        <label>icProfileHeader.h</label>
        <link refid="d7/d46/a00002"/>
      </node>
      <node id="29">
        <label>cstdlib</label>
      </node>
      <node id="28">
        <label>cstring</label>
      </node>
      <node id="26">
        <label>limits</label>
      </node>
      <node id="11">
        <label>list</label>
      </node>
      <node id="32">
        <label>map</label>
      </node>
      <node id="20">
        <label>memory</label>
      </node>
      <node id="6">
        <label>stddef.h</label>
      </node>
      <node id="8">
        <label>stdint.h</label>
      </node>
      <node id="15">
        <label>stdio.h</label>
      </node>
      <node id="12">
        <label>string</label>
      </node>
    </incdepgraph>
    <sectiondef kind="define">
      <memberdef kind="define" id="d3/df8/a00155_1abb796a32bb9b930ceb2efcbb87f4a909" prot="public" static="no">
        <name>ICCDUMPPIXEL</name>
        <param><defname>n</defname></param>
        <param><defname>pix</defname></param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="3417" column="12" bodyfile="IccProfLib/IccCmm.cpp" bodystart="3417" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="d3/df8/a00155_1a09ef76f73cd16ef7b7c77358b527e816" prot="public" static="no">
        <name>ICCPCSSTEPDUMPFMT</name>
        <initializer><ref refid="dc/dfe/a00125_1acbf74e170d642cd542691248a78c573e" kindref="member">ICCMTXSTEPDUMPFMT</ref></initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="121" column="9" bodyfile="IccProfLib/IccCmm.cpp" bodystart="121" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="d3/df8/a00155_1a1376d1bc8bb70237fde226cb6f49872c" prot="public" static="no">
        <name>IsCompatSpace</name>
        <param><defname>x</defname></param>
        <param><defname>y</defname></param>
        <initializer>((x)==(y) || (<ref refid="d1/dc1/a00092_1af2bf8c7d947cb795089de5f391f91d4d" kindref="member">IsSpacePCS</ref>(x) &amp;&amp; <ref refid="d1/dc1/a00092_1af2bf8c7d947cb795089de5f391f91d4d" kindref="member">IsSpacePCS</ref>(y)) || (<ref refid="d3/df8/a00155_1ac420df5122347019d9a312b07100d8de" kindref="member">IsSpaceMCS</ref>(x) &amp;&amp; <ref refid="d3/df8/a00155_1ac420df5122347019d9a312b07100d8de" kindref="member">IsSpaceMCS</ref>(y))/* || (<ref refid="d3/df8/a00155_1afc0e6f40540589cbdcd61411462e0aad" kindref="member">IsSpaceCMYK</ref>(x) &amp;&amp; <ref refid="d3/df8/a00155_1afc0e6f40540589cbdcd61411462e0aad" kindref="member">IsSpaceCMYK</ref>(y))*/)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="116" column="9" bodyfile="IccProfLib/IccCmm.cpp" bodystart="116" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="d3/df8/a00155_1a95cfb076604d7bea59905ba50253b1d2" prot="public" static="no">
        <name>IsCompatSpacePCS</name>
        <param><defname>x</defname></param>
        <param><defname>y</defname></param>
        <initializer>                                (((x)==<ref refid="d4/d81/a00110_1a550e980dd884839e33548afbd55b4277" kindref="member">icSigDevXYZData</ref> &amp;&amp; (y)==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>) || ((x)==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref> &amp;&amp; (y)==<ref refid="d4/d81/a00110_1a550e980dd884839e33548afbd55b4277" kindref="member">icSigDevXYZData</ref>) || \
                                ((x)==<ref refid="d4/d81/a00110_1a92d563abc2c24efa8ccad672a9dfd14f" kindref="member">icSigDevLabData</ref> &amp;&amp; (y)==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>) || ((x)==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref> &amp;&amp; (y)==<ref refid="d4/d81/a00110_1a92d563abc2c24efa8ccad672a9dfd14f" kindref="member">icSigDevLabData</ref>))</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="118" column="9" bodyfile="IccProfLib/IccCmm.cpp" bodystart="118" bodyend="119"/>
      </memberdef>
      <memberdef kind="define" id="d3/df8/a00155_1ab304d4f0fe0c22e5b3e078e9ab1e7085" prot="public" static="no">
        <name>IsNChannelCompat</name>
        <param><defname>x</defname></param>
        <param><defname>y</defname></param>
        <initializer>((<ref refid="d3/df8/a00155_1ab99e08f792259e1107c118b20cacd1ce" kindref="member">IsSpaceNChannel</ref>(x) &amp;&amp; <ref refid="d7/d46/a00002_1a186dd5a24f08dc94beb7142e3872b426" kindref="member">icNumColorSpaceChannels</ref>(x)==<ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(y)) || (<ref refid="d3/df8/a00155_1ab99e08f792259e1107c118b20cacd1ce" kindref="member">IsSpaceNChannel</ref>(y) &amp;&amp; <ref refid="d7/d46/a00002_1a186dd5a24f08dc94beb7142e3872b426" kindref="member">icNumColorSpaceChannels</ref>(y)==<ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(x)))</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="114" column="9" bodyfile="IccProfLib/IccCmm.cpp" bodystart="114" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="d3/df8/a00155_1afc0e6f40540589cbdcd61411462e0aad" prot="public" static="no">
        <name>IsSpaceCMYK</name>
        <param><defname>x</defname></param>
        <initializer>((x)==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661" kindref="member">icSigCmykData</ref> || (x)==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917addb4c9db388eda46c3ec7fdaa8824cf5" kindref="member">icSig4colorData</ref>)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="112" column="9" bodyfile="IccProfLib/IccCmm.cpp" bodystart="112" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="d3/df8/a00155_1aaacd6d45813e2697ad238b12befa5719" prot="public" static="no">
        <name>IsSpaceColorimetricPCS</name>
        <param><defname>x</defname></param>
        <initializer>((x)==<ref refid="d7/d46/a00002_1a3cc88012894a42474b7609adbe314918" kindref="member">icSigXYZPcsData</ref> || (x)==<ref refid="d7/d46/a00002_1a043048bd0c63d3bd54d35e8b5743d226" kindref="member">icSigLabPcsData</ref>)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="108" column="9" bodyfile="IccProfLib/IccCmm.cpp" bodystart="108" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="d3/df8/a00155_1a8685fe2c409e3323ec4a11938664df34" prot="public" static="no">
        <name>IsSpaceDevicePCS</name>
        <param><defname>x</defname></param>
        <initializer>((x)==<ref refid="d4/d81/a00110_1a550e980dd884839e33548afbd55b4277" kindref="member">icSigDevXYZData</ref> || (x)==<ref refid="d4/d81/a00110_1a92d563abc2c24efa8ccad672a9dfd14f" kindref="member">icSigDevLabData</ref>)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="107" column="9" bodyfile="IccProfLib/IccCmm.cpp" bodystart="107" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="d3/df8/a00155_1ac420df5122347019d9a312b07100d8de" prot="public" static="no">
        <name>IsSpaceMCS</name>
        <param><defname>x</defname></param>
        <initializer>(<ref refid="d7/d46/a00002_1a47e4f847bd0bc609907b5fea4daf3e75" kindref="member">icGetColorSpaceType</ref>(x)==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a79b72a0338fa6fbae9f707dd48b57f13" kindref="member">icSigSrcMCSChannelData</ref>)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="111" column="9" bodyfile="IccProfLib/IccCmm.cpp" bodystart="111" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="d3/df8/a00155_1ab99e08f792259e1107c118b20cacd1ce" prot="public" static="no">
        <name>IsSpaceNChannel</name>
        <param><defname>x</defname></param>
        <initializer>(<ref refid="d7/d46/a00002_1a47e4f847bd0bc609907b5fea4daf3e75" kindref="member">icGetColorSpaceType</ref>(x)==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ac8919c5ac8fc3849f57bf7fd2fc1d70a" kindref="member">icSigNChannelData</ref>)</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="109" column="9" bodyfile="IccProfLib/IccCmm.cpp" bodystart="109" bodyend="-1"/>
      </memberdef>
      <memberdef kind="define" id="d3/df8/a00155_1af2bf8c7d947cb795089de5f391f91d4d" prot="public" static="no">
        <name>IsSpacePCS</name>
        <param><defname>x</defname></param>
        <initializer>(<ref refid="d3/df8/a00155_1aaacd6d45813e2697ad238b12befa5719" kindref="member">IsSpaceColorimetricPCS</ref>(x) || <ref refid="d3/df8/a00155_1a05df9b9a2f56c907e676a0efc3e9219d" kindref="member">IsSpaceSpectralPCS</ref>(x))</initializer>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="110" column="9" bodyfile="IccProfLib/IccCmm.cpp" bodystart="110" bodyend="-1"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="var">
      <memberdef kind="variable" id="d3/df8/a00155_1a961f0b709819f36204e7da4148c1505e" prot="public" static="no" extern="yes" mutable="no">
        <type><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref></type>
        <definition>icFloatNumber icD50XYZ[3]</definition>
        <argsstring>[3]</argsstring>
        <name>icD50XYZ</name>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="3636" column="22" bodyfile="IccProfLib/IccUtil.cpp" bodystart="782" bodyend="782" declfile="IccProfLib/IccCmm.cpp" declline="3636" declcolumn="22"/>
      </memberdef>
    </sectiondef>
    <sectiondef kind="func">
      <memberdef kind="function" id="d3/df8/a00155_1a05df9b9a2f56c907e676a0efc3e9219d" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type>__inline bool</type>
        <definition>static __inline bool IsSpaceSpectralPCS</definition>
        <argsstring>(icUInt32Number sig)</argsstring>
        <name>IsSpaceSpectralPCS</name>
        <param>
          <type><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref></type>
          <declname>sig</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="96" column="22" bodyfile="IccProfLib/IccCmm.cpp" bodystart="96" bodyend="105"/>
      </memberdef>
      <memberdef kind="function" id="d3/df8/a00155_1a36a692db621ce2ccea49767209ab8294" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref></type>
        <definition>static icFloatNumber RGBClip</definition>
        <argsstring>(icFloatNumber v, CIccCurve *pCurve)</argsstring>
        <name>RGBClip</name>
        <param>
          <type><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref></type>
          <declname>v</declname>
        </param>
        <param>
          <type><ref refid="dd/de4/a01121" kindref="compound">CIccCurve</ref> *</type>
          <declname>pCurve</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="5341" column="22" bodyfile="IccProfLib/IccCmm.cpp" bodystart="5341" bodyend="5349"/>
        <references refid="dd/de4/a01121_1a0c972a2a0eacd5245a0f52993c9f501f" compoundref="da/d24/a00068" startline="101" endline="101">CIccCurve::Apply</references>
      </memberdef>
      <memberdef kind="function" id="d3/df8/a00155_1ae5a787099f4191e4c234ca3301c9cc0a" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref></type>
        <definition>static icFloatNumber XYZDescale</definition>
        <argsstring>(icFloatNumber v)</argsstring>
        <name>XYZDescale</name>
        <param>
          <type><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref></type>
          <declname>v</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="5336" column="22" bodyfile="IccProfLib/IccCmm.cpp" bodystart="5336" bodyend="5339"/>
      </memberdef>
      <memberdef kind="function" id="d3/df8/a00155_1aa7c8bbc66b122b6419782fbfb02d51ac" prot="public" static="yes" const="no" explicit="no" inline="no" virt="non-virtual">
        <type><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref></type>
        <definition>static icFloatNumber XYZScale</definition>
        <argsstring>(icFloatNumber v)</argsstring>
        <name>XYZScale</name>
        <param>
          <type><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref></type>
          <declname>v</declname>
        </param>
        <briefdescription>
        </briefdescription>
        <detaileddescription>
        </detaileddescription>
        <inbodydescription>
        </inbodydescription>
        <location file="IccProfLib/IccCmm.cpp" line="5330" column="22" bodyfile="IccProfLib/IccCmm.cpp" bodystart="5330" bodyend="5334"/>
      </memberdef>
    </sectiondef>
    <briefdescription>
    </briefdescription>
    <detaileddescription>
<para>File: <ref refid="d3/df8/a00155" kindref="compound">IccCmm.cpp</ref></para>
<para>Contains: Implementation of the CIccCmm class.</para>
<para>Version: V1</para>
<para>Copyright: ï¿½ see ICC Software License </para>
    </detaileddescription>
    <programlisting>
<codeline lineno="1"><highlight class="normal"></highlight></codeline>
<codeline lineno="11"><highlight class="normal"></highlight><highlight class="comment">/*</highlight></codeline>
<codeline lineno="12"><highlight class="comment"><sp/>*<sp/>The<sp/>ICC<sp/>Software<sp/>License,<sp/>Version<sp/>0.2</highlight></codeline>
<codeline lineno="13"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="14"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="15"><highlight class="comment"><sp/>*<sp/>Copyright<sp/>(c)<sp/>2003-2012<sp/>The<sp/>International<sp/>Color<sp/>Consortium.<sp/>All<sp/>rights<sp/></highlight></codeline>
<codeline lineno="16"><highlight class="comment"><sp/>*<sp/>reserved.</highlight></codeline>
<codeline lineno="17"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="18"><highlight class="comment"><sp/>*<sp/>Redistribution<sp/>and<sp/>use<sp/>in<sp/>source<sp/>and<sp/>binary<sp/>forms,<sp/>with<sp/>or<sp/>without</highlight></codeline>
<codeline lineno="19"><highlight class="comment"><sp/>*<sp/>modification,<sp/>are<sp/>permitted<sp/>provided<sp/>that<sp/>the<sp/>following<sp/>conditions</highlight></codeline>
<codeline lineno="20"><highlight class="comment"><sp/>*<sp/>are<sp/>met:</highlight></codeline>
<codeline lineno="21"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="22"><highlight class="comment"><sp/>*<sp/>1.<sp/>Redistributions<sp/>of<sp/>source<sp/>code<sp/>must<sp/>retain<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="23"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer.<sp/></highlight></codeline>
<codeline lineno="24"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="25"><highlight class="comment"><sp/>*<sp/>2.<sp/>Redistributions<sp/>in<sp/>binary<sp/>form<sp/>must<sp/>reproduce<sp/>the<sp/>above<sp/>copyright</highlight></codeline>
<codeline lineno="26"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>notice,<sp/>this<sp/>list<sp/>of<sp/>conditions<sp/>and<sp/>the<sp/>following<sp/>disclaimer<sp/>in</highlight></codeline>
<codeline lineno="27"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>the<sp/>documentation<sp/>and/or<sp/>other<sp/>materials<sp/>provided<sp/>with<sp/>the</highlight></codeline>
<codeline lineno="28"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>distribution.</highlight></codeline>
<codeline lineno="29"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="30"><highlight class="comment"><sp/>*<sp/>3.<sp/>In<sp/>the<sp/>absence<sp/>of<sp/>prior<sp/>written<sp/>permission,<sp/>the<sp/>names<sp/>&quot;ICC&quot;<sp/>and<sp/>&quot;The</highlight></codeline>
<codeline lineno="31"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>International<sp/>Color<sp/>Consortium&quot;<sp/>must<sp/>not<sp/>be<sp/>used<sp/>to<sp/>imply<sp/>that<sp/>the</highlight></codeline>
<codeline lineno="32"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>ICC<sp/>organization<sp/>endorses<sp/>or<sp/>promotes<sp/>products<sp/>derived<sp/>from<sp/>this</highlight></codeline>
<codeline lineno="33"><highlight class="comment"><sp/>*<sp/><sp/><sp/><sp/>software.</highlight></codeline>
<codeline lineno="34"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="35"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="36"><highlight class="comment"><sp/>*<sp/>THIS<sp/>SOFTWARE<sp/>IS<sp/>PROVIDED<sp/>``AS<sp/>IS&apos;&apos;<sp/>AND<sp/>ANY<sp/>EXPRESSED<sp/>OR<sp/>IMPLIED</highlight></codeline>
<codeline lineno="37"><highlight class="comment"><sp/>*<sp/>WARRANTIES,<sp/>INCLUDING,<sp/>BUT<sp/>NOT<sp/>LIMITED<sp/>TO,<sp/>THE<sp/>IMPLIED<sp/>WARRANTIES</highlight></codeline>
<codeline lineno="38"><highlight class="comment"><sp/>*<sp/>OF<sp/>MERCHANTABILITY<sp/>AND<sp/>FITNESS<sp/>FOR<sp/>A<sp/>PARTICULAR<sp/>PURPOSE<sp/>ARE</highlight></codeline>
<codeline lineno="39"><highlight class="comment"><sp/>*<sp/>DISCLAIMED.<sp/><sp/>IN<sp/>NO<sp/>EVENT<sp/>SHALL<sp/>THE<sp/>INTERNATIONAL<sp/>COLOR<sp/>CONSORTIUM<sp/>OR</highlight></codeline>
<codeline lineno="40"><highlight class="comment"><sp/>*<sp/>ITS<sp/>CONTRIBUTING<sp/>MEMBERS<sp/>BE<sp/>LIABLE<sp/>FOR<sp/>ANY<sp/>DIRECT,<sp/>INDIRECT,<sp/>INCIDENTAL,</highlight></codeline>
<codeline lineno="41"><highlight class="comment"><sp/>*<sp/>SPECIAL,<sp/>EXEMPLARY,<sp/>OR<sp/>CONSEQUENTIAL<sp/>DAMAGES<sp/>(INCLUDING,<sp/>BUT<sp/>NOT</highlight></codeline>
<codeline lineno="42"><highlight class="comment"><sp/>*<sp/>LIMITED<sp/>TO,<sp/>PROCUREMENT<sp/>OF<sp/>SUBSTITUTE<sp/>GOODS<sp/>OR<sp/>SERVICES;<sp/>LOSS<sp/>OF</highlight></codeline>
<codeline lineno="43"><highlight class="comment"><sp/>*<sp/>USE,<sp/>DATA,<sp/>OR<sp/>PROFITS;<sp/>OR<sp/>BUSINESS<sp/>INTERRUPTION)<sp/>HOWEVER<sp/>CAUSED<sp/>AND</highlight></codeline>
<codeline lineno="44"><highlight class="comment"><sp/>*<sp/>ON<sp/>ANY<sp/>THEORY<sp/>OF<sp/>LIABILITY,<sp/>WHETHER<sp/>IN<sp/>CONTRACT,<sp/>STRICT<sp/>LIABILITY,</highlight></codeline>
<codeline lineno="45"><highlight class="comment"><sp/>*<sp/>OR<sp/>TORT<sp/>(INCLUDING<sp/>NEGLIGENCE<sp/>OR<sp/>OTHERWISE)<sp/>ARISING<sp/>IN<sp/>ANY<sp/>WAY<sp/>OUT</highlight></codeline>
<codeline lineno="46"><highlight class="comment"><sp/>*<sp/>OF<sp/>THE<sp/>USE<sp/>OF<sp/>THIS<sp/>SOFTWARE,<sp/>EVEN<sp/>IF<sp/>ADVISED<sp/>OF<sp/>THE<sp/>POSSIBILITY<sp/>OF</highlight></codeline>
<codeline lineno="47"><highlight class="comment"><sp/>*<sp/>SUCH<sp/>DAMAGE.</highlight></codeline>
<codeline lineno="48"><highlight class="comment"><sp/>*<sp/>====================================================================</highlight></codeline>
<codeline lineno="49"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="50"><highlight class="comment"><sp/>*<sp/>This<sp/>software<sp/>consists<sp/>of<sp/>voluntary<sp/>contributions<sp/>made<sp/>by<sp/>many</highlight></codeline>
<codeline lineno="51"><highlight class="comment"><sp/>*<sp/>individuals<sp/>on<sp/>behalf<sp/>of<sp/>the<sp/>The<sp/>International<sp/>Color<sp/>Consortium.<sp/></highlight></codeline>
<codeline lineno="52"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="53"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="54"><highlight class="comment"><sp/>*<sp/>Membership<sp/>in<sp/>the<sp/>ICC<sp/>is<sp/>encouraged<sp/>when<sp/>this<sp/>software<sp/>is<sp/>used<sp/>for</highlight></codeline>
<codeline lineno="55"><highlight class="comment"><sp/>*<sp/>commercial<sp/>purposes.<sp/></highlight></codeline>
<codeline lineno="56"><highlight class="comment"><sp/>*</highlight></codeline>
<codeline lineno="57"><highlight class="comment"><sp/>*<sp/><sp/></highlight></codeline>
<codeline lineno="58"><highlight class="comment"><sp/>*<sp/>For<sp/>more<sp/>information<sp/>on<sp/>The<sp/>International<sp/>Color<sp/>Consortium,<sp/>please</highlight></codeline>
<codeline lineno="59"><highlight class="comment"><sp/>*<sp/>see<sp/>&lt;http://www.color.org/&gt;.</highlight></codeline>
<codeline lineno="60"><highlight class="comment"><sp/>*<sp/><sp/></highlight></codeline>
<codeline lineno="61"><highlight class="comment"><sp/>*<sp/></highlight></codeline>
<codeline lineno="62"><highlight class="comment"><sp/>*/</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="63"><highlight class="normal"></highlight></codeline>
<codeline lineno="65"><highlight class="comment">//<sp/>HISTORY:</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="66"><highlight class="normal"></highlight><highlight class="comment">//</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="67"><highlight class="normal"></highlight><highlight class="comment">//<sp/>-Initial<sp/>implementation<sp/>by<sp/>Max<sp/>Derhak<sp/>5-15-2003</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="68"><highlight class="normal"></highlight><highlight class="comment">//<sp/>-Added<sp/>support<sp/>for<sp/>Monochrome<sp/>ICC<sp/>profile<sp/>apply<sp/>by<sp/>Rohit<sp/>Patil<sp/>12-03-2008</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="69"><highlight class="normal"></highlight><highlight class="comment">//<sp/>-Integrated<sp/>changes<sp/>for<sp/>PCS<sp/>adjustment<sp/>by<sp/>George<sp/>Pawle<sp/>12-09-2008</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="70"><highlight class="normal"></highlight><highlight class="comment">//</highlight></codeline>
<codeline lineno="72"><highlight class="normal"></highlight></codeline>
<codeline lineno="73"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>WIN32</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="74"><highlight class="normal"></highlight><highlight class="preprocessor">#pragma<sp/>warning(<sp/>disable:<sp/>4786)<sp/></highlight><highlight class="comment">//disable<sp/>warning<sp/>in<sp/>&lt;list.h&gt;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="75"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="76"><highlight class="normal"></highlight></codeline>
<codeline lineno="77"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="df/d98/a00107" kindref="compound">IccXformFactory.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="78"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d2/df5/a00137" kindref="compound">IccTag.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="79"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d2/de7/a00014" kindref="compound">IccMpeBasic.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="80"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d7/d06/a00131" kindref="compound">IccArrayBasic.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="81"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="da/d1e/a00149" kindref="compound">IccStructBasic.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="82"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="df/d6a/a00119" kindref="compound">IccIO.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="83"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d4/dee/a00008" kindref="compound">IccApplyBPC.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="84"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="dd/d52/a00221" kindref="compound">IccSparseMatrix.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="85"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="d3/dd5/a00215" kindref="compound">IccEncoding.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="86"><highlight class="normal"></highlight><highlight class="preprocessor">#include<sp/>&quot;<ref refid="dc/dfe/a00125" kindref="compound">IccMatrixMath.h</ref>&quot;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="87"><highlight class="normal"></highlight></codeline>
<codeline lineno="88"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>USEREFICCMAXNAMESPACE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="89"><highlight class="normal"></highlight><highlight class="keyword">namespace<sp/></highlight><highlight class="normal">refIccMAX<sp/>{</highlight></codeline>
<codeline lineno="90"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="91"><highlight class="normal"></highlight></codeline>
<codeline lineno="93"><highlight class="comment">//<sp/>Useful<sp/>Macros</highlight></codeline>
<codeline lineno="95"><highlight class="normal"></highlight></codeline>
<codeline lineno="96" refid="d3/df8/a00155_1a05df9b9a2f56c907e676a0efc3e9219d" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/>__inline<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/><ref refid="d3/df8/a00155_1a05df9b9a2f56c907e676a0efc3e9219d" kindref="member">IsSpaceSpectralPCS</ref>(<ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>sig)</highlight></codeline>
<codeline lineno="97"><highlight class="normal">{</highlight></codeline>
<codeline lineno="98"><highlight class="normal"><sp/><sp/>sig<sp/>=<sp/><ref refid="d7/d46/a00002_1a47e4f847bd0bc609907b5fea4daf3e75" kindref="member">icGetColorSpaceType</ref>(sig);</highlight></codeline>
<codeline lineno="99"><highlight class="normal"></highlight></codeline>
<codeline lineno="100"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>sig==<ref refid="d7/d46/a00002_1aa9cd4477816537fbf648a155f6b78eda" kindref="member">icSigReflectanceSpectralPcsData</ref><sp/>||</highlight></codeline>
<codeline lineno="101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sig==<ref refid="d7/d46/a00002_1af5df74ebff3f8247e1c7c88844c1f140" kindref="member">icSigTransmissionSpectralPcsData</ref><sp/>||</highlight></codeline>
<codeline lineno="102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sig==<ref refid="d7/d46/a00002_1a163dee4d9a8a1568dded8480a166e852" kindref="member">icSigRadiantSpectralPcsData</ref><sp/>||</highlight></codeline>
<codeline lineno="103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sig==<ref refid="d7/d46/a00002_1ae84d222edd132ad7741c628c1d4729d9" kindref="member">icSigBiDirReflectanceSpectralPcsData</ref><sp/>||</highlight></codeline>
<codeline lineno="104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>sig==<ref refid="d7/d46/a00002_1a1b59192d9fcc1aee71b8cc523b4978ca" kindref="member">icSigSparseMatrixSpectralPcsData</ref>;</highlight></codeline>
<codeline lineno="105"><highlight class="normal">}</highlight></codeline>
<codeline lineno="106"><highlight class="normal"></highlight></codeline>
<codeline lineno="107" refid="d3/df8/a00155_1a8685fe2c409e3323ec4a11938664df34" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsSpaceDevicePCS(x)<sp/>((x)==icSigDevXYZData<sp/>||<sp/>(x)==icSigDevLabData)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="108" refid="d3/df8/a00155_1aaacd6d45813e2697ad238b12befa5719" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsSpaceColorimetricPCS(x)<sp/>((x)==icSigXYZPcsData<sp/>||<sp/>(x)==icSigLabPcsData)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="109" refid="d3/df8/a00155_1ab99e08f792259e1107c118b20cacd1ce" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsSpaceNChannel(x)<sp/>(icGetColorSpaceType(x)==icSigNChannelData)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="110" refid="d3/df8/a00155_1af2bf8c7d947cb795089de5f391f91d4d" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsSpacePCS(x)<sp/>(IsSpaceColorimetricPCS(x)<sp/>||<sp/>IsSpaceSpectralPCS(x))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="111" refid="d3/df8/a00155_1ac420df5122347019d9a312b07100d8de" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsSpaceMCS(x)<sp/>(icGetColorSpaceType(x)==icSigSrcMCSChannelData)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="112" refid="d3/df8/a00155_1afc0e6f40540589cbdcd61411462e0aad" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsSpaceCMYK(x)<sp/>((x)==icSigCmykData<sp/>||<sp/>(x)==icSig4colorData)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="113"><highlight class="normal"></highlight></codeline>
<codeline lineno="114" refid="d3/df8/a00155_1ab304d4f0fe0c22e5b3e078e9ab1e7085" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsNChannelCompat(x,<sp/>y)<sp/>((IsSpaceNChannel(x)<sp/>&amp;&amp;<sp/>icNumColorSpaceChannels(x)==icGetSpaceSamples(y))<sp/>||<sp/>(IsSpaceNChannel(y)<sp/>&amp;&amp;<sp/>icNumColorSpaceChannels(y)==icGetSpaceSamples(x)))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="115"><highlight class="normal"></highlight></codeline>
<codeline lineno="116" refid="d3/df8/a00155_1a1376d1bc8bb70237fde226cb6f49872c" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsCompatSpace(x,<sp/>y)<sp/>((x)==(y)<sp/>||<sp/>(IsSpacePCS(x)<sp/>&amp;&amp;<sp/>IsSpacePCS(y))<sp/>||<sp/>(IsSpaceMCS(x)<sp/>&amp;&amp;<sp/>IsSpaceMCS(y))</highlight><highlight class="comment">/*<sp/>||<sp/>(IsSpaceCMYK(x)<sp/>&amp;&amp;<sp/>IsSpaceCMYK(y))*/</highlight><highlight class="preprocessor">)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="117"><highlight class="normal"></highlight></codeline>
<codeline lineno="118" refid="d3/df8/a00155_1a95cfb076604d7bea59905ba50253b1d2" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>IsCompatSpacePCS(x,<sp/>y)<sp/>(((x)==icSigDevXYZData<sp/>&amp;&amp;<sp/>(y)==icSigXYZData)<sp/>||<sp/>((x)==icSigXYZData<sp/>&amp;&amp;<sp/>(y)==icSigDevXYZData)<sp/>||<sp/>\</highlight></codeline>
<codeline lineno="119"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>((x)==icSigDevLabData<sp/>&amp;&amp;<sp/>(y)==icSigLabData)<sp/>||<sp/>((x)==icSigLabData<sp/>&amp;&amp;<sp/>(y)==icSigDevLabData))</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="120"><highlight class="normal"></highlight></codeline>
<codeline lineno="121" refid="d3/df8/a00155_1a09ef76f73cd16ef7b7c77358b527e816" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor">#define<sp/>ICCPCSSTEPDUMPFMT<sp/>ICCMTXSTEPDUMPFMT</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="122"><highlight class="normal"></highlight></codeline>
<codeline lineno="123"><highlight class="normal"></highlight></codeline>
<codeline lineno="124"><highlight class="normal"></highlight></codeline>
<codeline lineno="133"><highlight class="normal"><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>CIccPCSUtil::UnitClip(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>v)</highlight></codeline>
<codeline lineno="134"><highlight class="normal">{</highlight></codeline>
<codeline lineno="135"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(v&lt;0)</highlight></codeline>
<codeline lineno="136"><highlight class="normal"><sp/><sp/><sp/><sp/>v<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="137"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(v&gt;1.0)</highlight></codeline>
<codeline lineno="138"><highlight class="normal"><sp/><sp/><sp/><sp/>v<sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="139"><highlight class="normal"></highlight></codeline>
<codeline lineno="140"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>v;</highlight></codeline>
<codeline lineno="141"><highlight class="normal">}</highlight></codeline>
<codeline lineno="142"><highlight class="normal"></highlight></codeline>
<codeline lineno="151"><highlight class="normal"><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>CIccPCSUtil::NegClip(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>v)</highlight></codeline>
<codeline lineno="152"><highlight class="normal">{</highlight></codeline>
<codeline lineno="153"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(v&lt;0)</highlight></codeline>
<codeline lineno="154"><highlight class="normal"><sp/><sp/><sp/><sp/>v=0;</highlight></codeline>
<codeline lineno="155"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="156"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>v;</highlight></codeline>
<codeline lineno="157"><highlight class="normal">}</highlight></codeline>
<codeline lineno="158"><highlight class="normal"></highlight></codeline>
<codeline lineno="167"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPCSUtil::LabToXyz(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Dst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Src,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bNoClip)</highlight></codeline>
<codeline lineno="168"><highlight class="normal">{</highlight></codeline>
<codeline lineno="169"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>Lab[3];</highlight></codeline>
<codeline lineno="170"><highlight class="normal"></highlight></codeline>
<codeline lineno="171"><highlight class="normal"><sp/><sp/>memcpy(&amp;Lab,Src,</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(Lab));</highlight></codeline>
<codeline lineno="172"><highlight class="normal"></highlight></codeline>
<codeline lineno="173"><highlight class="normal"><sp/><sp/><ref refid="d7/dce/a00143_1ac5de02865f572ea243f6da8c144c02fa" kindref="member">icLabFromPcs</ref>(Lab);</highlight></codeline>
<codeline lineno="174"><highlight class="normal"></highlight></codeline>
<codeline lineno="175"><highlight class="normal"><sp/><sp/><ref refid="d7/dce/a00143_1aaf617b49cf0d56a218cd52c840228705" kindref="member">icLabtoXYZ</ref>(Lab);</highlight></codeline>
<codeline lineno="176"><highlight class="normal"></highlight></codeline>
<codeline lineno="177"><highlight class="normal"><sp/><sp/><ref refid="d7/dce/a00143_1a4b4cfb7788c3a780f19f2f104677a5b8" kindref="member">icXyzToPcs</ref>(Lab);</highlight></codeline>
<codeline lineno="178"><highlight class="normal"></highlight></codeline>
<codeline lineno="179"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!bNoClip)<sp/>{</highlight></codeline>
<codeline lineno="180"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[0]<sp/>=<sp/><ref refid="d6/de1/a00356_1a6c0519738b01f52ba7341b517d3da7e4" kindref="member">UnitClip</ref>(Lab[0]);</highlight></codeline>
<codeline lineno="181"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[1]<sp/>=<sp/><ref refid="d6/de1/a00356_1a6c0519738b01f52ba7341b517d3da7e4" kindref="member">UnitClip</ref>(Lab[1]);</highlight></codeline>
<codeline lineno="182"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[2]<sp/>=<sp/><ref refid="d6/de1/a00356_1a6c0519738b01f52ba7341b517d3da7e4" kindref="member">UnitClip</ref>(Lab[2]);</highlight></codeline>
<codeline lineno="183"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="184"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="185"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[0]<sp/>=<sp/>Lab[0];</highlight></codeline>
<codeline lineno="186"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[1]<sp/>=<sp/>Lab[1];</highlight></codeline>
<codeline lineno="187"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[2]<sp/>=<sp/>Lab[2];</highlight></codeline>
<codeline lineno="188"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="189"><highlight class="normal">}</highlight></codeline>
<codeline lineno="190"><highlight class="normal"></highlight></codeline>
<codeline lineno="191"><highlight class="normal"></highlight></codeline>
<codeline lineno="200"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPCSUtil::XyzToLab(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Dst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Src,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bNoClip)</highlight></codeline>
<codeline lineno="201"><highlight class="normal">{</highlight></codeline>
<codeline lineno="202"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>XYZ[3];</highlight></codeline>
<codeline lineno="203"><highlight class="normal"></highlight></codeline>
<codeline lineno="204"><highlight class="normal"></highlight></codeline>
<codeline lineno="205"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!bNoClip)<sp/>{</highlight></codeline>
<codeline lineno="206"><highlight class="normal"><sp/><sp/><sp/><sp/>XYZ[0]<sp/>=<sp/><ref refid="d6/de1/a00356_1a6c0519738b01f52ba7341b517d3da7e4" kindref="member">UnitClip</ref>(Src[0]);</highlight></codeline>
<codeline lineno="207"><highlight class="normal"><sp/><sp/><sp/><sp/>XYZ[1]<sp/>=<sp/><ref refid="d6/de1/a00356_1a6c0519738b01f52ba7341b517d3da7e4" kindref="member">UnitClip</ref>(Src[1]);</highlight></codeline>
<codeline lineno="208"><highlight class="normal"><sp/><sp/><sp/><sp/>XYZ[2]<sp/>=<sp/><ref refid="d6/de1/a00356_1a6c0519738b01f52ba7341b517d3da7e4" kindref="member">UnitClip</ref>(Src[2]);</highlight></codeline>
<codeline lineno="209"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="210"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="211"><highlight class="normal"><sp/><sp/><sp/><sp/>XYZ[0]<sp/>=<sp/>Src[0];</highlight></codeline>
<codeline lineno="212"><highlight class="normal"><sp/><sp/><sp/><sp/>XYZ[1]<sp/>=<sp/>Src[1];</highlight></codeline>
<codeline lineno="213"><highlight class="normal"><sp/><sp/><sp/><sp/>XYZ[2]<sp/>=<sp/>Src[2];</highlight></codeline>
<codeline lineno="214"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="215"><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="216"><highlight class="normal"><sp/><sp/><ref refid="d7/dce/a00143_1a78841df2e0aea059520ce71944c4c3bb" kindref="member">icXyzFromPcs</ref>(XYZ);</highlight></codeline>
<codeline lineno="217"><highlight class="normal"></highlight></codeline>
<codeline lineno="218"><highlight class="normal"><sp/><sp/><ref refid="d7/dce/a00143_1a4ff45349385af6c19d5b3f68150a27b5" kindref="member">icXYZtoLab</ref>(XYZ);</highlight></codeline>
<codeline lineno="219"><highlight class="normal"></highlight></codeline>
<codeline lineno="220"><highlight class="normal"><sp/><sp/><ref refid="d7/dce/a00143_1a5768271d491af79a433e52722ed0a189" kindref="member">icLabToPcs</ref>(XYZ);</highlight></codeline>
<codeline lineno="221"><highlight class="normal"></highlight></codeline>
<codeline lineno="222"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!bNoClip)<sp/>{</highlight></codeline>
<codeline lineno="223"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[0]<sp/>=<sp/><ref refid="d6/de1/a00356_1a6c0519738b01f52ba7341b517d3da7e4" kindref="member">UnitClip</ref>(XYZ[0]);</highlight></codeline>
<codeline lineno="224"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[1]<sp/>=<sp/><ref refid="d6/de1/a00356_1a6c0519738b01f52ba7341b517d3da7e4" kindref="member">UnitClip</ref>(XYZ[1]);</highlight></codeline>
<codeline lineno="225"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[2]<sp/>=<sp/><ref refid="d6/de1/a00356_1a6c0519738b01f52ba7341b517d3da7e4" kindref="member">UnitClip</ref>(XYZ[2]);</highlight></codeline>
<codeline lineno="226"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="227"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="228"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[0]<sp/>=<sp/>XYZ[0];</highlight></codeline>
<codeline lineno="229"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[1]<sp/>=<sp/>XYZ[1];</highlight></codeline>
<codeline lineno="230"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[2]<sp/>=<sp/>XYZ[2];</highlight></codeline>
<codeline lineno="231"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="232"><highlight class="normal">}</highlight></codeline>
<codeline lineno="233"><highlight class="normal"></highlight></codeline>
<codeline lineno="234"><highlight class="normal"></highlight></codeline>
<codeline lineno="243"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPCSUtil::Lab2ToXyz(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Dst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Src,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bNoClip)</highlight></codeline>
<codeline lineno="244"><highlight class="normal">{</highlight></codeline>
<codeline lineno="245"><highlight class="normal"><sp/><sp/>Lab2ToLab4(Dst,<sp/>Src,<sp/>bNoClip);</highlight></codeline>
<codeline lineno="246"><highlight class="normal"><sp/><sp/>LabToXyz(Dst,<sp/>Dst,<sp/>bNoClip);</highlight></codeline>
<codeline lineno="247"><highlight class="normal">}</highlight></codeline>
<codeline lineno="248"><highlight class="normal"></highlight></codeline>
<codeline lineno="249"><highlight class="normal"></highlight></codeline>
<codeline lineno="258"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPCSUtil::XyzToLab2(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Dst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Src,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bNoClip)</highlight></codeline>
<codeline lineno="259"><highlight class="normal">{</highlight></codeline>
<codeline lineno="260"><highlight class="normal"><sp/><sp/>XyzToLab(Dst,<sp/>Src,<sp/>bNoClip);</highlight></codeline>
<codeline lineno="261"><highlight class="normal"><sp/><sp/>Lab4ToLab2(Dst,<sp/>Dst);</highlight></codeline>
<codeline lineno="262"><highlight class="normal">}</highlight></codeline>
<codeline lineno="263"><highlight class="normal"></highlight></codeline>
<codeline lineno="264"><highlight class="normal"></highlight></codeline>
<codeline lineno="273"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPCSUtil::Lab2ToLab4(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Dst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Src,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bNoClip)</highlight></codeline>
<codeline lineno="274"><highlight class="normal">{</highlight></codeline>
<codeline lineno="275"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bNoClip)<sp/>{</highlight></codeline>
<codeline lineno="276"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(Src[0]<sp/>*<sp/>65535.0f<sp/>/<sp/>65280.0f);</highlight></codeline>
<codeline lineno="277"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(Src[1]<sp/>*<sp/>65535.0f<sp/>/<sp/>65280.0f);</highlight></codeline>
<codeline lineno="278"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(Src[2]<sp/>*<sp/>65535.0f<sp/>/<sp/>65280.0f);</highlight></codeline>
<codeline lineno="279"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="280"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="281"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[0]<sp/>=<sp/><ref refid="d6/de1/a00356_1a6c0519738b01f52ba7341b517d3da7e4" kindref="member">UnitClip</ref>((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(Src[0]<sp/>*<sp/>65535.0f<sp/>/<sp/>65280.0f));</highlight></codeline>
<codeline lineno="282"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[1]<sp/>=<sp/><ref refid="d6/de1/a00356_1a6c0519738b01f52ba7341b517d3da7e4" kindref="member">UnitClip</ref>((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(Src[1]<sp/>*<sp/>65535.0f<sp/>/<sp/>65280.0f));</highlight></codeline>
<codeline lineno="283"><highlight class="normal"><sp/><sp/><sp/><sp/>Dst[2]<sp/>=<sp/><ref refid="d6/de1/a00356_1a6c0519738b01f52ba7341b517d3da7e4" kindref="member">UnitClip</ref>((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(Src[2]<sp/>*<sp/>65535.0f<sp/>/<sp/>65280.0f));</highlight></codeline>
<codeline lineno="284"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="285"><highlight class="normal">}</highlight></codeline>
<codeline lineno="286"><highlight class="normal"></highlight></codeline>
<codeline lineno="295"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPCSUtil::Lab4ToLab2(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Dst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Src)</highlight></codeline>
<codeline lineno="296"><highlight class="normal">{</highlight></codeline>
<codeline lineno="297"><highlight class="normal"><sp/><sp/>Dst[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(Src[0]<sp/>*<sp/>65280.0f<sp/>/<sp/>65535.0f);</highlight></codeline>
<codeline lineno="298"><highlight class="normal"><sp/><sp/>Dst[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(Src[1]<sp/>*<sp/>65280.0f<sp/>/<sp/>65535.0f);</highlight></codeline>
<codeline lineno="299"><highlight class="normal"><sp/><sp/>Dst[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(Src[2]<sp/>*<sp/>65280.0f<sp/>/<sp/>65535.0f);</highlight></codeline>
<codeline lineno="300"><highlight class="normal">}</highlight></codeline>
<codeline lineno="301"><highlight class="normal"></highlight></codeline>
<codeline lineno="302"><highlight class="normal"></highlight></codeline>
<codeline lineno="311"><highlight class="normal">CIccCreateXformHintManager::~CIccCreateXformHintManager()</highlight></codeline>
<codeline lineno="312"><highlight class="normal">{</highlight></codeline>
<codeline lineno="313"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pList)<sp/>{</highlight></codeline>
<codeline lineno="314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IIccCreateXformHintList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="315"><highlight class="normal"></highlight></codeline>
<codeline lineno="316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=m_pList-&gt;begin();<sp/>i!=m_pList-&gt;end();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i-&gt;ptr)</highlight></codeline>
<codeline lineno="318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="320"><highlight class="normal"></highlight></codeline>
<codeline lineno="321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_pList;</highlight></codeline>
<codeline lineno="322"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="323"><highlight class="normal">}</highlight></codeline>
<codeline lineno="324"><highlight class="normal"></highlight></codeline>
<codeline lineno="340"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccCreateXformHintManager::AddHint(IIccCreateXformHint*<sp/>pHint)</highlight></codeline>
<codeline lineno="341"><highlight class="normal">{</highlight></codeline>
<codeline lineno="342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pList)<sp/>{</highlight></codeline>
<codeline lineno="343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pList<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>IIccCreateXformHintList;</highlight></codeline>
<codeline lineno="344"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="345"><highlight class="normal"></highlight></codeline>
<codeline lineno="346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pHint)<sp/>{</highlight></codeline>
<codeline lineno="347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(GetHint(pHint-&gt;GetHintType()))<sp/>{</highlight></codeline>
<codeline lineno="348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pHint;</highlight></codeline>
<codeline lineno="349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IIccCreateXformHintPtr<sp/>Hint;</highlight></codeline>
<codeline lineno="352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Hint.ptr<sp/>=<sp/>pHint;</highlight></codeline>
<codeline lineno="353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pList-&gt;push_back(Hint);</highlight></codeline>
<codeline lineno="354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="355"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="356"><highlight class="normal"></highlight></codeline>
<codeline lineno="357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="358"><highlight class="normal">}</highlight></codeline>
<codeline lineno="359"><highlight class="normal"></highlight></codeline>
<codeline lineno="376"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccCreateXformHintManager::DeleteHint(IIccCreateXformHint*<sp/>pHint)</highlight></codeline>
<codeline lineno="377"><highlight class="normal">{</highlight></codeline>
<codeline lineno="378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pList<sp/>&amp;&amp;<sp/>pHint)<sp/>{</highlight></codeline>
<codeline lineno="379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IIccCreateXformHintList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=m_pList-&gt;begin();<sp/>i!=m_pList-&gt;end();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i-&gt;ptr)<sp/>{</highlight></codeline>
<codeline lineno="382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i-&gt;ptr<sp/>==<sp/>pHint)<sp/>{</highlight></codeline>
<codeline lineno="383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pHint;</highlight></codeline>
<codeline lineno="384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pHint<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pList-&gt;erase(i);</highlight></codeline>
<codeline lineno="386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="390"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="391"><highlight class="normal"></highlight></codeline>
<codeline lineno="392"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="393"><highlight class="normal">}</highlight></codeline>
<codeline lineno="394"><highlight class="normal"></highlight></codeline>
<codeline lineno="409"><highlight class="normal">IIccCreateXformHint*<sp/>CIccCreateXformHintManager::GetHint(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*<sp/>hintName)</highlight></codeline>
<codeline lineno="410"><highlight class="normal">{</highlight></codeline>
<codeline lineno="411"><highlight class="normal"><sp/><sp/><sp/><sp/>IIccCreateXformHint*<sp/>pHint=NULL;</highlight></codeline>
<codeline lineno="412"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="413"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pList)<sp/>{</highlight></codeline>
<codeline lineno="414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>IIccCreateXformHintList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=m_pList-&gt;begin();<sp/>i!=m_pList-&gt;end();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i-&gt;ptr)<sp/>{</highlight></codeline>
<codeline lineno="417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!strcmp(i-&gt;ptr-&gt;GetHintType(),<sp/>hintName))<sp/>{</highlight></codeline>
<codeline lineno="418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pHint<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="423"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="424"><highlight class="normal"></highlight></codeline>
<codeline lineno="425"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pHint;</highlight></codeline>
<codeline lineno="426"><highlight class="normal">}</highlight></codeline>
<codeline lineno="427"><highlight class="normal"></highlight></codeline>
<codeline lineno="436"><highlight class="normal">CIccXform::CIccXform()<sp/></highlight></codeline>
<codeline lineno="437"><highlight class="normal">{</highlight></codeline>
<codeline lineno="438"><highlight class="normal"><sp/><sp/>m_pProfile<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="439"><highlight class="normal"><sp/><sp/>m_bOwnsProfile<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="440"><highlight class="normal"><sp/><sp/>m_bInput<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="441"><highlight class="normal"><sp/><sp/>m_nIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1a0fbdbf76357f4ad739b1df71bd87ef8a" kindref="member">icUnknownIntent</ref>;</highlight></codeline>
<codeline lineno="442"><highlight class="normal"><sp/><sp/>m_pAdjustPCS<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="443"><highlight class="normal"><sp/><sp/>m_bAdjustPCS<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="444"><highlight class="normal"><sp/><sp/>m_bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="445"><highlight class="normal"><sp/><sp/>m_nMCS<sp/>=<sp/><ref refid="d6/d5b/a00026_1aaaa5f9a3442f4cebec6f0d815e022393a7777670882f9cded205c604bbdde8b0d" kindref="member">icNoMCS</ref>;</highlight></codeline>
<codeline lineno="446"><highlight class="normal"><sp/><sp/>m_bUseSpectralPCS<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="447"><highlight class="normal"><sp/><sp/>m_bSrcPcsConversion<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="448"><highlight class="normal"><sp/><sp/>m_bDstPcsConversion<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="449"><highlight class="normal"><sp/><sp/>m_pConnectionConditions<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="450"><highlight class="normal"><sp/><sp/>m_bDeleteEnvLooup<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="451"><highlight class="normal"><sp/><sp/>m_pCmmEnvVarLookup<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="452"><highlight class="normal"><sp/><sp/>m_nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref>;</highlight></codeline>
<codeline lineno="453"><highlight class="normal"><sp/><sp/>m_MediaXYZ<sp/>=<sp/>{};</highlight></codeline>
<codeline lineno="454"><highlight class="normal"><sp/><sp/>m_nInterp<sp/>=<sp/><ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913af6e0f18af557a029c4dda563c3a003fb" kindref="member">icInterpLinear</ref>;</highlight></codeline>
<codeline lineno="455"><highlight class="normal"><sp/><sp/>m_bUseD2BTags<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="456"><highlight class="normal"><sp/><sp/>m_bLuminanceMatching<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="457"><highlight class="normal"><sp/><sp/>m_PCSOffset[0]<sp/>=<sp/>m_PCSOffset[1]<sp/>=<sp/>m_PCSOffset[2]<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="458"><highlight class="normal">}</highlight></codeline>
<codeline lineno="459"><highlight class="normal"></highlight></codeline>
<codeline lineno="460"><highlight class="normal"></highlight></codeline>
<codeline lineno="469"><highlight class="normal">CIccXform::~CIccXform()</highlight></codeline>
<codeline lineno="470"><highlight class="normal">{</highlight></codeline>
<codeline lineno="471"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pProfile<sp/>&amp;&amp;<sp/>m_bOwnsProfile)</highlight></codeline>
<codeline lineno="472"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_pProfile;</highlight></codeline>
<codeline lineno="473"><highlight class="normal"></highlight></codeline>
<codeline lineno="474"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pAdjustPCS)<sp/>{</highlight></codeline>
<codeline lineno="475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_pAdjustPCS;</highlight></codeline>
<codeline lineno="476"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="477"><highlight class="normal"></highlight></codeline>
<codeline lineno="478"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pCmmEnvVarLookup<sp/>&amp;&amp;<sp/>m_bDeleteEnvLooup)<sp/>{</highlight></codeline>
<codeline lineno="479"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_pCmmEnvVarLookup;</highlight></codeline>
<codeline lineno="480"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="481"><highlight class="normal"></highlight></codeline>
<codeline lineno="482"><highlight class="normal">}</highlight></codeline>
<codeline lineno="483"><highlight class="normal"></highlight></codeline>
<codeline lineno="484"><highlight class="normal"></highlight></codeline>
<codeline lineno="485"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccXform::DetachAll()</highlight></codeline>
<codeline lineno="486"><highlight class="normal">{</highlight></codeline>
<codeline lineno="487"><highlight class="normal"><sp/><sp/>m_pProfile<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="488"><highlight class="normal"><sp/><sp/>m_bOwnsProfile<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="489"><highlight class="normal"><sp/><sp/>m_pConnectionConditions<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="490"><highlight class="normal">}</highlight></codeline>
<codeline lineno="491"><highlight class="normal"></highlight></codeline>
<codeline lineno="515"><highlight class="normal">CIccXform<sp/>*CIccXform::Create(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile,</highlight></codeline>
<codeline lineno="516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bInput</highlight><highlight class="comment">/*<sp/>=true<sp/>*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nIntent</highlight><highlight class="comment">/*<sp/>=icUnknownIntent<sp/>*/</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913" kindref="member">icXformInterp</ref><sp/>nInterp</highlight><highlight class="comment">/*<sp/>=icInterpLinear<sp/>*/</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc</highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7b" kindref="member">icXformLutType</ref><sp/>nLutType</highlight><highlight class="comment">/*<sp/>=icXformLutColor<sp/>*/</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseD2BTags</highlight><highlight class="comment">/*<sp/>=true<sp/>*/</highlight><highlight class="normal">,<sp/>CIccCreateXformHintManager<sp/>*pHintManager</highlight><highlight class="comment">/*<sp/>=NULL<sp/>*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="522"><highlight class="normal">{</highlight></codeline>
<codeline lineno="523"><highlight class="normal"><sp/><sp/>CIccXform<sp/>*rv<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="524"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nTagIntent<sp/>=<sp/>nIntent;</highlight></codeline>
<codeline lineno="525"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseSpectralPCS<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="526"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="527"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bRelToAbs<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="528"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aaaa5f9a3442f4cebec6f0d815e022393" kindref="member">icMCSConnectionType</ref><sp/>nMCS<sp/>=<sp/><ref refid="d6/d5b/a00026_1aaaa5f9a3442f4cebec6f0d815e022393a7777670882f9cded205c604bbdde8b0d" kindref="member">icNoMCS</ref>;</highlight></codeline>
<codeline lineno="529"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7b" kindref="member">icXformLutType</ref><sp/>nUseLutType<sp/>=<sp/>nLutType;</highlight></codeline>
<codeline lineno="530"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseColorimeticTags<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="531"><highlight class="normal"></highlight></codeline>
<codeline lineno="532"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nLutType<sp/>==<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262" kindref="member">icXformLutSpectral</ref>)<sp/>{</highlight></codeline>
<codeline lineno="533"><highlight class="normal"><sp/><sp/><sp/><sp/>nUseLutType<sp/>=<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614" kindref="member">icXformLutColor</ref>;</highlight></codeline>
<codeline lineno="534"><highlight class="normal"><sp/><sp/><sp/><sp/>bUseD2BTags<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="535"><highlight class="normal"><sp/><sp/><sp/><sp/>bUseColorimeticTags<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="536"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="537"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nLutType<sp/>==<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013" kindref="member">icXformLutColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="538"><highlight class="normal"><sp/><sp/><sp/><sp/>nUseLutType<sp/>=<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614" kindref="member">icXformLutColor</ref>;</highlight></codeline>
<codeline lineno="539"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="540"><highlight class="normal"></highlight></codeline>
<codeline lineno="541"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass==<ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a24cf99d0920e4e0b4549d67311e99928" kindref="member">icSigColorEncodingClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="542"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pEncProfile;</highlight></codeline>
<codeline lineno="543"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d3/dd5/a00215_1aa1b934352875d96de59a8b3332dc8e1d" kindref="member">icConvertEncodingProfile</ref>(pEncProfile,<sp/>pProfile)!=<ref refid="d3/dd5/a00215_1af0a7084e49f2f756cb1ff0cc500a9a41a3fed7724f564a3c845311a6694bc0b06" kindref="member">icEncConvertOk</ref>)</highlight></codeline>
<codeline lineno="544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="545"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pProfile;</highlight></codeline>
<codeline lineno="546"><highlight class="normal"><sp/><sp/><sp/><sp/>pProfile<sp/>=<sp/>pEncProfile;</highlight></codeline>
<codeline lineno="547"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="548"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass==<ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0af50c13fdfab9fcc0a7b831ac86d1fe3b" kindref="member">icSigLinkClass</ref></highlight><highlight class="comment">/*<sp/>&amp;&amp;<sp/>nIntent==icAbsoluteColorimetric*/</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="549"><highlight class="normal"><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref>;</highlight></codeline>
<codeline lineno="550"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="551"><highlight class="normal"></highlight></codeline>
<codeline lineno="552"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1a0fbdbf76357f4ad739b1df71bd87ef8a" kindref="member">icUnknownIntent</ref>)</highlight></codeline>
<codeline lineno="553"><highlight class="normal"><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref>;</highlight></codeline>
<codeline lineno="554"><highlight class="normal"></highlight></codeline>
<codeline lineno="555"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(nUseLutType)<sp/>{</highlight></codeline>
<codeline lineno="556"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614" kindref="member">icXformLutColor</ref>:</highlight></codeline>
<codeline lineno="557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bInput)<sp/>{</highlight></codeline>
<codeline lineno="558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="559"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseD2BTags)<sp/>{</highlight></codeline>
<codeline lineno="560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.spectralPCS<sp/>&amp;&amp;<sp/>nLutType!=<ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013" kindref="member">icXformLutColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a703f1866ed4cc98f623090b38917bc8e" kindref="member">icSigDToB0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="562"><highlight class="normal"></highlight></codeline>
<codeline lineno="563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ae185d0e91c27dc49b2a4a328de2fbb92" kindref="member">icSigDToB1Tag</ref>);</highlight></codeline>
<codeline lineno="565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a585329dfc33381a67de302149941bd38" kindref="member">icSigDToB3Tag</ref>);</highlight></codeline>
<codeline lineno="570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="575"><highlight class="normal"></highlight></codeline>
<codeline lineno="576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUseSpectralPCS<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="578"><highlight class="normal"></highlight></codeline>
<codeline lineno="579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a703f1866ed4cc98f623090b38917bc8e" kindref="member">icSigDToB0Tag</ref>);</highlight></codeline>
<codeline lineno="581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ae185d0e91c27dc49b2a4a328de2fbb92" kindref="member">icSigDToB1Tag</ref>);</highlight></codeline>
<codeline lineno="584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="585"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a585329dfc33381a67de302149941bd38" kindref="member">icSigDToB3Tag</ref>);</highlight></codeline>
<codeline lineno="587"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="589"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="590"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="592"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.version<sp/>&lt;<sp/><ref refid="d7/d46/a00002_1a802c8f93248af9679280a8c10705807c" kindref="member">icVersionNumberV5</ref>)<sp/>{</highlight></codeline>
<codeline lineno="594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a703f1866ed4cc98f623090b38917bc8e" kindref="member">icSigDToB0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="595"><highlight class="normal"></highlight></codeline>
<codeline lineno="596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>==<ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ae185d0e91c27dc49b2a4a328de2fbb92" kindref="member">icSigDToB1Tag</ref>);</highlight></codeline>
<codeline lineno="598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="601"><highlight class="normal"></highlight></codeline>
<codeline lineno="602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Apparently<sp/>Using<sp/>DtoB0<sp/>is<sp/>not<sp/>prescribed<sp/>here<sp/>by<sp/>the<sp/>v4<sp/>ICC<sp/>Specification</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.version<sp/>&gt;=<sp/><ref refid="d7/d46/a00002_1a802c8f93248af9679280a8c10705807c" kindref="member">icVersionNumberV5</ref>)<sp/>{</highlight></codeline>
<codeline lineno="604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a703f1866ed4cc98f623090b38917bc8e" kindref="member">icSigDToB0Tag</ref>);</highlight></codeline>
<codeline lineno="605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="608"><highlight class="normal"></highlight></codeline>
<codeline lineno="609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseColorimeticTags)<sp/>{</highlight></codeline>
<codeline lineno="610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a48a680ba3049e0c37a44da9f08e411c7" kindref="member">icSigAToB0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="613"><highlight class="normal"></highlight></codeline>
<codeline lineno="614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ab04125e571eb02f134e54fb3b0bcdb45" kindref="member">icSigAToB1Tag</ref>);</highlight></codeline>
<codeline lineno="616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a19b39e0d70b49c0c8864ec3b5ee2f1ba" kindref="member">icSigAToB3Tag</ref>);</highlight></codeline>
<codeline lineno="621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="626"><highlight class="normal"></highlight></codeline>
<codeline lineno="627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a48a680ba3049e0c37a44da9f08e411c7" kindref="member">icSigAToB0Tag</ref>);</highlight></codeline>
<codeline lineno="629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ab04125e571eb02f134e54fb3b0bcdb45" kindref="member">icSigAToB1Tag</ref>);</highlight></codeline>
<codeline lineno="632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a19b39e0d70b49c0c8864ec3b5ee2f1ba" kindref="member">icSigAToB3Tag</ref>);</highlight></codeline>
<codeline lineno="635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="641"><highlight class="normal"></highlight></codeline>
<codeline lineno="642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Unsupported<sp/>elements<sp/>cause<sp/>fall<sp/>back<sp/>behavior</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>!pTag-&gt;<ref refid="d7/dfd/a00969_1a3415307280dc7b871cc1797704008991" kindref="member">IsSupported</ref>())</highlight></codeline>
<codeline lineno="644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="645"><highlight class="normal"></highlight></codeline>
<codeline lineno="646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.version<sp/>&lt;<sp/><ref refid="d7/d46/a00002_1a802c8f93248af9679280a8c10705807c" kindref="member">icVersionNumberV5</ref>)<sp/>{</highlight></codeline>
<codeline lineno="648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Matrix/TRC<sp/>profiles<sp/>are<sp/>deprecated<sp/>in<sp/>v5<sp/>profiles</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.colorSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30" kindref="member">icSigRgbData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa06be3d5a167735863cb627f627c27988" kindref="member">icXformTypeMatrixTRC</ref>,<sp/>NULL,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.colorSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917af4c6afaa42216765b0431ec6ae0ba27c" kindref="member">icSigGrayData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa4ce2fe52f1dcd97ba1d6b9ad0628e6df" kindref="member">icXformTypeMonochrome</ref>,<sp/>NULL,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="658"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag-&gt;<ref refid="d7/dfd/a00969_1a0d6f4b6f857134bd87bfb0cd54025208" kindref="member">GetType</ref>()==<ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481" kindref="member">icSigMultiProcessElementType</ref>)<sp/>{</highlight></codeline>
<codeline lineno="662"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d" kindref="member">icXformTypeMpe</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pProfile-&gt;m_Header.colorSpace)<sp/>{</highlight></codeline>
<codeline lineno="666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>:</highlight></codeline>
<codeline lineno="667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>:</highlight></codeline>
<codeline lineno="668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0ab090e1f79d31e78c006c6ab25933dd" kindref="member">icSigLuvData</ref>:</highlight></codeline>
<codeline lineno="669"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ae02a4b86c48a9b85be92fdfc2114e496" kindref="member">icSigYCbCrData</ref>:</highlight></codeline>
<codeline lineno="670"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917afc7f319f261280fc48d7510c3a8bc330" kindref="member">icSigYxyData</ref>:</highlight></codeline>
<codeline lineno="671"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30" kindref="member">icSigRgbData</ref>:</highlight></codeline>
<codeline lineno="672"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917afc7cddf72b4d83ee5cb3568143580828" kindref="member">icSigHsvData</ref>:</highlight></codeline>
<codeline lineno="673"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ad4a717752d16d5fcf92e1fdd892b8bd8" kindref="member">icSigHlsData</ref>:</highlight></codeline>
<codeline lineno="674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917af20259a5702129c41fd08e21c7e94a74" kindref="member">icSigCmyData</ref>:</highlight></codeline>
<codeline lineno="675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917afa0686ad8f20f604e7e52807087f04da" kindref="member">icSig3colorData</ref>:</highlight></codeline>
<codeline lineno="676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa8f98fe94a91c4c002341c77b47ffed35" kindref="member">icXformType3DLut</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="678"><highlight class="normal"></highlight></codeline>
<codeline lineno="679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661" kindref="member">icSigCmykData</ref>:</highlight></codeline>
<codeline lineno="680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917addb4c9db388eda46c3ec7fdaa8824cf5" kindref="member">icSig4colorData</ref>:</highlight></codeline>
<codeline lineno="681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa9ad326943cff407bb96bdc9a53920996" kindref="member">icXformType4DLut</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="683"><highlight class="normal"></highlight></codeline>
<codeline lineno="684"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa2e963058ad1caacf212b0527242ec9e1" kindref="member">icXformTypeNDLut</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="687"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="692"><highlight class="normal"></highlight></codeline>
<codeline lineno="693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nLutType<sp/>==<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013" kindref="member">icXformLutColorimetric</ref><sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.version<sp/>&gt;=<sp/><ref refid="d7/d46/a00002_1a802c8f93248af9679280a8c10705807c" kindref="member">icVersionNumberV5</ref>)<sp/>{</highlight></codeline>
<codeline lineno="694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUseD2BTags<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseD2BTags)<sp/>{</highlight></codeline>
<codeline lineno="698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a0247611a0b2a3faa49a0df2dfc8420cc" kindref="member">icSigBToD0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="699"><highlight class="normal"></highlight></codeline>
<codeline lineno="700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Additional<sp/>precedence<sp/>not<sp/>prescribed<sp/>by<sp/>the<sp/>v4<sp/>ICC<sp/>Specification</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.version<sp/>&gt;=<sp/><ref refid="d7/d46/a00002_1a802c8f93248af9679280a8c10705807c" kindref="member">icVersionNumberV5</ref>)<sp/>{</highlight></codeline>
<codeline lineno="702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a0247611a0b2a3faa49a0df2dfc8420cc" kindref="member">icSigBToD0Tag</ref>);</highlight></codeline>
<codeline lineno="703"><highlight class="normal"></highlight></codeline>
<codeline lineno="704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a8a66e2d1402c9f9796a902cd2f0ac0eb" kindref="member">icSigBToD1Tag</ref>);</highlight></codeline>
<codeline lineno="706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nTagIntent==<ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)</highlight></codeline>
<codeline lineno="709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bRelToAbs<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="712"><highlight class="normal"></highlight></codeline>
<codeline lineno="713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a740cafe42e07749bbe3b36d881325801" kindref="member">icSigBToD3Tag</ref>);</highlight></codeline>
<codeline lineno="715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="721"><highlight class="normal"></highlight></codeline>
<codeline lineno="722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Unsupported<sp/>elements<sp/>cause<sp/>fall<sp/>back<sp/>behavior</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>!pTag-&gt;<ref refid="d7/dfd/a00969_1a3415307280dc7b871cc1797704008991" kindref="member">IsSupported</ref>())</highlight></codeline>
<codeline lineno="724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="725"><highlight class="normal"></highlight></codeline>
<codeline lineno="726"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUseSpectralPCS<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="728"><highlight class="normal"></highlight></codeline>
<codeline lineno="729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref><sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.version<sp/>&lt;<sp/><ref refid="d7/d46/a00002_1a802c8f93248af9679280a8c10705807c" kindref="member">icVersionNumberV5</ref>)<sp/>{</highlight></codeline>
<codeline lineno="730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a8a66e2d1402c9f9796a902cd2f0ac0eb" kindref="member">icSigBToD1Tag</ref>);</highlight></codeline>
<codeline lineno="731"><highlight class="normal"></highlight></codeline>
<codeline lineno="732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Unsupported<sp/>elements<sp/>cause<sp/>fall<sp/>back<sp/>behavior</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>!pTag-&gt;<ref refid="d7/dfd/a00969_1a3415307280dc7b871cc1797704008991" kindref="member">IsSupported</ref>())</highlight></codeline>
<codeline lineno="734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="735"><highlight class="normal"></highlight></codeline>
<codeline lineno="736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="738"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="740"><highlight class="normal"></highlight></codeline>
<codeline lineno="741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseColorimeticTags)<sp/>{</highlight></codeline>
<codeline lineno="742"><highlight class="normal"></highlight></codeline>
<codeline lineno="743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a78413df8b7d634ae4e0ec02f006e5bd0" kindref="member">icSigBToA0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="746"><highlight class="normal"></highlight></codeline>
<codeline lineno="747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a53147bf01d2c36339096d2f22b9c2869" kindref="member">icSigBToA1Tag</ref>);</highlight></codeline>
<codeline lineno="749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="750"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="752"><highlight class="normal"></highlight></codeline>
<codeline lineno="753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a78413df8b7d634ae4e0ec02f006e5bd0" kindref="member">icSigBToA0Tag</ref>);</highlight></codeline>
<codeline lineno="755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="756"><highlight class="normal"></highlight></codeline>
<codeline lineno="757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Additional<sp/>precedence<sp/>not<sp/>prescribed<sp/>by<sp/>the<sp/>v4<sp/>ICC<sp/>Specification</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.version<sp/>&gt;=<sp/><ref refid="d7/d46/a00002_1a802c8f93248af9679280a8c10705807c" kindref="member">icVersionNumberV5</ref>)<sp/>{</highlight></codeline>
<codeline lineno="759"><highlight class="normal"></highlight></codeline>
<codeline lineno="760"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a53147bf01d2c36339096d2f22b9c2869" kindref="member">icSigBToA1Tag</ref>);</highlight></codeline>
<codeline lineno="761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="762"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)</highlight></codeline>
<codeline lineno="764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bRelToAbs<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="766"><highlight class="normal"></highlight></codeline>
<codeline lineno="767"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ab6a3ba830b4ac279851cb5674c83ce06" kindref="member">icSigBToA3Tag</ref>);</highlight></codeline>
<codeline lineno="769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="772"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="776"><highlight class="normal"></highlight></codeline>
<codeline lineno="777"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.version<sp/>&lt;<sp/><ref refid="d7/d46/a00002_1a802c8f93248af9679280a8c10705807c" kindref="member">icVersionNumberV5</ref>)<sp/>{</highlight></codeline>
<codeline lineno="779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.colorSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30" kindref="member">icSigRgbData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa06be3d5a167735863cb627f627c27988" kindref="member">icXformTypeMatrixTRC</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="782"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.colorSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917af4c6afaa42216765b0431ec6ae0ba27c" kindref="member">icSigGrayData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa4ce2fe52f1dcd97ba1d6b9ad0628e6df" kindref="member">icXformTypeMonochrome</ref>,<sp/>NULL,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="788"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="789"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="790"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag-&gt;<ref refid="d7/dfd/a00969_1a0d6f4b6f857134bd87bfb0cd54025208" kindref="member">GetType</ref>()==<ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481" kindref="member">icSigMultiProcessElementType</ref>)<sp/>{</highlight></codeline>
<codeline lineno="792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d" kindref="member">icXformTypeMpe</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pProfile-&gt;m_Header.pcs)<sp/>{</highlight></codeline>
<codeline lineno="796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>:</highlight></codeline>
<codeline lineno="797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>:</highlight></codeline>
<codeline lineno="798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa8f98fe94a91c4c002341c77b47ffed35" kindref="member">icXformType3DLut</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="800"><highlight class="normal"></highlight></codeline>
<codeline lineno="801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="807"><highlight class="normal"></highlight></codeline>
<codeline lineno="808"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba0b1f2aadd55b74ea25adc32e3cadf4c0" kindref="member">icXformLutNamedColor</ref>:</highlight></codeline>
<codeline lineno="809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ac9a9457a436bbfaa9212552f337d2beb" kindref="member">icSigNamedColor2Tag</ref>);</highlight></codeline>
<codeline lineno="811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)</highlight></codeline>
<codeline lineno="812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="813"><highlight class="normal"></highlight></codeline>
<codeline lineno="814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccCreateNamedColorXformHint*<sp/>pNamedColorHint<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccCreateNamedColorXformHint();</highlight></codeline>
<codeline lineno="815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pNamedColorHint-&gt;csPcs<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pNamedColorHint-&gt;csDevice<sp/>=<sp/>pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pNamedColorHint-&gt;csSpectralPcs<sp/>=<sp/>pProfile-&gt;m_Header.spectralPCS;</highlight></codeline>
<codeline lineno="818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pNamedColorHint-&gt;spectralRange<sp/>=<sp/>pProfile-&gt;m_Header.spectralRange;</highlight></codeline>
<codeline lineno="819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pNamedColorHint-&gt;biSpectralRange<sp/>=<sp/>pProfile-&gt;m_Header.biSpectralRange;</highlight></codeline>
<codeline lineno="820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pHintManager)<sp/>{</highlight></codeline>
<codeline lineno="821"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pHintManager-&gt;AddHint(pNamedColorHint);</highlight></codeline>
<codeline lineno="822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pHintManager-&gt;DeleteHint(pNamedColorHint);</highlight></codeline>
<codeline lineno="824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccCreateXformHintManager<sp/>HintManager;</highlight></codeline>
<codeline lineno="827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>HintManager.AddHint(pNamedColorHint);</highlight></codeline>
<codeline lineno="828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>,<sp/>pTag,<sp/>&amp;HintManager);</highlight></codeline>
<codeline lineno="829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="830"><highlight class="normal"></highlight></codeline>
<codeline lineno="831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.spectralPCS)</highlight></codeline>
<codeline lineno="832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUseSpectralPCS<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="834"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="835"><highlight class="normal"></highlight></codeline>
<codeline lineno="836"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7baeb0501fdc1dcc7f1388f0fdca9b17356" kindref="member">icXformLutPreview</ref>:</highlight></codeline>
<codeline lineno="837"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ac5ae9a8a0d00acc2b7ec4f2da4ccc3f8" kindref="member">icSigPreview0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ac5ae9a8a0d00acc2b7ec4f2da4ccc3f8" kindref="member">icSigPreview0Tag</ref>);</highlight></codeline>
<codeline lineno="842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="845"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pProfile-&gt;m_Header.pcs)<sp/>{</highlight></codeline>
<codeline lineno="848"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>:</highlight></codeline>
<codeline lineno="849"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>:</highlight></codeline>
<codeline lineno="850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa8f98fe94a91c4c002341c77b47ffed35" kindref="member">icXformType3DLut</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="851"><highlight class="normal"></highlight></codeline>
<codeline lineno="852"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="858"><highlight class="normal"></highlight></codeline>
<codeline lineno="859"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba6df311bd7dc6c9c9284ad186b15f53de" kindref="member">icXformLutGamut</ref>:</highlight></codeline>
<codeline lineno="860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="862"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ad57d49a829f89f04159908e21ffe9d01" kindref="member">icSigGamutTag</ref>);</highlight></codeline>
<codeline lineno="863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pProfile-&gt;m_Header.pcs)<sp/>{</highlight></codeline>
<codeline lineno="868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>:</highlight></codeline>
<codeline lineno="869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>:</highlight></codeline>
<codeline lineno="870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa8f98fe94a91c4c002341c77b47ffed35" kindref="member">icXformType3DLut</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="871"><highlight class="normal"></highlight></codeline>
<codeline lineno="872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="873"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="878"><highlight class="normal"></highlight></codeline>
<codeline lineno="879"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7baf26b30e0e73bf289c23075e2f6106e6d" kindref="member">icXformLutBRDFParam</ref>:</highlight></codeline>
<codeline lineno="880"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>get<sp/>the<sp/>correct<sp/>tag<sp/>first</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="882"><highlight class="normal"></highlight></codeline>
<codeline lineno="883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseD2BTags)<sp/>{</highlight></codeline>
<codeline lineno="885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.spectralPCS)<sp/>{</highlight></codeline>
<codeline lineno="886"><highlight class="normal"></highlight></codeline>
<codeline lineno="887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a341a5307f022df0104358887c08c4115" kindref="member">icSigBrdfSpectralParameter0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="888"><highlight class="normal"></highlight></codeline>
<codeline lineno="889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUseSpectralPCS<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ae6f4fd41479c1274ea14e0bb432f0253" kindref="member">icSigBrdfColorimetricParameter0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="896"><highlight class="normal"></highlight></codeline>
<codeline lineno="897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Unsupported<sp/>elements<sp/>cause<sp/>fall<sp/>back<sp/>behavior</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>!pTag-&gt;<ref refid="d7/dfd/a00969_1a3415307280dc7b871cc1797704008991" kindref="member">IsSupported</ref>())</highlight></codeline>
<codeline lineno="899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="901"><highlight class="normal"></highlight></codeline>
<codeline lineno="902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>now<sp/>extract<sp/>the<sp/>correct<sp/>part<sp/>from<sp/>the<sp/>structure</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d00/a00401" kindref="compound">CIccStructBRDF</ref>*<sp/>pStructTag<sp/>=<sp/></highlight><highlight class="keyword">dynamic_cast&lt;</highlight><highlight class="normal"><ref refid="d7/d00/a00401" kindref="compound">CIccStructBRDF</ref>*</highlight><highlight class="keyword">&gt;</highlight><highlight class="normal">(pTag);</highlight></codeline>
<codeline lineno="904"><highlight class="normal"></highlight></codeline>
<codeline lineno="905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pStructTag<sp/>!=<sp/>NULL)</highlight></codeline>
<codeline lineno="906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag2<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="908"><highlight class="normal"></highlight></codeline>
<codeline lineno="909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(nLutType)<sp/>{</highlight></codeline>
<codeline lineno="910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7baf26b30e0e73bf289c23075e2f6106e6d" kindref="member">icXformLutBRDFParam</ref>:</highlight></codeline>
<codeline lineno="911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag2<sp/>=<sp/>pStructTag-&gt;<ref refid="da/dbf/a00393_1ae59376fd46156a41bb687406b3d881d7" kindref="member">GetElem</ref>(<ref refid="d7/d46/a00002_1af46212fb10475a9822be7160951f142cadd1015e094e8b2a1f9dff66dc0271754" kindref="member">icSigBrdfTransformMbr</ref>);</highlight></codeline>
<codeline lineno="912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>can&apos;t<sp/>get<sp/>here,<sp/>get<sp/>rid<sp/>of<sp/>warning</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag2)</highlight></codeline>
<codeline lineno="918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d" kindref="member">icXformTypeMpe</ref>,<sp/>pTag2,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="920"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="921"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="922"><highlight class="normal"></highlight></codeline>
<codeline lineno="923"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba1109d56a39fd11938962b487d6f965b8" kindref="member">icXformLutBRDFDirect</ref>:</highlight></codeline>
<codeline lineno="924"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>get<sp/>the<sp/>correct<sp/>tag<sp/>first</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="926"><highlight class="normal"></highlight></codeline>
<codeline lineno="927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseD2BTags)<sp/>{</highlight></codeline>
<codeline lineno="929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.spectralPCS)<sp/>{</highlight></codeline>
<codeline lineno="930"><highlight class="normal"></highlight></codeline>
<codeline lineno="931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a182f63dba24e9033151133f9678f7b75" kindref="member">icSigBRDFDToB0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="932"><highlight class="normal"></highlight></codeline>
<codeline lineno="933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUseSpectralPCS<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a6a8323df91e18a157d90c1f0f27c6a22" kindref="member">icSigBRDFAToB0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="940"><highlight class="normal"></highlight></codeline>
<codeline lineno="941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Unsupported<sp/>elements<sp/>cause<sp/>fall<sp/>back<sp/>behavior</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>!pTag-&gt;<ref refid="d7/dfd/a00969_1a3415307280dc7b871cc1797704008991" kindref="member">IsSupported</ref>())</highlight></codeline>
<codeline lineno="943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="945"><highlight class="normal"></highlight></codeline>
<codeline lineno="946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>!=<sp/>NULL)</highlight></codeline>
<codeline lineno="947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d" kindref="member">icXformTypeMpe</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="950"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="951"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="952"><highlight class="normal"></highlight></codeline>
<codeline lineno="953"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba1765210771d77678d0600381557d8bba" kindref="member">icXformLutBRDFMcsParam</ref>:</highlight></codeline>
<codeline lineno="954"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass<sp/>==<sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f" kindref="member">icSigMaterialVisualizationClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nMCS<sp/>=<sp/><ref refid="d6/d5b/a00026_1aaaa5f9a3442f4cebec6f0d815e022393a9900382442b6928de2af4b116f08dd5e" kindref="member">icFromMCS</ref>;</highlight></codeline>
<codeline lineno="959"><highlight class="normal"></highlight></codeline>
<codeline lineno="960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.spectralPCS)<sp/>{</highlight></codeline>
<codeline lineno="961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5abf1026085f40d42c8202fd1b3a8ad9b4" kindref="member">icSigBRDFMToS0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="962"><highlight class="normal"></highlight></codeline>
<codeline lineno="963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5abda57fa68ef3f179ca1728b2030da340" kindref="member">icSigBRDFMToS1Tag</ref>);</highlight></codeline>
<codeline lineno="965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>!=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5aa5b272ef03d506460dbb1c5c6a6cc599" kindref="member">icSigBRDFMToS3Tag</ref>);</highlight></codeline>
<codeline lineno="970"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="975"><highlight class="normal"></highlight></codeline>
<codeline lineno="976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5abf1026085f40d42c8202fd1b3a8ad9b4" kindref="member">icSigBRDFMToS0Tag</ref>);</highlight></codeline>
<codeline lineno="978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5abda57fa68ef3f179ca1728b2030da340" kindref="member">icSigBRDFMToS1Tag</ref>);</highlight></codeline>
<codeline lineno="981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5aa5b272ef03d506460dbb1c5c6a6cc599" kindref="member">icSigBRDFMToS3Tag</ref>);</highlight></codeline>
<codeline lineno="984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="989"><highlight class="normal"></highlight></codeline>
<codeline lineno="990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUseSpectralPCS<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.pcs<sp/>!=<sp/>0)<sp/>{</highlight></codeline>
<codeline lineno="994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5af8c5abf6686452d76ab9c0327ad5067c" kindref="member">icSigBRDFMToB0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="995"><highlight class="normal"></highlight></codeline>
<codeline lineno="996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a078ce8e7fc1f2e78a5bcd4506216f2b7" kindref="member">icSigBRDFMToB1Tag</ref>);</highlight></codeline>
<codeline lineno="998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="1000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>!=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a07ee2aaf6842476471432af3cc786404" kindref="member">icSigBRDFMToB3Tag</ref>);</highlight></codeline>
<codeline lineno="1003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="1004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="1005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="1009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5af8c5abf6686452d76ab9c0327ad5067c" kindref="member">icSigBRDFMToB0Tag</ref>);</highlight></codeline>
<codeline lineno="1010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="1012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a078ce8e7fc1f2e78a5bcd4506216f2b7" kindref="member">icSigBRDFMToB1Tag</ref>);</highlight></codeline>
<codeline lineno="1013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="1015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a07ee2aaf6842476471432af3cc786404" kindref="member">icSigBRDFMToB3Tag</ref>);</highlight></codeline>
<codeline lineno="1016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="1017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="1018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1022"><highlight class="normal"></highlight></codeline>
<codeline lineno="1023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Unsupported<sp/>elements<sp/>cause<sp/>fall<sp/>back<sp/>behavior</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>!pTag-&gt;<ref refid="d7/dfd/a00969_1a3415307280dc7b871cc1797704008991" kindref="member">IsSupported</ref>())</highlight></codeline>
<codeline lineno="1025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1026"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="1027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Unsupported<sp/>elements<sp/>cause<sp/>fall<sp/>back<sp/>behavior</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>!pTag-&gt;<ref refid="d7/dfd/a00969_1a3415307280dc7b871cc1797704008991" kindref="member">IsSupported</ref>())</highlight></codeline>
<codeline lineno="1029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.mcs)<sp/>{</highlight></codeline>
<codeline lineno="1032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d" kindref="member">icXformTypeMpe</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="1033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1036"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1037"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1038"><highlight class="normal"></highlight></codeline>
<codeline lineno="1039"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153" kindref="member">icXformLutMCS</ref>:</highlight></codeline>
<codeline lineno="1040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="1041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass==<ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0aeb74955777b1abe38df700474c7be5ce" kindref="member">icSigMaterialIdentificationClass</ref><sp/>||</highlight></codeline>
<codeline lineno="1043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pProfile-&gt;m_Header.deviceClass==<ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a787f32c0c9368bc8c4e85a670ae91c8d" kindref="member">icSigInputClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nMCS<sp/>=<sp/><ref refid="d6/d5b/a00026_1aaaa5f9a3442f4cebec6f0d815e022393a792a9f663756385f0a63c62606fbd5b5" kindref="member">icToMCS</ref>;</highlight></codeline>
<codeline lineno="1046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a4101fbfb53a9e422f925a0eb9b9754dc" kindref="member">icSigAToM0Tag</ref>);</highlight></codeline>
<codeline lineno="1047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass==<ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f" kindref="member">icSigMaterialVisualizationClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nMCS<sp/>=<sp/><ref refid="d6/d5b/a00026_1aaaa5f9a3442f4cebec6f0d815e022393a9900382442b6928de2af4b116f08dd5e" kindref="member">icFromMCS</ref>;</highlight></codeline>
<codeline lineno="1051"><highlight class="normal"></highlight></codeline>
<codeline lineno="1052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.spectralPCS)<sp/>{</highlight></codeline>
<codeline lineno="1053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a7a93318f3fc1c8582f6b11da800a899a" kindref="member">icSigMToS0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="1054"><highlight class="normal"></highlight></codeline>
<codeline lineno="1055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5adb1d5ba824d4d843572fe8206edad0ca" kindref="member">icSigMToS1Tag</ref>);</highlight></codeline>
<codeline lineno="1057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="1058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="1059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>!=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a33c2ed77d7d42de199cb874ec5ad4abf" kindref="member">icSigMToS3Tag</ref>);</highlight></codeline>
<codeline lineno="1062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="1063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="1064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1067"><highlight class="normal"></highlight></codeline>
<codeline lineno="1068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="1069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a7a93318f3fc1c8582f6b11da800a899a" kindref="member">icSigMToS0Tag</ref>);</highlight></codeline>
<codeline lineno="1070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="1072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5adb1d5ba824d4d843572fe8206edad0ca" kindref="member">icSigMToS1Tag</ref>);</highlight></codeline>
<codeline lineno="1073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="1075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a33c2ed77d7d42de199cb874ec5ad4abf" kindref="member">icSigMToS3Tag</ref>);</highlight></codeline>
<codeline lineno="1076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="1077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="1078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1081"><highlight class="normal"></highlight></codeline>
<codeline lineno="1082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="1083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUseSpectralPCS<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.pcs!=0)<sp/>{</highlight></codeline>
<codeline lineno="1086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a486e40891ee768a1331bf94d608d8400" kindref="member">icSigMToB0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="1087"><highlight class="normal"></highlight></codeline>
<codeline lineno="1088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a8ee39bf8d934b766ca5884899d3357a0" kindref="member">icSigMToB1Tag</ref>);</highlight></codeline>
<codeline lineno="1090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="1091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="1092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>!=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a50703cf46b465a10ad158fbb65ac8f8e" kindref="member">icSigMToB3Tag</ref>);</highlight></codeline>
<codeline lineno="1095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="1096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="1097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1100"><highlight class="normal"></highlight></codeline>
<codeline lineno="1101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="1102"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a486e40891ee768a1331bf94d608d8400" kindref="member">icSigMToB0Tag</ref>);</highlight></codeline>
<codeline lineno="1103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="1105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a8ee39bf8d934b766ca5884899d3357a0" kindref="member">icSigMToB1Tag</ref>);</highlight></codeline>
<codeline lineno="1106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="1108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a50703cf46b465a10ad158fbb65ac8f8e" kindref="member">icSigMToB3Tag</ref>);</highlight></codeline>
<codeline lineno="1109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="1110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="1111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1115"><highlight class="normal"></highlight></codeline>
<codeline lineno="1116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Unsupported<sp/>elements<sp/>cause<sp/>fall<sp/>back<sp/>behavior</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>!pTag-&gt;<ref refid="d7/dfd/a00969_1a3415307280dc7b871cc1797704008991" kindref="member">IsSupported</ref>())</highlight></codeline>
<codeline lineno="1118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass==<ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a8b2deae24b9246ac33314b42ad02ac48" kindref="member">icSigMaterialLinkClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nMCS<sp/>=<sp/><ref refid="d6/d5b/a00026_1aaaa5f9a3442f4cebec6f0d815e022393a9900382442b6928de2af4b116f08dd5e" kindref="member">icFromMCS</ref>;</highlight></codeline>
<codeline lineno="1123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ad5d6c8e49e16de86bede2c2e239b38d7" kindref="member">icSigMToA0Tag</ref>);</highlight></codeline>
<codeline lineno="1124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.mcs)<sp/>{</highlight></codeline>
<codeline lineno="1126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d" kindref="member">icXformTypeMpe</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="1127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1132"><highlight class="normal"></highlight></codeline>
<codeline lineno="1133"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1134"><highlight class="normal"></highlight></codeline>
<codeline lineno="1135"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)<sp/>{</highlight></codeline>
<codeline lineno="1136"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pPcc)</highlight></codeline>
<codeline lineno="1137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rv-&gt;m_pConnectionConditions<sp/>=<sp/>pPcc;</highlight></codeline>
<codeline lineno="1138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rv-&gt;m_pConnectionConditions<sp/>=<sp/>pProfile;</highlight></codeline>
<codeline lineno="1140"><highlight class="normal"></highlight></codeline>
<codeline lineno="1141"><highlight class="normal"><sp/><sp/><sp/><sp/>rv-&gt;SetParams(pProfile,<sp/>bInput,<sp/>nIntent,<sp/>nTagIntent,<sp/>bUseSpectralPCS,<sp/>nInterp,<sp/>pHintManager,<sp/>bAbsToRel,<sp/>nMCS);</highlight></codeline>
<codeline lineno="1142"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1143"><highlight class="normal"></highlight></codeline>
<codeline lineno="1144"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="1145"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1146"><highlight class="normal"></highlight></codeline>
<codeline lineno="1170"><highlight class="normal">CIccXform<sp/>*CIccXform::Create(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile,</highlight></codeline>
<codeline lineno="1171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag,</highlight></codeline>
<codeline lineno="1172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bInput</highlight><highlight class="comment">/*<sp/>=true<sp/>*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nIntent</highlight><highlight class="comment">/*<sp/>=icUnknownIntent<sp/>*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913" kindref="member">icXformInterp</ref><sp/>nInterp</highlight><highlight class="comment">/*<sp/>=icInterpLinear<sp/>*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc</highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseSpectralPCS</highlight><highlight class="comment">/*<sp/>=false*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccCreateXformHintManager<sp/>*pHintManager</highlight><highlight class="comment">/*<sp/>=NULL<sp/>*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1178"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1179"><highlight class="normal"><sp/><sp/>CIccXform<sp/>*rv<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1180"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nTagIntent<sp/>=<sp/>nIntent;</highlight></codeline>
<codeline lineno="1181"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1182"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bRelToAbs<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1183"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aaaa5f9a3442f4cebec6f0d815e022393" kindref="member">icMCSConnectionType</ref><sp/>nMCS<sp/>=<sp/><ref refid="d6/d5b/a00026_1aaaa5f9a3442f4cebec6f0d815e022393a7777670882f9cded205c604bbdde8b0d" kindref="member">icNoMCS</ref>;</highlight></codeline>
<codeline lineno="1184"><highlight class="normal"></highlight></codeline>
<codeline lineno="1185"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass<sp/>==<sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a24cf99d0920e4e0b4549d67311e99928" kindref="member">icSigColorEncodingClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1186"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1187"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1188"><highlight class="normal"></highlight></codeline>
<codeline lineno="1189"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass<sp/>==<sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0af50c13fdfab9fcc0a7b831ac86d1fe3b" kindref="member">icSigLinkClass</ref></highlight><highlight class="comment">/*<sp/>&amp;&amp;<sp/>nIntent==icAbsoluteColorimetric*/</highlight><highlight class="normal">)<sp/>{</highlight></codeline>
<codeline lineno="1190"><highlight class="normal"><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref>;</highlight></codeline>
<codeline lineno="1191"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1192"><highlight class="normal"></highlight></codeline>
<codeline lineno="1193"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1a0fbdbf76357f4ad739b1df71bd87ef8a" kindref="member">icUnknownIntent</ref>)</highlight></codeline>
<codeline lineno="1194"><highlight class="normal"><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref>;</highlight></codeline>
<codeline lineno="1195"><highlight class="normal"></highlight></codeline>
<codeline lineno="1196"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Unsupported<sp/>elements<sp/>cause<sp/>fall<sp/>back<sp/>behavior</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1197"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>==<sp/>NULL)</highlight></codeline>
<codeline lineno="1198"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1199"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>!pTag-&gt;<ref refid="d7/dfd/a00969_1a3415307280dc7b871cc1797704008991" kindref="member">IsSupported</ref>())</highlight></codeline>
<codeline lineno="1200"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1201"><highlight class="normal"></highlight></codeline>
<codeline lineno="1202"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bInput)<sp/>{</highlight></codeline>
<codeline lineno="1203"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag-&gt;<ref refid="d7/dfd/a00969_1a0d6f4b6f857134bd87bfb0cd54025208" kindref="member">GetType</ref>()<sp/>==<sp/><ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481" kindref="member">icSigMultiProcessElementType</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d" kindref="member">icXformTypeMpe</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="1205"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1206"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.colorSpace)<sp/>{</highlight></codeline>
<codeline lineno="1208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>:</highlight></codeline>
<codeline lineno="1209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>:</highlight></codeline>
<codeline lineno="1210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0ab090e1f79d31e78c006c6ab25933dd" kindref="member">icSigLuvData</ref>:</highlight></codeline>
<codeline lineno="1211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ae02a4b86c48a9b85be92fdfc2114e496" kindref="member">icSigYCbCrData</ref>:</highlight></codeline>
<codeline lineno="1212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917afc7f319f261280fc48d7510c3a8bc330" kindref="member">icSigYxyData</ref>:</highlight></codeline>
<codeline lineno="1213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30" kindref="member">icSigRgbData</ref>:</highlight></codeline>
<codeline lineno="1214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917afc7cddf72b4d83ee5cb3568143580828" kindref="member">icSigHsvData</ref>:</highlight></codeline>
<codeline lineno="1215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ad4a717752d16d5fcf92e1fdd892b8bd8" kindref="member">icSigHlsData</ref>:</highlight></codeline>
<codeline lineno="1216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917af20259a5702129c41fd08e21c7e94a74" kindref="member">icSigCmyData</ref>:</highlight></codeline>
<codeline lineno="1217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917afa0686ad8f20f604e7e52807087f04da" kindref="member">icSig3colorData</ref>:</highlight></codeline>
<codeline lineno="1218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa8f98fe94a91c4c002341c77b47ffed35" kindref="member">icXformType3DLut</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="1219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1220"><highlight class="normal"></highlight></codeline>
<codeline lineno="1221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661" kindref="member">icSigCmykData</ref>:</highlight></codeline>
<codeline lineno="1222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917addb4c9db388eda46c3ec7fdaa8824cf5" kindref="member">icSig4colorData</ref>:</highlight></codeline>
<codeline lineno="1223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa9ad326943cff407bb96bdc9a53920996" kindref="member">icXformType4DLut</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="1224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1225"><highlight class="normal"></highlight></codeline>
<codeline lineno="1226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa2e963058ad1caacf212b0527242ec9e1" kindref="member">icXformTypeNDLut</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="1228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1230"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1231"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1232"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1233"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag-&gt;<ref refid="d7/dfd/a00969_1a0d6f4b6f857134bd87bfb0cd54025208" kindref="member">GetType</ref>()<sp/>==<sp/><ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481" kindref="member">icSigMultiProcessElementType</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa024b427c7f71019c294beef3822a587d" kindref="member">icXformTypeMpe</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="1235"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1236"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.pcs)<sp/>{</highlight></codeline>
<codeline lineno="1238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>:</highlight></codeline>
<codeline lineno="1239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>:</highlight></codeline>
<codeline lineno="1240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="dd/d7e/a00809_1a194b94632e3d77385001a1596380d884" kindref="member">CIccXformCreator::CreateXform</ref>(<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fa8f98fe94a91c4c002341c77b47ffed35" kindref="member">icXformType3DLut</ref>,<sp/>pTag,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="1241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1242"><highlight class="normal"></highlight></codeline>
<codeline lineno="1243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="1244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1246"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1247"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1248"><highlight class="normal"></highlight></codeline>
<codeline lineno="1249"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)<sp/>{</highlight></codeline>
<codeline lineno="1250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pPcc)</highlight></codeline>
<codeline lineno="1251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rv-&gt;m_pConnectionConditions<sp/>=<sp/>pPcc;</highlight></codeline>
<codeline lineno="1252"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rv-&gt;m_pConnectionConditions<sp/>=<sp/>pProfile;</highlight></codeline>
<codeline lineno="1254"><highlight class="normal"></highlight></codeline>
<codeline lineno="1255"><highlight class="normal"><sp/><sp/><sp/><sp/>rv-&gt;SetParams(pProfile,<sp/>bInput,<sp/>nIntent,<sp/>nTagIntent,<sp/>bUseSpectralPCS,<sp/>nInterp,<sp/>pHintManager,<sp/>bAbsToRel,<sp/>nMCS);</highlight></codeline>
<codeline lineno="1256"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1257"><highlight class="normal"></highlight></codeline>
<codeline lineno="1258"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="1259"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1260"><highlight class="normal"></highlight></codeline>
<codeline lineno="1274"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccXform::SetParams(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bInput,<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nIntent,<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nTagIntent,</highlight></codeline>
<codeline lineno="1275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseSpectralPCS,<sp/><ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913" kindref="member">icXformInterp</ref><sp/>nInterp,<sp/>CIccCreateXformHintManager<sp/>*pHintManager</highlight><highlight class="comment">/*<sp/>=NULL<sp/>*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bAbsToRel</highlight><highlight class="comment">/*=false*/</highlight><highlight class="normal">,<sp/><ref refid="d6/d5b/a00026_1aaaa5f9a3442f4cebec6f0d815e022393" kindref="member">icMCSConnectionType</ref><sp/>nMCS</highlight><highlight class="comment">/*=icNoMCS*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1277"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1278"><highlight class="normal"><sp/><sp/>m_pProfile<sp/>=<sp/>pProfile;</highlight></codeline>
<codeline lineno="1279"><highlight class="normal"><sp/><sp/>m_bInput<sp/>=<sp/>bInput;</highlight></codeline>
<codeline lineno="1280"><highlight class="normal"><sp/><sp/>m_nIntent<sp/>=<sp/>nIntent;</highlight></codeline>
<codeline lineno="1281"><highlight class="normal"><sp/><sp/>m_nTagIntent<sp/>=<sp/>nTagIntent;</highlight></codeline>
<codeline lineno="1282"><highlight class="normal"><sp/><sp/>m_nInterp<sp/>=<sp/>nInterp;</highlight></codeline>
<codeline lineno="1283"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pAdjustPCS<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1284"><highlight class="normal"><sp/><sp/>m_bUseSpectralPCS<sp/>=<sp/>bUseSpectralPCS;</highlight></codeline>
<codeline lineno="1285"><highlight class="normal"><sp/><sp/>m_bAbsToRel<sp/>=<sp/>bAbsToRel;</highlight></codeline>
<codeline lineno="1286"><highlight class="normal"><sp/><sp/>m_nMCS<sp/>=<sp/>nMCS;</highlight></codeline>
<codeline lineno="1287"><highlight class="normal"><sp/><sp/>m_bLuminanceMatching<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1288"><highlight class="normal"></highlight></codeline>
<codeline lineno="1289"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pHintManager)<sp/>{</highlight></codeline>
<codeline lineno="1290"><highlight class="normal"><sp/><sp/><sp/><sp/>IIccCreateXformHint<sp/>*pHint=NULL;</highlight></codeline>
<codeline lineno="1291"><highlight class="normal"></highlight></codeline>
<codeline lineno="1292"><highlight class="normal"><sp/><sp/><sp/><sp/>pHint<sp/>=<sp/>pHintManager-&gt;GetHint(</highlight><highlight class="stringliteral">&quot;CIccCreateAdjustPCSXformHint&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1293"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pHint)<sp/>{</highlight></codeline>
<codeline lineno="1294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccCreateAdjustPCSXformHint<sp/>*pAdjustPCSHint<sp/>=<sp/>(CIccCreateAdjustPCSXformHint*)pHint;</highlight></codeline>
<codeline lineno="1295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pAdjustPCS<sp/>=<sp/>pAdjustPCSHint-&gt;GetNewAdjustPCSXform();</highlight></codeline>
<codeline lineno="1296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1297"><highlight class="normal"></highlight></codeline>
<codeline lineno="1298"><highlight class="normal"><sp/><sp/><sp/><sp/>pHint<sp/>=<sp/>pHintManager-&gt;GetHint(</highlight><highlight class="stringliteral">&quot;CIccCreateCmmEnvVarXformHint&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1299"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pHint)<sp/>{</highlight></codeline>
<codeline lineno="1300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccCreateCmmEnvVarXformHint<sp/>*pCmmEnvVarHint<sp/>=<sp/>(CIccCreateCmmEnvVarXformHint*)pHint;</highlight></codeline>
<codeline lineno="1301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pCmmEnvVarLookup<sp/>=<sp/>pCmmEnvVarHint-&gt;GetNewCmmEnvVarLookup();</highlight></codeline>
<codeline lineno="1302"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1303"><highlight class="normal"></highlight></codeline>
<codeline lineno="1304"><highlight class="normal"><sp/><sp/><sp/><sp/>pHint<sp/>=<sp/>pHintManager-&gt;GetHint(</highlight><highlight class="stringliteral">&quot;CIccLuminanceMatchingHint&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1305"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pHint)<sp/>{</highlight></codeline>
<codeline lineno="1306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_bLuminanceMatching<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1307"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1308"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1309"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1310"><highlight class="normal"></highlight></codeline>
<codeline lineno="1334"><highlight class="normal">CIccXform<sp/>*CIccXform::Create(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>&amp;Profile,</highlight></codeline>
<codeline lineno="1335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bInput</highlight><highlight class="comment">/*<sp/>=true<sp/>*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nIntent</highlight><highlight class="comment">/*<sp/>=icUnknownIntent<sp/>*/</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="1337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913" kindref="member">icXformInterp</ref><sp/>nInterp</highlight><highlight class="comment">/*<sp/>=icInterpLinear<sp/>*/</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="1338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc</highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7b" kindref="member">icXformLutType</ref><sp/>nLutType</highlight><highlight class="comment">/*<sp/>=icXformLutColor<sp/>*/</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="1340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseD2BxB2DxTags</highlight><highlight class="comment">/*<sp/>=true<sp/>*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="1341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccCreateXformHintManager<sp/>*pHintManager</highlight><highlight class="comment">/*<sp/>=NULL<sp/>*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="1342"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1343"><highlight class="normal"><sp/><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref>(Profile);</highlight></codeline>
<codeline lineno="1344"><highlight class="normal"><sp/><sp/>CIccXform<sp/>*pXform<sp/>=<sp/>Create(pProfile,<sp/>bInput,<sp/>nIntent,<sp/>nInterp,<sp/>pPcc,<sp/>nLutType,<sp/>bUseD2BxB2DxTags,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="1345"><highlight class="normal"></highlight></codeline>
<codeline lineno="1346"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pXform)</highlight></codeline>
<codeline lineno="1347"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pProfile;</highlight></codeline>
<codeline lineno="1348"><highlight class="normal"></highlight></codeline>
<codeline lineno="1349"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pXform;</highlight></codeline>
<codeline lineno="1350"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1351"><highlight class="normal"></highlight></codeline>
<codeline lineno="1352"><highlight class="normal"></highlight></codeline>
<codeline lineno="1364"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccXform::Begin()</highlight></codeline>
<codeline lineno="1365"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1366"><highlight class="normal"><sp/><sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pCond<sp/>=<sp/>GetConnectionConditions();</highlight></codeline>
<codeline lineno="1367"><highlight class="normal"></highlight></codeline>
<codeline lineno="1368"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>mediaXYZ[3];</highlight></codeline>
<codeline lineno="1369"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>illumXYZ[3];</highlight></codeline>
<codeline lineno="1370"><highlight class="normal"></highlight></codeline>
<codeline lineno="1371"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nIntent==<ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1372"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pCond)<sp/>{</highlight></codeline>
<codeline lineno="1373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pCond-&gt;<ref refid="db/d18/a00885_1a7268d05a042b582c68477e4aa956041a" kindref="member">getMediaWhiteXYZ</ref>(mediaXYZ);</highlight></codeline>
<codeline lineno="1374"><highlight class="normal"></highlight></codeline>
<codeline lineno="1375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_MediaXYZ.X<sp/>=<sp/><ref refid="d7/dce/a00143_1a7f49bd1c3d34a4dd4199f6bb0a674f96" kindref="member">icFtoF16</ref>(mediaXYZ[0]);</highlight></codeline>
<codeline lineno="1376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_MediaXYZ.Y<sp/>=<sp/><ref refid="d7/dce/a00143_1a7f49bd1c3d34a4dd4199f6bb0a674f96" kindref="member">icFtoF16</ref>(mediaXYZ[1]);</highlight></codeline>
<codeline lineno="1377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_MediaXYZ.Z<sp/>=<sp/><ref refid="d7/dce/a00143_1a7f49bd1c3d34a4dd4199f6bb0a674f96" kindref="member">icFtoF16</ref>(mediaXYZ[2]);</highlight></codeline>
<codeline lineno="1378"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1379"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>m_pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5aa000d29d0c1e0b2ed0fa49651a5efd26" kindref="member">icSigMediaWhitePointTag</ref>);</highlight></codeline>
<codeline lineno="1381"><highlight class="normal"></highlight></codeline>
<codeline lineno="1382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>||<sp/>pTag-&gt;<ref refid="d7/dfd/a00969_1a0d6f4b6f857134bd87bfb0cd54025208" kindref="member">GetType</ref>()!=<ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea6226593792ef658c78bcab04a6fd4850" kindref="member">icSigXYZType</ref>)</highlight></codeline>
<codeline lineno="1383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860" kindref="member">icCmmStatInvalidProfile</ref>;</highlight></codeline>
<codeline lineno="1384"><highlight class="normal"></highlight></codeline>
<codeline lineno="1385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d3/ded/a01017" kindref="compound">CIccTagXYZ</ref><sp/>*pXyzTag<sp/>=<sp/>(<ref refid="d3/ded/a01017" kindref="compound">CIccTagXYZ</ref>*)pTag;</highlight></codeline>
<codeline lineno="1386"><highlight class="normal"></highlight></codeline>
<codeline lineno="1387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_MediaXYZ<sp/>=<sp/>(*pXyzTag)[0];</highlight></codeline>
<codeline lineno="1388"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>mediaXYZ[0]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>(m_MediaXYZ.X);</highlight></codeline>
<codeline lineno="1389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>mediaXYZ[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>(m_MediaXYZ.Y);</highlight></codeline>
<codeline lineno="1390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>mediaXYZ[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>(m_MediaXYZ.Z);</highlight></codeline>
<codeline lineno="1391"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1392"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1393"><highlight class="normal"></highlight></codeline>
<codeline lineno="1394"><highlight class="normal"><sp/><sp/><ref refid="d8/dc7/a00517" kindref="compound">icXYZNumber</ref><sp/>illXYZ;</highlight></codeline>
<codeline lineno="1395"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pCond)<sp/>{</highlight></codeline>
<codeline lineno="1396"><highlight class="normal"><sp/><sp/><sp/><sp/>pCond-&gt;<ref refid="db/d18/a00885_1a9c5c38685ec6a82b97608f5571e303f2" kindref="member">getNormIlluminantXYZ</ref>(illumXYZ);</highlight></codeline>
<codeline lineno="1397"><highlight class="normal"><sp/><sp/><sp/><sp/>illXYZ.<ref refid="d8/dc7/a00517_1a8a82647ad953c198665aee9e3b659ea7" kindref="member">X</ref><sp/>=<sp/><ref refid="d7/dce/a00143_1a4a143eb09493d53cb1f7252819615498" kindref="member">icDtoF</ref>(illumXYZ[0]);</highlight></codeline>
<codeline lineno="1398"><highlight class="normal"><sp/><sp/><sp/><sp/>illXYZ.<ref refid="d8/dc7/a00517_1a3e75b8d208a5e4c55eac077643bc7689" kindref="member">Y</ref><sp/>=<sp/><ref refid="d7/dce/a00143_1a4a143eb09493d53cb1f7252819615498" kindref="member">icDtoF</ref>(illumXYZ[1]);</highlight></codeline>
<codeline lineno="1399"><highlight class="normal"><sp/><sp/><sp/><sp/>illXYZ.<ref refid="d8/dc7/a00517_1a8753b09e8d550ace7d30a0af5d0e7ab3" kindref="member">Z</ref><sp/>=<sp/><ref refid="d7/dce/a00143_1a4a143eb09493d53cb1f7252819615498" kindref="member">icDtoF</ref>(illumXYZ[2]);</highlight></codeline>
<codeline lineno="1400"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1401"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1402"><highlight class="normal"><sp/><sp/><sp/><sp/>illXYZ<sp/>=<sp/>m_pProfile-&gt;m_Header.illuminant;</highlight></codeline>
<codeline lineno="1403"><highlight class="normal"><sp/><sp/><sp/><sp/>illumXYZ[0]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>(illXYZ.<ref refid="d8/dc7/a00517_1a8a82647ad953c198665aee9e3b659ea7" kindref="member">X</ref>);</highlight></codeline>
<codeline lineno="1404"><highlight class="normal"><sp/><sp/><sp/><sp/>illumXYZ[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>(illXYZ.<ref refid="d8/dc7/a00517_1a3e75b8d208a5e4c55eac077643bc7689" kindref="member">Y</ref>);</highlight></codeline>
<codeline lineno="1405"><highlight class="normal"><sp/><sp/><sp/><sp/>illumXYZ[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>(illXYZ.<ref refid="d8/dc7/a00517_1a8753b09e8d550ace7d30a0af5d0e7ab3" kindref="member">Z</ref>);</highlight></codeline>
<codeline lineno="1406"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1407"><highlight class="normal"></highlight></codeline>
<codeline lineno="1408"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>set<sp/>up<sp/>for<sp/>any<sp/>needed<sp/>PCS<sp/>adjustment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1409"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref><sp/>&amp;&amp;<sp/></highlight></codeline>
<codeline lineno="1410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(m_MediaXYZ.X<sp/>!=<sp/>illXYZ.<ref refid="d8/dc7/a00517_1a8a82647ad953c198665aee9e3b659ea7" kindref="member">X</ref><sp/>||</highlight></codeline>
<codeline lineno="1411"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_MediaXYZ.Y<sp/>!=<sp/>illXYZ.<ref refid="d8/dc7/a00517_1a3e75b8d208a5e4c55eac077643bc7689" kindref="member">Y</ref><sp/>||</highlight></codeline>
<codeline lineno="1412"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_MediaXYZ.Z<sp/>!=<sp/>illXYZ.<ref refid="d8/dc7/a00517_1a8753b09e8d550ace7d30a0af5d0e7ab3" kindref="member">Z</ref>))<sp/>{</highlight></codeline>
<codeline lineno="1413"><highlight class="normal"></highlight></codeline>
<codeline lineno="1414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>Space<sp/>=<sp/>m_pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="1415"><highlight class="normal"></highlight></codeline>
<codeline lineno="1416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d1/dc1/a00092_1af2bf8c7d947cb795089de5f391f91d4d" kindref="member">IsSpacePCS</ref>(Space))<sp/>{</highlight></codeline>
<codeline lineno="1417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_bAdjustPCS<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>turn<sp/>ON<sp/>PCS<sp/>adjustment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1418"><highlight class="normal"></highlight></codeline>
<codeline lineno="1419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>scale<sp/>factors<sp/>depend<sp/>upon<sp/>media<sp/>white<sp/>point</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>set<sp/>up<sp/>for<sp/>input<sp/>transform</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="1422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSScale[0]<sp/>=<sp/>illumXYZ[0]<sp/>/<sp/>mediaXYZ[0];<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSScale[1]<sp/>=<sp/>illumXYZ[1]<sp/>/<sp/>mediaXYZ[1];</highlight></codeline>
<codeline lineno="1424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSScale[2]<sp/>=<sp/>illumXYZ[2]<sp/>/<sp/>mediaXYZ[2];</highlight></codeline>
<codeline lineno="1425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSScale[0]<sp/>=<sp/>mediaXYZ[0]<sp/>/<sp/>illumXYZ[0];<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSScale[1]<sp/>=<sp/>mediaXYZ[1]<sp/>/<sp/>illumXYZ[1];</highlight></codeline>
<codeline lineno="1429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSScale[2]<sp/>=<sp/>mediaXYZ[2]<sp/>/<sp/>illumXYZ[2];</highlight></codeline>
<codeline lineno="1430"><highlight class="normal"></highlight></codeline>
<codeline lineno="1431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1432"><highlight class="normal"></highlight></codeline>
<codeline lineno="1433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSOffset[0]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSOffset[1]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSOffset[2]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="1436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1437"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1438"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref><sp/>&amp;&amp;<sp/>(IsVersion2()<sp/>||<sp/>!HasPerceptualHandling()))<sp/>{</highlight></codeline>
<codeline lineno="1439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>Space<sp/>=<sp/>m_pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="1440"><highlight class="normal"></highlight></codeline>
<codeline lineno="1441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d1/dc1/a00092_1af2bf8c7d947cb795089de5f391f91d4d" kindref="member">IsSpacePCS</ref>(Space)<sp/>&amp;&amp;<sp/>m_pProfile-&gt;m_Header.deviceClass!=<ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a200e4fc8dcec29c6d411cae0c9a0483c" kindref="member">icSigAbstractClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_bAdjustPCS<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>turn<sp/>ON<sp/>PCS<sp/>adjustment</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1443"><highlight class="normal"></highlight></codeline>
<codeline lineno="1444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>set<sp/>up<sp/>for<sp/>input<sp/>transform,<sp/>which<sp/>needs<sp/>version<sp/>2<sp/>black<sp/>point<sp/>to<sp/>version<sp/>4</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSScale[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)<sp/>(1.0<sp/>-<sp/><ref refid="d6/d5b/a00026_1af707981d921fc26ac8eb85f4ff285e41" kindref="member">icPerceptualRefBlackX</ref><sp/>/<sp/><ref refid="d6/d5b/a00026_1a2099748836172e9623ed265cf9a416fe" kindref="member">icPerceptualRefWhiteX</ref>);<sp/><sp/></highlight><highlight class="comment">//<sp/>scale<sp/>factors</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSScale[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)<sp/>(1.0<sp/>-<sp/><ref refid="d6/d5b/a00026_1a91d9d2e6ccc7b48d1c505eac7d472e11" kindref="member">icPerceptualRefBlackY</ref><sp/>/<sp/><ref refid="d6/d5b/a00026_1ac9449e1acbe4f8a51e242f04afd25361" kindref="member">icPerceptualRefWhiteY</ref>);</highlight></codeline>
<codeline lineno="1447"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSScale[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)<sp/>(1.0<sp/>-<sp/><ref refid="d6/d5b/a00026_1a519837a14867b2fc70159d63527bfb48" kindref="member">icPerceptualRefBlackZ</ref><sp/>/<sp/><ref refid="d6/d5b/a00026_1a970c241f6169898a9ae88b10fe06f91b" kindref="member">icPerceptualRefWhiteZ</ref>);</highlight></codeline>
<codeline lineno="1448"><highlight class="normal"></highlight></codeline>
<codeline lineno="1449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSOffset[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)<sp/>(<ref refid="d6/d5b/a00026_1af707981d921fc26ac8eb85f4ff285e41" kindref="member">icPerceptualRefBlackX</ref><sp/>*<sp/>32768.0<sp/>/<sp/>65535.0);<sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>offset<sp/>factors</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSOffset[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)<sp/>(<ref refid="d6/d5b/a00026_1a91d9d2e6ccc7b48d1c505eac7d472e11" kindref="member">icPerceptualRefBlackY</ref><sp/>*<sp/>32768.0<sp/>/<sp/>65535.0);</highlight></codeline>
<codeline lineno="1451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSOffset[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)<sp/>(<ref refid="d6/d5b/a00026_1a519837a14867b2fc70159d63527bfb48" kindref="member">icPerceptualRefBlackZ</ref><sp/>*<sp/>32768.0<sp/>/<sp/>65535.0);</highlight></codeline>
<codeline lineno="1452"><highlight class="normal"></highlight></codeline>
<codeline lineno="1453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_bInput)<sp/>{<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>output<sp/>transform<sp/>must<sp/>convert<sp/>version<sp/>4<sp/>black<sp/>point<sp/>to<sp/>version<sp/>2</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSScale[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)<sp/>1.0<sp/>/<sp/>m_PCSScale[0];<sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>invert<sp/>scale<sp/>factors</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSScale[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)<sp/>1.0<sp/>/<sp/>m_PCSScale[1];</highlight></codeline>
<codeline lineno="1456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSScale[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)<sp/>1.0<sp/>/<sp/>m_PCSScale[2];</highlight></codeline>
<codeline lineno="1457"><highlight class="normal"></highlight></codeline>
<codeline lineno="1458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSOffset[0]<sp/>=<sp/>-<sp/>m_PCSOffset[0]<sp/>*<sp/>m_PCSScale[0];<sp/><sp/></highlight><highlight class="comment">//<sp/>negate<sp/>offset<sp/>factors</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSOffset[1]<sp/>=<sp/>-<sp/>m_PCSOffset[1]<sp/>*<sp/>m_PCSScale[1];</highlight></codeline>
<codeline lineno="1460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_PCSOffset[2]<sp/>=<sp/>-<sp/>m_PCSOffset[2]<sp/>*<sp/>m_PCSScale[2];</highlight></codeline>
<codeline lineno="1461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1463"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1464"><highlight class="normal"></highlight></codeline>
<codeline lineno="1465"><highlight class="normal"></highlight></codeline>
<codeline lineno="1466"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pAdjustPCS)<sp/>{</highlight></codeline>
<codeline lineno="1467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>ProfileCopy(*m_pProfile);</highlight></codeline>
<codeline lineno="1468"><highlight class="normal"></highlight></codeline>
<codeline lineno="1469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//<sp/>need<sp/>to<sp/>read<sp/>in<sp/>all<sp/>the<sp/>tags,<sp/>so<sp/>that<sp/>a<sp/>copy<sp/>of<sp/>the<sp/>profile<sp/>can<sp/>be<sp/>made</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!ProfileCopy.ReadTags(m_pProfile))<sp/>{</highlight></codeline>
<codeline lineno="1471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860" kindref="member">icCmmStatInvalidProfile</ref>;</highlight></codeline>
<codeline lineno="1472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pAdjustPCS-&gt;CalcFactors(&amp;ProfileCopy,<sp/></highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>m_PCSScale,<sp/>m_PCSOffset))<sp/>{</highlight></codeline>
<codeline lineno="1475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="1476"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1477"><highlight class="normal"></highlight></codeline>
<codeline lineno="1478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_bAdjustPCS<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_pAdjustPCS;</highlight></codeline>
<codeline lineno="1480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pAdjustPCS<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1481"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1482"><highlight class="normal"></highlight></codeline>
<codeline lineno="1483"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="1484"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1485"><highlight class="normal"></highlight></codeline>
<codeline lineno="1495"><highlight class="normal">CIccApplyXform<sp/>*CIccXform::GetNewApply(<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>&amp;status)</highlight></codeline>
<codeline lineno="1496"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1497"><highlight class="normal"><sp/><sp/>CIccApplyXform<sp/>*rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccApplyXform(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1498"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="1499"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!rv)<sp/>{</highlight></codeline>
<codeline lineno="1500"><highlight class="normal"><sp/><sp/><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="1501"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="1502"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1503"><highlight class="normal"></highlight></codeline>
<codeline lineno="1504"><highlight class="normal"><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="1505"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="1506"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1507"><highlight class="normal"></highlight></codeline>
<codeline lineno="1522"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccXform::AdjustPCS(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="1523"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1524"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>Space<sp/>=<sp/>m_pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="1525"><highlight class="normal"></highlight></codeline>
<codeline lineno="1526"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Space==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1527"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(UseLegacyPCS())<sp/>{</highlight></codeline>
<codeline lineno="1528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccPCSUtil::Lab2ToXyz(DstPixel,<sp/>SrcPixel,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1529"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1530"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPCSUtil::LabToXyz(DstPixel,<sp/>SrcPixel,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1532"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1533"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1534"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1535"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel[0]<sp/>=<sp/>SrcPixel[0];</highlight></codeline>
<codeline lineno="1536"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel[1]<sp/>=<sp/>SrcPixel[1];</highlight></codeline>
<codeline lineno="1537"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel[2]<sp/>=<sp/>SrcPixel[2];</highlight></codeline>
<codeline lineno="1538"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1539"><highlight class="normal"></highlight></codeline>
<codeline lineno="1540"><highlight class="normal"><sp/><sp/>DstPixel[0]<sp/>=<sp/>DstPixel[0]<sp/>*<sp/>m_PCSScale[0]<sp/>+<sp/>m_PCSOffset[0];</highlight></codeline>
<codeline lineno="1541"><highlight class="normal"><sp/><sp/>DstPixel[1]<sp/>=<sp/>DstPixel[1]<sp/>*<sp/>m_PCSScale[1]<sp/>+<sp/>m_PCSOffset[1];</highlight></codeline>
<codeline lineno="1542"><highlight class="normal"><sp/><sp/>DstPixel[2]<sp/>=<sp/>DstPixel[2]<sp/>*<sp/>m_PCSScale[2]<sp/>+<sp/>m_PCSOffset[2];</highlight></codeline>
<codeline lineno="1543"><highlight class="normal"></highlight></codeline>
<codeline lineno="1544"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(Space==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1545"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(UseLegacyPCS())<sp/>{</highlight></codeline>
<codeline lineno="1546"><highlight class="normal"></highlight></codeline>
<codeline lineno="1547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccPCSUtil::XyzToLab2(DstPixel,<sp/>DstPixel,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1548"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1549"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPCSUtil::XyzToLab(DstPixel,<sp/>DstPixel,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="1551"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1552"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1553"><highlight class="normal"></highlight><highlight class="preprocessor">#ifndef<sp/>SAMPLEICC_NOCLIPLABTOXYZ</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1554"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1555"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel[0]<sp/>=<sp/>CIccPCSUtil::NegClip(DstPixel[0]);</highlight></codeline>
<codeline lineno="1556"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel[1]<sp/>=<sp/>CIccPCSUtil::NegClip(DstPixel[1]);</highlight></codeline>
<codeline lineno="1557"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel[2]<sp/>=<sp/>CIccPCSUtil::NegClip(DstPixel[2]);</highlight></codeline>
<codeline lineno="1558"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1559"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1560"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1561"><highlight class="normal"></highlight></codeline>
<codeline lineno="1578"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*CIccXform::CheckSrcAbs(CIccApplyXform<sp/>*pApply,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Pixel)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="1579"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1580"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bAdjustPCS<sp/>&amp;&amp;<sp/>!m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="1581"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pAbsLab<sp/>=<sp/>pApply-&gt;m_AbsLab;</highlight></codeline>
<codeline lineno="1582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AdjustPCS(pAbsLab,<sp/>Pixel);</highlight></codeline>
<codeline lineno="1583"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pAbsLab;</highlight></codeline>
<codeline lineno="1584"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1585"><highlight class="normal"></highlight></codeline>
<codeline lineno="1586"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Pixel;</highlight></codeline>
<codeline lineno="1587"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1588"><highlight class="normal"></highlight></codeline>
<codeline lineno="1603"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccXform::CheckDstAbs(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Pixel)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="1604"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1605"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bAdjustPCS<sp/>&amp;&amp;<sp/>m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="1606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>AdjustPCS(Pixel,<sp/>Pixel);</highlight></codeline>
<codeline lineno="1607"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1608"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="1621"><highlight class="normal"><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>CIccXform::GetSrcSpace()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="1622"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1623"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>rv;</highlight></codeline>
<codeline lineno="1624"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0" kindref="member">icProfileClassSignature</ref><sp/>deviceClass<sp/>=<sp/>m_pProfile-&gt;m_Header.deviceClass;</highlight></codeline>
<codeline lineno="1625"><highlight class="normal"></highlight></codeline>
<codeline lineno="1626"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="1627"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bPcsAdjustXform)</highlight></codeline>
<codeline lineno="1628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>m_pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="1629"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>m_pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="1631"><highlight class="normal"></highlight></codeline>
<codeline lineno="1632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(deviceClass<sp/>!=<sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a200e4fc8dcec29c6d411cae0c9a0483c" kindref="member">icSigAbstractClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//convert<sp/>signature<sp/>to<sp/>device<sp/>colorspace<sp/>signature<sp/>(avoid<sp/>confusion<sp/>about<sp/>encoding).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="d4/d81/a00110_1a550e980dd884839e33548afbd55b4277" kindref="member">icSigDevXYZData</ref>;</highlight></codeline>
<codeline lineno="1636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="d4/d81/a00110_1a92d563abc2c24efa8ccad672a9dfd14f" kindref="member">icSigDevLabData</ref>;</highlight></codeline>
<codeline lineno="1639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1641"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1642"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1643"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_bUseSpectralPCS<sp/>||<sp/>!m_pProfile-&gt;m_Header.spectralPCS)<sp/>{</highlight></codeline>
<codeline lineno="1644"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>m_pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="1645"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1646"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1647"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="d7/d46/a00002_1a47e4f847bd0bc609907b5fea4daf3e75" kindref="member">icGetColorSpaceType</ref>(m_pProfile-&gt;m_Header.spectralPCS);</highlight></codeline>
<codeline lineno="1648"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1649"><highlight class="normal"></highlight></codeline>
<codeline lineno="1650"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="1651"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1652"><highlight class="normal"></highlight></codeline>
<codeline lineno="1664"><highlight class="normal"><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>CIccXform::GetNumSrcSamples()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="1665"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1666"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>rv;</highlight></codeline>
<codeline lineno="1667"><highlight class="normal"></highlight></codeline>
<codeline lineno="1668"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nMCS==<ref refid="d6/d5b/a00026_1aaaa5f9a3442f4cebec6f0d815e022393a9900382442b6928de2af4b116f08dd5e" kindref="member">icFromMCS</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1669"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)<ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>((<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)m_pProfile-&gt;m_Header.mcs);</highlight></codeline>
<codeline lineno="1670"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1671"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="1672"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)<ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(m_pProfile-&gt;m_Header.colorSpace);</highlight></codeline>
<codeline lineno="1673"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1674"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_bUseSpectralPCS<sp/>||<sp/>!m_pProfile-&gt;m_Header.spectralPCS)<sp/>{</highlight></codeline>
<codeline lineno="1675"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)<ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(m_pProfile-&gt;m_Header.pcs);</highlight></codeline>
<codeline lineno="1676"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1677"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1678"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)<ref refid="d7/dce/a00143_1a0ae39400770bbc7c8be88c485167ad26" kindref="member">icGetSpectralSpaceSamples</ref>(&amp;m_pProfile-&gt;m_Header);</highlight></codeline>
<codeline lineno="1679"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1680"><highlight class="normal"></highlight></codeline>
<codeline lineno="1681"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="1682"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1683"><highlight class="normal"></highlight></codeline>
<codeline lineno="1695"><highlight class="normal"><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>CIccXform::GetDstSpace()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="1696"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1697"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>rv;</highlight></codeline>
<codeline lineno="1698"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0" kindref="member">icProfileClassSignature</ref><sp/>deviceClass<sp/>=<sp/>m_pProfile-&gt;m_Header.deviceClass;</highlight></codeline>
<codeline lineno="1699"><highlight class="normal"></highlight></codeline>
<codeline lineno="1700"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nMCS==<ref refid="d6/d5b/a00026_1aaaa5f9a3442f4cebec6f0d815e022393a792a9f663756385f0a63c62606fbd5b5" kindref="member">icToMCS</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1701"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)m_pProfile-&gt;m_Header.mcs;</highlight></codeline>
<codeline lineno="1702"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1703"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="1704"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bUseSpectralPCS<sp/>&amp;&amp;<sp/>m_pProfile-&gt;m_Header.spectralPCS)</highlight></codeline>
<codeline lineno="1705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="d7/d46/a00002_1a47e4f847bd0bc609907b5fea4daf3e75" kindref="member">icGetColorSpaceType</ref>(m_pProfile-&gt;m_Header.spectralPCS);</highlight></codeline>
<codeline lineno="1706"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>m_pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="1708"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1709"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1710"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>m_pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="1711"><highlight class="normal"></highlight></codeline>
<codeline lineno="1712"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//convert<sp/>signature<sp/>to<sp/>device<sp/>colorspace<sp/>signature<sp/>(avoid<sp/>confusion<sp/>about<sp/>encoding).</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="1713"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(deviceClass<sp/>!=<sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a200e4fc8dcec29c6d411cae0c9a0483c" kindref="member">icSigAbstractClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="d4/d81/a00110_1a550e980dd884839e33548afbd55b4277" kindref="member">icSigDevXYZData</ref>;</highlight></codeline>
<codeline lineno="1716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="d4/d81/a00110_1a92d563abc2c24efa8ccad672a9dfd14f" kindref="member">icSigDevLabData</ref>;</highlight></codeline>
<codeline lineno="1719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1720"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1721"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1722"><highlight class="normal"></highlight></codeline>
<codeline lineno="1723"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="1724"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1725"><highlight class="normal"></highlight></codeline>
<codeline lineno="1737"><highlight class="normal"><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>CIccXform::GetNumDstSamples()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="1738"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="1739"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>rv;</highlight></codeline>
<codeline lineno="1740"><highlight class="normal"></highlight></codeline>
<codeline lineno="1741"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nMCS==<ref refid="d6/d5b/a00026_1aaaa5f9a3442f4cebec6f0d815e022393a792a9f663756385f0a63c62606fbd5b5" kindref="member">icToMCS</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1742"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)<ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>((<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)m_pProfile-&gt;m_Header.mcs);</highlight></codeline>
<codeline lineno="1743"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1744"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="1745"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)<ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(m_pProfile-&gt;m_Header.colorSpace);</highlight></codeline>
<codeline lineno="1746"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1747"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_bUseSpectralPCS<sp/>||<sp/>!m_pProfile-&gt;m_Header.spectralPCS)<sp/>{</highlight></codeline>
<codeline lineno="1748"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)<ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(m_pProfile-&gt;m_Header.pcs);</highlight></codeline>
<codeline lineno="1749"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1750"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="1751"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)<ref refid="d7/dce/a00143_1a0ae39400770bbc7c8be88c485167ad26" kindref="member">icGetSpectralSpaceSamples</ref>(&amp;m_pProfile-&gt;m_Header);</highlight></codeline>
<codeline lineno="1752"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1753"><highlight class="normal"></highlight></codeline>
<codeline lineno="1754"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="1755"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1756"><highlight class="normal"></highlight></codeline>
<codeline lineno="1757"><highlight class="normal"></highlight></codeline>
<codeline lineno="1766"><highlight class="normal">CIccApplyXform::CIccApplyXform(CIccXform<sp/>*pXform)<sp/>:<sp/>m_AbsLab{}</highlight></codeline>
<codeline lineno="1767"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1768"><highlight class="normal"><sp/><sp/>m_pXform<sp/>=<sp/>pXform;</highlight></codeline>
<codeline lineno="1769"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1770"><highlight class="normal"></highlight></codeline>
<codeline lineno="1779"><highlight class="normal">CIccApplyXform::~CIccApplyXform()</highlight></codeline>
<codeline lineno="1780"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1781"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1782"><highlight class="normal"></highlight></codeline>
<codeline lineno="1783"><highlight class="normal"></highlight></codeline>
<codeline lineno="1792"><highlight class="normal">CIccApplyNDLutXform::CIccApplyNDLutXform(CIccXformNDLut*<sp/>pXform,<sp/><ref refid="d9/d65/a01145" kindref="compound">CIccApplyCLUT</ref><sp/>*pApply)<sp/>:<sp/>CIccApplyXform(pXform)</highlight></codeline>
<codeline lineno="1793"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1794"><highlight class="normal"><sp/><sp/>m_pApply<sp/>=<sp/>pApply;</highlight></codeline>
<codeline lineno="1795"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1796"><highlight class="normal"></highlight></codeline>
<codeline lineno="1797"><highlight class="normal"></highlight></codeline>
<codeline lineno="1806"><highlight class="normal">CIccApplyNDLutXform::~CIccApplyNDLutXform()</highlight></codeline>
<codeline lineno="1807"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1808"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pApply)</highlight></codeline>
<codeline lineno="1809"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_pApply;</highlight></codeline>
<codeline lineno="1810"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1811"><highlight class="normal"></highlight></codeline>
<codeline lineno="1812"><highlight class="normal"></highlight></codeline>
<codeline lineno="1821"><highlight class="normal">CIccApplyPcsXform::CIccApplyPcsXform(CIccXform<sp/>*pXform)<sp/>:<sp/>CIccApplyXform(pXform)</highlight></codeline>
<codeline lineno="1822"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1823"><highlight class="normal"><sp/><sp/>m_list<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccApplyPcsStepList();</highlight></codeline>
<codeline lineno="1824"><highlight class="normal"><sp/><sp/>m_temp1<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1825"><highlight class="normal"><sp/><sp/>m_temp2<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1826"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1827"><highlight class="normal"></highlight></codeline>
<codeline lineno="1836"><highlight class="normal">CIccApplyPcsXform::~CIccApplyPcsXform()</highlight></codeline>
<codeline lineno="1837"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1838"><highlight class="normal"></highlight></codeline>
<codeline lineno="1839"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_list)<sp/>{</highlight></codeline>
<codeline lineno="1840"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccApplyPcsStepList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="1841"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=m_list-&gt;begin();<sp/>i!=m_list-&gt;end();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1842"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i-&gt;ptr)</highlight></codeline>
<codeline lineno="1843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="1844"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1845"><highlight class="normal"></highlight></codeline>
<codeline lineno="1846"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_list;</highlight></codeline>
<codeline lineno="1847"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1848"><highlight class="normal"></highlight></codeline>
<codeline lineno="1849"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_temp1)</highlight></codeline>
<codeline lineno="1850"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>[]<sp/>m_temp1;</highlight></codeline>
<codeline lineno="1851"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_temp2)</highlight></codeline>
<codeline lineno="1852"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>[]<sp/>m_temp2;</highlight></codeline>
<codeline lineno="1853"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1854"><highlight class="normal"></highlight></codeline>
<codeline lineno="1863"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccApplyPcsXform::Init()</highlight></codeline>
<codeline lineno="1864"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1865"><highlight class="normal"><sp/><sp/>CIccPcsXform<sp/>*pXform<sp/>=<sp/>(CIccPcsXform*)m_pXform;</highlight></codeline>
<codeline lineno="1866"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nChan<sp/>=<sp/>pXform-&gt;MaxChannels();</highlight></codeline>
<codeline lineno="1867"><highlight class="normal"></highlight></codeline>
<codeline lineno="1868"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nChan)<sp/>{</highlight></codeline>
<codeline lineno="1869"><highlight class="normal"><sp/><sp/><sp/><sp/>m_temp1<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>[nChan];</highlight></codeline>
<codeline lineno="1870"><highlight class="normal"><sp/><sp/><sp/><sp/>m_temp2<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>[nChan];</highlight></codeline>
<codeline lineno="1871"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1872"><highlight class="normal"></highlight></codeline>
<codeline lineno="1873"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_temp1!=NULL<sp/>&amp;&amp;<sp/>m_temp2!=NULL;</highlight></codeline>
<codeline lineno="1874"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1875"><highlight class="normal"></highlight></codeline>
<codeline lineno="1876"><highlight class="normal"></highlight></codeline>
<codeline lineno="1877"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccApplyPcsXform::AppendApplyStep(CIccApplyPcsStep<sp/>*pStep)</highlight></codeline>
<codeline lineno="1878"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1879"><highlight class="normal"><sp/><sp/>CIccApplyPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="1880"><highlight class="normal"></highlight></codeline>
<codeline lineno="1881"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pStep<sp/>&amp;&amp;<sp/>m_list)<sp/>{</highlight></codeline>
<codeline lineno="1882"><highlight class="normal"><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>pStep;</highlight></codeline>
<codeline lineno="1883"><highlight class="normal"><sp/><sp/><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="1884"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1885"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1886"><highlight class="normal"></highlight></codeline>
<codeline lineno="1887"><highlight class="normal"></highlight></codeline>
<codeline lineno="1896"><highlight class="normal">CIccPcsXform::CIccPcsXform()</highlight></codeline>
<codeline lineno="1897"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1898"><highlight class="normal"><sp/><sp/>m_list<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepList();</highlight></codeline>
<codeline lineno="1899"><highlight class="normal"></highlight></codeline>
<codeline lineno="1900"><highlight class="normal"><sp/><sp/>m_srcSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref>;</highlight></codeline>
<codeline lineno="1901"><highlight class="normal"><sp/><sp/>m_nSrcSamples<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1902"><highlight class="normal"></highlight></codeline>
<codeline lineno="1903"><highlight class="normal"><sp/><sp/>m_dstSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref>;</highlight></codeline>
<codeline lineno="1904"><highlight class="normal"><sp/><sp/>m_nDstSamples<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="1905"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1906"><highlight class="normal"></highlight></codeline>
<codeline lineno="1915"><highlight class="normal">CIccPcsXform::~CIccPcsXform()</highlight></codeline>
<codeline lineno="1916"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1917"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_list)<sp/>{</highlight></codeline>
<codeline lineno="1918"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccPcsStepList::iterator<sp/>step;</highlight></codeline>
<codeline lineno="1919"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(step=m_list-&gt;begin();<sp/>step!=m_list-&gt;end();<sp/>step++)<sp/>{</highlight></codeline>
<codeline lineno="1920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(step-&gt;ptr)<sp/>{</highlight></codeline>
<codeline lineno="1921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>step-&gt;ptr;</highlight></codeline>
<codeline lineno="1922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>step-&gt;ptr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="1923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1924"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1925"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_list;</highlight></codeline>
<codeline lineno="1926"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="1927"><highlight class="normal">}</highlight></codeline>
<codeline lineno="1928"><highlight class="normal"></highlight></codeline>
<codeline lineno="1938"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccPcsXform::Connect(CIccXform<sp/>*pFromXform,<sp/>CIccXform<sp/>*pToXform)</highlight></codeline>
<codeline lineno="1939"><highlight class="normal">{</highlight></codeline>
<codeline lineno="1940"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>stat;</highlight></codeline>
<codeline lineno="1941"><highlight class="normal"></highlight></codeline>
<codeline lineno="1942"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pFromXform<sp/>||<sp/>!pToXform)</highlight></codeline>
<codeline lineno="1943"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="1944"><highlight class="normal"></highlight></codeline>
<codeline lineno="1945"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromXform-&gt;IsMCS()<sp/>&amp;&amp;<sp/>pToXform-&gt;IsMCS())<sp/>{</highlight></codeline>
<codeline lineno="1946"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pFromProfile<sp/>=<sp/>pFromXform-&gt;GetProfilePtr();</highlight></codeline>
<codeline lineno="1947"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pToProfile<sp/>=<sp/>pToXform-&gt;GetProfilePtr();</highlight></codeline>
<codeline lineno="1948"><highlight class="normal"></highlight></codeline>
<codeline lineno="1949"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pFromProfile<sp/>||<sp/>!pToProfile)<sp/>{</highlight></codeline>
<codeline lineno="1950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="1951"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1952"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/de0/a00465" kindref="compound">CIccTagArray</ref><sp/>*pFromChannels<sp/>=<sp/>(<ref refid="db/de0/a00465" kindref="compound">CIccTagArray</ref>*)(pFromProfile-&gt;FindTagOfType(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ae92349e1ad0bb9aab7d390df0a8c82cc" kindref="member">icSigMaterialTypeArrayTag</ref>,<sp/><ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea2a4636dabf07722022104d8d112e2417" kindref="member">icSigTagArrayType</ref>));</highlight></codeline>
<codeline lineno="1953"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="db/de0/a00465" kindref="compound">CIccTagArray</ref><sp/>*pToChannels<sp/>=<sp/>(<ref refid="db/de0/a00465" kindref="compound">CIccTagArray</ref>*)(pToProfile-&gt;FindTagOfType(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ae92349e1ad0bb9aab7d390df0a8c82cc" kindref="member">icSigMaterialTypeArrayTag</ref>,<sp/><ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea2a4636dabf07722022104d8d112e2417" kindref="member">icSigTagArrayType</ref>));</highlight></codeline>
<codeline lineno="1954"><highlight class="normal"></highlight></codeline>
<codeline lineno="1955"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pFromChannels<sp/>||<sp/>!pToChannels)<sp/>{</highlight></codeline>
<codeline lineno="1956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="1957"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1958"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromChannels-&gt;<ref refid="db/de0/a00465_1ae4d0c4f6859dc47d44b5b0c9c6ab4e44" kindref="member">GetTagArrayType</ref>()!=<ref refid="d7/d46/a00002_1a97bb6c6d4e1859ba7290162215ac8beba89d9aedd1fa4b16ba01ee9ea41dec24f" kindref="member">icSigUtf8TextTypeArray</ref><sp/>||</highlight></codeline>
<codeline lineno="1959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToChannels-&gt;<ref refid="db/de0/a00465_1ae4d0c4f6859dc47d44b5b0c9c6ab4e44" kindref="member">GetTagArrayType</ref>()!=<ref refid="d7/d46/a00002_1a97bb6c6d4e1859ba7290162215ac8beba89d9aedd1fa4b16ba01ee9ea41dec24f" kindref="member">icSigUtf8TextTypeArray</ref><sp/>||</highlight></codeline>
<codeline lineno="1960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!pFromChannels-&gt;<ref refid="db/de0/a00465_1a0eec94cc1fea6ce5febd2d2a2c33921f" kindref="member">AreAllOfType</ref>(<ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea21dfb852fbf1b3dfa35ca6804d3d0499" kindref="member">icSigUtf8TextType</ref>)<sp/>||</highlight></codeline>
<codeline lineno="1961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!pToChannels-&gt;<ref refid="db/de0/a00465_1a0eec94cc1fea6ce5febd2d2a2c33921f" kindref="member">AreAllOfType</ref>(<ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea21dfb852fbf1b3dfa35ca6804d3d0499" kindref="member">icSigUtf8TextType</ref>))<sp/>{</highlight></codeline>
<codeline lineno="1962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="1963"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1964"><highlight class="normal"></highlight></codeline>
<codeline lineno="1965"><highlight class="normal"><sp/><sp/><sp/><sp/>m_nSrcSamples<sp/>=<sp/>pFromXform-&gt;GetNumDstSamples();</highlight></codeline>
<codeline lineno="1966"><highlight class="normal"><sp/><sp/><sp/><sp/>m_nDstSamples<sp/>=<sp/>pToXform-&gt;GetNumSrcSamples();</highlight></codeline>
<codeline lineno="1967"><highlight class="normal"></highlight></codeline>
<codeline lineno="1968"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromChannels-&gt;<ref refid="db/de0/a00465_1ad89262b326c7dde5b444599ed6d862e7" kindref="member">GetSize</ref>()<sp/>!=<sp/>m_nSrcSamples<sp/>||<sp/>pToChannels-&gt;<ref refid="db/de0/a00465_1ad89262b326c7dde5b444599ed6d862e7" kindref="member">GetSize</ref>()<sp/>!=<sp/>m_nDstSamples)<sp/>{</highlight></codeline>
<codeline lineno="1969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="1970"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1971"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>j;</highlight></codeline>
<codeline lineno="1972"><highlight class="normal"></highlight></codeline>
<codeline lineno="1973"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromProfile-&gt;m_Header.flags&amp;<ref refid="d7/d46/a00002_1ada4a40a4c4b6cd075f42e5364e90dcf7" kindref="member">icMCSNeedsSubsetTrue</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nSrcSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a11ef650eb30d34d4f469f2c5db79aa50" kindref="member">icUChar</ref><sp/>*szSrcChan<sp/>=<sp/>((<ref refid="dd/d24/a00981" kindref="compound">CIccTagUtf8Text</ref>*)pFromChannels-&gt;<ref refid="db/de0/a00465_1ac30ff943da70f26a654f2e9d39c0e568" kindref="member">GetIndex</ref>(i))-&gt;GetText();</highlight></codeline>
<codeline lineno="1976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j=0;<sp/>j&lt;m_nDstSamples;<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="1977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a11ef650eb30d34d4f469f2c5db79aa50" kindref="member">icUChar</ref><sp/>*szDstChan<sp/>=<sp/>((<ref refid="dd/d24/a00981" kindref="compound">CIccTagUtf8Text</ref>*)pToChannels-&gt;<ref refid="db/de0/a00465_1ac30ff943da70f26a654f2e9d39c0e568" kindref="member">GetIndex</ref>(i))-&gt;GetText();</highlight></codeline>
<codeline lineno="1978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d7/dce/a00143_1ae716aa59d818f8dda39c5a4245061336" kindref="member">icUtf8StrCmp</ref>(szSrcChan,<sp/>szDstChan))</highlight></codeline>
<codeline lineno="1979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j==m_nDstSamples)</highlight></codeline>
<codeline lineno="1982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a6bd126a39f8787a82bf08db1af1fcb9b" kindref="member">icCmmStatBadMCSLink</ref>;</highlight></codeline>
<codeline lineno="1983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1984"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1985"><highlight class="normal"></highlight></codeline>
<codeline lineno="1986"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToProfile-&gt;m_Header.flags&amp;<ref refid="d7/d46/a00002_1ada4a40a4c4b6cd075f42e5364e90dcf7" kindref="member">icMCSNeedsSubsetTrue</ref>)<sp/>{</highlight></codeline>
<codeline lineno="1987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nDstSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="1988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a11ef650eb30d34d4f469f2c5db79aa50" kindref="member">icUChar</ref><sp/>*szDstChan<sp/>=<sp/>((<ref refid="dd/d24/a00981" kindref="compound">CIccTagUtf8Text</ref>*)pToChannels-&gt;<ref refid="db/de0/a00465_1ac30ff943da70f26a654f2e9d39c0e568" kindref="member">GetIndex</ref>(i))-&gt;GetText();</highlight></codeline>
<codeline lineno="1989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j=0;<sp/>j&lt;m_nSrcSamples;<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="1990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a11ef650eb30d34d4f469f2c5db79aa50" kindref="member">icUChar</ref><sp/>*szSrcChan<sp/>=<sp/>((<ref refid="dd/d24/a00981" kindref="compound">CIccTagUtf8Text</ref>*)pFromChannels-&gt;<ref refid="db/de0/a00465_1ac30ff943da70f26a654f2e9d39c0e568" kindref="member">GetIndex</ref>(i))-&gt;GetText();</highlight></codeline>
<codeline lineno="1991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d7/dce/a00143_1ae716aa59d818f8dda39c5a4245061336" kindref="member">icUtf8StrCmp</ref>(szSrcChan,<sp/>szDstChan))</highlight></codeline>
<codeline lineno="1992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="1993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j==m_nSrcSamples)</highlight></codeline>
<codeline lineno="1995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a6bd126a39f8787a82bf08db1af1fcb9b" kindref="member">icCmmStatBadMCSLink</ref>;</highlight></codeline>
<codeline lineno="1996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1997"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="1998"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>pToProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a32d9a526626e93fa27620c528e48daf4" kindref="member">icSigMaterialDefaultValuesTag</ref>);</highlight></codeline>
<codeline lineno="1999"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d0/daa/a01029" kindref="compound">CIccTagNumArray</ref><sp/>*pDefaults<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="2000"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>pTag-&gt;<ref refid="d7/dfd/a00969_1aa2a3dd91bfad9cf1297300d70936121a" kindref="member">IsNumArrayType</ref>())<sp/>{</highlight></codeline>
<codeline lineno="2001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pDefaults<sp/>=<sp/>(<ref refid="d0/daa/a01029" kindref="compound">CIccTagNumArray</ref><sp/>*)pTag;</highlight></codeline>
<codeline lineno="2002"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2003"><highlight class="normal"></highlight></codeline>
<codeline lineno="2004"><highlight class="normal"><sp/><sp/><sp/><sp/>pushRouteMcs(pFromChannels,<sp/>pToChannels,<sp/>pDefaults);</highlight></codeline>
<codeline lineno="2005"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2006"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2007"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pFromXform-&gt;IsInput()<sp/>||<sp/>(pToXform-&gt;IsInput()<sp/>&amp;&amp;<sp/>!pToXform-&gt;IsAbstract()))<sp/>{</highlight></codeline>
<codeline lineno="2008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="2009"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2010"><highlight class="normal"></highlight></codeline>
<codeline lineno="2011"><highlight class="normal"><sp/><sp/><sp/><sp/>m_srcSpace<sp/>=<sp/>pFromXform-&gt;GetDstSpace();</highlight></codeline>
<codeline lineno="2012"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d3/df8/a00155_1a05df9b9a2f56c907e676a0efc3e9219d" kindref="member">IsSpaceSpectralPCS</ref>(m_srcSpace))</highlight></codeline>
<codeline lineno="2013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_srcSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1a47e4f847bd0bc609907b5fea4daf3e75" kindref="member">icGetColorSpaceType</ref>(m_srcSpace);</highlight></codeline>
<codeline lineno="2014"><highlight class="normal"></highlight></codeline>
<codeline lineno="2015"><highlight class="normal"><sp/><sp/><sp/><sp/>m_nSrcSamples<sp/>=<sp/>pFromXform-&gt;GetNumDstSamples();</highlight></codeline>
<codeline lineno="2016"><highlight class="normal"></highlight></codeline>
<codeline lineno="2017"><highlight class="normal"><sp/><sp/><sp/><sp/>m_dstSpace<sp/>=<sp/>pToXform-&gt;GetSrcSpace();</highlight></codeline>
<codeline lineno="2018"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d3/df8/a00155_1a05df9b9a2f56c907e676a0efc3e9219d" kindref="member">IsSpaceSpectralPCS</ref>(m_dstSpace))</highlight></codeline>
<codeline lineno="2019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_dstSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1a47e4f847bd0bc609907b5fea4daf3e75" kindref="member">icGetColorSpaceType</ref>(m_dstSpace);</highlight></codeline>
<codeline lineno="2020"><highlight class="normal"></highlight></codeline>
<codeline lineno="2021"><highlight class="normal"><sp/><sp/><sp/><sp/>m_nDstSamples<sp/>=<sp/>pToXform-&gt;GetNumSrcSamples();</highlight></codeline>
<codeline lineno="2022"><highlight class="normal"></highlight></codeline>
<codeline lineno="2023"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(m_srcSpace)<sp/>{</highlight></codeline>
<codeline lineno="2024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a043048bd0c63d3bd54d35e8b5743d226" kindref="member">icSigLabPcsData</ref>:</highlight></codeline>
<codeline lineno="2025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(m_dstSpace)<sp/>{</highlight></codeline>
<codeline lineno="2026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a043048bd0c63d3bd54d35e8b5743d226" kindref="member">icSigLabPcsData</ref>:</highlight></codeline>
<codeline lineno="2027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromXform-&gt;UseLegacyPCS())</highlight></codeline>
<codeline lineno="2028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushLab2ToXyz(pFromXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushLabToXyz(pFromXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromXform-&gt;NeedAdjustDstPCS())<sp/>{</highlight></codeline>
<codeline lineno="2032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pFromXform-&gt;m_PCSScale[0],<sp/>pFromXform-&gt;m_PCSScale[1],<sp/>pFromXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pFromXform-&gt;m_PCSOffset[0],<sp/>pFromXform-&gt;m_PCSOffset[1],<sp/>pFromXform-&gt;m_PCSOffset[2]);</highlight></codeline>
<codeline lineno="2034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((stat=pushXYZConvert(pFromXform,<sp/>pToXform))!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="2037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;NeedAdjustSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="2039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</highlight></codeline>
<codeline lineno="2040"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</highlight></codeline>
<codeline lineno="2041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pToXform-&gt;m_PCSScale[0],<sp/>pToXform-&gt;m_PCSScale[1],<sp/>pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;UseLegacyPCS())</highlight></codeline>
<codeline lineno="2045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToLab2(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToLab(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2049"><highlight class="normal"></highlight></codeline>
<codeline lineno="2050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a3cc88012894a42474b7609adbe314918" kindref="member">icSigXYZPcsData</ref>:</highlight></codeline>
<codeline lineno="2051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromXform-&gt;UseLegacyPCS())</highlight></codeline>
<codeline lineno="2052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushLab2ToXyz(pFromXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushLabToXyz(pFromXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2055"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromXform-&gt;NeedAdjustDstPCS())<sp/>{</highlight></codeline>
<codeline lineno="2056"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pFromXform-&gt;m_PCSScale[0],<sp/>pFromXform-&gt;m_PCSScale[1],<sp/>pFromXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pFromXform-&gt;m_PCSOffset[0],<sp/>pFromXform-&gt;m_PCSOffset[1],<sp/>pFromXform-&gt;m_PCSOffset[2]);</highlight></codeline>
<codeline lineno="2058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((stat=pushXYZConvert(pFromXform,<sp/>pToXform))!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="2061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2062"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;NeedAdjustSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="2063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</highlight></codeline>
<codeline lineno="2064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</highlight></codeline>
<codeline lineno="2065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pToXform-&gt;m_PCSScale[0],<sp/>pToXform-&gt;m_PCSScale[1],<sp/>pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToXyzIn();</highlight></codeline>
<codeline lineno="2069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2070"><highlight class="normal"></highlight></codeline>
<codeline lineno="2071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1aa9cd4477816537fbf648a155f6b78eda" kindref="member">icSigReflectanceSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1af5df74ebff3f8247e1c7c88844c1f140" kindref="member">icSigTransmissionSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a163dee4d9a8a1568dded8480a166e852" kindref="member">icSigRadiantSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1ae84d222edd132ad7741c628c1d4729d9" kindref="member">icSigBiDirReflectanceSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1b59192d9fcc1aee71b8cc523b4978ca" kindref="member">icSigSparseMatrixSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281" kindref="member">icCmmStatUnsupportedPcsLink</ref>;</highlight></codeline>
<codeline lineno="2077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2079"><highlight class="normal"></highlight></codeline>
<codeline lineno="2080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a3cc88012894a42474b7609adbe314918" kindref="member">icSigXYZPcsData</ref>:</highlight></codeline>
<codeline lineno="2081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(m_dstSpace)<sp/>{</highlight></codeline>
<codeline lineno="2082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a043048bd0c63d3bd54d35e8b5743d226" kindref="member">icSigLabPcsData</ref>:</highlight></codeline>
<codeline lineno="2083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzInToXyz();</highlight></codeline>
<codeline lineno="2084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromXform-&gt;NeedAdjustDstPCS())<sp/>{</highlight></codeline>
<codeline lineno="2085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pFromXform-&gt;m_PCSScale[0],<sp/>pFromXform-&gt;m_PCSScale[1],<sp/>pFromXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pFromXform-&gt;m_PCSOffset[0],<sp/>pFromXform-&gt;m_PCSOffset[1],<sp/>pFromXform-&gt;m_PCSOffset[2]);</highlight></codeline>
<codeline lineno="2087"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((stat=pushXYZConvert(pFromXform,<sp/>pToXform))!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="2090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;NeedAdjustSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="2092"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</highlight></codeline>
<codeline lineno="2093"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</highlight></codeline>
<codeline lineno="2094"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pToXform-&gt;m_PCSScale[0],<sp/>pToXform-&gt;m_PCSScale[1],<sp/>pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;UseLegacyPCS())</highlight></codeline>
<codeline lineno="2098"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToLab2(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2100"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToLab(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2101"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2102"><highlight class="normal"></highlight></codeline>
<codeline lineno="2103"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a3cc88012894a42474b7609adbe314918" kindref="member">icSigXYZPcsData</ref>:</highlight></codeline>
<codeline lineno="2104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzInToXyz();</highlight></codeline>
<codeline lineno="2105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromXform-&gt;NeedAdjustDstPCS())<sp/>{</highlight></codeline>
<codeline lineno="2106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pFromXform-&gt;m_PCSScale[0],<sp/>pFromXform-&gt;m_PCSScale[1],<sp/>pFromXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pFromXform-&gt;m_PCSOffset[0],<sp/>pFromXform-&gt;m_PCSOffset[1],<sp/>pFromXform-&gt;m_PCSOffset[2]);</highlight></codeline>
<codeline lineno="2108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((stat=pushXYZConvert(pFromXform,<sp/>pToXform))!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="2111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;NeedAdjustSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="2113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</highlight></codeline>
<codeline lineno="2114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</highlight></codeline>
<codeline lineno="2115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pToXform-&gt;m_PCSScale[0],<sp/>pToXform-&gt;m_PCSScale[1],<sp/>pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToXyzIn();</highlight></codeline>
<codeline lineno="2119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2120"><highlight class="normal"></highlight></codeline>
<codeline lineno="2121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1aa9cd4477816537fbf648a155f6b78eda" kindref="member">icSigReflectanceSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1af5df74ebff3f8247e1c7c88844c1f140" kindref="member">icSigTransmissionSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a163dee4d9a8a1568dded8480a166e852" kindref="member">icSigRadiantSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2124"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1ae84d222edd132ad7741c628c1d4729d9" kindref="member">icSigBiDirReflectanceSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1b59192d9fcc1aee71b8cc523b4978ca" kindref="member">icSigSparseMatrixSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281" kindref="member">icCmmStatUnsupportedPcsLink</ref>;</highlight></codeline>
<codeline lineno="2127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2129"><highlight class="normal"></highlight></codeline>
<codeline lineno="2130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1aa9cd4477816537fbf648a155f6b78eda" kindref="member">icSigReflectanceSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1af5df74ebff3f8247e1c7c88844c1f140" kindref="member">icSigTransmissionSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(m_dstSpace)<sp/>{</highlight></codeline>
<codeline lineno="2133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a043048bd0c63d3bd54d35e8b5743d226" kindref="member">icSigLabPcsData</ref>:</highlight></codeline>
<codeline lineno="2134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushRef2Xyz(pFromXform-&gt;m_pProfile,<sp/>pFromXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((stat=pushXYZConvert(pFromXform,<sp/>pToXform))!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="2137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;NeedAdjustSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="2139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</highlight></codeline>
<codeline lineno="2140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</highlight></codeline>
<codeline lineno="2141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pToXform-&gt;m_PCSScale[0],<sp/>pToXform-&gt;m_PCSScale[1],<sp/>pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;UseLegacyPCS())</highlight></codeline>
<codeline lineno="2145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToLab2(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToLab(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2149"><highlight class="normal"></highlight></codeline>
<codeline lineno="2150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a3cc88012894a42474b7609adbe314918" kindref="member">icSigXYZPcsData</ref>:</highlight></codeline>
<codeline lineno="2151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushRef2Xyz(pFromXform-&gt;m_pProfile,<sp/>pFromXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((stat=pushXYZConvert(pFromXform,<sp/>pToXform))!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="2154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;NeedAdjustSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="2156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</highlight></codeline>
<codeline lineno="2157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</highlight></codeline>
<codeline lineno="2158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pToXform-&gt;m_PCSScale[0],<sp/>pToXform-&gt;m_PCSScale[1],<sp/>pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToXyzIn();</highlight></codeline>
<codeline lineno="2162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2163"><highlight class="normal"></highlight></codeline>
<codeline lineno="2164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1aa9cd4477816537fbf648a155f6b78eda" kindref="member">icSigReflectanceSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1af5df74ebff3f8247e1c7c88844c1f140" kindref="member">icSigTransmissionSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushSpecToRange(pFromXform-&gt;m_pProfile-&gt;m_Header.spectralRange,<sp/></highlight></codeline>
<codeline lineno="2167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_pProfile-&gt;m_Header.spectralRange);</highlight></codeline>
<codeline lineno="2168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2169"><highlight class="normal"></highlight></codeline>
<codeline lineno="2170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a163dee4d9a8a1568dded8480a166e852" kindref="member">icSigRadiantSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushApplyIllum(pFromXform-&gt;m_pProfile,<sp/>pFromXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushSpecToRange(pFromXform-&gt;m_pProfile-&gt;m_Header.spectralRange,<sp/></highlight></codeline>
<codeline lineno="2173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_pProfile-&gt;m_Header.spectralRange);</highlight></codeline>
<codeline lineno="2174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2175"><highlight class="normal"></highlight></codeline>
<codeline lineno="2176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1ae84d222edd132ad7741c628c1d4729d9" kindref="member">icSigBiDirReflectanceSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1b59192d9fcc1aee71b8cc523b4978ca" kindref="member">icSigSparseMatrixSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281" kindref="member">icCmmStatUnsupportedPcsLink</ref>;</highlight></codeline>
<codeline lineno="2179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2181"><highlight class="normal"></highlight></codeline>
<codeline lineno="2182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a163dee4d9a8a1568dded8480a166e852" kindref="member">icSigRadiantSpectralPcsData</ref>:<sp/>{</highlight></codeline>
<codeline lineno="2183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pFromProfile<sp/>=<sp/>pFromXform-&gt;GetProfilePtr();</highlight></codeline>
<codeline lineno="2184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pToProfile<sp/>=<sp/>pToXform-&gt;GetProfilePtr();</highlight></codeline>
<codeline lineno="2185"><highlight class="normal"></highlight></codeline>
<codeline lineno="2186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(m_dstSpace)<sp/>{</highlight></codeline>
<codeline lineno="2187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a043048bd0c63d3bd54d35e8b5743d226" kindref="member">icSigLabPcsData</ref>:</highlight></codeline>
<codeline lineno="2188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushRad2Xyz(pFromProfile,<sp/>pFromXform-&gt;m_pConnectionConditions,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((stat=pushXYZConvert(pFromXform,<sp/>pToXform))!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="2191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;NeedAdjustSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="2193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</highlight></codeline>
<codeline lineno="2194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</highlight></codeline>
<codeline lineno="2195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pToXform-&gt;m_PCSScale[0],<sp/>pToXform-&gt;m_PCSScale[1],<sp/>pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;UseLegacyPCS())</highlight></codeline>
<codeline lineno="2199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToLab2(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToLab(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2203"><highlight class="normal"></highlight></codeline>
<codeline lineno="2204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a3cc88012894a42474b7609adbe314918" kindref="member">icSigXYZPcsData</ref>:</highlight></codeline>
<codeline lineno="2205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushRad2Xyz(pFromProfile,<sp/>pFromXform-&gt;m_pConnectionConditions,<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((stat=pushXYZConvert(pFromXform,<sp/>pToXform))!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="2208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;NeedAdjustSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="2210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</highlight></codeline>
<codeline lineno="2211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</highlight></codeline>
<codeline lineno="2212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pToXform-&gt;m_PCSScale[0],<sp/>pToXform-&gt;m_PCSScale[1],<sp/>pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToXyzIn();</highlight></codeline>
<codeline lineno="2216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2217"><highlight class="normal"></highlight></codeline>
<codeline lineno="2218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1aa9cd4477816537fbf648a155f6b78eda" kindref="member">icSigReflectanceSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1af5df74ebff3f8247e1c7c88844c1f140" kindref="member">icSigTransmissionSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281" kindref="member">icCmmStatUnsupportedPcsLink</ref>;</highlight></codeline>
<codeline lineno="2221"><highlight class="normal"></highlight></codeline>
<codeline lineno="2222"><highlight class="normal"></highlight></codeline>
<codeline lineno="2223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a163dee4d9a8a1568dded8480a166e852" kindref="member">icSigRadiantSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushSpecToRange(pFromXform-&gt;m_pProfile-&gt;m_Header.spectralRange,<sp/></highlight></codeline>
<codeline lineno="2225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_pProfile-&gt;m_Header.spectralRange);</highlight></codeline>
<codeline lineno="2226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2227"><highlight class="normal"></highlight></codeline>
<codeline lineno="2228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1ae84d222edd132ad7741c628c1d4729d9" kindref="member">icSigBiDirReflectanceSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1b59192d9fcc1aee71b8cc523b4978ca" kindref="member">icSigSparseMatrixSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281" kindref="member">icCmmStatUnsupportedPcsLink</ref>;</highlight></codeline>
<codeline lineno="2231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2234"><highlight class="normal"></highlight></codeline>
<codeline lineno="2235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1ae84d222edd132ad7741c628c1d4729d9" kindref="member">icSigBiDirReflectanceSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1b59192d9fcc1aee71b8cc523b4978ca" kindref="member">icSigSparseMatrixSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(m_dstSpace)<sp/>{</highlight></codeline>
<codeline lineno="2238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a043048bd0c63d3bd54d35e8b5743d226" kindref="member">icSigLabPcsData</ref>:</highlight></codeline>
<codeline lineno="2239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushBiRef2Xyz(pFromXform-&gt;m_pProfile,<sp/>pFromXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((stat=pushXYZConvert(pFromXform,<sp/>pToXform))!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="2242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;NeedAdjustSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="2244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</highlight></codeline>
<codeline lineno="2245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</highlight></codeline>
<codeline lineno="2246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pToXform-&gt;m_PCSScale[0],<sp/>pToXform-&gt;m_PCSScale[1],<sp/>pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;UseLegacyPCS())</highlight></codeline>
<codeline lineno="2250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToLab2(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToLab(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2254"><highlight class="normal"></highlight></codeline>
<codeline lineno="2255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a3cc88012894a42474b7609adbe314918" kindref="member">icSigXYZPcsData</ref>:</highlight></codeline>
<codeline lineno="2256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((stat=pushBiRef2Xyz(pFromXform-&gt;m_pProfile,<sp/>pFromXform-&gt;m_pConnectionConditions))!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="2258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((stat=pushXYZConvert(pFromXform,<sp/>pToXform))!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="2261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;NeedAdjustSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="2263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pToXform-&gt;m_PCSOffset[0]/pToXform-&gt;m_PCSScale[0],</highlight></codeline>
<codeline lineno="2264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[1]/pToXform-&gt;m_PCSScale[1],</highlight></codeline>
<codeline lineno="2265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_PCSOffset[2]/pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pToXform-&gt;m_PCSScale[0],<sp/>pToXform-&gt;m_PCSScale[1],<sp/>pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToXyzIn();</highlight></codeline>
<codeline lineno="2269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2270"><highlight class="normal"></highlight></codeline>
<codeline lineno="2271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1aa9cd4477816537fbf648a155f6b78eda" kindref="member">icSigReflectanceSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1af5df74ebff3f8247e1c7c88844c1f140" kindref="member">icSigTransmissionSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((stat=pushBiRef2Ref(pFromXform-&gt;m_pProfile,<sp/>pFromXform-&gt;m_pConnectionConditions))!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="2275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushSpecToRange(pFromXform-&gt;m_pProfile-&gt;m_Header.spectralRange,<sp/></highlight></codeline>
<codeline lineno="2277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_pProfile-&gt;m_Header.spectralRange);</highlight></codeline>
<codeline lineno="2278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2279"><highlight class="normal"></highlight></codeline>
<codeline lineno="2280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a163dee4d9a8a1568dded8480a166e852" kindref="member">icSigRadiantSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((stat=pushBiRef2Rad(pFromXform-&gt;m_pProfile,<sp/>pFromXform-&gt;m_pConnectionConditions))!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="2283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushSpecToRange(pFromXform-&gt;m_pProfile-&gt;m_Header.spectralRange,<sp/></highlight></codeline>
<codeline lineno="2285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pToXform-&gt;m_pProfile-&gt;m_Header.spectralRange);</highlight></codeline>
<codeline lineno="2286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2287"><highlight class="normal"></highlight></codeline>
<codeline lineno="2288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1ae84d222edd132ad7741c628c1d4729d9" kindref="member">icSigBiDirReflectanceSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d7/dce/a00143_1aaa32c9864a601c0a28143886cadb344d" kindref="member">icSameSpectralRange</ref>(pFromXform-&gt;m_pProfile-&gt;m_Header.spectralRange,<sp/>pToXform-&gt;m_pProfile-&gt;m_Header.spectralRange)<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="2290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1aaa32c9864a601c0a28143886cadb344d" kindref="member">icSameSpectralRange</ref>(pFromXform-&gt;m_pProfile-&gt;m_Header.biSpectralRange,<sp/>pToXform-&gt;m_pProfile-&gt;m_Header.biSpectralRange))</highlight></codeline>
<codeline lineno="2291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281" kindref="member">icCmmStatUnsupportedPcsLink</ref>;</highlight></codeline>
<codeline lineno="2294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="2295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1b59192d9fcc1aee71b8cc523b4978ca" kindref="member">icSigSparseMatrixSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="2296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281" kindref="member">icCmmStatUnsupportedPcsLink</ref>;</highlight></codeline>
<codeline lineno="2297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2299"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2300"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2301"><highlight class="normal"></highlight></codeline>
<codeline lineno="2302"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv<sp/>=<sp/>Optimize();</highlight></codeline>
<codeline lineno="2303"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="2304"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="2305"><highlight class="normal"></highlight></codeline>
<codeline lineno="2306"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_list-&gt;begin()==m_list-&gt;end())</highlight></codeline>
<codeline lineno="2307"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10" kindref="member">icCmmStatIdentityXform</ref>;</highlight></codeline>
<codeline lineno="2308"><highlight class="normal"></highlight></codeline>
<codeline lineno="2309"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="2310"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2311"><highlight class="normal"></highlight></codeline>
<codeline lineno="2312"><highlight class="normal"></highlight></codeline>
<codeline lineno="2322"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccPcsXform::ConnectFirst(CIccXform*<sp/>pToXform,<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>srcSpace)</highlight></codeline>
<codeline lineno="2323"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2324"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pToXform)</highlight></codeline>
<codeline lineno="2325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="2326"><highlight class="normal"></highlight></codeline>
<codeline lineno="2327"><highlight class="normal"></highlight></codeline>
<codeline lineno="2328"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(srcSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2329"><highlight class="normal"><sp/><sp/><sp/><sp/>pushXyzInToXyz();</highlight></codeline>
<codeline lineno="2330"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;NeedAdjustSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="2331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pToXform-&gt;m_PCSScale[0],<sp/>pToXform-&gt;m_PCSScale[1],<sp/>pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pToXform-&gt;m_PCSOffset[0],<sp/>pToXform-&gt;m_PCSOffset[1],<sp/>pToXform-&gt;m_PCSOffset[2]);</highlight></codeline>
<codeline lineno="2333"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2334"><highlight class="normal"></highlight></codeline>
<codeline lineno="2335"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;GetSrcSpace()<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;UseLegacyPCS())</highlight></codeline>
<codeline lineno="2337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToLab2(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToLab(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2340"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2341"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToXyzIn();</highlight></codeline>
<codeline lineno="2343"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2344"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2345"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(srcSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2346"><highlight class="normal"></highlight></codeline>
<codeline lineno="2347"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;GetSrcSpace()<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pushLabToXyz(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2349"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;NeedAdjustSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="2350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pToXform-&gt;m_PCSScale[0],<sp/>pToXform-&gt;m_PCSScale[1],<sp/>pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pToXform-&gt;m_PCSOffset[0],<sp/>pToXform-&gt;m_PCSOffset[1],<sp/>pToXform-&gt;m_PCSOffset[2]);</highlight></codeline>
<codeline lineno="2352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2353"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2354"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;NeedAdjustSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="2355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pushLabToXyz(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pushScale3(pToXform-&gt;m_PCSScale[0],<sp/>pToXform-&gt;m_PCSScale[1],<sp/>pToXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pushOffset3(pToXform-&gt;m_PCSOffset[0],<sp/>pToXform-&gt;m_PCSOffset[1],<sp/>pToXform-&gt;m_PCSOffset[2]);</highlight></codeline>
<codeline lineno="2358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;UseLegacyPCS())</highlight></codeline>
<codeline lineno="2359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToLab2(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2360"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToLab(pToXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2362"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;UseLegacyPCS()<sp/>&amp;&amp;<sp/>!pToXform-&gt;IsInput())<sp/>{</highlight></codeline>
<codeline lineno="2364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pushLabToLab2();</highlight></codeline>
<codeline lineno="2365"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2366"><highlight class="normal"></highlight></codeline>
<codeline lineno="2367"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2368"><highlight class="normal"></highlight></codeline>
<codeline lineno="2369"><highlight class="normal"></highlight></codeline>
<codeline lineno="2370"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv<sp/>=<sp/>Optimize();</highlight></codeline>
<codeline lineno="2371"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="2372"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="2373"><highlight class="normal"></highlight></codeline>
<codeline lineno="2374"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_list-&gt;begin()<sp/>==<sp/>m_list-&gt;end())</highlight></codeline>
<codeline lineno="2375"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10" kindref="member">icCmmStatIdentityXform</ref>;</highlight></codeline>
<codeline lineno="2376"><highlight class="normal"></highlight></codeline>
<codeline lineno="2377"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="2378"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2379"><highlight class="normal"></highlight></codeline>
<codeline lineno="2380"><highlight class="normal"></highlight></codeline>
<codeline lineno="2390"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccPcsXform::ConnectLast(CIccXform*<sp/>pFromXform,<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>dstSpace)</highlight></codeline>
<codeline lineno="2391"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2392"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pFromXform)</highlight></codeline>
<codeline lineno="2393"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="2394"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>srcSpace<sp/>=<sp/>pFromXform-&gt;GetDstSpace();</highlight></codeline>
<codeline lineno="2395"><highlight class="normal"></highlight></codeline>
<codeline lineno="2396"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromXform-&gt;NeedAdjustDstPCS()<sp/>&amp;&amp;<sp/><ref refid="d3/df8/a00155_1aaacd6d45813e2697ad238b12befa5719" kindref="member">IsSpaceColorimetricPCS</ref>(dstSpace))<sp/>{</highlight></codeline>
<codeline lineno="2397"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(srcSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromXform-&gt;UseLegacyPCS())</highlight></codeline>
<codeline lineno="2399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushLab2ToXyz(pFromXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pushLabToXyz(pFromXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2402"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2403"><highlight class="normal"></highlight></codeline>
<codeline lineno="2404"><highlight class="normal"><sp/><sp/><sp/><sp/>pushScale3(pFromXform-&gt;m_PCSScale[0],<sp/>pFromXform-&gt;m_PCSScale[1],<sp/>pFromXform-&gt;m_PCSScale[2]);</highlight></codeline>
<codeline lineno="2405"><highlight class="normal"><sp/><sp/><sp/><sp/>pushOffset3(pFromXform-&gt;m_PCSOffset[0],<sp/>pFromXform-&gt;m_PCSOffset[1],<sp/>pFromXform-&gt;m_PCSOffset[2]);</highlight></codeline>
<codeline lineno="2406"><highlight class="normal"></highlight></codeline>
<codeline lineno="2407"><highlight class="normal"><sp/><sp/><sp/><sp/>pushXyzToXyzIn();</highlight></codeline>
<codeline lineno="2408"><highlight class="normal"></highlight></codeline>
<codeline lineno="2409"><highlight class="normal"><sp/><sp/><sp/><sp/>srcSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>;</highlight></codeline>
<codeline lineno="2410"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2411"><highlight class="normal"></highlight></codeline>
<codeline lineno="2412"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(srcSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref><sp/>&amp;&amp;<sp/>dstSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2413"><highlight class="normal"><sp/><sp/><sp/><sp/>pushXyzInToXyz();</highlight></codeline>
<codeline lineno="2414"><highlight class="normal"><sp/><sp/><sp/><sp/>pushXyzToLab(pFromXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2415"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2416"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(srcSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref><sp/>&amp;&amp;<sp/>dstSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2417"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromXform-&gt;UseLegacyPCS())</highlight></codeline>
<codeline lineno="2418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pushLab2ToXyz(pFromXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2419"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pushLabToXyz(pFromXform-&gt;m_pConnectionConditions);</highlight></codeline>
<codeline lineno="2421"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromXform-&gt;IsInput())</highlight></codeline>
<codeline lineno="2422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pushXyzToXyzIn();</highlight></codeline>
<codeline lineno="2423"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2424"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromXform-&gt;UseLegacyPCS()<sp/>&amp;&amp;<sp/>pFromXform-&gt;IsInput()<sp/>&amp;&amp;<sp/>srcSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref><sp/>&amp;&amp;<sp/>dstSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2425"><highlight class="normal"><sp/><sp/><sp/><sp/>pushLab2ToLab();</highlight></codeline>
<codeline lineno="2426"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2427"><highlight class="normal"></highlight></codeline>
<codeline lineno="2428"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv<sp/>=<sp/>Optimize();</highlight></codeline>
<codeline lineno="2429"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="2430"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="2431"><highlight class="normal"></highlight></codeline>
<codeline lineno="2432"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_list-&gt;begin()<sp/>==<sp/>m_list-&gt;end())</highlight></codeline>
<codeline lineno="2433"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10" kindref="member">icCmmStatIdentityXform</ref>;</highlight></codeline>
<codeline lineno="2434"><highlight class="normal"></highlight></codeline>
<codeline lineno="2435"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="2436"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2437"><highlight class="normal"></highlight></codeline>
<codeline lineno="2438"><highlight class="normal"></highlight></codeline>
<codeline lineno="2447"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccPcsXform::Optimize()</highlight></codeline>
<codeline lineno="2448"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2449"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_list)</highlight></codeline>
<codeline lineno="2450"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="2451"><highlight class="normal"></highlight></codeline>
<codeline lineno="2452"><highlight class="normal"><sp/><sp/>CIccPcsStepList<sp/>steps<sp/>=<sp/>*m_list;</highlight></codeline>
<codeline lineno="2453"><highlight class="normal"><sp/><sp/>CIccPcsStepList::iterator<sp/>next,<sp/>last;</highlight></codeline>
<codeline lineno="2454"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>done=</highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2455"><highlight class="normal"></highlight></codeline>
<codeline lineno="2456"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2457"><highlight class="normal"><sp/><sp/>std::string<sp/>str;</highlight></codeline>
<codeline lineno="2458"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(next<sp/>=<sp/>steps.begin();<sp/>next<sp/>!=<sp/>steps.end();<sp/>next++)<sp/>{</highlight></codeline>
<codeline lineno="2459"><highlight class="normal"><sp/><sp/><sp/><sp/>next-&gt;ptr-&gt;dump(str);</highlight></codeline>
<codeline lineno="2460"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2461"><highlight class="normal"><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;PCS_Steps:\n%s&quot;</highlight><highlight class="normal">,<sp/>str.c_str());</highlight></codeline>
<codeline lineno="2462"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2463"><highlight class="normal"></highlight></codeline>
<codeline lineno="2464"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">while</highlight><highlight class="normal"><sp/>(!done)<sp/>{</highlight></codeline>
<codeline lineno="2465"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccPcsStepList<sp/>newSteps;</highlight></codeline>
<codeline lineno="2466"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="2467"><highlight class="normal"></highlight></codeline>
<codeline lineno="2468"><highlight class="normal"><sp/><sp/><sp/><sp/>done<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2469"><highlight class="normal"></highlight></codeline>
<codeline lineno="2470"><highlight class="normal"><sp/><sp/><sp/><sp/>next<sp/>=<sp/>steps.begin();</highlight></codeline>
<codeline lineno="2471"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(next==steps.end())<sp/>{</highlight></codeline>
<codeline lineno="2472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>*m_list<sp/>=<sp/>steps;</highlight></codeline>
<codeline lineno="2473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10" kindref="member">icCmmStatIdentityXform</ref>;</highlight></codeline>
<codeline lineno="2474"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2475"><highlight class="normal"><sp/><sp/><sp/><sp/>last<sp/>=<sp/>next;</highlight></codeline>
<codeline lineno="2476"><highlight class="normal"><sp/><sp/><sp/><sp/>next++;</highlight></codeline>
<codeline lineno="2477"><highlight class="normal"></highlight></codeline>
<codeline lineno="2478"><highlight class="normal"><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>last-&gt;ptr;</highlight></codeline>
<codeline lineno="2479"><highlight class="normal"></highlight></codeline>
<codeline lineno="2480"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;next!=steps.end();<sp/>next++)<sp/>{</highlight></codeline>
<codeline lineno="2481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsStep<sp/>*pStep<sp/>=<sp/>ptr.ptr-&gt;concat(next-&gt;ptr);</highlight></codeline>
<codeline lineno="2482"><highlight class="normal"></highlight></codeline>
<codeline lineno="2483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pStep)<sp/>{</highlight></codeline>
<codeline lineno="2484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>done<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="2485"><highlight class="normal"></highlight></codeline>
<codeline lineno="2486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>ptr.ptr;</highlight></codeline>
<codeline lineno="2487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>next-&gt;ptr;</highlight></codeline>
<codeline lineno="2488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>pStep;</highlight></codeline>
<codeline lineno="2489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!ptr.ptr-&gt;isIdentity())<sp/>{</highlight></codeline>
<codeline lineno="2492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>newSteps.push_back(ptr);</highlight></codeline>
<codeline lineno="2493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>next-&gt;ptr;</highlight></codeline>
<codeline lineno="2495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2496"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2497"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!ptr.ptr-&gt;isIdentity())<sp/>{</highlight></codeline>
<codeline lineno="2498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>newSteps.push_back(ptr);</highlight></codeline>
<codeline lineno="2499"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2500"><highlight class="normal"></highlight></codeline>
<codeline lineno="2501"><highlight class="normal"><sp/><sp/><sp/><sp/>steps<sp/>=<sp/>newSteps;</highlight></codeline>
<codeline lineno="2502"><highlight class="normal"></highlight></codeline>
<codeline lineno="2503"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>for<sp/>(next=steps.begin();<sp/>next!=steps.end();<sp/>next++)<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2504"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>next-&gt;ptr;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2505"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/><sp/><sp/>done<sp/>=<sp/>true;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2506"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2507"><highlight class="normal"></highlight></codeline>
<codeline lineno="2508"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2509"><highlight class="normal"></highlight></codeline>
<codeline lineno="2510"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!steps.empty())<sp/>{</highlight></codeline>
<codeline lineno="2511"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccPcsStepList<sp/>newSteps;</highlight></codeline>
<codeline lineno="2512"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="2513"><highlight class="normal"></highlight></codeline>
<codeline lineno="2514"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(next=steps.begin();<sp/>next<sp/>!=<sp/>steps.end();<sp/>next++)<sp/>{</highlight></codeline>
<codeline lineno="2515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>next-&gt;ptr-&gt;reduce();</highlight></codeline>
<codeline lineno="2516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ptr.ptr<sp/>!=<sp/>next-&gt;ptr)</highlight></codeline>
<codeline lineno="2517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>next-&gt;ptr;</highlight></codeline>
<codeline lineno="2518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>newSteps.push_back(ptr);</highlight></codeline>
<codeline lineno="2519"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2520"><highlight class="normal"><sp/><sp/><sp/><sp/>steps<sp/>=<sp/>newSteps;</highlight></codeline>
<codeline lineno="2521"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2522"><highlight class="normal"></highlight></codeline>
<codeline lineno="2523"><highlight class="normal"><sp/><sp/>*m_list<sp/>=<sp/>steps;</highlight></codeline>
<codeline lineno="2524"><highlight class="normal"></highlight></codeline>
<codeline lineno="2525"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="2526"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2527"><highlight class="normal"></highlight></codeline>
<codeline lineno="2528"><highlight class="normal"></highlight></codeline>
<codeline lineno="2538"><highlight class="normal">CIccApplyXform<sp/>*CIccPcsXform::GetNewApply(<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>&amp;status)</highlight></codeline>
<codeline lineno="2539"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2540"><highlight class="normal"><sp/><sp/>CIccApplyPcsXform<sp/>*pNew<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccApplyPcsXform(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="2541"><highlight class="normal"></highlight></codeline>
<codeline lineno="2542"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNew)<sp/>{</highlight></codeline>
<codeline lineno="2543"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pNew-&gt;Init())<sp/>{</highlight></codeline>
<codeline lineno="2544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pNew;</highlight></codeline>
<codeline lineno="2545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="2546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="2547"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2548"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2549"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2550"><highlight class="normal"><sp/><sp/><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="2551"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="2552"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2553"><highlight class="normal"></highlight></codeline>
<codeline lineno="2554"><highlight class="normal"><sp/><sp/>CIccPcsStepList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="2555"><highlight class="normal"><sp/><sp/>CIccApplyPcsStep<sp/>*pStep;</highlight></codeline>
<codeline lineno="2556"><highlight class="normal"></highlight></codeline>
<codeline lineno="2557"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=m_list-&gt;begin();<sp/>i!=m_list-&gt;end();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="2558"><highlight class="normal"><sp/><sp/><sp/><sp/>pStep<sp/>=<sp/>i-&gt;ptr-&gt;GetNewApply();</highlight></codeline>
<codeline lineno="2559"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pStep<sp/>||<sp/>status<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pNew;</highlight></codeline>
<codeline lineno="2561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="2562"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2563"><highlight class="normal"><sp/><sp/><sp/><sp/>pNew-&gt;AppendApplyStep(pStep);</highlight></codeline>
<codeline lineno="2564"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2565"><highlight class="normal"></highlight></codeline>
<codeline lineno="2566"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pNew;</highlight></codeline>
<codeline lineno="2567"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2568"><highlight class="normal"></highlight></codeline>
<codeline lineno="2569"><highlight class="normal"></highlight></codeline>
<codeline lineno="2578"><highlight class="normal"><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>CIccPcsXform::MaxChannels()</highlight></codeline>
<codeline lineno="2579"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2580"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nMax<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="2581"><highlight class="normal"><sp/><sp/>CIccPcsStepList::const_iterator<sp/>s<sp/>=<sp/>m_list-&gt;begin();</highlight></codeline>
<codeline lineno="2582"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(s==m_list-&gt;end())</highlight></codeline>
<codeline lineno="2583"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nMax;</highlight></codeline>
<codeline lineno="2584"><highlight class="normal"><sp/><sp/>nMax<sp/>=<sp/>s-&gt;ptr-&gt;GetDstChannels();</highlight></codeline>
<codeline lineno="2585"><highlight class="normal"><sp/><sp/>s++;</highlight></codeline>
<codeline lineno="2586"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;<sp/>s!=<sp/>m_list-&gt;end();<sp/>s++)<sp/>{</highlight></codeline>
<codeline lineno="2587"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(s-&gt;ptr-&gt;GetSrcChannels()&gt;nMax)</highlight></codeline>
<codeline lineno="2588"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nMax<sp/>=<sp/>s-&gt;ptr-&gt;GetSrcChannels();</highlight></codeline>
<codeline lineno="2589"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2590"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>nMax;</highlight></codeline>
<codeline lineno="2591"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2592"><highlight class="normal"></highlight></codeline>
<codeline lineno="2601"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushRouteMcs(<ref refid="db/de0/a00465" kindref="compound">CIccTagArray</ref><sp/>*pSrcChannels,<sp/><ref refid="db/de0/a00465" kindref="compound">CIccTagArray</ref><sp/>*pDstChannels,<sp/><ref refid="d0/daa/a01029" kindref="compound">CIccTagNumArray</ref><sp/>*pDefaults)</highlight></codeline>
<codeline lineno="2602"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2603"><highlight class="normal"><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="2604"><highlight class="normal"></highlight></codeline>
<codeline lineno="2605"><highlight class="normal"><sp/><sp/>ptr.ptr<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepRouteMcs(pSrcChannels,<sp/>pDstChannels,<sp/>pDefaults);</highlight></codeline>
<codeline lineno="2606"><highlight class="normal"><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="2607"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2608"><highlight class="normal"></highlight></codeline>
<codeline lineno="2609"><highlight class="normal"></highlight></codeline>
<codeline lineno="2618"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushLab2ToLab()</highlight></codeline>
<codeline lineno="2619"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2620"><highlight class="normal"><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="2621"><highlight class="normal"></highlight></codeline>
<codeline lineno="2622"><highlight class="normal"><sp/><sp/>ptr.ptr<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepLab2ToLab();</highlight></codeline>
<codeline lineno="2623"><highlight class="normal"><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="2624"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2625"><highlight class="normal"></highlight></codeline>
<codeline lineno="2626"><highlight class="normal"></highlight></codeline>
<codeline lineno="2635"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushLabToLab2()</highlight></codeline>
<codeline lineno="2636"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2637"><highlight class="normal"><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="2638"><highlight class="normal"></highlight></codeline>
<codeline lineno="2639"><highlight class="normal"><sp/><sp/>ptr.ptr<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepLabToLab2();</highlight></codeline>
<codeline lineno="2640"><highlight class="normal"><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="2641"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2642"><highlight class="normal"></highlight></codeline>
<codeline lineno="2643"><highlight class="normal"></highlight></codeline>
<codeline lineno="2652"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushLab2ToXyz(<sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPCC)</highlight></codeline>
<codeline lineno="2653"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2654"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>xyzWhite[3];</highlight></codeline>
<codeline lineno="2655"><highlight class="normal"><sp/><sp/>pPCC-&gt;<ref refid="db/d18/a00885_1a9c5c38685ec6a82b97608f5571e303f2" kindref="member">getNormIlluminantXYZ</ref>(xyzWhite);</highlight></codeline>
<codeline lineno="2656"><highlight class="normal"></highlight></codeline>
<codeline lineno="2657"><highlight class="normal"><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="2658"><highlight class="normal"></highlight></codeline>
<codeline lineno="2659"><highlight class="normal"><sp/><sp/>ptr.ptr<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepLab2ToXYZ(xyzWhite);</highlight></codeline>
<codeline lineno="2660"><highlight class="normal"><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="2661"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2662"><highlight class="normal"></highlight></codeline>
<codeline lineno="2663"><highlight class="normal"></highlight></codeline>
<codeline lineno="2672"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushXyzToLab2(<ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPCC)</highlight></codeline>
<codeline lineno="2673"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2674"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>xyzWhite[3];</highlight></codeline>
<codeline lineno="2675"><highlight class="normal"><sp/><sp/>pPCC-&gt;<ref refid="db/d18/a00885_1a9c5c38685ec6a82b97608f5571e303f2" kindref="member">getNormIlluminantXYZ</ref>(xyzWhite);</highlight></codeline>
<codeline lineno="2676"><highlight class="normal"></highlight></codeline>
<codeline lineno="2677"><highlight class="normal"><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="2678"><highlight class="normal"></highlight></codeline>
<codeline lineno="2679"><highlight class="normal"><sp/><sp/>ptr.ptr<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepXYZToLab2(xyzWhite);</highlight></codeline>
<codeline lineno="2680"><highlight class="normal"><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="2681"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2682"><highlight class="normal"></highlight></codeline>
<codeline lineno="2683"><highlight class="normal"></highlight></codeline>
<codeline lineno="2692"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushLabToXyz(<ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPCC)</highlight></codeline>
<codeline lineno="2693"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2694"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>xyzWhite[3];</highlight></codeline>
<codeline lineno="2695"><highlight class="normal"><sp/><sp/>pPCC-&gt;<ref refid="db/d18/a00885_1a9c5c38685ec6a82b97608f5571e303f2" kindref="member">getNormIlluminantXYZ</ref>(xyzWhite);</highlight></codeline>
<codeline lineno="2696"><highlight class="normal"></highlight></codeline>
<codeline lineno="2697"><highlight class="normal"><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="2698"><highlight class="normal"></highlight></codeline>
<codeline lineno="2699"><highlight class="normal"><sp/><sp/>ptr.ptr<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepLabToXYZ(xyzWhite);</highlight></codeline>
<codeline lineno="2700"><highlight class="normal"><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="2701"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2702"><highlight class="normal"></highlight></codeline>
<codeline lineno="2703"><highlight class="normal"></highlight></codeline>
<codeline lineno="2712"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushXyzToLab(<sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPCC)</highlight></codeline>
<codeline lineno="2713"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2714"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>xyzWhite[3];</highlight></codeline>
<codeline lineno="2715"><highlight class="normal"><sp/><sp/>pPCC-&gt;<ref refid="db/d18/a00885_1a9c5c38685ec6a82b97608f5571e303f2" kindref="member">getNormIlluminantXYZ</ref>(xyzWhite);</highlight></codeline>
<codeline lineno="2716"><highlight class="normal"></highlight></codeline>
<codeline lineno="2717"><highlight class="normal"><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="2718"><highlight class="normal"></highlight></codeline>
<codeline lineno="2719"><highlight class="normal"><sp/><sp/>ptr.ptr<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepXYZToLab(xyzWhite);</highlight></codeline>
<codeline lineno="2720"><highlight class="normal"><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="2721"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2722"><highlight class="normal"></highlight></codeline>
<codeline lineno="2732"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushScale3(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>v1,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>v2,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>v3)</highlight></codeline>
<codeline lineno="2733"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2734"><highlight class="normal"><sp/><sp/>CIccPcsStepScale<sp/>*scale;</highlight></codeline>
<codeline lineno="2735"><highlight class="normal"><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="2736"><highlight class="normal"></highlight></codeline>
<codeline lineno="2737"><highlight class="normal"><sp/><sp/>scale<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepScale(3);</highlight></codeline>
<codeline lineno="2738"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*data<sp/>=<sp/>scale-&gt;data();</highlight></codeline>
<codeline lineno="2739"><highlight class="normal"><sp/><sp/>data[0]<sp/>=<sp/>v1;</highlight></codeline>
<codeline lineno="2740"><highlight class="normal"><sp/><sp/>data[1]<sp/>=<sp/>v2;</highlight></codeline>
<codeline lineno="2741"><highlight class="normal"><sp/><sp/>data[2]<sp/>=<sp/>v3;</highlight></codeline>
<codeline lineno="2742"><highlight class="normal"></highlight></codeline>
<codeline lineno="2743"><highlight class="normal"><sp/><sp/>ptr.ptr<sp/>=<sp/>scale;</highlight></codeline>
<codeline lineno="2744"><highlight class="normal"><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="2745"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2746"><highlight class="normal"></highlight></codeline>
<codeline lineno="2755"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushXyzToXyzIn()</highlight></codeline>
<codeline lineno="2756"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2757"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>scale<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)<sp/>(32768.0<sp/>/<sp/>65535.0);</highlight></codeline>
<codeline lineno="2758"><highlight class="normal"><sp/><sp/>pushScale3(scale,<sp/>scale,<sp/>scale);</highlight></codeline>
<codeline lineno="2759"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2760"><highlight class="normal"></highlight></codeline>
<codeline lineno="2761"><highlight class="normal"></highlight></codeline>
<codeline lineno="2770"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushXyzInToXyz()</highlight></codeline>
<codeline lineno="2771"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2772"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>scale<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)<sp/>(65535.0<sp/>/<sp/>32768.0);</highlight></codeline>
<codeline lineno="2773"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pushScale3(scale,<sp/>scale,<sp/>scale);</highlight></codeline>
<codeline lineno="2774"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2775"><highlight class="normal"></highlight></codeline>
<codeline lineno="2776"><highlight class="normal"></highlight></codeline>
<codeline lineno="2785"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushXyzToXyzLum(<ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPCC)</highlight></codeline>
<codeline lineno="2786"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2787"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>XYZLum[3];</highlight></codeline>
<codeline lineno="2788"><highlight class="normal"><sp/><sp/>pPCC-&gt;<ref refid="db/d18/a00885_1a6b7d53898284b4c85611c2443e14d70c" kindref="member">getLumIlluminantXYZ</ref>(&amp;XYZLum[0]);</highlight></codeline>
<codeline lineno="2789"><highlight class="normal"></highlight></codeline>
<codeline lineno="2790"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>scale<sp/>=<sp/>XYZLum[1];</highlight></codeline>
<codeline lineno="2791"><highlight class="normal"></highlight></codeline>
<codeline lineno="2792"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pushScale3(scale,<sp/>scale,<sp/>scale);</highlight></codeline>
<codeline lineno="2793"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2794"><highlight class="normal"></highlight></codeline>
<codeline lineno="2795"><highlight class="normal"></highlight></codeline>
<codeline lineno="2804"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushXyzLumToXyz(<ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPCC)</highlight></codeline>
<codeline lineno="2805"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2806"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>XYZLum[3];</highlight></codeline>
<codeline lineno="2807"><highlight class="normal"><sp/><sp/>pPCC-&gt;<ref refid="db/d18/a00885_1a6b7d53898284b4c85611c2443e14d70c" kindref="member">getLumIlluminantXYZ</ref>(&amp;XYZLum[0]);</highlight></codeline>
<codeline lineno="2808"><highlight class="normal"></highlight></codeline>
<codeline lineno="2809"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>scale<sp/>=<sp/>1.0f<sp/>/<sp/>XYZLum[1];</highlight></codeline>
<codeline lineno="2810"><highlight class="normal"></highlight></codeline>
<codeline lineno="2811"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pushScale3(scale,<sp/>scale,<sp/>scale);</highlight></codeline>
<codeline lineno="2812"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2813"><highlight class="normal"></highlight></codeline>
<codeline lineno="2814"><highlight class="normal"></highlight></codeline>
<codeline lineno="2825"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushOffset3(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>v1,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>v2,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>v3,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bConvertIntXyzOffset</highlight><highlight class="comment">/*=true*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="2826"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2827"><highlight class="normal"><sp/><sp/>CIccPcsStepOffset<sp/>*offset;</highlight></codeline>
<codeline lineno="2828"><highlight class="normal"><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="2829"><highlight class="normal"></highlight></codeline>
<codeline lineno="2830"><highlight class="normal"><sp/><sp/>offset<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepOffset(3);</highlight></codeline>
<codeline lineno="2831"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*data<sp/>=<sp/>offset-&gt;data();</highlight></codeline>
<codeline lineno="2832"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bConvertIntXyzOffset)<sp/>{</highlight></codeline>
<codeline lineno="2833"><highlight class="normal"><sp/><sp/><sp/><sp/>data[0]<sp/>=<sp/>v1*65535.0f/32768.0f;</highlight></codeline>
<codeline lineno="2834"><highlight class="normal"><sp/><sp/><sp/><sp/>data[1]<sp/>=<sp/>v2*65535.0f/32768.0f;</highlight></codeline>
<codeline lineno="2835"><highlight class="normal"><sp/><sp/><sp/><sp/>data[2]<sp/>=<sp/>v3*65535.0f/32768.0f;</highlight></codeline>
<codeline lineno="2836"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2837"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="2838"><highlight class="normal"><sp/><sp/><sp/><sp/>data[0]<sp/>=<sp/>v1;</highlight></codeline>
<codeline lineno="2839"><highlight class="normal"><sp/><sp/><sp/><sp/>data[1]<sp/>=<sp/>v2;</highlight></codeline>
<codeline lineno="2840"><highlight class="normal"><sp/><sp/><sp/><sp/>data[2]<sp/>=<sp/>v3;</highlight></codeline>
<codeline lineno="2841"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2842"><highlight class="normal"></highlight></codeline>
<codeline lineno="2843"><highlight class="normal"><sp/><sp/>ptr.ptr<sp/>=<sp/>offset;</highlight></codeline>
<codeline lineno="2844"><highlight class="normal"><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="2845"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2846"><highlight class="normal"></highlight></codeline>
<codeline lineno="2847"><highlight class="normal"></highlight></codeline>
<codeline lineno="2857"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushScale(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>n,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*vals)</highlight></codeline>
<codeline lineno="2858"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2859"><highlight class="normal"><sp/><sp/>CIccPcsStepScale<sp/>*scale<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepScale(n);</highlight></codeline>
<codeline lineno="2860"><highlight class="normal"><sp/><sp/>memcpy(scale-&gt;data(),<sp/>vals,<sp/>n*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="2861"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="2862"><highlight class="normal"><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="2863"><highlight class="normal"><sp/><sp/>ptr.ptr<sp/>=<sp/>scale;</highlight></codeline>
<codeline lineno="2864"><highlight class="normal"><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="2865"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2866"><highlight class="normal"></highlight></codeline>
<codeline lineno="2867"><highlight class="normal"></highlight></codeline>
<codeline lineno="2876"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushMatrix(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nRows,<sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nCols,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*vals)</highlight></codeline>
<codeline lineno="2877"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2878"><highlight class="normal"><sp/><sp/>CIccPcsStepMatrix<sp/>*mtx<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepMatrix(nRows,<sp/>nCols);</highlight></codeline>
<codeline lineno="2879"><highlight class="normal"><sp/><sp/>memcpy(mtx-&gt;entry(0),<sp/>vals,<sp/>nRows*nCols*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="2880"><highlight class="normal"></highlight></codeline>
<codeline lineno="2881"><highlight class="normal"><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="2882"><highlight class="normal"><sp/><sp/>ptr.ptr<sp/>=<sp/>mtx;</highlight></codeline>
<codeline lineno="2883"><highlight class="normal"><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="2884"><highlight class="normal">}</highlight></codeline>
<codeline lineno="2885"><highlight class="normal"></highlight></codeline>
<codeline lineno="2886"><highlight class="normal"></highlight></codeline>
<codeline lineno="2897"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccPcsXform::pushXYZConvert(CIccXform<sp/>*pFromXform,<sp/>CIccXform<sp/>*pToXform)</highlight></codeline>
<codeline lineno="2898"><highlight class="normal">{</highlight></codeline>
<codeline lineno="2899"><highlight class="normal"><sp/><sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pSrcPcc<sp/>=<sp/>pFromXform-&gt;GetConnectionConditions();</highlight></codeline>
<codeline lineno="2900"><highlight class="normal"><sp/><sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pDstPcc<sp/>=<sp/>pToXform-&gt;GetConnectionConditions();</highlight></codeline>
<codeline lineno="2901"><highlight class="normal"></highlight></codeline>
<codeline lineno="2902"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pSrcPcc<sp/>||<sp/>!pDstPcc)</highlight></codeline>
<codeline lineno="2903"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9d8efd1c91aa512d46f51cd30a7927f5" kindref="member">icCmmStatBadConnection</ref>;</highlight></codeline>
<codeline lineno="2904"><highlight class="normal"></highlight></codeline>
<codeline lineno="2905"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//If<sp/>source<sp/>and<sp/>dest<sp/>observer<sp/>and<sp/>illuminant<sp/>are<sp/>same<sp/>then<sp/>no<sp/>transform<sp/>is<sp/>needed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2906"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pSrcPcc-&gt;<ref refid="db/d18/a00885_1a9ca9746d8f42338293e7570275af03d7" kindref="member">isEquivalentPcc</ref>(*pDstPcc))<sp/>{</highlight></codeline>
<codeline lineno="2907"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="2908"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2909"><highlight class="normal"></highlight></codeline>
<codeline lineno="2910"><highlight class="normal"><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="2911"><highlight class="normal"></highlight></codeline>
<codeline lineno="2912"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pSrcPcc-&gt;<ref refid="db/d18/a00885_1a91dc6e895f5fcc5cd924bcdedd5ea0b5" kindref="member">isStandardPcc</ref>())<sp/>{</highlight></codeline>
<codeline lineno="2913"><highlight class="normal"></highlight></codeline>
<codeline lineno="2914"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/d54/a01213" kindref="compound">CIccTagMultiProcessElement</ref><sp/>*pMpe<sp/>=<sp/>pSrcPcc-&gt;<ref refid="db/d18/a00885_1a6a535454f7d93b11bc5f6a83e9142331" kindref="member">getCustomToStandardPcc</ref>();</highlight></codeline>
<codeline lineno="2915"><highlight class="normal"></highlight></codeline>
<codeline lineno="2916"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pMpe<sp/>||<sp/>pMpe-&gt;<ref refid="d5/d54/a01213_1a1492a516235fdb066359bb5362efc89a" kindref="member">NumInputChannels</ref>()!=3<sp/>||<sp/>pMpe-&gt;<ref refid="d5/d54/a01213_1a425dfa52f0af074b588df02d283d63f9" kindref="member">NumOutputChannels</ref>()!=3)</highlight></codeline>
<codeline lineno="2917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="2918"><highlight class="normal"></highlight></codeline>
<codeline lineno="2919"><highlight class="normal"><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="2920"><highlight class="normal"></highlight></codeline>
<codeline lineno="2921"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//push<sp/>single<sp/>matrix<sp/>element<sp/>as<sp/>a<sp/>CIccPcsStepMatrix<sp/>so<sp/>it<sp/>can<sp/>be<sp/>optimized</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2922"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pMpe-&gt;<ref refid="d5/d54/a01213_1a9074a090efc10dd2470ff45594e10a11" kindref="member">NumElements</ref>()==1)<sp/>{</highlight></codeline>
<codeline lineno="2923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/d43/a01193" kindref="compound">CIccMultiProcessElement</ref><sp/>*pElem<sp/>=<sp/>pMpe-&gt;<ref refid="d5/d54/a01213_1ad49db93f89c409fc5aa3bd646a00beac" kindref="member">GetElement</ref>(0);</highlight></codeline>
<codeline lineno="2924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pElem)<sp/>{</highlight></codeline>
<codeline lineno="2925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pElem-&gt;<ref refid="dd/d43/a01193_1abc48ee629f3d2102bfdd5c03891b37e1" kindref="member">GetType</ref>()==<ref refid="d7/d46/a00002_1a5dbecf663e56b6445a7f199306ee1b4da9f1d5e498c47af2a0e0be3fa029970fe" kindref="member">icSigMatrixElemType</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d0/d82/a00857" kindref="compound">CIccMpeMatrix</ref><sp/>*pMatElem<sp/>=<sp/>(<ref refid="d0/d82/a00857" kindref="compound">CIccMpeMatrix</ref>*)pElem;</highlight></codeline>
<codeline lineno="2927"><highlight class="normal"></highlight></codeline>
<codeline lineno="2928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pMat<sp/>=<sp/>pMatElem-&gt;<ref refid="d0/d82/a00857_1a8caea712089acbdd830b1fa29d10aa8c" kindref="member">GetMatrix</ref>();</highlight></codeline>
<codeline lineno="2929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pOffset<sp/>=<sp/>pMatElem-&gt;<ref refid="d0/d82/a00857_1a02f8ec1722ad1f16f5ea3efa7b241f91" kindref="member">GetConstants</ref>();</highlight></codeline>
<codeline lineno="2930"><highlight class="normal"></highlight></codeline>
<codeline lineno="2931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pMat<sp/>&amp;&amp;<sp/>(!pOffset<sp/>||<sp/>(pOffset[0]==0.0<sp/>&amp;&amp;<sp/>pOffset[1]==0.0<sp/>&amp;&amp;<sp/>pOffset[2]==0.0)))<sp/>{</highlight></codeline>
<codeline lineno="2932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsStepMatrix<sp/>*pStepMtx<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepMatrix(3,<sp/>3);</highlight></codeline>
<codeline lineno="2933"><highlight class="normal"></highlight></codeline>
<codeline lineno="2934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pStepMtx<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(pStepMtx-&gt;entry(0,0),<sp/>pMat,<sp/>9*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="2936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>pStepMtx;</highlight></codeline>
<codeline lineno="2938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2941"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2942"><highlight class="normal"></highlight></codeline>
<codeline lineno="2943"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!ptr.ptr)<sp/>{</highlight></codeline>
<codeline lineno="2944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsStepMpe<sp/>*pStepMpe<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepMpe((<ref refid="d5/d54/a01213" kindref="compound">CIccTagMultiProcessElement</ref>*)pMpe-&gt;<ref refid="d5/d54/a01213_1a87956fe8fd516379d8a450d057f258fb" kindref="member">NewCopy</ref>());</highlight></codeline>
<codeline lineno="2945"><highlight class="normal"></highlight></codeline>
<codeline lineno="2946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pStepMpe)</highlight></codeline>
<codeline lineno="2947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="2948"><highlight class="normal"></highlight></codeline>
<codeline lineno="2949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pStepMpe-&gt;Begin())<sp/>{</highlight></codeline>
<codeline lineno="2950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pStepMpe;</highlight></codeline>
<codeline lineno="2951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9d8efd1c91aa512d46f51cd30a7927f5" kindref="member">icCmmStatBadConnection</ref>;</highlight></codeline>
<codeline lineno="2952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2953"><highlight class="normal"></highlight></codeline>
<codeline lineno="2954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>pStepMpe;</highlight></codeline>
<codeline lineno="2955"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2956"><highlight class="normal"></highlight></codeline>
<codeline lineno="2957"><highlight class="normal"><sp/><sp/><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="2958"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="2959"><highlight class="normal"></highlight></codeline>
<codeline lineno="2960"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pDstPcc-&gt;<ref refid="db/d18/a00885_1a91dc6e895f5fcc5cd924bcdedd5ea0b5" kindref="member">isStandardPcc</ref>())<sp/>{</highlight></codeline>
<codeline lineno="2961"><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="2962"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d5/d54/a01213" kindref="compound">CIccTagMultiProcessElement</ref><sp/>*pMpe<sp/>=<sp/>pDstPcc-&gt;<ref refid="db/d18/a00885_1a16094632a566d2945892046797fac4d9" kindref="member">getStandardToCustomPcc</ref>();</highlight></codeline>
<codeline lineno="2963"><highlight class="normal"></highlight></codeline>
<codeline lineno="2964"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pMpe<sp/>||<sp/>pMpe-&gt;<ref refid="d5/d54/a01213_1a1492a516235fdb066359bb5362efc89a" kindref="member">NumInputChannels</ref>()!=3<sp/>||<sp/>pMpe-&gt;<ref refid="d5/d54/a01213_1a425dfa52f0af074b588df02d283d63f9" kindref="member">NumOutputChannels</ref>()!=3)</highlight></codeline>
<codeline lineno="2965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="2966"><highlight class="normal"></highlight></codeline>
<codeline lineno="2967"><highlight class="normal"><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="2968"><highlight class="normal"></highlight></codeline>
<codeline lineno="2969"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//push<sp/>single<sp/>matrix<sp/>element<sp/>as<sp/>a<sp/>CIccPcsStepMatrix<sp/>so<sp/>it<sp/>can<sp/>be<sp/>optimized</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="2970"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pMpe-&gt;<ref refid="d5/d54/a01213_1a9074a090efc10dd2470ff45594e10a11" kindref="member">NumElements</ref>()==1)<sp/>{</highlight></codeline>
<codeline lineno="2971"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/d43/a01193" kindref="compound">CIccMultiProcessElement</ref><sp/>*pElem<sp/>=<sp/>pMpe-&gt;<ref refid="d5/d54/a01213_1ad49db93f89c409fc5aa3bd646a00beac" kindref="member">GetElement</ref>(0);</highlight></codeline>
<codeline lineno="2972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pElem)<sp/>{</highlight></codeline>
<codeline lineno="2973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pElem-&gt;<ref refid="dd/d43/a01193_1abc48ee629f3d2102bfdd5c03891b37e1" kindref="member">GetType</ref>()==<ref refid="d7/d46/a00002_1a5dbecf663e56b6445a7f199306ee1b4da9f1d5e498c47af2a0e0be3fa029970fe" kindref="member">icSigMatrixElemType</ref>)<sp/>{</highlight></codeline>
<codeline lineno="2974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d0/d82/a00857" kindref="compound">CIccMpeMatrix</ref><sp/>*pMatElem<sp/>=<sp/>(<ref refid="d0/d82/a00857" kindref="compound">CIccMpeMatrix</ref>*)pElem;</highlight></codeline>
<codeline lineno="2975"><highlight class="normal"></highlight></codeline>
<codeline lineno="2976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pMat<sp/>=<sp/>pMatElem-&gt;<ref refid="d0/d82/a00857_1a8caea712089acbdd830b1fa29d10aa8c" kindref="member">GetMatrix</ref>();</highlight></codeline>
<codeline lineno="2977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pOffset<sp/>=<sp/>pMatElem-&gt;<ref refid="d0/d82/a00857_1a02f8ec1722ad1f16f5ea3efa7b241f91" kindref="member">GetConstants</ref>();</highlight></codeline>
<codeline lineno="2978"><highlight class="normal"></highlight></codeline>
<codeline lineno="2979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pMat<sp/>&amp;&amp;<sp/>(!pOffset<sp/>||<sp/>(pOffset[0]==0.0<sp/>&amp;&amp;<sp/>pOffset[1]==0.0<sp/>&amp;&amp;<sp/>pOffset[2]==0.0)))<sp/>{</highlight></codeline>
<codeline lineno="2980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsStepMatrix<sp/>*pStepMtx<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepMatrix(3,<sp/>3);</highlight></codeline>
<codeline lineno="2981"><highlight class="normal"></highlight></codeline>
<codeline lineno="2982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pStepMtx<sp/>)<sp/>{</highlight></codeline>
<codeline lineno="2983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(pStepMtx-&gt;entry(0,0),<sp/>pMat,<sp/>9*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="2984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>pStepMtx;</highlight></codeline>
<codeline lineno="2986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2989"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="2990"><highlight class="normal"></highlight></codeline>
<codeline lineno="2991"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!ptr.ptr)<sp/>{</highlight></codeline>
<codeline lineno="2992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsStepMpe<sp/>*pStepMpe<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepMpe((<ref refid="d5/d54/a01213" kindref="compound">CIccTagMultiProcessElement</ref>*)pMpe-&gt;<ref refid="d5/d54/a01213_1a87956fe8fd516379d8a450d057f258fb" kindref="member">NewCopy</ref>());</highlight></codeline>
<codeline lineno="2993"><highlight class="normal"></highlight></codeline>
<codeline lineno="2994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pStepMpe)</highlight></codeline>
<codeline lineno="2995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="2996"><highlight class="normal"></highlight></codeline>
<codeline lineno="2997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pStepMpe-&gt;Begin())<sp/>{</highlight></codeline>
<codeline lineno="2998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pStepMpe;</highlight></codeline>
<codeline lineno="2999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9d8efd1c91aa512d46f51cd30a7927f5" kindref="member">icCmmStatBadConnection</ref>;</highlight></codeline>
<codeline lineno="3000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3001"><highlight class="normal"></highlight></codeline>
<codeline lineno="3002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>pStepMpe;</highlight></codeline>
<codeline lineno="3003"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3004"><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="3005"><highlight class="normal"><sp/><sp/><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="3006"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3007"><highlight class="normal"></highlight></codeline>
<codeline lineno="3008"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pFromXform-&gt;LuminanceMatching())<sp/>{</highlight></codeline>
<codeline lineno="3009"><highlight class="normal"><sp/><sp/><sp/><sp/>pushXyzToXyzLum(pSrcPcc);</highlight></codeline>
<codeline lineno="3010"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3011"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pToXform-&gt;LuminanceMatching())<sp/>{</highlight></codeline>
<codeline lineno="3012"><highlight class="normal"><sp/><sp/><sp/><sp/>pushXyzLumToXyz(pDstPcc);</highlight></codeline>
<codeline lineno="3013"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3014"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="3015"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="3016"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3017"><highlight class="normal"></highlight></codeline>
<codeline lineno="3018"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushXYZNormalize(<ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>&amp;srcRange,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>&amp;dstRange)</highlight></codeline>
<codeline lineno="3019"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3020"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d8/dbf/a01109" kindref="compound">CIccTagSpectralViewingConditions</ref><sp/>*pView<sp/>=<sp/>pPcc-&gt;<ref refid="db/d18/a00885_1a41d44184a1e66e1f7bd46e60fc69fda6" kindref="member">getPccViewingConditions</ref>();</highlight></codeline>
<codeline lineno="3021"><highlight class="normal"><sp/><sp/>CIccPcsXform<sp/>tmp;</highlight></codeline>
<codeline lineno="3022"><highlight class="normal"></highlight></codeline>
<codeline lineno="3023"><highlight class="normal"><sp/><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>illuminantRange;</highlight></codeline>
<codeline lineno="3024"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*illuminant<sp/>=<sp/>pView-&gt;<ref refid="d8/dbf/a01109_1aa4fe6556022cceea44adf34848528245" kindref="member">getIlluminant</ref>(illuminantRange);</highlight></codeline>
<codeline lineno="3025"><highlight class="normal"></highlight></codeline>
<codeline lineno="3026"><highlight class="normal"><sp/><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>observerRange;</highlight></codeline>
<codeline lineno="3027"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*observer<sp/>=<sp/>pView-&gt;<ref refid="d8/dbf/a01109_1a2319ced95e40cb2493820227f54a302d" kindref="member">getObserver</ref>(observerRange);</highlight></codeline>
<codeline lineno="3028"><highlight class="normal"></highlight></codeline>
<codeline lineno="3029"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//make<sp/>sure<sp/>illuminant<sp/>goes<sp/>through<sp/>identical<sp/>conversion<sp/>steps</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3030"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d7/dce/a00143_1aaa32c9864a601c0a28143886cadb344d" kindref="member">icSameSpectralRange</ref>(srcRange,<sp/>illuminantRange)<sp/>||<sp/>!<ref refid="d7/dce/a00143_1aaa32c9864a601c0a28143886cadb344d" kindref="member">icSameSpectralRange</ref>(dstRange,<sp/>illuminantRange))<sp/>{</highlight></codeline>
<codeline lineno="3031"><highlight class="normal"><sp/><sp/><sp/><sp/>tmp.pushSpecToRange(illuminantRange,<sp/>srcRange);</highlight></codeline>
<codeline lineno="3032"><highlight class="normal"><sp/><sp/><sp/><sp/>tmp.pushSpecToRange(srcRange,<sp/>dstRange);</highlight></codeline>
<codeline lineno="3033"><highlight class="normal"><sp/><sp/><sp/><sp/>tmp.pushSpecToRange(dstRange,<sp/>observerRange);</highlight></codeline>
<codeline lineno="3034"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3035"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3036"><highlight class="normal"><sp/><sp/><sp/><sp/>tmp.pushSpecToRange(illuminantRange,<sp/>observerRange);</highlight></codeline>
<codeline lineno="3037"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3038"><highlight class="normal"><sp/><sp/>tmp.pushMatrix(3,<sp/>observerRange.<ref refid="dd/d72/a00541_1a3cf7d4cc4e63f81e4480198a14bc4fd4" kindref="member">steps</ref>,<sp/>observer);</highlight></codeline>
<codeline lineno="3039"><highlight class="normal"></highlight></codeline>
<codeline lineno="3040"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>stat=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="3041"><highlight class="normal"><sp/><sp/>CIccApplyXform<sp/>*pApply<sp/>=<sp/>tmp.GetNewApply(stat);</highlight></codeline>
<codeline lineno="3042"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApply)<sp/>{</highlight></codeline>
<codeline lineno="3043"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>xyz[3],<sp/>normxyz[3],<sp/>pccxyz[3];</highlight></codeline>
<codeline lineno="3044"><highlight class="normal"></highlight></codeline>
<codeline lineno="3045"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Get<sp/>absolute<sp/>xyz<sp/>for<sp/>illuminant<sp/>and<sp/>observer</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3046"><highlight class="normal"><sp/><sp/><sp/><sp/>tmp.Apply(pApply,<sp/>xyz,<sp/>illuminant);</highlight></codeline>
<codeline lineno="3047"><highlight class="normal"></highlight></codeline>
<codeline lineno="3048"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//calculate<sp/>normalized<sp/>XYZ</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3049"><highlight class="normal"><sp/><sp/><sp/><sp/>normxyz[0]<sp/>=<sp/>xyz[0]<sp/>/<sp/>xyz[1];</highlight></codeline>
<codeline lineno="3050"><highlight class="normal"><sp/><sp/><sp/><sp/>normxyz[1]<sp/>=<sp/>xyz[1]<sp/>/<sp/>xyz[1];</highlight></codeline>
<codeline lineno="3051"><highlight class="normal"><sp/><sp/><sp/><sp/>normxyz[2]<sp/>=<sp/>xyz[2]<sp/>/<sp/>xyz[1];</highlight></codeline>
<codeline lineno="3052"><highlight class="normal"></highlight></codeline>
<codeline lineno="3053"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//get<sp/>desired<sp/>XYZ<sp/>from<sp/>pcc<sp/>(might<sp/>be<sp/>slightly<sp/>different<sp/>from<sp/>calculated<sp/>normxyz)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3054"><highlight class="normal"><sp/><sp/><sp/><sp/>pPcc-&gt;<ref refid="db/d18/a00885_1a9c5c38685ec6a82b97608f5571e303f2" kindref="member">getNormIlluminantXYZ</ref>(pccxyz);</highlight></codeline>
<codeline lineno="3055"><highlight class="normal"></highlight></codeline>
<codeline lineno="3056"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>1</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3057"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//push<sp/>scale<sp/>factor<sp/>to<sp/>normalize<sp/>XYZ<sp/>values<sp/>and<sp/>correct<sp/>for<sp/>difference<sp/>between<sp/>calculated<sp/>and<sp/>desired<sp/>XYZ</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3058"><highlight class="normal"><sp/><sp/><sp/><sp/>pushScale3(pccxyz[0]<sp/>/<sp/>(normxyz[0]<sp/>*<sp/>xyz[1]),<sp/></highlight></codeline>
<codeline lineno="3059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pccxyz[1]<sp/>/<sp/>(normxyz[1]<sp/>*<sp/>xyz[1]),</highlight></codeline>
<codeline lineno="3060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pccxyz[2]<sp/>/<sp/>(normxyz[2]<sp/>*<sp/>xyz[1]));</highlight></codeline>
<codeline lineno="3061"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3062"><highlight class="normal"><sp/><sp/><sp/><sp/>pushScale3(1.0f/xyz[1],<sp/>1.0f/xyz[1],<sp/>1.0f/xyz[1]);</highlight></codeline>
<codeline lineno="3063"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3064"><highlight class="normal"></highlight></codeline>
<codeline lineno="3065"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pApply;</highlight></codeline>
<codeline lineno="3066"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3067"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3068"><highlight class="normal"></highlight></codeline>
<codeline lineno="3079"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushRef2Xyz(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile,<sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc)</highlight></codeline>
<codeline lineno="3080"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3081"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d8/dbf/a01109" kindref="compound">CIccTagSpectralViewingConditions</ref><sp/>*pView<sp/>=<sp/>pPcc-&gt;<ref refid="db/d18/a00885_1a41d44184a1e66e1f7bd46e60fc69fda6" kindref="member">getPccViewingConditions</ref>();</highlight></codeline>
<codeline lineno="3082"><highlight class="normal"></highlight></codeline>
<codeline lineno="3083"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pView)<sp/>{</highlight></codeline>
<codeline lineno="3084"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>illuminantRange;</highlight></codeline>
<codeline lineno="3085"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*illuminant<sp/>=<sp/>pView-&gt;<ref refid="d8/dbf/a01109_1aa4fe6556022cceea44adf34848528245" kindref="member">getIlluminant</ref>(illuminantRange);</highlight></codeline>
<codeline lineno="3086"><highlight class="normal"></highlight></codeline>
<codeline lineno="3087"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>observerRange;</highlight></codeline>
<codeline lineno="3088"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*observer<sp/>=<sp/>pView-&gt;<ref refid="d8/dbf/a01109_1a2319ced95e40cb2493820227f54a302d" kindref="member">getObserver</ref>(observerRange);</highlight></codeline>
<codeline lineno="3089"><highlight class="normal"></highlight></codeline>
<codeline lineno="3090"><highlight class="normal"><sp/><sp/><sp/><sp/>pushSpecToRange(pProfile-&gt;m_Header.spectralRange,<sp/>illuminantRange);</highlight></codeline>
<codeline lineno="3091"><highlight class="normal"><sp/><sp/><sp/><sp/>pushScale(illuminantRange.<ref refid="dd/d72/a00541_1a3cf7d4cc4e63f81e4480198a14bc4fd4" kindref="member">steps</ref>,<sp/>illuminant);</highlight></codeline>
<codeline lineno="3092"><highlight class="normal"><sp/><sp/><sp/><sp/>pushSpecToRange(illuminantRange,<sp/>observerRange);</highlight></codeline>
<codeline lineno="3093"><highlight class="normal"><sp/><sp/><sp/><sp/>pushMatrix(3,<sp/>observerRange.<ref refid="dd/d72/a00541_1a3cf7d4cc4e63f81e4480198a14bc4fd4" kindref="member">steps</ref>,<sp/>observer);</highlight></codeline>
<codeline lineno="3094"><highlight class="normal"></highlight></codeline>
<codeline lineno="3095"><highlight class="normal"><sp/><sp/><sp/><sp/>pushXYZNormalize(pPcc,<sp/>illuminantRange,<sp/>illuminantRange);</highlight></codeline>
<codeline lineno="3096"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3097"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3098"><highlight class="normal"></highlight></codeline>
<codeline lineno="3099"><highlight class="normal"></highlight></codeline>
<codeline lineno="3109"><highlight class="normal">CIccPcsStepMatrix<sp/>*CIccPcsXform::rangeMap(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>&amp;srcRange,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>&amp;dstRange)</highlight></codeline>
<codeline lineno="3110"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3111"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(srcRange.<ref refid="dd/d72/a00541_1a3cf7d4cc4e63f81e4480198a14bc4fd4" kindref="member">steps</ref><sp/>!=<sp/>dstRange.<ref refid="dd/d72/a00541_1a3cf7d4cc4e63f81e4480198a14bc4fd4" kindref="member">steps</ref><sp/>||</highlight></codeline>
<codeline lineno="3112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>srcRange.<ref refid="dd/d72/a00541_1a65d0544793f49b86857f2d54f9897446" kindref="member">start</ref><sp/>!=<sp/>dstRange.<ref refid="dd/d72/a00541_1a65d0544793f49b86857f2d54f9897446" kindref="member">start</ref><sp/>||</highlight></codeline>
<codeline lineno="3113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>srcRange.<ref refid="dd/d72/a00541_1a81f6d2d938687df976c13f1f3c8d4b09" kindref="member">end</ref><sp/>!=<sp/>dstRange.<ref refid="dd/d72/a00541_1a81f6d2d938687df976c13f1f3c8d4b09" kindref="member">end</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3114"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccPcsStepMatrix<sp/>*mtx<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepMatrix(dstRange.<ref refid="dd/d72/a00541_1a3cf7d4cc4e63f81e4480198a14bc4fd4" kindref="member">steps</ref>,<sp/>srcRange.<ref refid="dd/d72/a00541_1a3cf7d4cc4e63f81e4480198a14bc4fd4" kindref="member">steps</ref>);</highlight></codeline>
<codeline lineno="3115"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!mtx-&gt;SetRange(srcRange,<sp/>dstRange))</highlight></codeline>
<codeline lineno="3116"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="3117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>mtx;</highlight></codeline>
<codeline lineno="3118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="3119"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3120"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>mtx;</highlight></codeline>
<codeline lineno="3121"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3122"><highlight class="normal"></highlight></codeline>
<codeline lineno="3123"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="3124"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3125"><highlight class="normal"></highlight></codeline>
<codeline lineno="3126"><highlight class="normal"></highlight></codeline>
<codeline lineno="3136"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushSpecToRange(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>&amp;srcRange,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>&amp;dstRange)</highlight></codeline>
<codeline lineno="3137"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3138"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d7/dce/a00143_1aaa32c9864a601c0a28143886cadb344d" kindref="member">icSameSpectralRange</ref>(srcRange,<sp/>dstRange))<sp/>{</highlight></codeline>
<codeline lineno="3139"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="3140"><highlight class="normal"><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>rangeMap(srcRange,<sp/>dstRange);</highlight></codeline>
<codeline lineno="3141"><highlight class="normal"></highlight></codeline>
<codeline lineno="3142"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ptr.ptr)</highlight></codeline>
<codeline lineno="3143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="3144"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3145"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3146"><highlight class="normal"></highlight></codeline>
<codeline lineno="3147"><highlight class="normal"></highlight></codeline>
<codeline lineno="3159"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushApplyIllum(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile,<sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc)</highlight></codeline>
<codeline lineno="3160"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3161"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d8/dbf/a01109" kindref="compound">CIccTagSpectralViewingConditions</ref><sp/>*pView<sp/>=<sp/>pPcc-&gt;<ref refid="db/d18/a00885_1a41d44184a1e66e1f7bd46e60fc69fda6" kindref="member">getPccViewingConditions</ref>();</highlight></codeline>
<codeline lineno="3162"><highlight class="normal"></highlight></codeline>
<codeline lineno="3163"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pView)<sp/>{</highlight></codeline>
<codeline lineno="3164"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="3165"><highlight class="normal"></highlight></codeline>
<codeline lineno="3166"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>illuminantRange;</highlight></codeline>
<codeline lineno="3167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*illuminant<sp/>=<sp/>pView-&gt;<ref refid="d8/dbf/a01109_1aa4fe6556022cceea44adf34848528245" kindref="member">getIlluminant</ref>(illuminantRange);</highlight></codeline>
<codeline lineno="3168"><highlight class="normal"></highlight></codeline>
<codeline lineno="3169"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccPcsStepScale<sp/>*pScale<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepScale(illuminantRange.<ref refid="dd/d72/a00541_1a3cf7d4cc4e63f81e4480198a14bc4fd4" kindref="member">steps</ref>);</highlight></codeline>
<codeline lineno="3170"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(pScale-&gt;data(),<sp/>illuminant,<sp/>illuminantRange.<ref refid="dd/d72/a00541_1a3cf7d4cc4e63f81e4480198a14bc4fd4" kindref="member">steps</ref>*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="3171"><highlight class="normal"></highlight></codeline>
<codeline lineno="3172"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d7/dce/a00143_1aaa32c9864a601c0a28143886cadb344d" kindref="member">icSameSpectralRange</ref>(pProfile-&gt;m_Header.spectralRange,<sp/>illuminantRange))<sp/>{</highlight></codeline>
<codeline lineno="3173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>pScale;</highlight></codeline>
<codeline lineno="3174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="3175"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/><sp/>=<sp/>rangeMap(pProfile-&gt;m_Header.spectralRange,<sp/>illuminantRange);</highlight></codeline>
<codeline lineno="3178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ptr.ptr)<sp/>{</highlight></codeline>
<codeline lineno="3179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="3180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3181"><highlight class="normal"></highlight></codeline>
<codeline lineno="3182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>pScale;</highlight></codeline>
<codeline lineno="3183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="3184"><highlight class="normal"></highlight></codeline>
<codeline lineno="3185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>rangeMap(illuminantRange,<sp/>pProfile-&gt;m_Header.spectralRange);</highlight></codeline>
<codeline lineno="3186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ptr.ptr)</highlight></codeline>
<codeline lineno="3187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="3188"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3189"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3190"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3191"><highlight class="normal"></highlight></codeline>
<codeline lineno="3192"><highlight class="normal"></highlight></codeline>
<codeline lineno="3203"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::pushRad2Xyz(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref>*<sp/>pProfile,<sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bAbsoluteCIEColorimetry)</highlight></codeline>
<codeline lineno="3204"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3205"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d8/dbf/a01109" kindref="compound">CIccTagSpectralViewingConditions</ref><sp/>*pProfView<sp/>=<sp/>pProfile<sp/>?<sp/>pProfile-&gt;getPccViewingConditions()<sp/>:<sp/>NULL;</highlight></codeline>
<codeline lineno="3206"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d8/dbf/a01109" kindref="compound">CIccTagSpectralViewingConditions</ref><sp/>*pView<sp/>=<sp/>pPcc-&gt;<ref refid="db/d18/a00885_1a41d44184a1e66e1f7bd46e60fc69fda6" kindref="member">getPccViewingConditions</ref>();</highlight></codeline>
<codeline lineno="3207"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfView<sp/>&amp;&amp;<sp/>pView)<sp/>{</highlight></codeline>
<codeline lineno="3208"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>illuminantRange;</highlight></codeline>
<codeline lineno="3209"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*illuminant<sp/>=<sp/>pView-&gt;<ref refid="d8/dbf/a01109_1aa4fe6556022cceea44adf34848528245" kindref="member">getIlluminant</ref>(illuminantRange);</highlight></codeline>
<codeline lineno="3210"><highlight class="normal"></highlight></codeline>
<codeline lineno="3211"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>observerRange;</highlight></codeline>
<codeline lineno="3212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*observer<sp/>=<sp/>pView-&gt;<ref refid="d8/dbf/a01109_1a2319ced95e40cb2493820227f54a302d" kindref="member">getObserver</ref>(observerRange);</highlight></codeline>
<codeline lineno="3213"><highlight class="normal"></highlight></codeline>
<codeline lineno="3214"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Preserve<sp/>smallest<sp/>step<sp/>size</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3215"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>dPCSStepSize<sp/>=<sp/>(<ref refid="d7/dce/a00143_1af29908d138da11b5eb2b6174fb9020e2" kindref="member">icF16toF</ref>(pProfile-&gt;m_Header.spectralRange.end)<sp/>-<sp/><ref refid="d7/dce/a00143_1af29908d138da11b5eb2b6174fb9020e2" kindref="member">icF16toF</ref>(pProfile-&gt;m_Header.spectralRange.start))/(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pProfile-&gt;m_Header.spectralRange.steps;</highlight></codeline>
<codeline lineno="3216"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>dObsStepSize<sp/>=<sp/>(<ref refid="d7/dce/a00143_1af29908d138da11b5eb2b6174fb9020e2" kindref="member">icF16toF</ref>(observerRange.<ref refid="dd/d72/a00541_1a81f6d2d938687df976c13f1f3c8d4b09" kindref="member">end</ref>)<sp/>-<sp/><ref refid="d7/dce/a00143_1af29908d138da11b5eb2b6174fb9020e2" kindref="member">icF16toF</ref>(observerRange.<ref refid="dd/d72/a00541_1a65d0544793f49b86857f2d54f9897446" kindref="member">start</ref>))<sp/>/<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)<sp/>observerRange.<ref refid="dd/d72/a00541_1a3cf7d4cc4e63f81e4480198a14bc4fd4" kindref="member">steps</ref>;</highlight></codeline>
<codeline lineno="3217"><highlight class="normal"></highlight></codeline>
<codeline lineno="3218"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(dPCSStepSize&lt;dObsStepSize)<sp/>{</highlight></codeline>
<codeline lineno="3219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*obs<sp/>=<sp/>pView-&gt;<ref refid="d8/dbf/a01109_1ab70e50510cb2440171a3ba005587adff" kindref="member">applyRangeToObserver</ref>(pProfile-&gt;m_Header.spectralRange);</highlight></codeline>
<codeline lineno="3220"><highlight class="normal"></highlight></codeline>
<codeline lineno="3221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pushMatrix(3,<sp/>pProfile-&gt;m_Header.spectralRange.steps,<sp/>obs);</highlight></codeline>
<codeline lineno="3222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>free(obs);</highlight></codeline>
<codeline lineno="3223"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3224"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pushSpecToRange(pProfile-&gt;m_Header.spectralRange,<sp/>observerRange);</highlight></codeline>
<codeline lineno="3226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pushMatrix(3,<sp/>observerRange.<ref refid="dd/d72/a00541_1a3cf7d4cc4e63f81e4480198a14bc4fd4" kindref="member">steps</ref>,<sp/>observer);</highlight></codeline>
<codeline lineno="3227"><highlight class="normal"></highlight></codeline>
<codeline lineno="3228"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3229"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>k;</highlight></codeline>
<codeline lineno="3230"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bAbsoluteCIEColorimetry)<sp/>{</highlight></codeline>
<codeline lineno="3231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>k<sp/>=<sp/>683;</highlight></codeline>
<codeline lineno="3232"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3233"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>k<sp/>=<sp/>1.0f<sp/>/<sp/>pPcc-&gt;<ref refid="db/d18/a00885_1a81fb6e4ffae390d84145d802702b6d6c" kindref="member">getObserverWhiteScaleFactor</ref>(illuminant,<sp/>illuminantRange);</highlight></codeline>
<codeline lineno="3235"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3236"><highlight class="normal"><sp/><sp/><sp/><sp/>pushScale3(k,<sp/>k,<sp/>k);</highlight></codeline>
<codeline lineno="3237"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3238"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3239"><highlight class="normal"></highlight></codeline>
<codeline lineno="3240"><highlight class="normal"></highlight></codeline>
<codeline lineno="3250"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccPcsXform::pushBiRef2Rad(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile,<sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc)</highlight></codeline>
<codeline lineno="3251"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3252"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d8/dbf/a01109" kindref="compound">CIccTagSpectralViewingConditions</ref><sp/>*pView<sp/>=<sp/>pPcc-&gt;<ref refid="db/d18/a00885_1a41d44184a1e66e1f7bd46e60fc69fda6" kindref="member">getPccViewingConditions</ref>();</highlight></codeline>
<codeline lineno="3253"><highlight class="normal"></highlight></codeline>
<codeline lineno="3254"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pView)<sp/>{</highlight></codeline>
<codeline lineno="3255"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>illuminantRange;</highlight></codeline>
<codeline lineno="3256"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*illuminant<sp/>=<sp/>pView-&gt;<ref refid="d8/dbf/a01109_1aa4fe6556022cceea44adf34848528245" kindref="member">getIlluminant</ref>(illuminantRange);</highlight></codeline>
<codeline lineno="3257"><highlight class="normal"></highlight></codeline>
<codeline lineno="3258"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d7/d46/a00002_1a47e4f847bd0bc609907b5fea4daf3e75" kindref="member">icGetColorSpaceType</ref>(pProfile-&gt;m_Header.spectralPCS)==<ref refid="d7/d46/a00002_1a1b59192d9fcc1aee71b8cc523b4978ca" kindref="member">icSigSparseMatrixSpectralPcsData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="3259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsStepSrcSparseMatrix<sp/>*pMtx<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepSrcSparseMatrix(pProfile-&gt;m_Header.spectralRange.steps,<sp/></highlight></codeline>
<codeline lineno="3260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pProfile-&gt;m_Header.biSpectralRange.steps,</highlight></codeline>
<codeline lineno="3261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)<ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>((<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.spectralPCS));</highlight></codeline>
<codeline lineno="3262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pMtx)</highlight></codeline>
<codeline lineno="3263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="3264"><highlight class="normal"></highlight></codeline>
<codeline lineno="3265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsStepMatrix<sp/>*illumMtx<sp/>=<sp/>rangeMap(illuminantRange,<sp/>pProfile-&gt;m_Header.biSpectralRange);</highlight></codeline>
<codeline lineno="3266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(illumMtx)<sp/>{</highlight></codeline>
<codeline lineno="3267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>illumMtx-&gt;Apply(NULL,<sp/>pMtx-&gt;data(),<sp/>illuminant);</highlight></codeline>
<codeline lineno="3268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>illumMtx;<sp/></highlight></codeline>
<codeline lineno="3269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(pMtx-&gt;data(),<sp/>illuminant,<sp/>illuminantRange.<ref refid="dd/d72/a00541_1a3cf7d4cc4e63f81e4480198a14bc4fd4" kindref="member">steps</ref>*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="3272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3273"><highlight class="normal"></highlight></codeline>
<codeline lineno="3274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="3275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>pMtx;</highlight></codeline>
<codeline lineno="3276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="3277"><highlight class="normal"></highlight></codeline>
<codeline lineno="3278"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsStepSrcMatrix<sp/>*pMtx<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepSrcMatrix(pProfile-&gt;m_Header.spectralRange.steps,<sp/>pProfile-&gt;m_Header.biSpectralRange.steps);</highlight></codeline>
<codeline lineno="3281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pMtx)</highlight></codeline>
<codeline lineno="3282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="3283"><highlight class="normal"></highlight></codeline>
<codeline lineno="3284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsStepMatrix<sp/>*illumMtx<sp/>=<sp/>rangeMap(illuminantRange,<sp/>pProfile-&gt;m_Header.biSpectralRange);</highlight></codeline>
<codeline lineno="3285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(illumMtx)<sp/>{</highlight></codeline>
<codeline lineno="3286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>illumMtx-&gt;Apply(NULL,<sp/>pMtx-&gt;data(),<sp/>illuminant);</highlight></codeline>
<codeline lineno="3287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>illumMtx;<sp/></highlight></codeline>
<codeline lineno="3288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(pMtx-&gt;data(),<sp/>illuminant,<sp/>illuminantRange.<ref refid="dd/d72/a00541_1a3cf7d4cc4e63f81e4480198a14bc4fd4" kindref="member">steps</ref>*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="3291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3292"><highlight class="normal"></highlight></codeline>
<codeline lineno="3293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="3294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>pMtx;</highlight></codeline>
<codeline lineno="3295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="3296"><highlight class="normal"></highlight></codeline>
<codeline lineno="3297"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3298"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3299"><highlight class="normal"></highlight></codeline>
<codeline lineno="3300"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="3301"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3302"><highlight class="normal"></highlight></codeline>
<codeline lineno="3303"><highlight class="normal"></highlight></codeline>
<codeline lineno="3315"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccPcsXform::pushBiRef2Xyz(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile,<sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc)</highlight></codeline>
<codeline lineno="3316"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3317"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>stat<sp/>=<sp/>pushBiRef2Rad(pProfile,<sp/>pPcc);</highlight></codeline>
<codeline lineno="3318"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="3319"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="3320"><highlight class="normal"></highlight></codeline>
<codeline lineno="3321"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d8/dbf/a01109" kindref="compound">CIccTagSpectralViewingConditions</ref><sp/>*pView<sp/>=<sp/>pPcc-&gt;<ref refid="db/d18/a00885_1a41d44184a1e66e1f7bd46e60fc69fda6" kindref="member">getPccViewingConditions</ref>();</highlight></codeline>
<codeline lineno="3322"><highlight class="normal"></highlight></codeline>
<codeline lineno="3323"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pView)<sp/>{</highlight></codeline>
<codeline lineno="3324"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>observerRange;</highlight></codeline>
<codeline lineno="3325"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*observer<sp/>=<sp/>pView-&gt;<ref refid="d8/dbf/a01109_1a2319ced95e40cb2493820227f54a302d" kindref="member">getObserver</ref>(observerRange);</highlight></codeline>
<codeline lineno="3326"><highlight class="normal"></highlight></codeline>
<codeline lineno="3327"><highlight class="normal"><sp/><sp/><sp/><sp/>pushSpecToRange(pProfile-&gt;m_Header.spectralRange,<sp/>observerRange);</highlight></codeline>
<codeline lineno="3328"><highlight class="normal"><sp/><sp/><sp/><sp/>pushMatrix(3,<sp/>observerRange.<ref refid="dd/d72/a00541_1a3cf7d4cc4e63f81e4480198a14bc4fd4" kindref="member">steps</ref>,<sp/>observer);</highlight></codeline>
<codeline lineno="3329"><highlight class="normal"><sp/><sp/><sp/><sp/>pushXYZNormalize(pPcc,<sp/>pProfile-&gt;m_Header.biSpectralRange,<sp/>pProfile-&gt;m_Header.spectralRange);</highlight></codeline>
<codeline lineno="3330"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3331"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3332"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9d8efd1c91aa512d46f51cd30a7927f5" kindref="member">icCmmStatBadConnection</ref>;</highlight></codeline>
<codeline lineno="3333"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3334"><highlight class="normal"></highlight></codeline>
<codeline lineno="3335"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="3336"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3337"><highlight class="normal"></highlight></codeline>
<codeline lineno="3338"><highlight class="normal"></highlight></codeline>
<codeline lineno="3349"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccPcsXform::pushBiRef2Ref(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile,<sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc)</highlight></codeline>
<codeline lineno="3350"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3351"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>stat<sp/>=<sp/>pushBiRef2Rad(pProfile,<sp/>pPcc);</highlight></codeline>
<codeline lineno="3352"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="3353"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="3354"><highlight class="normal"></highlight></codeline>
<codeline lineno="3355"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d8/dbf/a01109" kindref="compound">CIccTagSpectralViewingConditions</ref><sp/>*pView<sp/>=<sp/>pPcc-&gt;<ref refid="db/d18/a00885_1a41d44184a1e66e1f7bd46e60fc69fda6" kindref="member">getPccViewingConditions</ref>();</highlight></codeline>
<codeline lineno="3356"><highlight class="normal"></highlight></codeline>
<codeline lineno="3357"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pView)<sp/>{</highlight></codeline>
<codeline lineno="3358"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>illuminantRange;</highlight></codeline>
<codeline lineno="3359"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*illuminant<sp/>=<sp/>pView-&gt;<ref refid="d8/dbf/a01109_1aa4fe6556022cceea44adf34848528245" kindref="member">getIlluminant</ref>(illuminantRange);</highlight></codeline>
<codeline lineno="3360"><highlight class="normal"></highlight></codeline>
<codeline lineno="3361"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccPcsStepScale<sp/>*pScale<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepScale(pProfile-&gt;m_Header.spectralRange.steps);</highlight></codeline>
<codeline lineno="3362"><highlight class="normal"></highlight></codeline>
<codeline lineno="3363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pScale)<sp/>{</highlight></codeline>
<codeline lineno="3364"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pData<sp/>=<sp/>pScale-&gt;data();</highlight></codeline>
<codeline lineno="3365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsStepMatrix<sp/>*illumMtx<sp/>=<sp/>rangeMap(illuminantRange,<sp/>pProfile-&gt;m_Header.spectralRange);</highlight></codeline>
<codeline lineno="3366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="3367"><highlight class="normal"></highlight></codeline>
<codeline lineno="3368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(illumMtx)<sp/>{</highlight></codeline>
<codeline lineno="3369"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>illumMtx-&gt;Apply(NULL,<sp/>pData,<sp/>illuminant);</highlight></codeline>
<codeline lineno="3370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;pProfile-&gt;m_Header.spectralRange.steps;<sp/>i++)</highlight></codeline>
<codeline lineno="3371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pData[i]<sp/>=<sp/>1.0f<sp/>/<sp/>pData[i];</highlight></codeline>
<codeline lineno="3372"><highlight class="normal"></highlight></codeline>
<codeline lineno="3373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>illumMtx;</highlight></codeline>
<codeline lineno="3374"><highlight class="normal"></highlight></codeline>
<codeline lineno="3375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;pProfile-&gt;m_Header.spectralRange.steps;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="3378"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pData[i]<sp/>=<sp/>1.0f<sp/>/<sp/>illuminant[i];</highlight></codeline>
<codeline lineno="3379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3381"><highlight class="normal"></highlight></codeline>
<codeline lineno="3382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsStepPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="3383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>pScale;</highlight></codeline>
<codeline lineno="3384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_list-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="3385"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3386"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="3388"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3389"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3390"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9d8efd1c91aa512d46f51cd30a7927f5" kindref="member">icCmmStatBadConnection</ref>;</highlight></codeline>
<codeline lineno="3391"><highlight class="normal"></highlight></codeline>
<codeline lineno="3392"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="3393"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3394"><highlight class="normal"></highlight></codeline>
<codeline lineno="3395"><highlight class="normal"></highlight></codeline>
<codeline lineno="3396"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>_DEBUG</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3397"><highlight class="normal"></highlight><highlight class="comment">//#define<sp/>DUMPCSSTEPRESULTS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3398"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DUMPCSSTEPRESULTS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3399"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/>#define<sp/>ICCDUMPPIXEL(n,<sp/>pix)<sp/>\</highlight></codeline>
<codeline lineno="3400"><highlight class="preprocessor"><sp/><sp/>if<sp/>((n)&lt;96)<sp/>{<sp/>\</highlight></codeline>
<codeline lineno="3401"><highlight class="preprocessor"><sp/><sp/><sp/><sp/>printf(&quot;[&quot;);<sp/>\</highlight></codeline>
<codeline lineno="3402"><highlight class="preprocessor"><sp/><sp/><sp/><sp/>int<sp/>i;<sp/>\</highlight></codeline>
<codeline lineno="3403"><highlight class="preprocessor"><sp/><sp/><sp/><sp/>for<sp/>(i=0;<sp/>i&lt;(n);<sp/>i++)<sp/>{<sp/>\</highlight></codeline>
<codeline lineno="3404"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/>if<sp/>(i<sp/>&amp;&amp;<sp/>!(i%12))<sp/>\</highlight></codeline>
<codeline lineno="3405"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(&quot;...\n&quot;);<sp/>\</highlight></codeline>
<codeline lineno="3406"><highlight class="preprocessor"><sp/><sp/><sp/><sp/><sp/><sp/>printf(&quot;<sp/>%.5f&quot;,<sp/>pix[i]);<sp/>\</highlight></codeline>
<codeline lineno="3407"><highlight class="preprocessor"><sp/><sp/><sp/><sp/>}<sp/>\</highlight></codeline>
<codeline lineno="3408"><highlight class="preprocessor"><sp/><sp/><sp/><sp/>printf(&quot;]\n&quot;);<sp/>\</highlight></codeline>
<codeline lineno="3409"><highlight class="preprocessor"><sp/><sp/>}<sp/>\</highlight></codeline>
<codeline lineno="3410"><highlight class="preprocessor"><sp/><sp/>else<sp/>{<sp/>\</highlight></codeline>
<codeline lineno="3411"><highlight class="preprocessor"><sp/><sp/><sp/><sp/>printf(&quot;[<sp/>BigAray<sp/>with<sp/>%d<sp/>elements]\n&quot;,<sp/>(n));<sp/>\</highlight></codeline>
<codeline lineno="3412"><highlight class="preprocessor"><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3413"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3414"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/>#define<sp/>ICCDUMPPIXEL(n,<sp/>pix)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3415"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3416"><highlight class="normal"></highlight><highlight class="preprocessor">#else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3417" refid="d3/df8/a00155_1abb796a32bb9b930ceb2efcbb87f4a909" refkind="member"><highlight class="normal"></highlight><highlight class="preprocessor"><sp/><sp/>#define<sp/>ICCDUMPPIXEL(n,<sp/>pix)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3418"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3419"><highlight class="normal"></highlight></codeline>
<codeline lineno="3420"><highlight class="normal"></highlight></codeline>
<codeline lineno="3429"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsXform::Apply(CIccApplyXform<sp/>*pXform,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3430"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3431"><highlight class="normal"><sp/><sp/>CIccApplyPcsXform<sp/>*pApplyXform<sp/>=<sp/>(CIccApplyPcsXform*)pXform;</highlight></codeline>
<codeline lineno="3432"><highlight class="normal"><sp/><sp/>CIccApplyPcsStepList<sp/>*pList<sp/>=<sp/>pApplyXform-&gt;m_list;</highlight></codeline>
<codeline lineno="3433"><highlight class="normal"></highlight></codeline>
<codeline lineno="3434"><highlight class="normal"><sp/><sp/><ref refid="d3/df8/a00155_1abb796a32bb9b930ceb2efcbb87f4a909" kindref="member">ICCDUMPPIXEL</ref>(GetNumSrcSamples(),<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="3435"><highlight class="normal"></highlight></codeline>
<codeline lineno="3436"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pList)<sp/>{</highlight></codeline>
<codeline lineno="3437"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(DstPixel,<sp/>SrcPixel,<sp/>GetNumSrcSamples()*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="3438"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d3/df8/a00155_1abb796a32bb9b930ceb2efcbb87f4a909" kindref="member">ICCDUMPPIXEL</ref>(GetNumSrcSamples(),<sp/>DstPixel);</highlight></codeline>
<codeline lineno="3439"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3440"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3441"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="3442"><highlight class="normal"><sp/><sp/>CIccApplyPcsStepList::iterator<sp/>s,<sp/>n;</highlight></codeline>
<codeline lineno="3443"><highlight class="normal"><sp/><sp/>s<sp/>=<sp/>n<sp/>=pList-&gt;begin();</highlight></codeline>
<codeline lineno="3444"><highlight class="normal"></highlight></codeline>
<codeline lineno="3445"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(s==pList-&gt;end())<sp/>{</highlight></codeline>
<codeline lineno="3446"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(DstPixel,<sp/>SrcPixel,<sp/>GetNumSrcSamples()*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="3447"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d3/df8/a00155_1abb796a32bb9b930ceb2efcbb87f4a909" kindref="member">ICCDUMPPIXEL</ref>(GetNumSrcSamples(),<sp/>DstPixel);</highlight></codeline>
<codeline lineno="3448"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3449"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3450"><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="3451"><highlight class="normal"><sp/><sp/>n++;</highlight></codeline>
<codeline lineno="3452"><highlight class="normal"></highlight></codeline>
<codeline lineno="3453"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n==pList-&gt;end())<sp/>{</highlight></codeline>
<codeline lineno="3454"><highlight class="normal"><sp/><sp/><sp/><sp/>s-&gt;ptr-&gt;Apply(DstPixel,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="3455"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d3/df8/a00155_1abb796a32bb9b930ceb2efcbb87f4a909" kindref="member">ICCDUMPPIXEL</ref>(s-&gt;ptr-&gt;GetStep()-&gt;GetDstChannels(),<sp/>DstPixel);</highlight></codeline>
<codeline lineno="3456"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3457"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3458"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*src<sp/>=<sp/>SrcPixel;</highlight></codeline>
<codeline lineno="3459"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*p1<sp/>=<sp/>pApplyXform-&gt;m_temp1;</highlight></codeline>
<codeline lineno="3460"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*p2<sp/>=<sp/>pApplyXform-&gt;m_temp2;</highlight></codeline>
<codeline lineno="3461"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*t;</highlight></codeline>
<codeline lineno="3462"><highlight class="normal"></highlight></codeline>
<codeline lineno="3463"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;n!=pList-&gt;end();<sp/>s=n,<sp/>n++)<sp/>{</highlight></codeline>
<codeline lineno="3464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>s-&gt;ptr-&gt;Apply(p1,<sp/>src);</highlight></codeline>
<codeline lineno="3465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d3/df8/a00155_1abb796a32bb9b930ceb2efcbb87f4a909" kindref="member">ICCDUMPPIXEL</ref>(s-&gt;ptr-&gt;GetStep()-&gt;GetDstChannels(),<sp/>p1);</highlight></codeline>
<codeline lineno="3466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>src=p1;</highlight></codeline>
<codeline lineno="3467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>t=p1;<sp/>p1=p2;<sp/>p2=t;</highlight></codeline>
<codeline lineno="3468"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3469"><highlight class="normal"><sp/><sp/><sp/><sp/>s-&gt;ptr-&gt;Apply(DstPixel,<sp/>src);</highlight></codeline>
<codeline lineno="3470"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d3/df8/a00155_1abb796a32bb9b930ceb2efcbb87f4a909" kindref="member">ICCDUMPPIXEL</ref>(s-&gt;ptr-&gt;GetStep()-&gt;GetDstChannels(),<sp/>DstPixel);</highlight></codeline>
<codeline lineno="3471"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3472"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3473"><highlight class="normal"></highlight></codeline>
<codeline lineno="3482"><highlight class="normal">CIccApplyPcsStep*<sp/>CIccPcsStep::GetNewApply()</highlight></codeline>
<codeline lineno="3483"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3484"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccApplyPcsStep(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="3485"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3486"><highlight class="normal"></highlight></codeline>
<codeline lineno="3487"><highlight class="normal"></highlight></codeline>
<codeline lineno="3496"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepIdentity::Apply(CIccApplyPcsStep<sp/>*pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3497"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3498"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pDst<sp/>!=<sp/>pSrc)</highlight></codeline>
<codeline lineno="3499"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(pDst,<sp/>pSrc,<sp/>m_nChannels*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="3500"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3501"><highlight class="normal"></highlight></codeline>
<codeline lineno="3502"><highlight class="normal"></highlight></codeline>
<codeline lineno="3511"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepIdentity::dump(std::string<sp/>&amp;str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3512"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3513"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepIdentity\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3514"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3515"><highlight class="normal"></highlight></codeline>
<codeline lineno="3516"><highlight class="normal"></highlight></codeline>
<codeline lineno="3525"><highlight class="normal">CIccPcsStepRouteMcs::CIccPcsStepRouteMcs(<ref refid="db/de0/a00465" kindref="compound">CIccTagArray</ref><sp/>*pSrcChannels,<sp/><ref refid="db/de0/a00465" kindref="compound">CIccTagArray</ref><sp/>*pDstChannels,<sp/><ref refid="d0/daa/a01029" kindref="compound">CIccTagNumArray</ref><sp/>*pDefaults)</highlight></codeline>
<codeline lineno="3526"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3527"><highlight class="normal"><sp/><sp/>m_nSrcChannels<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)pSrcChannels-&gt;<ref refid="db/de0/a00465_1ad89262b326c7dde5b444599ed6d862e7" kindref="member">GetSize</ref>();</highlight></codeline>
<codeline lineno="3528"><highlight class="normal"><sp/><sp/>m_nDstChannels<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)pDstChannels-&gt;<ref refid="db/de0/a00465_1ad89262b326c7dde5b444599ed6d862e7" kindref="member">GetSize</ref>();</highlight></codeline>
<codeline lineno="3529"><highlight class="normal"><sp/><sp/>m_Index<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">[m_nDstChannels];</highlight></codeline>
<codeline lineno="3530"><highlight class="normal"><sp/><sp/>m_Defaults<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>[m_nDstChannels];</highlight></codeline>
<codeline lineno="3531"><highlight class="normal"></highlight></codeline>
<codeline lineno="3532"><highlight class="normal"><sp/><sp/>memset(m_Defaults,<sp/>0,<sp/>m_nDstChannels*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="3533"><highlight class="normal"></highlight></codeline>
<codeline lineno="3534"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pDefaults)<sp/>{</highlight></codeline>
<codeline lineno="3535"><highlight class="normal"><sp/><sp/><sp/><sp/>pDefaults-&gt;<ref refid="d0/daa/a01029_1a2c8e9e09f0916181fc93e0d5ce1817d8" kindref="member">GetValues</ref>(m_Defaults,<sp/>0,<sp/>m_nDstChannels);</highlight></codeline>
<codeline lineno="3536"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3537"><highlight class="normal"></highlight></codeline>
<codeline lineno="3538"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>j;</highlight></codeline>
<codeline lineno="3539"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>*szSrc;</highlight></codeline>
<codeline lineno="3540"><highlight class="normal"></highlight></codeline>
<codeline lineno="3541"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nDstChannels;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="3542"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a11ef650eb30d34d4f469f2c5db79aa50" kindref="member">icUChar</ref><sp/>*szDstChan<sp/>=<sp/>((<ref refid="dd/d24/a00981" kindref="compound">CIccTagUtf8Text</ref>*)(pDstChannels-&gt;<ref refid="db/de0/a00465_1ac30ff943da70f26a654f2e9d39c0e568" kindref="member">GetIndex</ref>(i)))-&gt;GetText();</highlight></codeline>
<codeline lineno="3543"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j=0;<sp/>j&lt;m_nSrcChannels;<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="3544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a11ef650eb30d34d4f469f2c5db79aa50" kindref="member">icUChar</ref><sp/>*szSrcChan<sp/>=<sp/>((<ref refid="dd/d24/a00981" kindref="compound">CIccTagUtf8Text</ref>*)(pSrcChannels-&gt;<ref refid="db/de0/a00465_1ac30ff943da70f26a654f2e9d39c0e568" kindref="member">GetIndex</ref>(j)))-&gt;GetText();</highlight></codeline>
<codeline lineno="3545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>szSrc<sp/>=<sp/>(</highlight><highlight class="keywordtype">char</highlight><highlight class="normal">*)szSrcChan;</highlight></codeline>
<codeline lineno="3546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d7/dce/a00143_1ae716aa59d818f8dda39c5a4245061336" kindref="member">icUtf8StrCmp</ref>(szDstChan,<sp/>szSrcChan))</highlight></codeline>
<codeline lineno="3547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3548"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3549"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j==m_nSrcChannels)<sp/>{</highlight></codeline>
<codeline lineno="3550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_Index[i]<sp/>=<sp/>-1;</highlight></codeline>
<codeline lineno="3551"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3552"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_Index[i]<sp/>=<sp/>j;</highlight></codeline>
<codeline lineno="3554"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3555"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//printf(&quot;%d<sp/>-<sp/>%d<sp/>%s\n&quot;,<sp/>m_Index[i],<sp/>i,<sp/>szDstChan);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3556"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3557"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3558"><highlight class="normal"></highlight></codeline>
<codeline lineno="3559"><highlight class="normal"></highlight></codeline>
<codeline lineno="3568"><highlight class="normal">CIccPcsStepRouteMcs::~CIccPcsStepRouteMcs()</highlight></codeline>
<codeline lineno="3569"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3570"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Index)</highlight></codeline>
<codeline lineno="3571"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>[]<sp/>m_Index;</highlight></codeline>
<codeline lineno="3572"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Defaults)</highlight></codeline>
<codeline lineno="3573"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>[]<sp/>m_Defaults;</highlight></codeline>
<codeline lineno="3574"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3575"><highlight class="normal"></highlight></codeline>
<codeline lineno="3576"><highlight class="normal"></highlight></codeline>
<codeline lineno="3585"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccPcsStepRouteMcs::isIdentity()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3586"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3587"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nSrcChannels!=m_nDstChannels)</highlight></codeline>
<codeline lineno="3588"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3589"><highlight class="normal"></highlight></codeline>
<codeline lineno="3590"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="3591"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nDstChannels;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="3592"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Index[i]!=i)</highlight></codeline>
<codeline lineno="3593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3594"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3595"><highlight class="normal"></highlight></codeline>
<codeline lineno="3596"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3597"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3598"><highlight class="normal"></highlight></codeline>
<codeline lineno="3599"><highlight class="normal"></highlight></codeline>
<codeline lineno="3600"><highlight class="normal"></highlight></codeline>
<codeline lineno="3609"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepRouteMcs::Apply(CIccApplyPcsStep<sp/>*pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3610"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3611"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pDst<sp/>!=<sp/>pSrc)<sp/>{</highlight></codeline>
<codeline lineno="3612"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="3613"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nDstChannels;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="3614"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Index[i]&gt;=0)</highlight></codeline>
<codeline lineno="3615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pDst[i]<sp/>=<sp/>pSrc[m_Index[i]];</highlight></codeline>
<codeline lineno="3616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pDst[i]<sp/>=<sp/>m_Defaults[i];</highlight></codeline>
<codeline lineno="3618"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3619"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3620"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3621"><highlight class="normal"></highlight></codeline>
<codeline lineno="3622"><highlight class="normal"></highlight></codeline>
<codeline lineno="3631"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepRouteMcs::dump(std::string<sp/>&amp;str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3632"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3633"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepRouteMcs\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3634"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3635"><highlight class="normal"></highlight></codeline>
<codeline lineno="3636"><highlight class="normal"></highlight><highlight class="keyword">extern</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/><ref refid="d3/df8/a00155_1a961f0b709819f36204e7da4148c1505e" kindref="member">icD50XYZ</ref>[3];</highlight></codeline>
<codeline lineno="3637"><highlight class="normal"></highlight></codeline>
<codeline lineno="3646"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccPcsLabStep::isSameWhite(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*xyzWhite)</highlight></codeline>
<codeline lineno="3647"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3648"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(m_xyzWhite[0]==xyzWhite[0]<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="3649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_xyzWhite[1]==xyzWhite[1]<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="3650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_xyzWhite[2]==xyzWhite[2]);</highlight></codeline>
<codeline lineno="3651"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3652"><highlight class="normal"></highlight></codeline>
<codeline lineno="3653"><highlight class="normal"></highlight></codeline>
<codeline lineno="3654"><highlight class="normal"></highlight></codeline>
<codeline lineno="3663"><highlight class="normal">CIccPcsStepLabToXYZ::CIccPcsStepLabToXYZ(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*xyzWhite</highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3664"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3665"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(xyzWhite)<sp/>{</highlight></codeline>
<codeline lineno="3666"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(m_xyzWhite,<sp/>xyzWhite,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(m_xyzWhite));</highlight></codeline>
<codeline lineno="3667"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3668"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3669"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(m_xyzWhite,<sp/><ref refid="d3/df8/a00155_1a961f0b709819f36204e7da4148c1505e" kindref="member">icD50XYZ</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(m_xyzWhite));</highlight></codeline>
<codeline lineno="3670"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3671"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3672"><highlight class="normal"></highlight></codeline>
<codeline lineno="3673"><highlight class="normal"></highlight></codeline>
<codeline lineno="3682"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepLabToXYZ::Apply(CIccApplyPcsStep<sp/>*pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3683"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3684"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>Lab[3];</highlight></codeline>
<codeline lineno="3685"><highlight class="normal"></highlight></codeline>
<codeline lineno="3686"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//lab4<sp/>to<sp/>XYZ</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3687"><highlight class="normal"><sp/><sp/>Lab[0]<sp/>=<sp/>pSrc[0]<sp/>*<sp/>100.0f;</highlight></codeline>
<codeline lineno="3688"><highlight class="normal"><sp/><sp/>Lab[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pSrc[1]*255.0f<sp/>-<sp/>128.0f);</highlight></codeline>
<codeline lineno="3689"><highlight class="normal"><sp/><sp/>Lab[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pSrc[2]*255.0f<sp/>-<sp/>128.0f);</highlight></codeline>
<codeline lineno="3690"><highlight class="normal"></highlight></codeline>
<codeline lineno="3691"><highlight class="normal"><sp/><sp/><ref refid="d7/dce/a00143_1aaf617b49cf0d56a218cd52c840228705" kindref="member">icLabtoXYZ</ref>(pDst,<sp/>Lab,<sp/>m_xyzWhite);</highlight></codeline>
<codeline lineno="3692"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3693"><highlight class="normal"></highlight></codeline>
<codeline lineno="3694"><highlight class="normal"></highlight></codeline>
<codeline lineno="3703"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepLabToXYZ::dump(std::string<sp/>&amp;str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3704"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3705"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepLabToXYZ\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3706"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3707"><highlight class="normal"></highlight></codeline>
<codeline lineno="3708"><highlight class="normal"></highlight></codeline>
<codeline lineno="3719"><highlight class="normal">CIccPcsStep<sp/>*CIccPcsStepLabToXYZ::concat(CIccPcsStep<sp/>*pNext)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3720"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3721"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext)<sp/>{</highlight></codeline>
<codeline lineno="3722"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext-&gt;GetType()<sp/>==<sp/>icPcsStepXYZToLab)<sp/>{</highlight></codeline>
<codeline lineno="3723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsLabStep*<sp/>pStep<sp/>=<sp/>(CIccPcsLabStep*)pNext;</highlight></codeline>
<codeline lineno="3724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pStep-&gt;isSameWhite(m_xyzWhite))</highlight></codeline>
<codeline lineno="3725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepIdentity(3);</highlight></codeline>
<codeline lineno="3726"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3727"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext-&gt;GetType()<sp/>==<sp/>icPcsStepXYZToLab2)<sp/>{</highlight></codeline>
<codeline lineno="3728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsLabStep*<sp/>pStep<sp/>=<sp/>(CIccPcsLabStep*)pNext;</highlight></codeline>
<codeline lineno="3729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pStep-&gt;isSameWhite(m_xyzWhite))</highlight></codeline>
<codeline lineno="3730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepLabToLab2();</highlight></codeline>
<codeline lineno="3731"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3732"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3733"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="3734"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3735"><highlight class="normal"></highlight></codeline>
<codeline lineno="3736"><highlight class="normal"></highlight></codeline>
<codeline lineno="3745"><highlight class="normal">CIccPcsStepXYZToLab::CIccPcsStepXYZToLab(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*xyzWhite</highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3746"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3747"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(xyzWhite)<sp/>{</highlight></codeline>
<codeline lineno="3748"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(m_xyzWhite,<sp/>xyzWhite,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(m_xyzWhite));</highlight></codeline>
<codeline lineno="3749"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3750"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3751"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(m_xyzWhite,<sp/><ref refid="d3/df8/a00155_1a961f0b709819f36204e7da4148c1505e" kindref="member">icD50XYZ</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(m_xyzWhite));</highlight></codeline>
<codeline lineno="3752"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3753"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3754"><highlight class="normal"></highlight></codeline>
<codeline lineno="3755"><highlight class="normal"></highlight></codeline>
<codeline lineno="3764"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepXYZToLab::Apply(CIccApplyPcsStep<sp/>*pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3765"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3766"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>Lab[3];</highlight></codeline>
<codeline lineno="3767"><highlight class="normal"><sp/><sp/><ref refid="d7/dce/a00143_1a4ff45349385af6c19d5b3f68150a27b5" kindref="member">icXYZtoLab</ref>(Lab,<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*)pSrc,<sp/>m_xyzWhite);</highlight></codeline>
<codeline lineno="3768"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//lab4<sp/>from<sp/>XYZ</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3769"><highlight class="normal"><sp/><sp/>pDst[0]<sp/>=<sp/>Lab[0]<sp/>/<sp/>100.0f;</highlight></codeline>
<codeline lineno="3770"><highlight class="normal"><sp/><sp/>pDst[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((Lab[1]<sp/>+<sp/>128.0f)<sp/>/<sp/>255.0f);</highlight></codeline>
<codeline lineno="3771"><highlight class="normal"><sp/><sp/>pDst[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((Lab[2]<sp/>+<sp/>128.0f)<sp/>/<sp/>255.0f);</highlight></codeline>
<codeline lineno="3772"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3773"><highlight class="normal"></highlight></codeline>
<codeline lineno="3774"><highlight class="normal"></highlight></codeline>
<codeline lineno="3783"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepXYZToLab::dump(std::string<sp/>&amp;str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3784"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3785"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepXYZToLab\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3786"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3787"><highlight class="normal"></highlight></codeline>
<codeline lineno="3788"><highlight class="normal"></highlight></codeline>
<codeline lineno="3799"><highlight class="normal">CIccPcsStep<sp/>*CIccPcsStepXYZToLab::concat(CIccPcsStep<sp/>*pNext)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3800"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3801"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext<sp/>&amp;&amp;<sp/>pNext-&gt;GetType()==icPcsStepLabToXYZ)<sp/>{</highlight></codeline>
<codeline lineno="3802"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccPcsLabStep<sp/>*pStep<sp/>=<sp/>(CIccPcsLabStep<sp/>*)pNext;</highlight></codeline>
<codeline lineno="3803"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pStep-&gt;isSameWhite(m_xyzWhite))</highlight></codeline>
<codeline lineno="3804"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepIdentity(3);</highlight></codeline>
<codeline lineno="3805"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3806"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="3807"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3808"><highlight class="normal"></highlight></codeline>
<codeline lineno="3809"><highlight class="normal"></highlight></codeline>
<codeline lineno="3818"><highlight class="normal">CIccPcsStepLab2ToXYZ::CIccPcsStepLab2ToXYZ(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*xyzWhite</highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3819"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3820"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(xyzWhite)<sp/>{</highlight></codeline>
<codeline lineno="3821"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(m_xyzWhite,<sp/>xyzWhite,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(m_xyzWhite));</highlight></codeline>
<codeline lineno="3822"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3823"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3824"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(m_xyzWhite,<sp/><ref refid="d3/df8/a00155_1a961f0b709819f36204e7da4148c1505e" kindref="member">icD50XYZ</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(m_xyzWhite));</highlight></codeline>
<codeline lineno="3825"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3826"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3827"><highlight class="normal"></highlight></codeline>
<codeline lineno="3836"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepLab2ToXYZ::Apply(CIccApplyPcsStep<sp/>*pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3837"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3838"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>Lab[3];</highlight></codeline>
<codeline lineno="3839"><highlight class="normal"></highlight></codeline>
<codeline lineno="3840"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//lab2<sp/>to<sp/>XYZ</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3841"><highlight class="normal"><sp/><sp/>Lab[0]<sp/>=<sp/>pSrc[0]<sp/>*<sp/>(65535.0f<sp/>/<sp/>65280.0f)<sp/>*<sp/>100.0f;</highlight></codeline>
<codeline lineno="3842"><highlight class="normal"><sp/><sp/>Lab[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pSrc[1]<sp/>*<sp/>65535.0f<sp/>/<sp/>65280.0f<sp/>*<sp/>255.0f<sp/>-<sp/>128.0f);</highlight></codeline>
<codeline lineno="3843"><highlight class="normal"><sp/><sp/>Lab[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pSrc[2]<sp/>*<sp/>65535.0f<sp/>/<sp/>65280.0f<sp/>*<sp/>255.0f<sp/>-<sp/>128.0f);</highlight></codeline>
<codeline lineno="3844"><highlight class="normal"></highlight></codeline>
<codeline lineno="3845"><highlight class="normal"><sp/><sp/><ref refid="d7/dce/a00143_1aaf617b49cf0d56a218cd52c840228705" kindref="member">icLabtoXYZ</ref>(pDst,<sp/>Lab,<sp/>m_xyzWhite);</highlight></codeline>
<codeline lineno="3846"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3847"><highlight class="normal"></highlight></codeline>
<codeline lineno="3848"><highlight class="normal"></highlight></codeline>
<codeline lineno="3857"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepLab2ToXYZ::dump(std::string<sp/>&amp;str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3858"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3859"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepLab2ToXYZ\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3860"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3861"><highlight class="normal"></highlight></codeline>
<codeline lineno="3862"><highlight class="normal"></highlight></codeline>
<codeline lineno="3873"><highlight class="normal">CIccPcsStep<sp/>*CIccPcsStepLab2ToXYZ::concat(CIccPcsStep<sp/>*pNext)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3874"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3875"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext)<sp/>{</highlight></codeline>
<codeline lineno="3876"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext-&gt;GetType()<sp/>==<sp/>icPcsStepXYZToLab2)<sp/>{</highlight></codeline>
<codeline lineno="3877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsLabStep*<sp/>pStep<sp/>=<sp/>(CIccPcsLabStep*)pNext;</highlight></codeline>
<codeline lineno="3878"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pStep-&gt;isSameWhite(m_xyzWhite))</highlight></codeline>
<codeline lineno="3879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepIdentity(3);</highlight></codeline>
<codeline lineno="3880"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3881"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext-&gt;GetType()<sp/>==<sp/>icPcsStepXYZToLab)<sp/>{</highlight></codeline>
<codeline lineno="3882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsLabStep*<sp/>pStep<sp/>=<sp/>(CIccPcsLabStep*)pNext;</highlight></codeline>
<codeline lineno="3883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pStep-&gt;isSameWhite(m_xyzWhite))</highlight></codeline>
<codeline lineno="3884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepLab2ToLab();</highlight></codeline>
<codeline lineno="3885"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="3886"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3887"><highlight class="normal"></highlight></codeline>
<codeline lineno="3888"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="3889"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3890"><highlight class="normal"></highlight></codeline>
<codeline lineno="3891"><highlight class="normal"></highlight></codeline>
<codeline lineno="3900"><highlight class="normal">CIccPcsStepXYZToLab2::CIccPcsStepXYZToLab2(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*xyzWhite</highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="3901"><highlight class="normal">{</highlight></codeline>
<codeline lineno="3902"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(xyzWhite)<sp/>{</highlight></codeline>
<codeline lineno="3903"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(m_xyzWhite,<sp/>xyzWhite,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(m_xyzWhite));</highlight></codeline>
<codeline lineno="3904"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3905"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="3906"><highlight class="normal"><sp/><sp/><sp/><sp/>memcpy(m_xyzWhite,<sp/><ref refid="d3/df8/a00155_1a961f0b709819f36204e7da4148c1505e" kindref="member">icD50XYZ</ref>,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(m_xyzWhite));</highlight></codeline>
<codeline lineno="3907"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3908"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3909"><highlight class="normal"></highlight></codeline>
<codeline lineno="3910"><highlight class="normal"></highlight></codeline>
<codeline lineno="3919"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepXYZToLab2::Apply(CIccApplyPcsStep<sp/>*pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3920"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3921"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>Lab[3];</highlight></codeline>
<codeline lineno="3922"><highlight class="normal"><sp/><sp/><ref refid="d7/dce/a00143_1a4ff45349385af6c19d5b3f68150a27b5" kindref="member">icXYZtoLab</ref>(Lab,<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*)pSrc,<sp/>m_xyzWhite);</highlight></codeline>
<codeline lineno="3923"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//lab2<sp/>from<sp/>XYZ</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="3924"><highlight class="normal"><sp/><sp/>pDst[0]<sp/>=<sp/>(Lab[0]<sp/>/<sp/>100.0f)<sp/>*<sp/>(65280.0f<sp/>/<sp/>65535.0f);</highlight></codeline>
<codeline lineno="3925"><highlight class="normal"><sp/><sp/>pDst[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((Lab[1]<sp/>+<sp/>128.0f)<sp/>/<sp/>255.0f)<sp/>*<sp/>(65280.0f<sp/>/<sp/>65535.0f);</highlight></codeline>
<codeline lineno="3926"><highlight class="normal"><sp/><sp/>pDst[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((Lab[2]<sp/>+<sp/>128.0f)<sp/>/<sp/>255.0f)<sp/>*<sp/>(65280.0f<sp/>/<sp/>65535.0f);</highlight></codeline>
<codeline lineno="3927"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3928"><highlight class="normal"></highlight></codeline>
<codeline lineno="3929"><highlight class="normal"></highlight></codeline>
<codeline lineno="3938"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepXYZToLab2::dump(std::string<sp/>&amp;str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3939"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3940"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepXYZToLab2\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3941"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3942"><highlight class="normal"></highlight></codeline>
<codeline lineno="3943"><highlight class="normal"></highlight></codeline>
<codeline lineno="3954"><highlight class="normal">CIccPcsStep<sp/>*CIccPcsStepXYZToLab2::concat(CIccPcsStep<sp/>*pNext)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3955"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3956"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext<sp/>&amp;&amp;<sp/>pNext-&gt;GetType()==icPcsStepLab2ToXYZ)<sp/>{</highlight></codeline>
<codeline lineno="3957"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccPcsLabStep<sp/>*pStep<sp/>=<sp/>(CIccPcsLabStep<sp/>*)pNext;</highlight></codeline>
<codeline lineno="3958"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pStep-&gt;isSameWhite(m_xyzWhite))</highlight></codeline>
<codeline lineno="3959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepIdentity(3);</highlight></codeline>
<codeline lineno="3960"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="3961"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="3962"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3963"><highlight class="normal"></highlight></codeline>
<codeline lineno="3964"><highlight class="normal"></highlight></codeline>
<codeline lineno="3973"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepLabToLab2::Apply(CIccApplyPcsStep*<sp/>pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*<sp/>pDst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*<sp/>pSrc)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3974"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3975"><highlight class="normal"><sp/><sp/>pDst[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pSrc[0]<sp/>*<sp/>65280.0f<sp/>/<sp/>65535.0f);</highlight></codeline>
<codeline lineno="3976"><highlight class="normal"><sp/><sp/>pDst[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pSrc[1]<sp/>*<sp/>65280.0f<sp/>/<sp/>65535.0f);</highlight></codeline>
<codeline lineno="3977"><highlight class="normal"><sp/><sp/>pDst[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pSrc[2]<sp/>*<sp/>65280.0f<sp/>/<sp/>65535.0f);</highlight></codeline>
<codeline lineno="3978"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3979"><highlight class="normal"></highlight></codeline>
<codeline lineno="3980"><highlight class="normal"></highlight></codeline>
<codeline lineno="3989"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepLabToLab2::dump(std::string&amp;<sp/>str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="3990"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="3991"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepLabToLab2\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="3992"><highlight class="normal">}</highlight></codeline>
<codeline lineno="3993"><highlight class="normal"></highlight></codeline>
<codeline lineno="4004"><highlight class="normal">CIccPcsStep*<sp/>CIccPcsStepLabToLab2::concat(CIccPcsStep*<sp/>pNext)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4005"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4006"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext<sp/>&amp;&amp;<sp/>pNext-&gt;GetType()<sp/>==<sp/>icPcsStepLab2ToLab)<sp/>{</highlight></codeline>
<codeline lineno="4007"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepIdentity(3);</highlight></codeline>
<codeline lineno="4008"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4009"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="4010"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4011"><highlight class="normal"></highlight></codeline>
<codeline lineno="4012"><highlight class="normal"></highlight></codeline>
<codeline lineno="4021"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepLab2ToLab::Apply(CIccApplyPcsStep*<sp/>pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*<sp/>pDst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*<sp/>pSrc)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4022"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4023"><highlight class="normal"><sp/><sp/>pDst[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pSrc[0]<sp/>*<sp/>65535.0f<sp/>/<sp/>65280.0f);</highlight></codeline>
<codeline lineno="4024"><highlight class="normal"><sp/><sp/>pDst[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pSrc[1]<sp/>*<sp/>65535.0f<sp/>/<sp/>65280.0f);</highlight></codeline>
<codeline lineno="4025"><highlight class="normal"><sp/><sp/>pDst[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pSrc[2]<sp/>*<sp/>65535.0f<sp/>/<sp/>65280.0f);</highlight></codeline>
<codeline lineno="4026"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4027"><highlight class="normal"></highlight></codeline>
<codeline lineno="4028"><highlight class="normal"></highlight></codeline>
<codeline lineno="4037"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepLab2ToLab::dump(std::string&amp;<sp/>str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4038"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4039"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepLab2ToLab\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4040"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4041"><highlight class="normal"></highlight></codeline>
<codeline lineno="4042"><highlight class="normal"></highlight></codeline>
<codeline lineno="4053"><highlight class="normal">CIccPcsStep*<sp/>CIccPcsStepLab2ToLab::concat(CIccPcsStep*<sp/>pNext)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4054"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4055"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext<sp/>&amp;&amp;<sp/>pNext-&gt;GetType()<sp/>==<sp/>icPcsStepLabToLab2)<sp/>{</highlight></codeline>
<codeline lineno="4056"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepIdentity(3);</highlight></codeline>
<codeline lineno="4057"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4058"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="4059"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4060"><highlight class="normal"></highlight></codeline>
<codeline lineno="4061"><highlight class="normal"></highlight></codeline>
<codeline lineno="4070"><highlight class="normal">CIccPcsStepOffset::CIccPcsStepOffset(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nChannels)</highlight></codeline>
<codeline lineno="4071"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4072"><highlight class="normal"><sp/><sp/>m_nChannels<sp/>=<sp/>nChannels;</highlight></codeline>
<codeline lineno="4073"><highlight class="normal"><sp/><sp/>m_vals<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>[nChannels];</highlight></codeline>
<codeline lineno="4074"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4075"><highlight class="normal"></highlight></codeline>
<codeline lineno="4076"><highlight class="normal"></highlight></codeline>
<codeline lineno="4085"><highlight class="normal">CIccPcsStepOffset::~CIccPcsStepOffset()</highlight></codeline>
<codeline lineno="4086"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4087"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_vals)</highlight></codeline>
<codeline lineno="4088"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>[]<sp/>m_vals;</highlight></codeline>
<codeline lineno="4089"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4090"><highlight class="normal"></highlight></codeline>
<codeline lineno="4091"><highlight class="normal"></highlight></codeline>
<codeline lineno="4100"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepOffset::Apply(CIccApplyPcsStep<sp/>*pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4101"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4102"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nChannels==3)<sp/>{</highlight></codeline>
<codeline lineno="4103"><highlight class="normal"><sp/><sp/><sp/><sp/>pDst[0]<sp/>=<sp/>m_vals[0]<sp/>+<sp/>pSrc[0];</highlight></codeline>
<codeline lineno="4104"><highlight class="normal"><sp/><sp/><sp/><sp/>pDst[1]<sp/>=<sp/>m_vals[1]<sp/>+<sp/>pSrc[1];</highlight></codeline>
<codeline lineno="4105"><highlight class="normal"><sp/><sp/><sp/><sp/>pDst[2]<sp/>=<sp/>m_vals[2]<sp/>+<sp/>pSrc[2];</highlight></codeline>
<codeline lineno="4106"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4107"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4108"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="4109"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nChannels;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pDst[i]<sp/>=<sp/>m_vals[i]<sp/>+<sp/>pSrc[i];</highlight></codeline>
<codeline lineno="4111"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4112"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4113"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4114"><highlight class="normal"></highlight></codeline>
<codeline lineno="4115"><highlight class="normal"></highlight></codeline>
<codeline lineno="4124"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepOffset::dump(std::string<sp/>&amp;str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4125"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4126"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepOffset\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4127"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>buf[80];</highlight></codeline>
<codeline lineno="4128"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;m_nChannels;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4129"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(buf,<sp/><ref refid="d3/df8/a00155_1a09ef76f73cd16ef7b7c77358b527e816" kindref="member">ICCPCSSTEPDUMPFMT</ref>,<sp/>m_vals[i]);</highlight></codeline>
<codeline lineno="4130"><highlight class="normal"><sp/><sp/><sp/><sp/>str<sp/>+=<sp/>buf;</highlight></codeline>
<codeline lineno="4131"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4132"><highlight class="normal"><sp/><sp/>str<sp/>+=</highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4133"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4134"><highlight class="normal"></highlight></codeline>
<codeline lineno="4135"><highlight class="normal"></highlight></codeline>
<codeline lineno="4145"><highlight class="normal">CIccPcsStepOffset<sp/>*CIccPcsStepOffset::Add(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccPcsStepOffset<sp/>*offset)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4146"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4147"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(offset-&gt;m_nChannels<sp/>!=<sp/>m_nChannels)</highlight></codeline>
<codeline lineno="4148"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="4149"><highlight class="normal"></highlight></codeline>
<codeline lineno="4150"><highlight class="normal"><sp/><sp/>CIccPcsStepOffset<sp/>*pNew<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepOffset(m_nChannels);</highlight></codeline>
<codeline lineno="4151"><highlight class="normal"></highlight></codeline>
<codeline lineno="4152"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNew)<sp/>{</highlight></codeline>
<codeline lineno="4153"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="4154"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nChannels;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pNew-&gt;m_vals[i]<sp/>=<sp/>m_vals[i]<sp/>+<sp/>offset-&gt;m_vals[i];<sp/></highlight></codeline>
<codeline lineno="4156"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4157"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4158"><highlight class="normal"></highlight></codeline>
<codeline lineno="4159"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pNew;</highlight></codeline>
<codeline lineno="4160"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4161"><highlight class="normal"></highlight></codeline>
<codeline lineno="4172"><highlight class="normal">CIccPcsStep<sp/>*CIccPcsStepOffset::concat(CIccPcsStep<sp/>*pNext)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4173"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4174"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext<sp/>&amp;&amp;<sp/>pNext-&gt;GetType()==icPcsStepOffset<sp/>&amp;&amp;<sp/>m_nChannels==pNext-&gt;GetSrcChannels())</highlight></codeline>
<codeline lineno="4175"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Add((</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccPcsStepOffset*)pNext);</highlight></codeline>
<codeline lineno="4176"><highlight class="normal"></highlight></codeline>
<codeline lineno="4177"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="4178"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4179"><highlight class="normal"></highlight></codeline>
<codeline lineno="4180"><highlight class="normal"></highlight></codeline>
<codeline lineno="4189"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccPcsStepOffset::isIdentity()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4190"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4191"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="4192"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nChannels;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4193"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_vals[i]&lt;-<ref refid="dc/dfe/a00125_1aa35e9dfb9d4807cbd014d00681934905" kindref="member">icNearRange</ref><sp/>||<sp/>m_vals[i]&gt;<ref refid="dc/dfe/a00125_1aa35e9dfb9d4807cbd014d00681934905" kindref="member">icNearRange</ref>)</highlight></codeline>
<codeline lineno="4194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4195"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4196"><highlight class="normal"></highlight></codeline>
<codeline lineno="4197"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4198"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4199"><highlight class="normal"></highlight></codeline>
<codeline lineno="4200"><highlight class="normal"></highlight></codeline>
<codeline lineno="4209"><highlight class="normal">CIccPcsStepScale::CIccPcsStepScale(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nChannels)</highlight></codeline>
<codeline lineno="4210"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4211"><highlight class="normal"><sp/><sp/>m_nChannels<sp/>=<sp/>nChannels;</highlight></codeline>
<codeline lineno="4212"><highlight class="normal"><sp/><sp/>m_vals<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>[nChannels];</highlight></codeline>
<codeline lineno="4213"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4214"><highlight class="normal"></highlight></codeline>
<codeline lineno="4215"><highlight class="normal"></highlight></codeline>
<codeline lineno="4224"><highlight class="normal">CIccPcsStepScale::~CIccPcsStepScale()</highlight></codeline>
<codeline lineno="4225"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4226"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_vals)</highlight></codeline>
<codeline lineno="4227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>[]<sp/>m_vals;</highlight></codeline>
<codeline lineno="4228"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4229"><highlight class="normal"></highlight></codeline>
<codeline lineno="4238"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepScale::Apply(CIccApplyPcsStep<sp/>*pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4239"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4240"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nChannels==3)<sp/>{</highlight></codeline>
<codeline lineno="4241"><highlight class="normal"><sp/><sp/><sp/><sp/>pDst[0]<sp/>=<sp/>m_vals[0]<sp/>*<sp/>pSrc[0];</highlight></codeline>
<codeline lineno="4242"><highlight class="normal"><sp/><sp/><sp/><sp/>pDst[1]<sp/>=<sp/>m_vals[1]<sp/>*<sp/>pSrc[1];</highlight></codeline>
<codeline lineno="4243"><highlight class="normal"><sp/><sp/><sp/><sp/>pDst[2]<sp/>=<sp/>m_vals[2]<sp/>*<sp/>pSrc[2];</highlight></codeline>
<codeline lineno="4244"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4245"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4246"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="4247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nChannels;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pDst[i]<sp/>=<sp/>m_vals[i]<sp/>*<sp/>pSrc[i];</highlight></codeline>
<codeline lineno="4249"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4250"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4251"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4252"><highlight class="normal"></highlight></codeline>
<codeline lineno="4253"><highlight class="normal"></highlight></codeline>
<codeline lineno="4262"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepScale::dump(std::string<sp/>&amp;str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4263"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4264"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepScale\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4265"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>buf[80];</highlight></codeline>
<codeline lineno="4266"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;m_nChannels;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4267"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(buf,<sp/><ref refid="d3/df8/a00155_1a09ef76f73cd16ef7b7c77358b527e816" kindref="member">ICCPCSSTEPDUMPFMT</ref>,<sp/>m_vals[i]);</highlight></codeline>
<codeline lineno="4268"><highlight class="normal"><sp/><sp/><sp/><sp/>str<sp/>+=<sp/>buf;</highlight></codeline>
<codeline lineno="4269"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4270"><highlight class="normal"><sp/><sp/>str<sp/>+=</highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4271"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4272"><highlight class="normal"></highlight></codeline>
<codeline lineno="4273"><highlight class="normal"></highlight></codeline>
<codeline lineno="4283"><highlight class="normal">CIccPcsStepScale<sp/>*CIccPcsStepScale::Mult(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccPcsStepScale<sp/>*scale)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4284"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4285"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(scale-&gt;m_nChannels<sp/>!=<sp/>m_nChannels)</highlight></codeline>
<codeline lineno="4286"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="4287"><highlight class="normal"></highlight></codeline>
<codeline lineno="4288"><highlight class="normal"><sp/><sp/>CIccPcsStepScale<sp/>*pNew<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepScale(m_nChannels);</highlight></codeline>
<codeline lineno="4289"><highlight class="normal"></highlight></codeline>
<codeline lineno="4290"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNew)<sp/>{</highlight></codeline>
<codeline lineno="4291"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="4292"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nChannels;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pNew-&gt;m_vals[i]<sp/>=<sp/>m_vals[i]<sp/>*<sp/>scale-&gt;m_vals[i];<sp/></highlight></codeline>
<codeline lineno="4294"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4295"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4296"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pNew;</highlight></codeline>
<codeline lineno="4297"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4298"><highlight class="normal"></highlight></codeline>
<codeline lineno="4308"><highlight class="normal">CIccPcsStepMatrix<sp/>*CIccPcsStepScale::Mult(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccPcsStepMatrix<sp/>*matrix)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4309"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4310"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(matrix-&gt;GetSrcChannels()<sp/>!=<sp/>m_nChannels)</highlight></codeline>
<codeline lineno="4311"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="4312"><highlight class="normal"></highlight></codeline>
<codeline lineno="4313"><highlight class="normal"><sp/><sp/>CIccPcsStepMatrix<sp/>*pNew<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepMatrix(matrix-&gt;GetDstChannels(),<sp/>matrix-&gt;GetSrcChannels());</highlight></codeline>
<codeline lineno="4314"><highlight class="normal"></highlight></codeline>
<codeline lineno="4315"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNew)<sp/>{</highlight></codeline>
<codeline lineno="4316"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>j;</highlight></codeline>
<codeline lineno="4317"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j=0;<sp/>j&lt;matrix-&gt;GetDstChannels();<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="4318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*row<sp/>=<sp/>matrix-&gt;entry(j);</highlight></codeline>
<codeline lineno="4319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*to=pNew-&gt;entry(j);</highlight></codeline>
<codeline lineno="4320"><highlight class="normal"></highlight></codeline>
<codeline lineno="4321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nChannels;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to[i]<sp/>=<sp/>m_vals[i]<sp/>*<sp/>row[i];<sp/></highlight></codeline>
<codeline lineno="4323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4324"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4325"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4326"><highlight class="normal"></highlight></codeline>
<codeline lineno="4327"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pNew;</highlight></codeline>
<codeline lineno="4328"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4329"><highlight class="normal"></highlight></codeline>
<codeline lineno="4339"><highlight class="normal">CIccPcsStepMatrix<sp/>*CIccPcsStepScale::Mult(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d0/d82/a00857" kindref="compound">CIccMpeMatrix</ref><sp/>*matrix)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4340"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4341"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(matrix-&gt;<ref refid="dd/d43/a01193_1a0e7393d937cb768d52265a7ebed2b3a9" kindref="member">NumInputChannels</ref>()<sp/>!=<sp/>m_nChannels)</highlight></codeline>
<codeline lineno="4342"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="4343"><highlight class="normal"></highlight></codeline>
<codeline lineno="4344"><highlight class="normal"><sp/><sp/>CIccPcsStepMatrix<sp/>*pNew<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepMatrix(matrix-&gt;<ref refid="dd/d43/a01193_1a431d2d96c834f4f9b0674dafe8609ae1" kindref="member">NumOutputChannels</ref>(),<sp/>matrix-&gt;<ref refid="dd/d43/a01193_1a0e7393d937cb768d52265a7ebed2b3a9" kindref="member">NumInputChannels</ref>());</highlight></codeline>
<codeline lineno="4345"><highlight class="normal"></highlight></codeline>
<codeline lineno="4346"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNew)<sp/>{</highlight></codeline>
<codeline lineno="4347"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>j;</highlight></codeline>
<codeline lineno="4348"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*mtx<sp/>=<sp/>matrix-&gt;<ref refid="d0/d82/a00857_1a8caea712089acbdd830b1fa29d10aa8c" kindref="member">GetMatrix</ref>();</highlight></codeline>
<codeline lineno="4349"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j<sp/>=<sp/>0;<sp/>j<sp/>&lt;<sp/>matrix-&gt;<ref refid="dd/d43/a01193_1a431d2d96c834f4f9b0674dafe8609ae1" kindref="member">NumOutputChannels</ref>();<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="4350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*row<sp/>=<sp/>&amp;mtx[j*matrix-&gt;<ref refid="dd/d43/a01193_1a0e7393d937cb768d52265a7ebed2b3a9" kindref="member">NumInputChannels</ref>()];</highlight></codeline>
<codeline lineno="4351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*to<sp/>=<sp/>pNew-&gt;entry(j);</highlight></codeline>
<codeline lineno="4352"><highlight class="normal"></highlight></codeline>
<codeline lineno="4353"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>m_nChannels;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>to[i]<sp/>=<sp/>m_vals[i]<sp/>*<sp/>row[i];</highlight></codeline>
<codeline lineno="4355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4356"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4357"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4358"><highlight class="normal"></highlight></codeline>
<codeline lineno="4359"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pNew;</highlight></codeline>
<codeline lineno="4360"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4361"><highlight class="normal"></highlight></codeline>
<codeline lineno="4362"><highlight class="normal"></highlight></codeline>
<codeline lineno="4373"><highlight class="normal">CIccPcsStep<sp/>*CIccPcsStepScale::concat(CIccPcsStep<sp/>*pNext)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4374"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4375"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext)<sp/>{</highlight></codeline>
<codeline lineno="4376"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext-&gt;GetType()==icPcsStepScale<sp/>&amp;&amp;<sp/>m_nChannels==pNext-&gt;GetSrcChannels())</highlight></codeline>
<codeline lineno="4377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Mult((</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccPcsStepScale*)pNext);</highlight></codeline>
<codeline lineno="4378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext-&gt;GetType()==icPcsStepMatrix<sp/>&amp;&amp;<sp/>m_nChannels==pNext-&gt;GetSrcChannels())</highlight></codeline>
<codeline lineno="4379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Mult((</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccPcsStepMatrix*)pNext);</highlight></codeline>
<codeline lineno="4380"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext-&gt;GetType()<sp/>==<sp/>icPcsStepMpe<sp/>&amp;&amp;<sp/>m_nChannels<sp/>==<sp/>pNext-&gt;GetSrcChannels())<sp/>{</highlight></codeline>
<codeline lineno="4381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsStepMpe<sp/>*pMpe<sp/>=<sp/>(CIccPcsStepMpe*)pNext;</highlight></codeline>
<codeline lineno="4382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d0/d82/a00857" kindref="compound">CIccMpeMatrix</ref><sp/>*pMatrix<sp/>=<sp/>pMpe-&gt;<ref refid="d0/d82/a00857_1a8caea712089acbdd830b1fa29d10aa8c" kindref="member">GetMatrix</ref>();</highlight></codeline>
<codeline lineno="4383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pMatrix)</highlight></codeline>
<codeline lineno="4384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Mult(pMatrix);</highlight></codeline>
<codeline lineno="4385"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4386"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4387"><highlight class="normal"></highlight></codeline>
<codeline lineno="4388"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="4389"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4390"><highlight class="normal"></highlight></codeline>
<codeline lineno="4391"><highlight class="normal"></highlight></codeline>
<codeline lineno="4400"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccPcsStepScale::isIdentity()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4401"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4402"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="4403"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nChannels;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4404"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_vals[i]&lt;1.0f-<ref refid="dc/dfe/a00125_1aa35e9dfb9d4807cbd014d00681934905" kindref="member">icNearRange</ref><sp/>||<sp/>m_vals[i]&gt;1.0f+<ref refid="dc/dfe/a00125_1aa35e9dfb9d4807cbd014d00681934905" kindref="member">icNearRange</ref>)</highlight></codeline>
<codeline lineno="4405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4406"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4407"><highlight class="normal"></highlight></codeline>
<codeline lineno="4408"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4409"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4410"><highlight class="normal"></highlight></codeline>
<codeline lineno="4411"><highlight class="normal"></highlight></codeline>
<codeline lineno="4412"><highlight class="normal"></highlight></codeline>
<codeline lineno="4421"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepMatrix::dump(std::string<sp/>&amp;str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4422"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4423"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepMatrix\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4424"><highlight class="normal"><sp/><sp/>dumpMtx(str);</highlight></codeline>
<codeline lineno="4425"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4426"><highlight class="normal"></highlight></codeline>
<codeline lineno="4427"><highlight class="normal"></highlight></codeline>
<codeline lineno="4437"><highlight class="normal">CIccPcsStepMatrix<sp/>*CIccPcsStepMatrix::Mult(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccPcsStepScale<sp/>*scale)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4438"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4439"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>mCols<sp/>=<sp/>scale-&gt;GetSrcChannels();</highlight></codeline>
<codeline lineno="4440"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>mRows<sp/>=<sp/>mCols;</highlight></codeline>
<codeline lineno="4441"><highlight class="normal"></highlight></codeline>
<codeline lineno="4442"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nRows<sp/>!=<sp/>mCols)</highlight></codeline>
<codeline lineno="4443"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="4444"><highlight class="normal"></highlight></codeline>
<codeline lineno="4445"><highlight class="normal"><sp/><sp/>CIccPcsStepMatrix<sp/>*pNew<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepMatrix(m_nRows,<sp/>m_nCols);</highlight></codeline>
<codeline lineno="4446"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*data<sp/>=<sp/>scale-&gt;data();</highlight></codeline>
<codeline lineno="4447"><highlight class="normal"></highlight></codeline>
<codeline lineno="4448"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>j;</highlight></codeline>
<codeline lineno="4449"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j=0;<sp/>j&lt;m_nRows;<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="4450"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*row<sp/>=<sp/>entry(j);</highlight></codeline>
<codeline lineno="4451"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*to<sp/>=<sp/>pNew-&gt;entry(j);</highlight></codeline>
<codeline lineno="4452"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nCols;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>to[i]<sp/>=<sp/>data[j]<sp/>*<sp/>row[i];</highlight></codeline>
<codeline lineno="4454"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4455"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4456"><highlight class="normal"></highlight></codeline>
<codeline lineno="4457"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pNew;</highlight></codeline>
<codeline lineno="4458"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4459"><highlight class="normal"></highlight></codeline>
<codeline lineno="4469"><highlight class="normal">CIccPcsStepMatrix<sp/>*CIccPcsStepMatrix::Mult(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccPcsStepMatrix<sp/>*matrix)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4470"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4471"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>mCols<sp/>=<sp/>matrix-&gt;m_nCols;</highlight></codeline>
<codeline lineno="4472"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>mRows<sp/>=<sp/>matrix-&gt;m_nRows;</highlight></codeline>
<codeline lineno="4473"><highlight class="normal"></highlight></codeline>
<codeline lineno="4474"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nRows<sp/>!=<sp/>mCols)</highlight></codeline>
<codeline lineno="4475"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="4476"><highlight class="normal"></highlight></codeline>
<codeline lineno="4477"><highlight class="normal"><sp/><sp/>CIccPcsStepMatrix<sp/>*pNew<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepMatrix(mRows,<sp/>m_nCols);</highlight></codeline>
<codeline lineno="4478"><highlight class="normal"></highlight></codeline>
<codeline lineno="4479"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>j,<sp/>k;</highlight></codeline>
<codeline lineno="4480"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j=0;<sp/>j&lt;mRows;<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="4481"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*row<sp/>=<sp/>matrix-&gt;entry(j);</highlight></codeline>
<codeline lineno="4482"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nCols;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*to<sp/>=<sp/>pNew-&gt;entry(j,<sp/>i);</highlight></codeline>
<codeline lineno="4484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*from<sp/>=<sp/>entry(0,<sp/>i);</highlight></codeline>
<codeline lineno="4485"><highlight class="normal"></highlight></codeline>
<codeline lineno="4486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>*to<sp/>=<sp/>0.0f;</highlight></codeline>
<codeline lineno="4487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(k=0;<sp/>k&lt;m_nRows;<sp/>k++)<sp/>{</highlight></codeline>
<codeline lineno="4488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>*to<sp/>+=<sp/>row[k]<sp/>*<sp/>(*from);</highlight></codeline>
<codeline lineno="4489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>from<sp/>+=<sp/>m_nCols;</highlight></codeline>
<codeline lineno="4490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4491"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4492"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4493"><highlight class="normal"></highlight></codeline>
<codeline lineno="4494"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pNew;</highlight></codeline>
<codeline lineno="4495"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4496"><highlight class="normal"></highlight></codeline>
<codeline lineno="4497"><highlight class="normal"></highlight></codeline>
<codeline lineno="4508"><highlight class="normal">CIccPcsStep<sp/>*CIccPcsStepMatrix::concat(CIccPcsStep<sp/>*pNext)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4509"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4510"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext)<sp/>{</highlight></codeline>
<codeline lineno="4511"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext-&gt;GetType()==icPcsStepScale<sp/>&amp;&amp;<sp/>GetDstChannels()==pNext-&gt;GetSrcChannels())</highlight></codeline>
<codeline lineno="4512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Mult((</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccPcsStepScale*)pNext);</highlight></codeline>
<codeline lineno="4513"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNext-&gt;GetType()==icPcsStepMatrix<sp/>&amp;&amp;<sp/>GetDstChannels()==pNext-&gt;GetSrcChannels())</highlight></codeline>
<codeline lineno="4514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Mult((</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccPcsStepMatrix*)pNext);</highlight></codeline>
<codeline lineno="4515"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4516"><highlight class="normal"></highlight></codeline>
<codeline lineno="4517"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="4518"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4519"><highlight class="normal"></highlight></codeline>
<codeline lineno="4530"><highlight class="normal">CIccPcsStep<sp/>*CIccPcsStepMatrix::reduce()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4531"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4532"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nVals<sp/>=<sp/>m_nRows*m_nCols;</highlight></codeline>
<codeline lineno="4533"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nNonZeros<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="4534"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="4535"><highlight class="normal"></highlight></codeline>
<codeline lineno="4536"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;nVals;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4537"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>v<sp/>=<sp/>m_vals[i];</highlight></codeline>
<codeline lineno="4538"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d7/dce/a00143_1af798ee3250b2d1add99b57064aaf1961" kindref="member">icNotZero</ref>(v))</highlight></codeline>
<codeline lineno="4539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nNonZeros++;</highlight></codeline>
<codeline lineno="4540"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4541"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nNonZeros&lt;nVals*3/4)<sp/>{</highlight></codeline>
<codeline lineno="4542"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>nMatrixBytes<sp/>=<sp/><ref refid="d6/dad/a00941_1a966b1ee488c4648da2c84b4484e7ff4a" kindref="member">CIccSparseMatrix::MemSize</ref>(nNonZeros,<sp/>m_nRows,<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>))+4*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>);</highlight></codeline>
<codeline lineno="4543"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccPcsStepSparseMatrix<sp/>*pMtx<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsStepSparseMatrix(m_nRows,<sp/>m_nCols,<sp/>nMatrixBytes);</highlight></codeline>
<codeline lineno="4544"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d6/dad/a00941" kindref="compound">CIccSparseMatrix</ref><sp/>mtx(pMtx-&gt;data(),<sp/>nMatrixBytes);</highlight></codeline>
<codeline lineno="4545"><highlight class="normal"><sp/><sp/><sp/><sp/>mtx.Init(m_nRows,<sp/>m_nCols,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="4546"><highlight class="normal"><sp/><sp/><sp/><sp/>mtx.FillFromFullMatrix(m_vals);</highlight></codeline>
<codeline lineno="4547"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pMtx;</highlight></codeline>
<codeline lineno="4548"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4549"><highlight class="normal"></highlight></codeline>
<codeline lineno="4550"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(CIccPcsStep*)</highlight><highlight class="keyword">this</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4551"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4552"><highlight class="normal"></highlight></codeline>
<codeline lineno="4553"><highlight class="normal"></highlight></codeline>
<codeline lineno="4554"><highlight class="normal"></highlight></codeline>
<codeline lineno="4563"><highlight class="normal">CIccPcsStepMpe::CIccPcsStepMpe(<ref refid="d5/d54/a01213" kindref="compound">CIccTagMultiProcessElement</ref><sp/>*pMpe)</highlight></codeline>
<codeline lineno="4564"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4565"><highlight class="normal"><sp/><sp/>m_pMpe<sp/>=<sp/>pMpe;</highlight></codeline>
<codeline lineno="4566"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4567"><highlight class="normal"></highlight></codeline>
<codeline lineno="4568"><highlight class="normal"></highlight></codeline>
<codeline lineno="4577"><highlight class="normal">CIccPcsStepMpe::~CIccPcsStepMpe()</highlight></codeline>
<codeline lineno="4578"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4579"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pMpe)</highlight></codeline>
<codeline lineno="4580"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_pMpe;</highlight></codeline>
<codeline lineno="4581"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4582"><highlight class="normal"></highlight></codeline>
<codeline lineno="4583"><highlight class="normal"></highlight></codeline>
<codeline lineno="4592"><highlight class="normal">CIccApplyPcsStep*<sp/>CIccPcsStepMpe::GetNewApply()</highlight></codeline>
<codeline lineno="4593"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4594"><highlight class="normal"><sp/><sp/>CIccApplyPcsStepMpe<sp/>*rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccApplyPcsStepMpe(</highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>m_pMpe-&gt;GetNewApply());</highlight></codeline>
<codeline lineno="4595"><highlight class="normal"></highlight></codeline>
<codeline lineno="4596"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="4597"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4598"><highlight class="normal"></highlight></codeline>
<codeline lineno="4599"><highlight class="normal"></highlight></codeline>
<codeline lineno="4608"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepMpe::Apply(CIccApplyPcsStep<sp/>*pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4609"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4610"><highlight class="normal"><sp/><sp/>CIccApplyPcsStepMpe<sp/>*pMpeApply<sp/>=<sp/>(CIccApplyPcsStepMpe*)pApply;</highlight></codeline>
<codeline lineno="4611"><highlight class="normal"></highlight></codeline>
<codeline lineno="4612"><highlight class="normal"><sp/><sp/>m_pMpe-&gt;Apply(pMpeApply-&gt;m_pApply,<sp/>pDst,<sp/>pSrc);</highlight></codeline>
<codeline lineno="4613"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4614"><highlight class="normal"></highlight></codeline>
<codeline lineno="4615"><highlight class="normal"></highlight></codeline>
<codeline lineno="4624"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepMpe::dump(std::string<sp/>&amp;str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4625"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4626"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepMpe\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4627"><highlight class="normal"><sp/><sp/>m_pMpe-&gt;Describe(str,<sp/>100);<sp/></highlight><highlight class="comment">//<sp/>TODO<sp/>propogate<sp/>nVerboseness<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4628"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4629"><highlight class="normal"></highlight></codeline>
<codeline lineno="4630"><highlight class="normal"></highlight></codeline>
<codeline lineno="4639"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccPcsStepMpe::isIdentity()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4640"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4641"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pMpe<sp/>||<sp/>!m_pMpe-&gt;NumElements())</highlight></codeline>
<codeline lineno="4642"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4643"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4644"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4645"><highlight class="normal"></highlight></codeline>
<codeline lineno="4655"><highlight class="normal"><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>CIccPcsStepMpe::GetSrcChannels()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4656"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4657"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_pMpe-&gt;NumInputChannels();</highlight></codeline>
<codeline lineno="4658"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4659"><highlight class="normal"></highlight></codeline>
<codeline lineno="4660"><highlight class="normal"></highlight></codeline>
<codeline lineno="4670"><highlight class="normal"><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>CIccPcsStepMpe::GetDstChannels()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4671"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4672"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_pMpe-&gt;NumOutputChannels();</highlight></codeline>
<codeline lineno="4673"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4674"><highlight class="normal"></highlight></codeline>
<codeline lineno="4675"><highlight class="normal"></highlight></codeline>
<codeline lineno="4685"><highlight class="normal"><ref refid="d0/d82/a00857" kindref="compound">CIccMpeMatrix</ref><sp/>*CIccPcsStepMpe::GetMatrix()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4686"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4687"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Must<sp/>be<sp/>single<sp/>element</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4688"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pMpe-&gt;NumElements()<sp/>==<sp/>1)<sp/>{</highlight></codeline>
<codeline lineno="4689"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/d43/a01193" kindref="compound">CIccMultiProcessElement</ref><sp/>*pElem<sp/>=<sp/>m_pMpe-&gt;GetElement(0);</highlight></codeline>
<codeline lineno="4690"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Must<sp/>be<sp/>a<sp/>matrix</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4691"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pElem<sp/>&amp;&amp;<sp/>pElem-&gt;<ref refid="dd/d43/a01193_1abc48ee629f3d2102bfdd5c03891b37e1" kindref="member">GetType</ref>()<sp/>==<sp/><ref refid="d7/d46/a00002_1a5dbecf663e56b6445a7f199306ee1b4da9f1d5e498c47af2a0e0be3fa029970fe" kindref="member">icSigMatrixElemType</ref>)<sp/>{</highlight></codeline>
<codeline lineno="4692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d0/d82/a00857" kindref="compound">CIccMpeMatrix</ref><sp/>*pMtx<sp/>=<sp/>(<ref refid="d0/d82/a00857" kindref="compound">CIccMpeMatrix</ref>*)pElem;</highlight></codeline>
<codeline lineno="4693"><highlight class="normal"></highlight></codeline>
<codeline lineno="4694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Should<sp/>not<sp/>apply<sp/>any<sp/>constants</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pMtx-&gt;<ref refid="d0/d82/a00857_1a02f8ec1722ad1f16f5ea3efa7b241f91" kindref="member">GetConstants</ref>()<sp/>||<sp/>!pMtx-&gt;<ref refid="d0/d82/a00857_1adbf9791bb07086c6e6770d1914817663" kindref="member">GetApplyConstants</ref>())</highlight></codeline>
<codeline lineno="4696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pMtx;</highlight></codeline>
<codeline lineno="4697"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4698"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4699"><highlight class="normal"></highlight></codeline>
<codeline lineno="4700"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="4701"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4702"><highlight class="normal"></highlight></codeline>
<codeline lineno="4703"><highlight class="normal"></highlight></codeline>
<codeline lineno="4704"><highlight class="normal"></highlight></codeline>
<codeline lineno="4705"><highlight class="normal"></highlight></codeline>
<codeline lineno="4715"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccPcsStepMpe::Begin()</highlight></codeline>
<codeline lineno="4716"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4717"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_pMpe-&gt;<ref refid="d0/d82/a00857_1a6e45463a693a93771269d03b6c5ccd53" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="4718"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4719"><highlight class="normal"></highlight></codeline>
<codeline lineno="4720"><highlight class="normal"></highlight></codeline>
<codeline lineno="4729"><highlight class="normal">CIccPcsStepSrcMatrix::CIccPcsStepSrcMatrix(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nRows,<sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nCols)</highlight></codeline>
<codeline lineno="4730"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4731"><highlight class="normal"><sp/><sp/>m_nRows<sp/>=<sp/>nRows;</highlight></codeline>
<codeline lineno="4732"><highlight class="normal"><sp/><sp/>m_nCols<sp/>=<sp/>nCols;</highlight></codeline>
<codeline lineno="4733"><highlight class="normal"><sp/><sp/>m_vals<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>[nCols];</highlight></codeline>
<codeline lineno="4734"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4735"><highlight class="normal"></highlight></codeline>
<codeline lineno="4736"><highlight class="normal"></highlight></codeline>
<codeline lineno="4745"><highlight class="normal">CIccPcsStepSrcMatrix::~CIccPcsStepSrcMatrix()</highlight></codeline>
<codeline lineno="4746"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4747"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_vals)</highlight></codeline>
<codeline lineno="4748"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_vals;</highlight></codeline>
<codeline lineno="4749"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4750"><highlight class="normal"></highlight></codeline>
<codeline lineno="4751"><highlight class="normal"></highlight></codeline>
<codeline lineno="4761"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepSrcMatrix::Apply(CIccApplyPcsStep<sp/>*pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4762"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4763"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i,<sp/>j;</highlight></codeline>
<codeline lineno="4764"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*row<sp/>=<sp/>pSrc;</highlight></codeline>
<codeline lineno="4765"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j=0;<sp/>j&lt;m_nRows;<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="4766"><highlight class="normal"><sp/><sp/><sp/><sp/>pDst[j]<sp/>=<sp/>0.0f;</highlight></codeline>
<codeline lineno="4767"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nCols;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pDst[j]<sp/>+=<sp/>row[i]<sp/>*<sp/>m_vals[i];</highlight></codeline>
<codeline lineno="4769"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4770"><highlight class="normal"><sp/><sp/><sp/><sp/>row<sp/>+=<sp/>m_nCols;</highlight></codeline>
<codeline lineno="4771"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4772"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4773"><highlight class="normal"></highlight></codeline>
<codeline lineno="4774"><highlight class="normal"></highlight></codeline>
<codeline lineno="4783"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepSrcMatrix::dump(std::string<sp/>&amp;str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4784"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4785"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepSrcMatrix\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4786"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>buf[80];</highlight></codeline>
<codeline lineno="4787"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;m_nCols;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4788"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(buf,<sp/><ref refid="d3/df8/a00155_1a09ef76f73cd16ef7b7c77358b527e816" kindref="member">ICCPCSSTEPDUMPFMT</ref>,<sp/>m_vals[i]);</highlight></codeline>
<codeline lineno="4789"><highlight class="normal"><sp/><sp/><sp/><sp/>str<sp/>+=<sp/>buf;</highlight></codeline>
<codeline lineno="4790"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4791"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4792"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4793"><highlight class="normal"></highlight></codeline>
<codeline lineno="4794"><highlight class="normal"></highlight></codeline>
<codeline lineno="4803"><highlight class="normal">CIccPcsStepSparseMatrix::CIccPcsStepSparseMatrix(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nRows,<sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nCols,<sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>nBytesPerMatrix)</highlight></codeline>
<codeline lineno="4804"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4805"><highlight class="normal"><sp/><sp/>m_nRows<sp/>=<sp/>nRows;</highlight></codeline>
<codeline lineno="4806"><highlight class="normal"><sp/><sp/>m_nCols<sp/>=<sp/>nCols;</highlight></codeline>
<codeline lineno="4807"><highlight class="normal"><sp/><sp/>m_nBytesPerMatrix<sp/>=<sp/>nBytesPerMatrix;</highlight></codeline>
<codeline lineno="4808"><highlight class="normal"><sp/><sp/>m_nChannels<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="4809"><highlight class="normal"><sp/><sp/>m_vals<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>[m_nBytesPerMatrix/</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)];</highlight></codeline>
<codeline lineno="4810"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4811"><highlight class="normal"></highlight></codeline>
<codeline lineno="4812"><highlight class="normal"></highlight></codeline>
<codeline lineno="4821"><highlight class="normal">CIccPcsStepSparseMatrix::~CIccPcsStepSparseMatrix()</highlight></codeline>
<codeline lineno="4822"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4823"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_vals)</highlight></codeline>
<codeline lineno="4824"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>[]<sp/>m_vals;</highlight></codeline>
<codeline lineno="4825"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4826"><highlight class="normal"></highlight></codeline>
<codeline lineno="4827"><highlight class="normal"></highlight></codeline>
<codeline lineno="4837"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepSparseMatrix::Apply(CIccApplyPcsStep<sp/>*pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4838"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4839"><highlight class="normal"><sp/><sp/><ref refid="d6/dad/a00941" kindref="compound">CIccSparseMatrix</ref><sp/>mtx((<ref refid="d7/d46/a00002_1a0462ca2992be7c80b056e640a192b325" kindref="member">icUInt8Number</ref>*)m_vals,<sp/>m_nBytesPerMatrix,<sp/><ref refid="d7/d46/a00002_1a5bc58d64df71e86546c9f40fe5fefa06" kindref="member">icSparseMatrixFloatNum</ref>,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="4840"><highlight class="normal"></highlight></codeline>
<codeline lineno="4841"><highlight class="normal"><sp/><sp/>mtx.MultiplyVector(pDst,<sp/>pSrc);</highlight></codeline>
<codeline lineno="4842"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4843"><highlight class="normal"></highlight></codeline>
<codeline lineno="4844"><highlight class="normal"></highlight></codeline>
<codeline lineno="4853"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepSparseMatrix::dump(std::string<sp/>&amp;str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4854"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4855"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepSparseMatrix\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4856"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>char<sp/>buf[80];</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4857"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>for<sp/>(int<sp/>i=0;<sp/>i&lt;m_nCols;<sp/>i++)<sp/>{</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4858"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>sprintf(buf,<sp/>ICCPCSSTEPDUMPFMT,<sp/>m_vals[i]);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4859"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>str<sp/>+=<sp/>buf;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4860"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>}</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4861"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>str<sp/>+=<sp/>&quot;\n&quot;;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="4862"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4863"><highlight class="normal"></highlight></codeline>
<codeline lineno="4864"><highlight class="normal"></highlight></codeline>
<codeline lineno="4873"><highlight class="normal">CIccPcsStepSrcSparseMatrix::CIccPcsStepSrcSparseMatrix(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nRows,<sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nCols,<sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nChannels)</highlight></codeline>
<codeline lineno="4874"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4875"><highlight class="normal"><sp/><sp/>m_nRows<sp/>=<sp/>nRows;</highlight></codeline>
<codeline lineno="4876"><highlight class="normal"><sp/><sp/>m_nCols<sp/>=<sp/>nCols;</highlight></codeline>
<codeline lineno="4877"><highlight class="normal"><sp/><sp/>m_nChannels<sp/>=<sp/>nChannels;</highlight></codeline>
<codeline lineno="4878"><highlight class="normal"><sp/><sp/>m_nBytesPerMatrix<sp/>=<sp/>nChannels<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>);</highlight></codeline>
<codeline lineno="4879"><highlight class="normal"></highlight></codeline>
<codeline lineno="4880"><highlight class="normal"><sp/><sp/>m_vals<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>[nCols];</highlight></codeline>
<codeline lineno="4881"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4882"><highlight class="normal"></highlight></codeline>
<codeline lineno="4883"><highlight class="normal"></highlight></codeline>
<codeline lineno="4892"><highlight class="normal">CIccPcsStepSrcSparseMatrix::~CIccPcsStepSrcSparseMatrix()</highlight></codeline>
<codeline lineno="4893"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4894"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_vals)</highlight></codeline>
<codeline lineno="4895"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>[]<sp/>m_vals;</highlight></codeline>
<codeline lineno="4896"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4897"><highlight class="normal"></highlight></codeline>
<codeline lineno="4898"><highlight class="normal"></highlight></codeline>
<codeline lineno="4908"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepSrcSparseMatrix::Apply(CIccApplyPcsStep<sp/>*pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4909"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4910"><highlight class="normal"><sp/><sp/><ref refid="d6/dad/a00941" kindref="compound">CIccSparseMatrix</ref><sp/>mtx((<ref refid="d7/d46/a00002_1a0462ca2992be7c80b056e640a192b325" kindref="member">icUInt8Number</ref>*)pSrc,<sp/>m_nBytesPerMatrix,<sp/><ref refid="d7/d46/a00002_1a5bc58d64df71e86546c9f40fe5fefa06" kindref="member">icSparseMatrixFloatNum</ref>,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="4911"><highlight class="normal"></highlight></codeline>
<codeline lineno="4912"><highlight class="normal"><sp/><sp/>mtx.MultiplyVector(pDst,<sp/>m_vals);</highlight></codeline>
<codeline lineno="4913"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4914"><highlight class="normal"></highlight></codeline>
<codeline lineno="4915"><highlight class="normal"></highlight></codeline>
<codeline lineno="4924"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccPcsStepSrcSparseMatrix::dump(std::string<sp/>&amp;str)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="4925"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="4926"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\nCIccPcsStepSrcSparseMatrix\n\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4927"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">char</highlight><highlight class="normal"><sp/>buf[80];</highlight></codeline>
<codeline lineno="4928"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;m_nCols;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="4929"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(buf,<sp/><ref refid="d3/df8/a00155_1a09ef76f73cd16ef7b7c77358b527e816" kindref="member">ICCPCSSTEPDUMPFMT</ref>,<sp/>m_vals[i]);</highlight></codeline>
<codeline lineno="4930"><highlight class="normal"><sp/><sp/><sp/><sp/>str<sp/>+=<sp/>buf;</highlight></codeline>
<codeline lineno="4931"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="4932"><highlight class="normal"><sp/><sp/>str<sp/>+=<sp/></highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4933"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4934"><highlight class="normal"></highlight></codeline>
<codeline lineno="4935"><highlight class="normal"></highlight></codeline>
<codeline lineno="4944"><highlight class="normal">CIccXformMonochrome::CIccXformMonochrome()</highlight></codeline>
<codeline lineno="4945"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4946"><highlight class="normal"><sp/><sp/><sp/><sp/>m_Curve<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="4947"><highlight class="normal"><sp/><sp/><sp/><sp/>m_ApplyCurvePtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="4948"><highlight class="normal"><sp/><sp/><sp/><sp/>m_bFreeCurve<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4949"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4950"><highlight class="normal"></highlight></codeline>
<codeline lineno="4959"><highlight class="normal">CIccXformMonochrome::~CIccXformMonochrome()</highlight></codeline>
<codeline lineno="4960"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4961"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bFreeCurve<sp/>&amp;&amp;<sp/>m_Curve)<sp/>{</highlight></codeline>
<codeline lineno="4962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_Curve;</highlight></codeline>
<codeline lineno="4963"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4964"><highlight class="normal">}</highlight></codeline>
<codeline lineno="4965"><highlight class="normal"></highlight></codeline>
<codeline lineno="4976"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccXformMonochrome::Begin()</highlight></codeline>
<codeline lineno="4977"><highlight class="normal">{</highlight></codeline>
<codeline lineno="4978"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>status;</highlight></codeline>
<codeline lineno="4979"><highlight class="normal"></highlight></codeline>
<codeline lineno="4980"><highlight class="normal"><sp/><sp/><sp/><sp/>status<sp/>=<sp/>CIccXform::Begin();</highlight></codeline>
<codeline lineno="4981"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(status<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="4982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>status;</highlight></codeline>
<codeline lineno="4983"><highlight class="normal"></highlight></codeline>
<codeline lineno="4984"><highlight class="normal"><sp/><sp/><sp/><sp/>m_ApplyCurvePtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="4985"><highlight class="normal"></highlight></codeline>
<codeline lineno="4986"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="4987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_Curve<sp/>=<sp/>GetCurve(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a046bf81412ed16e2ce5f0735bb7e7315" kindref="member">icSigGrayTRCTag</ref>);</highlight></codeline>
<codeline lineno="4988"><highlight class="normal"></highlight></codeline>
<codeline lineno="4989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Curve)<sp/>{</highlight></codeline>
<codeline lineno="4990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a" kindref="member">icCmmStatProfileMissingTag</ref>;</highlight></codeline>
<codeline lineno="4991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4992"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="4993"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="4994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_Curve<sp/>=<sp/>GetInvCurve(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a046bf81412ed16e2ce5f0735bb7e7315" kindref="member">icSigGrayTRCTag</ref>);</highlight></codeline>
<codeline lineno="4995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_bFreeCurve<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="4996"><highlight class="normal"></highlight></codeline>
<codeline lineno="4997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Curve)<sp/>{</highlight></codeline>
<codeline lineno="4998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a" kindref="member">icCmmStatProfileMissingTag</ref>;</highlight></codeline>
<codeline lineno="4999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5000"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5001"><highlight class="normal"></highlight></codeline>
<codeline lineno="5002"><highlight class="normal"><sp/><sp/><sp/><sp/>m_Curve-&gt;Begin();</highlight></codeline>
<codeline lineno="5003"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Curve-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="5004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtr<sp/>=<sp/>m_Curve;</highlight></codeline>
<codeline lineno="5005"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5006"><highlight class="normal"></highlight></codeline>
<codeline lineno="5007"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="5008"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5009"><highlight class="normal"></highlight></codeline>
<codeline lineno="5023"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccXformMonochrome::Apply(CIccApplyXform*<sp/>pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="5024"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="5025"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>Pixel[3];</highlight></codeline>
<codeline lineno="5026"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="5027"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bSrcPcsConversion)</highlight></codeline>
<codeline lineno="5028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>SrcPixel<sp/>=<sp/>CheckSrcAbs(pApply,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="5029"><highlight class="normal"></highlight></codeline>
<codeline lineno="5030"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="5031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[0]<sp/>=<sp/>SrcPixel[0];</highlight></codeline>
<codeline lineno="5032"><highlight class="normal"></highlight></codeline>
<codeline lineno="5033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtr)<sp/>{</highlight></codeline>
<codeline lineno="5034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[0]<sp/>=<sp/>m_ApplyCurvePtr-&gt;Apply(Pixel[0]);</highlight></codeline>
<codeline lineno="5035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5036"><highlight class="normal"></highlight></codeline>
<codeline lineno="5037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[0]<sp/>=<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>(<ref refid="d6/d5b/a00026_1a2099748836172e9623ed265cf9a416fe" kindref="member">icPerceptualRefWhiteX</ref>);<sp/></highlight></codeline>
<codeline lineno="5038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[1]<sp/>=<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>(<ref refid="d6/d5b/a00026_1ac9449e1acbe4f8a51e242f04afd25361" kindref="member">icPerceptualRefWhiteY</ref>);</highlight></codeline>
<codeline lineno="5039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[2]<sp/>=<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>(<ref refid="d6/d5b/a00026_1a970c241f6169898a9ae88b10fe06f91b" kindref="member">icPerceptualRefWhiteZ</ref>);</highlight></codeline>
<codeline lineno="5040"><highlight class="normal"></highlight></codeline>
<codeline lineno="5041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a4b4cfb7788c3a780f19f2f104677a5b8" kindref="member">icXyzToPcs</ref>(DstPixel);</highlight></codeline>
<codeline lineno="5042"><highlight class="normal"></highlight></codeline>
<codeline lineno="5043"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pProfile-&gt;m_Header.pcs==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="5044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(UseLegacyPCS())<sp/>{</highlight></codeline>
<codeline lineno="5045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccPCSUtil::XyzToLab2(DstPixel,<sp/>DstPixel,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="5046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5047"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="5048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccPCSUtil::XyzToLab(DstPixel,<sp/>DstPixel,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="5049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5051"><highlight class="normal"></highlight></codeline>
<codeline lineno="5052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[0]<sp/>*=<sp/>Pixel[0];</highlight></codeline>
<codeline lineno="5053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[1]<sp/>*=<sp/>Pixel[0];</highlight></codeline>
<codeline lineno="5054"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[2]<sp/>*=<sp/>Pixel[0];</highlight></codeline>
<codeline lineno="5055"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5056"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="5057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[0]<sp/>=<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>(<ref refid="d6/d5b/a00026_1a2099748836172e9623ed265cf9a416fe" kindref="member">icPerceptualRefWhiteX</ref>);<sp/></highlight></codeline>
<codeline lineno="5058"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[1]<sp/>=<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>(<ref refid="d6/d5b/a00026_1ac9449e1acbe4f8a51e242f04afd25361" kindref="member">icPerceptualRefWhiteY</ref>);</highlight></codeline>
<codeline lineno="5059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[2]<sp/>=<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>(<ref refid="d6/d5b/a00026_1a970c241f6169898a9ae88b10fe06f91b" kindref="member">icPerceptualRefWhiteZ</ref>);</highlight></codeline>
<codeline lineno="5060"><highlight class="normal"></highlight></codeline>
<codeline lineno="5061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a4b4cfb7788c3a780f19f2f104677a5b8" kindref="member">icXyzToPcs</ref>(Pixel);</highlight></codeline>
<codeline lineno="5062"><highlight class="normal"></highlight></codeline>
<codeline lineno="5063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pProfile-&gt;m_Header.pcs==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="5064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(UseLegacyPCS())<sp/>{</highlight></codeline>
<codeline lineno="5065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccPCSUtil::XyzToLab2(Pixel,<sp/>Pixel,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="5066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="5068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccPCSUtil::XyzToLab(Pixel,<sp/>Pixel,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="5069"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[0]<sp/>=<sp/>SrcPixel[0]/Pixel[0];</highlight></codeline>
<codeline lineno="5071"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5072"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="5073"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[0]<sp/>=<sp/>SrcPixel[1]/Pixel[1];</highlight></codeline>
<codeline lineno="5074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5075"><highlight class="normal"></highlight></codeline>
<codeline lineno="5076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtr)<sp/>{</highlight></codeline>
<codeline lineno="5077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[0]<sp/>=<sp/>m_ApplyCurvePtr-&gt;Apply(DstPixel[0]);</highlight></codeline>
<codeline lineno="5078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5079"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5080"><highlight class="normal"></highlight></codeline>
<codeline lineno="5081"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bDstPcsConversion)</highlight></codeline>
<codeline lineno="5082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CheckDstAbs(DstPixel);</highlight></codeline>
<codeline lineno="5083"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5084"><highlight class="normal"></highlight></codeline>
<codeline lineno="5099"><highlight class="normal"><ref refid="dd/de4/a01121" kindref="compound">CIccCurve</ref><sp/>*CIccXformMonochrome::GetCurve(<ref refid="d7/d46/a00002_1a67fa1b773fad35303680761ee5ef9313" kindref="member">icSignature</ref><sp/>sig)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="5100"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="5101"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>m_pProfile-&gt;FindTag(sig);</highlight></codeline>
<codeline lineno="5102"><highlight class="normal"></highlight></codeline>
<codeline lineno="5103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>(pTag-&gt;<ref refid="d7/dfd/a00969_1a0d6f4b6f857134bd87bfb0cd54025208" kindref="member">GetType</ref>()==<ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea96cf6489d8d5dc86691eee5d443cf337" kindref="member">icSigCurveType</ref><sp/>||<sp/>pTag-&gt;<ref refid="d7/dfd/a00969_1a0d6f4b6f857134bd87bfb0cd54025208" kindref="member">GetType</ref>()==<ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea5f55d7347cee83f4b7570f2c0092a3c4" kindref="member">icSigParametricCurveType</ref>))<sp/>{</highlight></codeline>
<codeline lineno="5104"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="dd/de4/a01121" kindref="compound">CIccCurve</ref>*)pTag;</highlight></codeline>
<codeline lineno="5105"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5106"><highlight class="normal"></highlight></codeline>
<codeline lineno="5107"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="5108"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5109"><highlight class="normal"></highlight></codeline>
<codeline lineno="5124"><highlight class="normal"><ref refid="dd/de4/a01121" kindref="compound">CIccCurve</ref><sp/>*CIccXformMonochrome::GetInvCurve(<ref refid="d7/d46/a00002_1a67fa1b773fad35303680761ee5ef9313" kindref="member">icSignature</ref><sp/>sig)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="5125"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="5126"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">CIccCurve</ref><sp/>*pCurve;</highlight></codeline>
<codeline lineno="5127"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d6/dc4/a01125" kindref="compound">CIccTagCurve</ref><sp/>*pInvCurve;</highlight></codeline>
<codeline lineno="5128"><highlight class="normal"></highlight></codeline>
<codeline lineno="5129"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(pCurve<sp/>=<sp/>GetCurve(sig)))</highlight></codeline>
<codeline lineno="5130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="5131"><highlight class="normal"></highlight></codeline>
<codeline lineno="5132"><highlight class="normal"><sp/><sp/><sp/><sp/>pCurve-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5133"><highlight class="normal"></highlight></codeline>
<codeline lineno="5134"><highlight class="normal"><sp/><sp/><sp/><sp/>pInvCurve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="d6/dc4/a01125" kindref="compound">CIccTagCurve</ref>(2048);</highlight></codeline>
<codeline lineno="5135"><highlight class="normal"></highlight></codeline>
<codeline lineno="5136"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="5137"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>x;</highlight></codeline>
<codeline lineno="5138"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Lut<sp/>=<sp/>&amp;(*pInvCurve)[0];</highlight></codeline>
<codeline lineno="5139"><highlight class="normal"></highlight></codeline>
<codeline lineno="5140"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;2048;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="5141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>x=(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)i<sp/>/<sp/>2047;</highlight></codeline>
<codeline lineno="5142"><highlight class="normal"></highlight></codeline>
<codeline lineno="5143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Lut[i]<sp/>=<sp/>pCurve-&gt;<ref refid="dd/de4/a01121_1abf88e98ece3d98f0e8bc090fe7596e05" kindref="member">Find</ref>(x);</highlight></codeline>
<codeline lineno="5144"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5145"><highlight class="normal"></highlight></codeline>
<codeline lineno="5146"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pInvCurve;</highlight></codeline>
<codeline lineno="5147"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5148"><highlight class="normal"></highlight></codeline>
<codeline lineno="5163"><highlight class="normal"><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>CIccXformMonochrome::ExtractInputCurves()</highlight></codeline>
<codeline lineno="5164"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5165"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="5166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Curve)<sp/>{</highlight></codeline>
<codeline lineno="5167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[1];</highlight></codeline>
<codeline lineno="5168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[0]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_Curve-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5169"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="5171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5172"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5173"><highlight class="normal"></highlight></codeline>
<codeline lineno="5174"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="5175"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5176"><highlight class="normal"></highlight></codeline>
<codeline lineno="5191"><highlight class="normal"><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>CIccXformMonochrome::ExtractOutputCurves()</highlight></codeline>
<codeline lineno="5192"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5193"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="5194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Curve)<sp/>{</highlight></codeline>
<codeline lineno="5195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[1];</highlight></codeline>
<codeline lineno="5196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[0]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_Curve-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="5199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5200"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5201"><highlight class="normal"></highlight></codeline>
<codeline lineno="5202"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="5203"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5204"><highlight class="normal"></highlight></codeline>
<codeline lineno="5213"><highlight class="normal">CIccXformMatrixTRC::CIccXformMatrixTRC()<sp/>:<sp/>m_e{}</highlight></codeline>
<codeline lineno="5214"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5215"><highlight class="normal"><sp/><sp/>m_Curve[0]<sp/>=<sp/>m_Curve[1]<sp/>=<sp/>m_Curve[2]<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5216"><highlight class="normal"><sp/><sp/>m_ApplyCurvePtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5217"><highlight class="normal"><sp/><sp/>m_bFreeCurve<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="5218"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5219"><highlight class="normal"></highlight></codeline>
<codeline lineno="5228"><highlight class="normal">CIccXformMatrixTRC::~CIccXformMatrixTRC()</highlight></codeline>
<codeline lineno="5229"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5230"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bFreeCurve)<sp/>{</highlight></codeline>
<codeline lineno="5231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Curve[0])</highlight></codeline>
<codeline lineno="5232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_Curve[0];</highlight></codeline>
<codeline lineno="5233"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Curve[1])</highlight></codeline>
<codeline lineno="5234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_Curve[1];</highlight></codeline>
<codeline lineno="5235"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Curve[2])</highlight></codeline>
<codeline lineno="5236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_Curve[2];</highlight></codeline>
<codeline lineno="5237"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5238"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5239"><highlight class="normal"></highlight></codeline>
<codeline lineno="5250"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccXformMatrixTRC::Begin()</highlight></codeline>
<codeline lineno="5251"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5252"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>status;</highlight></codeline>
<codeline lineno="5253"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d3/ded/a01017" kindref="compound">CIccTagXYZ</ref><sp/>*pXYZ;</highlight></codeline>
<codeline lineno="5254"><highlight class="normal"></highlight></codeline>
<codeline lineno="5255"><highlight class="normal"><sp/><sp/>status<sp/>=<sp/>CIccXform::Begin();</highlight></codeline>
<codeline lineno="5256"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(status<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="5257"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>status;</highlight></codeline>
<codeline lineno="5258"><highlight class="normal"></highlight></codeline>
<codeline lineno="5259"><highlight class="normal"><sp/><sp/>pXYZ<sp/>=<sp/>GetColumn(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ad3037f416da1bdbcee55755bd896db3e" kindref="member">icSigRedMatrixColumnTag</ref>);</highlight></codeline>
<codeline lineno="5260"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pXYZ)<sp/>{</highlight></codeline>
<codeline lineno="5261"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a" kindref="member">icCmmStatProfileMissingTag</ref>;</highlight></codeline>
<codeline lineno="5262"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5263"><highlight class="normal"></highlight></codeline>
<codeline lineno="5264"><highlight class="normal"><sp/><sp/>m_e[0]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>((*pXYZ)[0].X);</highlight></codeline>
<codeline lineno="5265"><highlight class="normal"><sp/><sp/>m_e[3]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>((*pXYZ)[0].Y);</highlight></codeline>
<codeline lineno="5266"><highlight class="normal"><sp/><sp/>m_e[6]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>((*pXYZ)[0].Z);</highlight></codeline>
<codeline lineno="5267"><highlight class="normal"></highlight></codeline>
<codeline lineno="5268"><highlight class="normal"><sp/><sp/>pXYZ<sp/>=<sp/>GetColumn(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a946d32df00f8fdcd52d05afdfa1ae897" kindref="member">icSigGreenMatrixColumnTag</ref>);</highlight></codeline>
<codeline lineno="5269"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pXYZ)<sp/>{</highlight></codeline>
<codeline lineno="5270"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a" kindref="member">icCmmStatProfileMissingTag</ref>;</highlight></codeline>
<codeline lineno="5271"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5272"><highlight class="normal"></highlight></codeline>
<codeline lineno="5273"><highlight class="normal"><sp/><sp/>m_e[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>((*pXYZ)[0].X);</highlight></codeline>
<codeline lineno="5274"><highlight class="normal"><sp/><sp/>m_e[4]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>((*pXYZ)[0].Y);</highlight></codeline>
<codeline lineno="5275"><highlight class="normal"><sp/><sp/>m_e[7]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>((*pXYZ)[0].Z);</highlight></codeline>
<codeline lineno="5276"><highlight class="normal"></highlight></codeline>
<codeline lineno="5277"><highlight class="normal"><sp/><sp/>pXYZ<sp/>=<sp/>GetColumn(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a19e7177ed729ed7835222428eef4c2a3" kindref="member">icSigBlueMatrixColumnTag</ref>);</highlight></codeline>
<codeline lineno="5278"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pXYZ)<sp/>{</highlight></codeline>
<codeline lineno="5279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a" kindref="member">icCmmStatProfileMissingTag</ref>;</highlight></codeline>
<codeline lineno="5280"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5281"><highlight class="normal"></highlight></codeline>
<codeline lineno="5282"><highlight class="normal"><sp/><sp/>m_e[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>((*pXYZ)[0].X);</highlight></codeline>
<codeline lineno="5283"><highlight class="normal"><sp/><sp/>m_e[5]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>((*pXYZ)[0].Y);</highlight></codeline>
<codeline lineno="5284"><highlight class="normal"><sp/><sp/>m_e[8]<sp/>=<sp/><ref refid="d7/dce/a00143_1a52fc751ce015924f9655f8288813a02c" kindref="member">icFtoD</ref>((*pXYZ)[0].Z);</highlight></codeline>
<codeline lineno="5285"><highlight class="normal"></highlight></codeline>
<codeline lineno="5286"><highlight class="normal"><sp/><sp/>m_ApplyCurvePtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5287"><highlight class="normal"></highlight></codeline>
<codeline lineno="5288"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="5289"><highlight class="normal"><sp/><sp/><sp/><sp/>m_Curve[0]<sp/>=<sp/>GetCurve(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a7fea74def2b68bdcd33cec08da4fa667" kindref="member">icSigRedTRCTag</ref>);</highlight></codeline>
<codeline lineno="5290"><highlight class="normal"><sp/><sp/><sp/><sp/>m_Curve[1]<sp/>=<sp/>GetCurve(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a3525a308b3af69ebe5c8888dcb80ef12" kindref="member">icSigGreenTRCTag</ref>);</highlight></codeline>
<codeline lineno="5291"><highlight class="normal"><sp/><sp/><sp/><sp/>m_Curve[2]<sp/>=<sp/>GetCurve(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a8b6202952425dbdc400d2626e650c903" kindref="member">icSigBlueTRCTag</ref>);</highlight></codeline>
<codeline lineno="5292"><highlight class="normal"></highlight></codeline>
<codeline lineno="5293"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Curve[0]<sp/>||<sp/>!m_Curve[1]<sp/>||<sp/>!m_Curve[2])<sp/>{</highlight></codeline>
<codeline lineno="5294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a" kindref="member">icCmmStatProfileMissingTag</ref>;</highlight></codeline>
<codeline lineno="5295"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5296"><highlight class="normal"></highlight></codeline>
<codeline lineno="5297"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5298"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="5299"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pProfile-&gt;m_Header.pcs!=<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="5300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="5301"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5302"><highlight class="normal"></highlight></codeline>
<codeline lineno="5303"><highlight class="normal"><sp/><sp/><sp/><sp/>m_Curve[0]<sp/>=<sp/>GetInvCurve(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a7fea74def2b68bdcd33cec08da4fa667" kindref="member">icSigRedTRCTag</ref>);</highlight></codeline>
<codeline lineno="5304"><highlight class="normal"><sp/><sp/><sp/><sp/>m_Curve[1]<sp/>=<sp/>GetInvCurve(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a3525a308b3af69ebe5c8888dcb80ef12" kindref="member">icSigGreenTRCTag</ref>);</highlight></codeline>
<codeline lineno="5305"><highlight class="normal"><sp/><sp/><sp/><sp/>m_Curve[2]<sp/>=<sp/>GetInvCurve(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a8b6202952425dbdc400d2626e650c903" kindref="member">icSigBlueTRCTag</ref>);</highlight></codeline>
<codeline lineno="5306"><highlight class="normal"></highlight></codeline>
<codeline lineno="5307"><highlight class="normal"><sp/><sp/><sp/><sp/>m_bFreeCurve<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="5308"><highlight class="normal"></highlight></codeline>
<codeline lineno="5309"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Curve[0]<sp/>||<sp/>!m_Curve[1]<sp/>||<sp/>!m_Curve[2])<sp/>{</highlight></codeline>
<codeline lineno="5310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a" kindref="member">icCmmStatProfileMissingTag</ref>;</highlight></codeline>
<codeline lineno="5311"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5312"><highlight class="normal"></highlight></codeline>
<codeline lineno="5313"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d7/dce/a00143_1aa1bb8385706c3c656575f0d6a4ae4d76" kindref="member">icMatrixInvert3x3</ref>(m_e))<sp/>{</highlight></codeline>
<codeline lineno="5314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860" kindref="member">icCmmStatInvalidProfile</ref>;</highlight></codeline>
<codeline lineno="5315"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5316"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5317"><highlight class="normal"></highlight></codeline>
<codeline lineno="5318"><highlight class="normal"><sp/><sp/>m_Curve[0]-&gt;Begin();</highlight></codeline>
<codeline lineno="5319"><highlight class="normal"><sp/><sp/>m_Curve[1]-&gt;Begin();</highlight></codeline>
<codeline lineno="5320"><highlight class="normal"><sp/><sp/>m_Curve[2]-&gt;Begin();</highlight></codeline>
<codeline lineno="5321"><highlight class="normal"></highlight></codeline>
<codeline lineno="5322"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Curve[0]-&gt;IsIdentity()<sp/>||<sp/>!m_Curve[1]-&gt;IsIdentity()<sp/>||<sp/>!m_Curve[2]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="5323"><highlight class="normal"><sp/><sp/><sp/><sp/>m_ApplyCurvePtr<sp/>=<sp/>m_Curve;</highlight></codeline>
<codeline lineno="5324"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5325"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="5326"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="5327"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5328"><highlight class="normal"></highlight></codeline>
<codeline lineno="5329"><highlight class="normal"></highlight></codeline>
<codeline lineno="5330" refid="d3/df8/a00155_1aa7c8bbc66b122b6419782fbfb02d51ac" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/><ref refid="d3/df8/a00155_1aa7c8bbc66b122b6419782fbfb02d51ac" kindref="member">XYZScale</ref>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>v)</highlight></codeline>
<codeline lineno="5331"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5332"><highlight class="normal"><sp/><sp/>v<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(v<sp/>*<sp/>32768.0<sp/>/<sp/>65535.0);</highlight></codeline>
<codeline lineno="5333"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>v;</highlight></codeline>
<codeline lineno="5334"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5335"><highlight class="normal"></highlight></codeline>
<codeline lineno="5336" refid="d3/df8/a00155_1ae5a787099f4191e4c234ca3301c9cc0a" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/><ref refid="d3/df8/a00155_1ae5a787099f4191e4c234ca3301c9cc0a" kindref="member">XYZDescale</ref>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>v)</highlight></codeline>
<codeline lineno="5337"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5338"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(v<sp/>*<sp/>65535.0<sp/>/<sp/>32768.0);</highlight></codeline>
<codeline lineno="5339"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5340"><highlight class="normal"></highlight></codeline>
<codeline lineno="5341" refid="d3/df8/a00155_1a36a692db621ce2ccea49767209ab8294" refkind="member"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/><ref refid="d3/df8/a00155_1a36a692db621ce2ccea49767209ab8294" kindref="member">RGBClip</ref>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>v,<sp/><ref refid="dd/de4/a01121" kindref="compound">CIccCurve</ref><sp/>*pCurve)</highlight></codeline>
<codeline lineno="5342"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5343"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(v&lt;=0)</highlight></codeline>
<codeline lineno="5344"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">(pCurve-&gt;<ref refid="dd/de4/a01121_1a0c972a2a0eacd5245a0f52993c9f501f" kindref="member">Apply</ref>(0));</highlight></codeline>
<codeline lineno="5345"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(v&gt;=1.0)</highlight></codeline>
<codeline lineno="5346"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(pCurve-&gt;<ref refid="dd/de4/a01121_1a0c972a2a0eacd5245a0f52993c9f501f" kindref="member">Apply</ref>(1.0));</highlight></codeline>
<codeline lineno="5347"><highlight class="normal"></highlight></codeline>
<codeline lineno="5348"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pCurve-&gt;<ref refid="dd/de4/a01121_1a0c972a2a0eacd5245a0f52993c9f501f" kindref="member">Apply</ref>(v);</highlight></codeline>
<codeline lineno="5349"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5350"><highlight class="normal"></highlight></codeline>
<codeline lineno="5364"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccXformMatrixTRC::Apply(CIccApplyXform*<sp/>pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="5365"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="5366"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>Pixel[3];</highlight></codeline>
<codeline lineno="5367"><highlight class="normal"></highlight></codeline>
<codeline lineno="5368"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bSrcPcsConversion)</highlight></codeline>
<codeline lineno="5369"><highlight class="normal"><sp/><sp/><sp/><sp/>SrcPixel<sp/>=<sp/>CheckSrcAbs(pApply,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="5370"><highlight class="normal"></highlight></codeline>
<codeline lineno="5371"><highlight class="normal"><sp/><sp/>Pixel[0]<sp/>=<sp/>SrcPixel[0];</highlight></codeline>
<codeline lineno="5372"><highlight class="normal"><sp/><sp/>Pixel[1]<sp/>=<sp/>SrcPixel[1];</highlight></codeline>
<codeline lineno="5373"><highlight class="normal"><sp/><sp/>Pixel[2]<sp/>=<sp/>SrcPixel[2];</highlight></codeline>
<codeline lineno="5374"><highlight class="normal"></highlight></codeline>
<codeline lineno="5375"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="5376"><highlight class="normal"></highlight></codeline>
<codeline lineno="5377"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>LinR,<sp/>LinG,<sp/>LinB;</highlight></codeline>
<codeline lineno="5378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtr)<sp/>{</highlight></codeline>
<codeline lineno="5379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>LinR<sp/>=<sp/>m_ApplyCurvePtr[0]-&gt;Apply(Pixel[0]);</highlight></codeline>
<codeline lineno="5380"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>LinG<sp/>=<sp/>m_ApplyCurvePtr[1]-&gt;Apply(Pixel[1]);</highlight></codeline>
<codeline lineno="5381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>LinB<sp/>=<sp/>m_ApplyCurvePtr[2]-&gt;Apply(Pixel[2]);</highlight></codeline>
<codeline lineno="5382"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5383"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="5384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>LinR<sp/>=<sp/>Pixel[0];</highlight></codeline>
<codeline lineno="5385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>LinG<sp/>=<sp/>Pixel[1];</highlight></codeline>
<codeline lineno="5386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>LinB<sp/>=<sp/>Pixel[2];</highlight></codeline>
<codeline lineno="5387"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5388"><highlight class="normal"></highlight></codeline>
<codeline lineno="5389"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel[0]<sp/>=<sp/><ref refid="d3/df8/a00155_1aa7c8bbc66b122b6419782fbfb02d51ac" kindref="member">XYZScale</ref>((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(m_e[0]<sp/>*<sp/>LinR<sp/>+<sp/>m_e[1]<sp/>*<sp/>LinG<sp/>+<sp/>m_e[2]<sp/>*<sp/>LinB));</highlight></codeline>
<codeline lineno="5390"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel[1]<sp/>=<sp/><ref refid="d3/df8/a00155_1aa7c8bbc66b122b6419782fbfb02d51ac" kindref="member">XYZScale</ref>((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(m_e[3]<sp/>*<sp/>LinR<sp/>+<sp/>m_e[4]<sp/>*<sp/>LinG<sp/>+<sp/>m_e[5]<sp/>*<sp/>LinB));</highlight></codeline>
<codeline lineno="5391"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel[2]<sp/>=<sp/><ref refid="d3/df8/a00155_1aa7c8bbc66b122b6419782fbfb02d51ac" kindref="member">XYZScale</ref>((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(m_e[6]<sp/>*<sp/>LinR<sp/>+<sp/>m_e[7]<sp/>*<sp/>LinG<sp/>+<sp/>m_e[8]<sp/>*<sp/>LinB));</highlight></codeline>
<codeline lineno="5392"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5393"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="5394"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>X<sp/>=<sp/><ref refid="d3/df8/a00155_1ae5a787099f4191e4c234ca3301c9cc0a" kindref="member">XYZDescale</ref>(Pixel[0]);</highlight></codeline>
<codeline lineno="5395"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Y<sp/>=<sp/><ref refid="d3/df8/a00155_1ae5a787099f4191e4c234ca3301c9cc0a" kindref="member">XYZDescale</ref>(Pixel[1]);</highlight></codeline>
<codeline lineno="5396"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">double</highlight><highlight class="normal"><sp/>Z<sp/>=<sp/><ref refid="d3/df8/a00155_1ae5a787099f4191e4c234ca3301c9cc0a" kindref="member">XYZDescale</ref>(Pixel[2]);</highlight></codeline>
<codeline lineno="5397"><highlight class="normal"></highlight></codeline>
<codeline lineno="5398"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtr)<sp/>{</highlight></codeline>
<codeline lineno="5399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[0]<sp/>=<sp/><ref refid="d3/df8/a00155_1a36a692db621ce2ccea49767209ab8294" kindref="member">RGBClip</ref>((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(m_e[0]<sp/>*<sp/>X<sp/>+<sp/>m_e[1]<sp/>*<sp/>Y<sp/>+<sp/>m_e[2]<sp/>*<sp/>Z),<sp/>m_ApplyCurvePtr[0]);</highlight></codeline>
<codeline lineno="5400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[1]<sp/>=<sp/><ref refid="d3/df8/a00155_1a36a692db621ce2ccea49767209ab8294" kindref="member">RGBClip</ref>((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(m_e[3]<sp/>*<sp/>X<sp/>+<sp/>m_e[4]<sp/>*<sp/>Y<sp/>+<sp/>m_e[5]<sp/>*<sp/>Z),<sp/>m_ApplyCurvePtr[1]);</highlight></codeline>
<codeline lineno="5401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[2]<sp/>=<sp/><ref refid="d3/df8/a00155_1a36a692db621ce2ccea49767209ab8294" kindref="member">RGBClip</ref>((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(m_e[6]<sp/>*<sp/>X<sp/>+<sp/>m_e[7]<sp/>*<sp/>Y<sp/>+<sp/>m_e[8]<sp/>*<sp/>Z),<sp/>m_ApplyCurvePtr[2]);</highlight></codeline>
<codeline lineno="5402"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5403"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="5404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(m_e[0]<sp/>*<sp/>X<sp/>+<sp/>m_e[1]<sp/>*<sp/>Y<sp/>+<sp/>m_e[2]<sp/>*<sp/>Z);</highlight></codeline>
<codeline lineno="5405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(m_e[3]<sp/>*<sp/>X<sp/>+<sp/>m_e[4]<sp/>*<sp/>Y<sp/>+<sp/>m_e[5]<sp/>*<sp/>Z);</highlight></codeline>
<codeline lineno="5406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>DstPixel[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(m_e[6]<sp/>*<sp/>X<sp/>+<sp/>m_e[7]<sp/>*<sp/>Y<sp/>+<sp/>m_e[8]<sp/>*<sp/>Z);</highlight></codeline>
<codeline lineno="5407"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5408"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5409"><highlight class="normal"></highlight></codeline>
<codeline lineno="5410"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bDstPcsConversion)</highlight></codeline>
<codeline lineno="5411"><highlight class="normal"><sp/><sp/><sp/><sp/>CheckDstAbs(DstPixel);</highlight></codeline>
<codeline lineno="5412"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5413"><highlight class="normal"></highlight></codeline>
<codeline lineno="5428"><highlight class="normal"><ref refid="dd/de4/a01121" kindref="compound">CIccCurve</ref><sp/>*CIccXformMatrixTRC::GetCurve(<ref refid="d7/d46/a00002_1a67fa1b773fad35303680761ee5ef9313" kindref="member">icSignature</ref><sp/>sig)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="5429"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="5430"><highlight class="normal"><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>m_pProfile-&gt;FindTag(sig);</highlight></codeline>
<codeline lineno="5431"><highlight class="normal"></highlight></codeline>
<codeline lineno="5432"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>(pTag-&gt;<ref refid="d7/dfd/a00969_1a0d6f4b6f857134bd87bfb0cd54025208" kindref="member">GetType</ref>()==<ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea96cf6489d8d5dc86691eee5d443cf337" kindref="member">icSigCurveType</ref><sp/>||<sp/>pTag-&gt;<ref refid="d7/dfd/a00969_1a0d6f4b6f857134bd87bfb0cd54025208" kindref="member">GetType</ref>()==<ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea5f55d7347cee83f4b7570f2c0092a3c4" kindref="member">icSigParametricCurveType</ref>))<sp/>{</highlight></codeline>
<codeline lineno="5433"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="dd/de4/a01121" kindref="compound">CIccCurve</ref>*)pTag;</highlight></codeline>
<codeline lineno="5434"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5435"><highlight class="normal"></highlight></codeline>
<codeline lineno="5436"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="5437"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5438"><highlight class="normal"></highlight></codeline>
<codeline lineno="5453"><highlight class="normal"><ref refid="d3/ded/a01017" kindref="compound">CIccTagXYZ</ref><sp/>*CIccXformMatrixTRC::GetColumn(<ref refid="d7/d46/a00002_1a67fa1b773fad35303680761ee5ef9313" kindref="member">icSignature</ref><sp/>sig)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="5454"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="5455"><highlight class="normal"><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>m_pProfile-&gt;FindTag(sig);</highlight></codeline>
<codeline lineno="5456"><highlight class="normal"></highlight></codeline>
<codeline lineno="5457"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>||<sp/>pTag-&gt;<ref refid="d7/dfd/a00969_1a0d6f4b6f857134bd87bfb0cd54025208" kindref="member">GetType</ref>()!=<ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea6226593792ef658c78bcab04a6fd4850" kindref="member">icSigXYZType</ref>)<sp/>{</highlight></codeline>
<codeline lineno="5458"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="5459"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5460"><highlight class="normal"></highlight></codeline>
<codeline lineno="5461"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="d3/ded/a01017" kindref="compound">CIccTagXYZ</ref>*)pTag;</highlight></codeline>
<codeline lineno="5462"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5463"><highlight class="normal"></highlight></codeline>
<codeline lineno="5478"><highlight class="normal"><ref refid="dd/de4/a01121" kindref="compound">CIccCurve</ref><sp/>*CIccXformMatrixTRC::GetInvCurve(<ref refid="d7/d46/a00002_1a67fa1b773fad35303680761ee5ef9313" kindref="member">icSignature</ref><sp/>sig)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="5479"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="5480"><highlight class="normal"><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">CIccCurve</ref><sp/>*pCurve;</highlight></codeline>
<codeline lineno="5481"><highlight class="normal"><sp/><sp/><ref refid="d6/dc4/a01125" kindref="compound">CIccTagCurve</ref><sp/>*pInvCurve;</highlight></codeline>
<codeline lineno="5482"><highlight class="normal"></highlight></codeline>
<codeline lineno="5483"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!(pCurve<sp/>=<sp/>GetCurve(sig)))</highlight></codeline>
<codeline lineno="5484"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="5485"><highlight class="normal"></highlight></codeline>
<codeline lineno="5486"><highlight class="normal"><sp/><sp/>pCurve-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5487"><highlight class="normal"></highlight></codeline>
<codeline lineno="5488"><highlight class="normal"><sp/><sp/>pInvCurve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="d6/dc4/a01125" kindref="compound">CIccTagCurve</ref>(2048);</highlight></codeline>
<codeline lineno="5489"><highlight class="normal"></highlight></codeline>
<codeline lineno="5490"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="5491"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>x;</highlight></codeline>
<codeline lineno="5492"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*Lut<sp/>=<sp/>&amp;(*pInvCurve)[0];</highlight></codeline>
<codeline lineno="5493"><highlight class="normal"></highlight></codeline>
<codeline lineno="5494"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;2048;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="5495"><highlight class="normal"><sp/><sp/><sp/><sp/>x=(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)i<sp/>/<sp/>2047;</highlight></codeline>
<codeline lineno="5496"><highlight class="normal"></highlight></codeline>
<codeline lineno="5497"><highlight class="normal"><sp/><sp/><sp/><sp/>Lut[i]<sp/>=<sp/>pCurve-&gt;<ref refid="dd/de4/a01121_1abf88e98ece3d98f0e8bc090fe7596e05" kindref="member">Find</ref>(x);</highlight></codeline>
<codeline lineno="5498"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5499"><highlight class="normal"></highlight></codeline>
<codeline lineno="5500"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pInvCurve;</highlight></codeline>
<codeline lineno="5501"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5502"><highlight class="normal"></highlight></codeline>
<codeline lineno="5517"><highlight class="normal"><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>CIccXformMatrixTRC::ExtractInputCurves()</highlight></codeline>
<codeline lineno="5518"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5519"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="5520"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Curve[0])<sp/>{</highlight></codeline>
<codeline lineno="5521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[3];</highlight></codeline>
<codeline lineno="5522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[0]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_Curve[0]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[1]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_Curve[1]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[2]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_Curve[2]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5526"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="5527"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5528"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5529"><highlight class="normal"></highlight></codeline>
<codeline lineno="5530"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="5531"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5532"><highlight class="normal"></highlight></codeline>
<codeline lineno="5547"><highlight class="normal"><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>CIccXformMatrixTRC::ExtractOutputCurves()</highlight></codeline>
<codeline lineno="5548"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5549"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="5550"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Curve[0])<sp/>{</highlight></codeline>
<codeline lineno="5551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[3];</highlight></codeline>
<codeline lineno="5552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[0]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_Curve[0]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[1]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_Curve[1]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[2]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_Curve[2]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="5557"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5558"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5559"><highlight class="normal"></highlight></codeline>
<codeline lineno="5560"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="5561"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5562"><highlight class="normal"></highlight></codeline>
<codeline lineno="5574"><highlight class="normal">CIccXform3DLut::CIccXform3DLut(<ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag)</highlight></codeline>
<codeline lineno="5575"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5576"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>pTag-&gt;<ref refid="d7/dfd/a00969_1a5cf5b72ab66ca68a6c8ddfd861741bb8" kindref="member">IsMBBType</ref>())<sp/>{</highlight></codeline>
<codeline lineno="5577"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pTag<sp/>=<sp/>(<ref refid="dc/d06/a01153" kindref="compound">CIccMBB</ref>*)pTag;</highlight></codeline>
<codeline lineno="5578"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5579"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5580"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5581"><highlight class="normal"></highlight></codeline>
<codeline lineno="5582"><highlight class="normal"><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>m_ApplyCurvePtrB<sp/>=<sp/>m_ApplyCurvePtrM<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5583"><highlight class="normal"><sp/><sp/>m_ApplyMatrixPtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5584"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5585"><highlight class="normal"></highlight></codeline>
<codeline lineno="5594"><highlight class="normal">CIccXform3DLut::~CIccXform3DLut()</highlight></codeline>
<codeline lineno="5595"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5596"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5597"><highlight class="normal"></highlight></codeline>
<codeline lineno="5608"><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccXform3DLut::Begin()</highlight></codeline>
<codeline lineno="5609"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5610"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>status;</highlight></codeline>
<codeline lineno="5611"><highlight class="normal"><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">CIccCurve</ref><sp/>**Curve;</highlight></codeline>
<codeline lineno="5612"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="5613"><highlight class="normal"></highlight></codeline>
<codeline lineno="5614"><highlight class="normal"><sp/><sp/>status<sp/>=<sp/>CIccXform::Begin();</highlight></codeline>
<codeline lineno="5615"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(status<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="5616"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>status;</highlight></codeline>
<codeline lineno="5617"><highlight class="normal"></highlight></codeline>
<codeline lineno="5618"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pTag<sp/>||</highlight></codeline>
<codeline lineno="5619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;InputChannels()!=3)<sp/>{</highlight></codeline>
<codeline lineno="5620"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096" kindref="member">icCmmStatInvalidLut</ref>;</highlight></codeline>
<codeline lineno="5621"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5622"><highlight class="normal"></highlight></codeline>
<codeline lineno="5623"><highlight class="normal"><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5624"><highlight class="normal"><sp/><sp/>m_ApplyCurvePtrB<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5625"><highlight class="normal"><sp/><sp/>m_ApplyCurvePtrM<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5626"><highlight class="normal"></highlight></codeline>
<codeline lineno="5627"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="5628"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesB)<sp/>{</highlight></codeline>
<codeline lineno="5629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesB;</highlight></codeline>
<codeline lineno="5630"><highlight class="normal"></highlight></codeline>
<codeline lineno="5631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[0]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[1]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[2]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5634"><highlight class="normal"></highlight></codeline>
<codeline lineno="5635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[0]-&gt;IsIdentity()<sp/>||<sp/>!Curve[1]-&gt;IsIdentity()<sp/>||<sp/>!Curve[2]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="5636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrB<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="5637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5638"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5639"><highlight class="normal"></highlight></codeline>
<codeline lineno="5640"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesM)<sp/>{</highlight></codeline>
<codeline lineno="5641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesM;</highlight></codeline>
<codeline lineno="5642"><highlight class="normal"></highlight></codeline>
<codeline lineno="5643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[0]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[1]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[2]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="5647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[0]-&gt;IsIdentity()<sp/>||<sp/>!Curve[1]-&gt;IsIdentity()<sp/>||<sp/>!Curve[2]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="5648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrM<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="5649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5650"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5651"><highlight class="normal"></highlight></codeline>
<codeline lineno="5652"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CLUT)<sp/>{</highlight></codeline>
<codeline lineno="5653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5654"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5655"><highlight class="normal"></highlight></codeline>
<codeline lineno="5656"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesA)<sp/>{</highlight></codeline>
<codeline lineno="5657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesA;</highlight></codeline>
<codeline lineno="5658"><highlight class="normal"></highlight></codeline>
<codeline lineno="5659"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="5660"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5661"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5662"><highlight class="normal"></highlight></codeline>
<codeline lineno="5663"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="5664"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[i]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="5665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="5666"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="5667"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5668"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5669"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5670"><highlight class="normal"></highlight></codeline>
<codeline lineno="5671"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5672"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="5673"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesA)<sp/>{</highlight></codeline>
<codeline lineno="5674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesA;</highlight></codeline>
<codeline lineno="5675"><highlight class="normal"></highlight></codeline>
<codeline lineno="5676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[0]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5677"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[1]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[2]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5679"><highlight class="normal"></highlight></codeline>
<codeline lineno="5680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[0]-&gt;IsIdentity()<sp/>||<sp/>!Curve[1]-&gt;IsIdentity()<sp/>||<sp/>!Curve[2]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="5681"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="5682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5683"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5684"><highlight class="normal"></highlight></codeline>
<codeline lineno="5685"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CLUT)<sp/>{</highlight></codeline>
<codeline lineno="5686"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5687"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5688"><highlight class="normal"></highlight></codeline>
<codeline lineno="5689"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesM)<sp/>{</highlight></codeline>
<codeline lineno="5690"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesM;</highlight></codeline>
<codeline lineno="5691"><highlight class="normal"></highlight></codeline>
<codeline lineno="5692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="5693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5695"><highlight class="normal"></highlight></codeline>
<codeline lineno="5696"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="5697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[i]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="5698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrM<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="5699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="5700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5701"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5702"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5703"><highlight class="normal"></highlight></codeline>
<codeline lineno="5704"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesB)<sp/>{</highlight></codeline>
<codeline lineno="5705"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesB;</highlight></codeline>
<codeline lineno="5706"><highlight class="normal"></highlight></codeline>
<codeline lineno="5707"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="5708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5709"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5710"><highlight class="normal"></highlight></codeline>
<codeline lineno="5711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="5712"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[i]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="5713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrB<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="5714"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="5715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5716"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5717"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5718"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5719"><highlight class="normal"></highlight></codeline>
<codeline lineno="5720"><highlight class="normal"><sp/><sp/>m_ApplyMatrixPtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5721"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_Matrix)<sp/>{</highlight></codeline>
<codeline lineno="5722"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="5723"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_nInput!=3)<sp/>{</highlight></codeline>
<codeline lineno="5724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860" kindref="member">icCmmStatInvalidProfile</ref>;</highlight></codeline>
<codeline lineno="5725"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5726"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5727"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="5728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_nOutput!=3)<sp/>{</highlight></codeline>
<codeline lineno="5729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860" kindref="member">icCmmStatInvalidProfile</ref>;</highlight></codeline>
<codeline lineno="5730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5731"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5732"><highlight class="normal"></highlight></codeline>
<codeline lineno="5733"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pTag-&gt;m_Matrix-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="5734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyMatrixPtr<sp/>=<sp/>m_pTag-&gt;m_Matrix;</highlight></codeline>
<codeline lineno="5735"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5736"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5737"><highlight class="normal"></highlight></codeline>
<codeline lineno="5738"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="5739"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5740"><highlight class="normal"></highlight></codeline>
<codeline lineno="5754"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccXform3DLut::Apply(CIccApplyXform*<sp/>pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="5755"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="5756"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>Pixel[16];</highlight></codeline>
<codeline lineno="5757"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="5758"><highlight class="normal"></highlight></codeline>
<codeline lineno="5759"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bSrcPcsConversion)</highlight></codeline>
<codeline lineno="5760"><highlight class="normal"><sp/><sp/><sp/><sp/>SrcPixel<sp/>=<sp/>CheckSrcAbs(pApply,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="5761"><highlight class="normal"></highlight></codeline>
<codeline lineno="5762"><highlight class="normal"><sp/><sp/>Pixel[0]<sp/>=<sp/>SrcPixel[0];</highlight></codeline>
<codeline lineno="5763"><highlight class="normal"><sp/><sp/>Pixel[1]<sp/>=<sp/>SrcPixel[1];</highlight></codeline>
<codeline lineno="5764"><highlight class="normal"><sp/><sp/>Pixel[2]<sp/>=<sp/>SrcPixel[2];</highlight></codeline>
<codeline lineno="5765"><highlight class="normal"></highlight></codeline>
<codeline lineno="5766"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="5767"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrB)<sp/>{</highlight></codeline>
<codeline lineno="5768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[0]<sp/>=<sp/>m_ApplyCurvePtrB[0]-&gt;Apply(Pixel[0]);</highlight></codeline>
<codeline lineno="5769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[1]<sp/>=<sp/>m_ApplyCurvePtrB[1]-&gt;Apply(Pixel[1]);</highlight></codeline>
<codeline lineno="5770"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[2]<sp/>=<sp/>m_ApplyCurvePtrB[2]-&gt;Apply(Pixel[2]);</highlight></codeline>
<codeline lineno="5771"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5772"><highlight class="normal"></highlight></codeline>
<codeline lineno="5773"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyMatrixPtr)<sp/>{</highlight></codeline>
<codeline lineno="5774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyMatrixPtr-&gt;Apply(Pixel);</highlight></codeline>
<codeline lineno="5775"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5776"><highlight class="normal"></highlight></codeline>
<codeline lineno="5777"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrM)<sp/>{</highlight></codeline>
<codeline lineno="5778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[0]<sp/>=<sp/>m_ApplyCurvePtrM[0]-&gt;Apply(Pixel[0]);</highlight></codeline>
<codeline lineno="5779"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[1]<sp/>=<sp/>m_ApplyCurvePtrM[1]-&gt;Apply(Pixel[1]);</highlight></codeline>
<codeline lineno="5780"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[2]<sp/>=<sp/>m_ApplyCurvePtrM[2]-&gt;Apply(Pixel[2]);</highlight></codeline>
<codeline lineno="5781"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5782"><highlight class="normal"></highlight></codeline>
<codeline lineno="5783"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CLUT)<sp/>{</highlight></codeline>
<codeline lineno="5784"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nInterp==<ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913af6e0f18af557a029c4dda563c3a003fb" kindref="member">icInterpLinear</ref>)</highlight></codeline>
<codeline lineno="5785"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;Interp3d(Pixel,<sp/>Pixel);</highlight></codeline>
<codeline lineno="5786"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5787"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;Interp3dTetra(Pixel,<sp/>Pixel);</highlight></codeline>
<codeline lineno="5788"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5789"><highlight class="normal"></highlight></codeline>
<codeline lineno="5790"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrA)<sp/>{</highlight></codeline>
<codeline lineno="5791"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="5792"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[i]<sp/>=<sp/>m_ApplyCurvePtrA[i]-&gt;Apply(Pixel[i]);</highlight></codeline>
<codeline lineno="5793"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5794"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5795"><highlight class="normal"></highlight></codeline>
<codeline lineno="5796"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5797"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="5798"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrA)<sp/>{</highlight></codeline>
<codeline lineno="5799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[0]<sp/>=<sp/>m_ApplyCurvePtrA[0]-&gt;Apply(Pixel[0]);</highlight></codeline>
<codeline lineno="5800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[1]<sp/>=<sp/>m_ApplyCurvePtrA[1]-&gt;Apply(Pixel[1]);</highlight></codeline>
<codeline lineno="5801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[2]<sp/>=<sp/>m_ApplyCurvePtrA[2]-&gt;Apply(Pixel[2]);</highlight></codeline>
<codeline lineno="5802"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5803"><highlight class="normal"></highlight></codeline>
<codeline lineno="5804"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CLUT)<sp/>{</highlight></codeline>
<codeline lineno="5805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nInterp==<ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913af6e0f18af557a029c4dda563c3a003fb" kindref="member">icInterpLinear</ref>)</highlight></codeline>
<codeline lineno="5806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;Interp3d(Pixel,<sp/>Pixel);</highlight></codeline>
<codeline lineno="5807"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;Interp3dTetra(Pixel,<sp/>Pixel);</highlight></codeline>
<codeline lineno="5809"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5810"><highlight class="normal"></highlight></codeline>
<codeline lineno="5811"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrM)<sp/>{</highlight></codeline>
<codeline lineno="5812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="5813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[i]<sp/>=<sp/>m_ApplyCurvePtrM[i]-&gt;Apply(Pixel[i]);</highlight></codeline>
<codeline lineno="5814"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5815"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5816"><highlight class="normal"></highlight></codeline>
<codeline lineno="5817"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyMatrixPtr)<sp/>{</highlight></codeline>
<codeline lineno="5818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyMatrixPtr-&gt;Apply(Pixel);</highlight></codeline>
<codeline lineno="5819"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5820"><highlight class="normal"></highlight></codeline>
<codeline lineno="5821"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrB)<sp/>{</highlight></codeline>
<codeline lineno="5822"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="5823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[i]<sp/>=<sp/>m_ApplyCurvePtrB[i]-&gt;Apply(Pixel[i]);</highlight></codeline>
<codeline lineno="5824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5825"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5826"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5827"><highlight class="normal"></highlight></codeline>
<codeline lineno="5828"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="5829"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel[i]<sp/>=<sp/>Pixel[i];</highlight></codeline>
<codeline lineno="5830"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5831"><highlight class="normal"></highlight></codeline>
<codeline lineno="5832"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bDstPcsConversion)</highlight></codeline>
<codeline lineno="5833"><highlight class="normal"><sp/><sp/><sp/><sp/>CheckDstAbs(DstPixel);</highlight></codeline>
<codeline lineno="5834"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5835"><highlight class="normal"></highlight></codeline>
<codeline lineno="5850"><highlight class="normal"><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>CIccXform3DLut::ExtractInputCurves()</highlight></codeline>
<codeline lineno="5851"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5852"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="5853"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="5854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesB)<sp/>{</highlight></codeline>
<codeline lineno="5855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[3];</highlight></codeline>
<codeline lineno="5856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[0]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesB[0]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[1]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesB[1]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[2]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesB[2]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrB<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="5861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5862"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5863"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="5864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesA)<sp/>{</highlight></codeline>
<codeline lineno="5865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[3];</highlight></codeline>
<codeline lineno="5866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[0]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesA[0]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[1]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesA[1]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[2]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesA[2]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="5871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5872"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5873"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5874"><highlight class="normal"></highlight></codeline>
<codeline lineno="5875"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="5876"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5877"><highlight class="normal"></highlight></codeline>
<codeline lineno="5892"><highlight class="normal"><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>CIccXform3DLut::ExtractOutputCurves()</highlight></codeline>
<codeline lineno="5893"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5894"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="5895"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="5896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesA)<sp/>{</highlight></codeline>
<codeline lineno="5897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[m_pTag-&gt;m_nOutput];</highlight></codeline>
<codeline lineno="5898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="5899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesA[i]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="5903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5904"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5905"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="5906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesB)<sp/>{</highlight></codeline>
<codeline lineno="5907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[m_pTag-&gt;m_nOutput];</highlight></codeline>
<codeline lineno="5908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="5909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesB[i]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="5910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrB<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="5913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5914"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5915"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5916"><highlight class="normal"></highlight></codeline>
<codeline lineno="5917"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="5918"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5919"><highlight class="normal"></highlight></codeline>
<codeline lineno="5931"><highlight class="normal">CIccXform4DLut::CIccXform4DLut(<ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag)</highlight></codeline>
<codeline lineno="5932"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5933"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>pTag-&gt;<ref refid="d7/dfd/a00969_1a5cf5b72ab66ca68a6c8ddfd861741bb8" kindref="member">IsMBBType</ref>())<sp/>{</highlight></codeline>
<codeline lineno="5934"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pTag<sp/>=<sp/>(<ref refid="dc/d06/a01153" kindref="compound">CIccMBB</ref>*)pTag;</highlight></codeline>
<codeline lineno="5935"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5936"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="5937"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5938"><highlight class="normal"></highlight></codeline>
<codeline lineno="5939"><highlight class="normal"><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>m_ApplyCurvePtrB<sp/>=<sp/>m_ApplyCurvePtrM<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5940"><highlight class="normal"><sp/><sp/>m_ApplyMatrixPtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5941"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5942"><highlight class="normal"></highlight></codeline>
<codeline lineno="5943"><highlight class="normal"></highlight></codeline>
<codeline lineno="5952"><highlight class="normal">CIccXform4DLut::~CIccXform4DLut()</highlight></codeline>
<codeline lineno="5953"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5954"><highlight class="normal">}</highlight></codeline>
<codeline lineno="5955"><highlight class="normal"></highlight></codeline>
<codeline lineno="5956"><highlight class="normal"></highlight></codeline>
<codeline lineno="5967"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccXform4DLut::Begin()</highlight></codeline>
<codeline lineno="5968"><highlight class="normal">{</highlight></codeline>
<codeline lineno="5969"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>status;</highlight></codeline>
<codeline lineno="5970"><highlight class="normal"><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">CIccCurve</ref><sp/>**Curve;</highlight></codeline>
<codeline lineno="5971"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="5972"><highlight class="normal"></highlight></codeline>
<codeline lineno="5973"><highlight class="normal"><sp/><sp/>status<sp/>=<sp/>CIccXform::Begin();</highlight></codeline>
<codeline lineno="5974"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(status<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="5975"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>status;</highlight></codeline>
<codeline lineno="5976"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5977"><highlight class="normal"></highlight></codeline>
<codeline lineno="5978"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pTag<sp/>||</highlight></codeline>
<codeline lineno="5979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;InputChannels()!=4)<sp/>{</highlight></codeline>
<codeline lineno="5980"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096" kindref="member">icCmmStatInvalidLut</ref>;</highlight></codeline>
<codeline lineno="5981"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="5982"><highlight class="normal"></highlight></codeline>
<codeline lineno="5983"><highlight class="normal"><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>m_ApplyCurvePtrB<sp/>=<sp/>m_ApplyCurvePtrM<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="5984"><highlight class="normal"></highlight></codeline>
<codeline lineno="5985"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="5986"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesB)<sp/>{</highlight></codeline>
<codeline lineno="5987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesB;</highlight></codeline>
<codeline lineno="5988"><highlight class="normal"></highlight></codeline>
<codeline lineno="5989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[0]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[1]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[2]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[3]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="5993"><highlight class="normal"></highlight></codeline>
<codeline lineno="5994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[0]-&gt;IsIdentity()<sp/>||<sp/>!Curve[1]-&gt;IsIdentity()<sp/>||</highlight></codeline>
<codeline lineno="5995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!Curve[2]-&gt;IsIdentity()<sp/>||<sp/>!Curve[3]-&gt;IsIdentity())<sp/></highlight></codeline>
<codeline lineno="5996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="5997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrB<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="5998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="5999"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6000"><highlight class="normal"></highlight></codeline>
<codeline lineno="6001"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CLUT)<sp/>{</highlight></codeline>
<codeline lineno="6002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="6003"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6004"><highlight class="normal"></highlight></codeline>
<codeline lineno="6005"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesA)<sp/>{</highlight></codeline>
<codeline lineno="6006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesA;</highlight></codeline>
<codeline lineno="6007"><highlight class="normal"></highlight></codeline>
<codeline lineno="6008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="6010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6011"><highlight class="normal"></highlight></codeline>
<codeline lineno="6012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[i]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="6014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="6015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6018"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6019"><highlight class="normal"></highlight></codeline>
<codeline lineno="6020"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6021"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6022"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesA)<sp/>{</highlight></codeline>
<codeline lineno="6023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesA;</highlight></codeline>
<codeline lineno="6024"><highlight class="normal"></highlight></codeline>
<codeline lineno="6025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[0]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="6026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[1]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="6027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[2]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="6028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve[3]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="6029"><highlight class="normal"></highlight></codeline>
<codeline lineno="6030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[0]-&gt;IsIdentity()<sp/>||<sp/>!Curve[1]-&gt;IsIdentity()<sp/>||</highlight></codeline>
<codeline lineno="6031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!Curve[2]-&gt;IsIdentity()<sp/>||<sp/>!Curve[3]-&gt;IsIdentity())<sp/></highlight></codeline>
<codeline lineno="6032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="6033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="6034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6035"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6036"><highlight class="normal"></highlight></codeline>
<codeline lineno="6037"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CLUT)<sp/>{</highlight></codeline>
<codeline lineno="6038"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="6039"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6040"><highlight class="normal"></highlight></codeline>
<codeline lineno="6041"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesM)<sp/>{</highlight></codeline>
<codeline lineno="6042"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesM;</highlight></codeline>
<codeline lineno="6043"><highlight class="normal"></highlight></codeline>
<codeline lineno="6044"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="6046"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6047"><highlight class="normal"></highlight></codeline>
<codeline lineno="6048"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6049"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[i]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="6050"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrM<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="6051"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6052"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6053"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6054"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6055"><highlight class="normal"></highlight></codeline>
<codeline lineno="6056"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesB)<sp/>{</highlight></codeline>
<codeline lineno="6057"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesB;</highlight></codeline>
<codeline lineno="6058"><highlight class="normal"></highlight></codeline>
<codeline lineno="6059"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6060"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="6061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6062"><highlight class="normal"></highlight></codeline>
<codeline lineno="6063"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6064"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[i]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="6065"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrB<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="6066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6069"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6070"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6071"><highlight class="normal"></highlight></codeline>
<codeline lineno="6072"><highlight class="normal"><sp/><sp/>m_ApplyMatrixPtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6073"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_Matrix)<sp/>{</highlight></codeline>
<codeline lineno="6074"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="6075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860" kindref="member">icCmmStatInvalidProfile</ref>;</highlight></codeline>
<codeline lineno="6076"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6077"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_nOutput!=3)<sp/>{</highlight></codeline>
<codeline lineno="6079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860" kindref="member">icCmmStatInvalidProfile</ref>;</highlight></codeline>
<codeline lineno="6080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6081"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6082"><highlight class="normal"></highlight></codeline>
<codeline lineno="6083"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pTag-&gt;m_Matrix-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="6084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyMatrixPtr<sp/>=<sp/>m_pTag-&gt;m_Matrix;</highlight></codeline>
<codeline lineno="6085"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6086"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6087"><highlight class="normal"></highlight></codeline>
<codeline lineno="6088"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="6089"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6090"><highlight class="normal"></highlight></codeline>
<codeline lineno="6091"><highlight class="normal"></highlight></codeline>
<codeline lineno="6105"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccXform4DLut::Apply(CIccApplyXform*<sp/>pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="6106"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="6107"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>Pixel[16];</highlight></codeline>
<codeline lineno="6108"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="6109"><highlight class="normal"></highlight></codeline>
<codeline lineno="6110"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bSrcPcsConversion)</highlight></codeline>
<codeline lineno="6111"><highlight class="normal"><sp/><sp/><sp/><sp/>SrcPixel<sp/>=<sp/>CheckSrcAbs(pApply,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="6112"><highlight class="normal"></highlight></codeline>
<codeline lineno="6113"><highlight class="normal"><sp/><sp/>Pixel[0]<sp/>=<sp/>SrcPixel[0];</highlight></codeline>
<codeline lineno="6114"><highlight class="normal"><sp/><sp/>Pixel[1]<sp/>=<sp/>SrcPixel[1];</highlight></codeline>
<codeline lineno="6115"><highlight class="normal"><sp/><sp/>Pixel[2]<sp/>=<sp/>SrcPixel[2];</highlight></codeline>
<codeline lineno="6116"><highlight class="normal"><sp/><sp/>Pixel[3]<sp/>=<sp/>SrcPixel[3];</highlight></codeline>
<codeline lineno="6117"><highlight class="normal"></highlight></codeline>
<codeline lineno="6118"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="6119"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrB)<sp/>{</highlight></codeline>
<codeline lineno="6120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[0]<sp/>=<sp/>m_ApplyCurvePtrB[0]-&gt;Apply(Pixel[0]);</highlight></codeline>
<codeline lineno="6121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[1]<sp/>=<sp/>m_ApplyCurvePtrB[1]-&gt;Apply(Pixel[1]);</highlight></codeline>
<codeline lineno="6122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[2]<sp/>=<sp/>m_ApplyCurvePtrB[2]-&gt;Apply(Pixel[2]);</highlight></codeline>
<codeline lineno="6123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[3]<sp/>=<sp/>m_ApplyCurvePtrB[3]-&gt;Apply(Pixel[3]);</highlight></codeline>
<codeline lineno="6124"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6125"><highlight class="normal"></highlight></codeline>
<codeline lineno="6126"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CLUT)<sp/>{</highlight></codeline>
<codeline lineno="6127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;Interp4d(Pixel,<sp/>Pixel);</highlight></codeline>
<codeline lineno="6128"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6129"><highlight class="normal"></highlight></codeline>
<codeline lineno="6130"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrA)<sp/>{</highlight></codeline>
<codeline lineno="6131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[i]<sp/>=<sp/>m_ApplyCurvePtrA[i]-&gt;Apply(Pixel[i]);</highlight></codeline>
<codeline lineno="6133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6134"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6135"><highlight class="normal"></highlight></codeline>
<codeline lineno="6136"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6137"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrA)<sp/>{</highlight></codeline>
<codeline lineno="6139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[0]<sp/>=<sp/>m_ApplyCurvePtrA[0]-&gt;Apply(Pixel[0]);</highlight></codeline>
<codeline lineno="6140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[1]<sp/>=<sp/>m_ApplyCurvePtrA[1]-&gt;Apply(Pixel[1]);</highlight></codeline>
<codeline lineno="6141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[2]<sp/>=<sp/>m_ApplyCurvePtrA[2]-&gt;Apply(Pixel[2]);</highlight></codeline>
<codeline lineno="6142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[3]<sp/>=<sp/>m_ApplyCurvePtrA[3]-&gt;Apply(Pixel[3]);</highlight></codeline>
<codeline lineno="6143"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6144"><highlight class="normal"></highlight></codeline>
<codeline lineno="6145"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CLUT)<sp/>{</highlight></codeline>
<codeline lineno="6146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;Interp4d(Pixel,<sp/>Pixel);</highlight></codeline>
<codeline lineno="6147"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6148"><highlight class="normal"></highlight></codeline>
<codeline lineno="6149"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrM)<sp/>{</highlight></codeline>
<codeline lineno="6150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[i]<sp/>=<sp/>m_ApplyCurvePtrM[i]-&gt;Apply(Pixel[i]);</highlight></codeline>
<codeline lineno="6152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6153"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6154"><highlight class="normal"></highlight></codeline>
<codeline lineno="6155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyMatrixPtr)<sp/>{</highlight></codeline>
<codeline lineno="6156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyMatrixPtr-&gt;Apply(Pixel);</highlight></codeline>
<codeline lineno="6157"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6158"><highlight class="normal"></highlight></codeline>
<codeline lineno="6159"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrB)<sp/>{</highlight></codeline>
<codeline lineno="6160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[i]<sp/>=<sp/>m_ApplyCurvePtrB[i]-&gt;Apply(Pixel[i]);</highlight></codeline>
<codeline lineno="6162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6163"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6164"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6165"><highlight class="normal"></highlight></codeline>
<codeline lineno="6166"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6167"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel[i]<sp/>=<sp/>Pixel[i];</highlight></codeline>
<codeline lineno="6168"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6169"><highlight class="normal"></highlight></codeline>
<codeline lineno="6170"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bDstPcsConversion)</highlight></codeline>
<codeline lineno="6171"><highlight class="normal"><sp/><sp/><sp/><sp/>CheckDstAbs(DstPixel);</highlight></codeline>
<codeline lineno="6172"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6173"><highlight class="normal"></highlight></codeline>
<codeline lineno="6188"><highlight class="normal"><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>CIccXform4DLut::ExtractInputCurves()</highlight></codeline>
<codeline lineno="6189"><highlight class="normal">{</highlight></codeline>
<codeline lineno="6190"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="6191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="6192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesB)<sp/>{</highlight></codeline>
<codeline lineno="6193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[4];</highlight></codeline>
<codeline lineno="6194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[0]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesB[0]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="6195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[1]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesB[1]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="6196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[2]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesB[2]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="6197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[3]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesB[3]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="6198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrB<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="6200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesA)<sp/>{</highlight></codeline>
<codeline lineno="6204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[4];</highlight></codeline>
<codeline lineno="6205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[0]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesA[0]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="6206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[1]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesA[1]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="6207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[2]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesA[2]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="6208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[3]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesA[3]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="6209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="6211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6213"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6214"><highlight class="normal"></highlight></codeline>
<codeline lineno="6215"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="6216"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6217"><highlight class="normal"></highlight></codeline>
<codeline lineno="6232"><highlight class="normal"><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>CIccXform4DLut::ExtractOutputCurves()</highlight></codeline>
<codeline lineno="6233"><highlight class="normal">{</highlight></codeline>
<codeline lineno="6234"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="6235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="6236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesA)<sp/>{</highlight></codeline>
<codeline lineno="6237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[m_pTag-&gt;m_nOutput];</highlight></codeline>
<codeline lineno="6238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesA[i]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="6240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="6243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesB)<sp/>{</highlight></codeline>
<codeline lineno="6247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[m_pTag-&gt;m_nOutput];</highlight></codeline>
<codeline lineno="6248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesB[i]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="6250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrB<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="6253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6255"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6256"><highlight class="normal"></highlight></codeline>
<codeline lineno="6257"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="6258"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6259"><highlight class="normal"></highlight></codeline>
<codeline lineno="6260"><highlight class="normal"></highlight></codeline>
<codeline lineno="6272"><highlight class="normal">CIccXformNDLut::CIccXformNDLut(<ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag)</highlight></codeline>
<codeline lineno="6273"><highlight class="normal">{</highlight></codeline>
<codeline lineno="6274"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>pTag-&gt;<ref refid="d7/dfd/a00969_1a5cf5b72ab66ca68a6c8ddfd861741bb8" kindref="member">IsMBBType</ref>())<sp/>{</highlight></codeline>
<codeline lineno="6275"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pTag<sp/>=<sp/>(<ref refid="dc/d06/a01153" kindref="compound">CIccMBB</ref>*)pTag;</highlight></codeline>
<codeline lineno="6276"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6277"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6278"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6279"><highlight class="normal"></highlight></codeline>
<codeline lineno="6280"><highlight class="normal"><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>m_ApplyCurvePtrB<sp/>=<sp/>m_ApplyCurvePtrM<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6281"><highlight class="normal"><sp/><sp/>m_ApplyMatrixPtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6282"><highlight class="normal"><sp/><sp/>m_nNumInput<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="6283"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6284"><highlight class="normal"></highlight></codeline>
<codeline lineno="6285"><highlight class="normal"></highlight></codeline>
<codeline lineno="6294"><highlight class="normal">CIccXformNDLut::~CIccXformNDLut()</highlight></codeline>
<codeline lineno="6295"><highlight class="normal">{</highlight></codeline>
<codeline lineno="6296"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6297"><highlight class="normal"></highlight></codeline>
<codeline lineno="6298"><highlight class="normal"></highlight></codeline>
<codeline lineno="6309"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccXformNDLut::Begin()</highlight></codeline>
<codeline lineno="6310"><highlight class="normal">{</highlight></codeline>
<codeline lineno="6311"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>status;</highlight></codeline>
<codeline lineno="6312"><highlight class="normal"><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">CIccCurve</ref><sp/>**Curve;</highlight></codeline>
<codeline lineno="6313"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="6314"><highlight class="normal"></highlight></codeline>
<codeline lineno="6315"><highlight class="normal"><sp/><sp/>status<sp/>=<sp/>CIccXform::Begin();</highlight></codeline>
<codeline lineno="6316"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(status<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="6317"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>status;</highlight></codeline>
<codeline lineno="6318"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6319"><highlight class="normal"></highlight></codeline>
<codeline lineno="6320"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pTag<sp/>||<sp/>(m_pTag-&gt;InputChannels()&gt;2<sp/>&amp;&amp;<sp/>m_pTag-&gt;InputChannels()&lt;5))<sp/>{</highlight></codeline>
<codeline lineno="6321"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096" kindref="member">icCmmStatInvalidLut</ref>;</highlight></codeline>
<codeline lineno="6322"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6323"><highlight class="normal"></highlight></codeline>
<codeline lineno="6324"><highlight class="normal"><sp/><sp/>m_nNumInput<sp/>=<sp/>m_pTag-&gt;m_nInput;</highlight></codeline>
<codeline lineno="6325"><highlight class="normal"></highlight></codeline>
<codeline lineno="6326"><highlight class="normal"><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>m_ApplyCurvePtrB<sp/>=<sp/>m_ApplyCurvePtrM<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6327"><highlight class="normal"></highlight></codeline>
<codeline lineno="6328"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="6329"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesB)<sp/>{</highlight></codeline>
<codeline lineno="6330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesB;</highlight></codeline>
<codeline lineno="6331"><highlight class="normal"></highlight></codeline>
<codeline lineno="6332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nNumInput;<sp/>i++)</highlight></codeline>
<codeline lineno="6333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]-&gt;Begin();</highlight></codeline>
<codeline lineno="6334"><highlight class="normal"></highlight></codeline>
<codeline lineno="6335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nNumInput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[i]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="6337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrB<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="6338"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6340"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6341"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6342"><highlight class="normal"></highlight></codeline>
<codeline lineno="6343"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CLUT)<sp/>{</highlight></codeline>
<codeline lineno="6344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="6345"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6346"><highlight class="normal"></highlight></codeline>
<codeline lineno="6347"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesA)<sp/>{</highlight></codeline>
<codeline lineno="6348"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesA;</highlight></codeline>
<codeline lineno="6349"><highlight class="normal"></highlight></codeline>
<codeline lineno="6350"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="6352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6353"><highlight class="normal"></highlight></codeline>
<codeline lineno="6354"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[i]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="6356"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="6357"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6358"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6359"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6360"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6361"><highlight class="normal"></highlight></codeline>
<codeline lineno="6362"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6363"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6364"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesA)<sp/>{</highlight></codeline>
<codeline lineno="6365"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesA;</highlight></codeline>
<codeline lineno="6366"><highlight class="normal"></highlight></codeline>
<codeline lineno="6367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nNumInput;<sp/>i++)</highlight></codeline>
<codeline lineno="6368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]-&gt;Begin();</highlight></codeline>
<codeline lineno="6369"><highlight class="normal"></highlight></codeline>
<codeline lineno="6370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nNumInput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[i]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="6372"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="6373"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6376"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6377"><highlight class="normal"></highlight></codeline>
<codeline lineno="6378"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CLUT)<sp/>{</highlight></codeline>
<codeline lineno="6379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="6380"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6381"><highlight class="normal"></highlight></codeline>
<codeline lineno="6382"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesM)<sp/>{</highlight></codeline>
<codeline lineno="6383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesM;</highlight></codeline>
<codeline lineno="6384"><highlight class="normal"></highlight></codeline>
<codeline lineno="6385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="6387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6388"><highlight class="normal"></highlight></codeline>
<codeline lineno="6389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[i]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="6391"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrM<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="6392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6395"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6396"><highlight class="normal"></highlight></codeline>
<codeline lineno="6397"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesB)<sp/>{</highlight></codeline>
<codeline lineno="6398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>Curve<sp/>=<sp/>m_pTag-&gt;m_CurvesB;</highlight></codeline>
<codeline lineno="6399"><highlight class="normal"></highlight></codeline>
<codeline lineno="6400"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6401"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]-&gt;<ref refid="dd/de4/a01121_1a947c1f052a69bbfdbe3c873f3b44921d" kindref="member">Begin</ref>();</highlight></codeline>
<codeline lineno="6402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6403"><highlight class="normal"></highlight></codeline>
<codeline lineno="6404"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6405"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Curve[i]-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="6406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrB<sp/>=<sp/>Curve;</highlight></codeline>
<codeline lineno="6407"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6408"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6409"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6410"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6411"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6412"><highlight class="normal"></highlight></codeline>
<codeline lineno="6413"><highlight class="normal"><sp/><sp/>m_ApplyMatrixPtr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6414"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_Matrix)<sp/>{</highlight></codeline>
<codeline lineno="6415"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="6416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860" kindref="member">icCmmStatInvalidProfile</ref>;</highlight></codeline>
<codeline lineno="6417"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6418"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_nOutput!=3)<sp/>{</highlight></codeline>
<codeline lineno="6420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860" kindref="member">icCmmStatInvalidProfile</ref>;</highlight></codeline>
<codeline lineno="6421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6422"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6423"><highlight class="normal"></highlight></codeline>
<codeline lineno="6424"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pTag-&gt;m_Matrix-&gt;IsIdentity())<sp/>{</highlight></codeline>
<codeline lineno="6425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyMatrixPtr<sp/>=<sp/>m_pTag-&gt;m_Matrix;</highlight></codeline>
<codeline lineno="6426"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6427"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6428"><highlight class="normal"></highlight></codeline>
<codeline lineno="6429"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="6430"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6431"><highlight class="normal"></highlight></codeline>
<codeline lineno="6432"><highlight class="normal"></highlight></codeline>
<codeline lineno="6444"><highlight class="normal">CIccApplyXform*<sp/>CIccXformNDLut::GetNewApply(<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref>&amp;<sp/>status)</highlight></codeline>
<codeline lineno="6445"><highlight class="normal">{</highlight></codeline>
<codeline lineno="6446"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pTag)</highlight></codeline>
<codeline lineno="6447"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="6448"><highlight class="normal"></highlight></codeline>
<codeline lineno="6449"><highlight class="normal"><sp/><sp/><ref refid="d8/d02/a01149" kindref="compound">CIccCLUT</ref>*<sp/>pCLUT<sp/>=<sp/>m_pTag-&gt;GetCLUT();</highlight></codeline>
<codeline lineno="6450"><highlight class="normal"><sp/><sp/><ref refid="d9/d65/a01145" kindref="compound">CIccApplyCLUT</ref>*<sp/>pApply<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6451"><highlight class="normal"></highlight></codeline>
<codeline lineno="6452"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pCLUT<sp/>&amp;&amp;<sp/>m_nNumInput<sp/>&gt;<sp/>6)<sp/>{</highlight></codeline>
<codeline lineno="6453"><highlight class="normal"><sp/><sp/><sp/><sp/>pApply<sp/>=<sp/>pCLUT-&gt;<ref refid="d8/d02/a01149_1af5d5680c45af970ec254e32f06b15c41" kindref="member">GetNewApply</ref>();</highlight></codeline>
<codeline lineno="6454"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pApply)<sp/>{</highlight></codeline>
<codeline lineno="6455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="6456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="6457"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6458"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6459"><highlight class="normal"></highlight></codeline>
<codeline lineno="6460"><highlight class="normal"><sp/><sp/>CIccApplyNDLutXform*<sp/>rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccApplyNDLutXform(</highlight><highlight class="keyword">this</highlight><highlight class="normal">,<sp/>pApply);</highlight></codeline>
<codeline lineno="6461"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="6462"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!rv)<sp/>{</highlight></codeline>
<codeline lineno="6463"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApply)</highlight></codeline>
<codeline lineno="6464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pApply;</highlight></codeline>
<codeline lineno="6465"><highlight class="normal"><sp/><sp/><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="6466"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="6467"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6468"><highlight class="normal"></highlight></codeline>
<codeline lineno="6469"><highlight class="normal"><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="6470"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="6471"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6472"><highlight class="normal"></highlight></codeline>
<codeline lineno="6486"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccXformNDLut::Apply(CIccApplyXform*<sp/>pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="6487"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="6488"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>Pixel[16]<sp/>=<sp/>{0};</highlight></codeline>
<codeline lineno="6489"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="6490"><highlight class="normal"></highlight></codeline>
<codeline lineno="6491"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bSrcPcsConversion)</highlight></codeline>
<codeline lineno="6492"><highlight class="normal"><sp/><sp/><sp/><sp/>SrcPixel<sp/>=<sp/>CheckSrcAbs(pApply,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="6493"><highlight class="normal"></highlight></codeline>
<codeline lineno="6494"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nNumInput;<sp/>i++)</highlight></codeline>
<codeline lineno="6495"><highlight class="normal"><sp/><sp/><sp/><sp/>Pixel[i]<sp/>=<sp/>SrcPixel[i];</highlight></codeline>
<codeline lineno="6496"><highlight class="normal"></highlight></codeline>
<codeline lineno="6497"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="6498"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrB)<sp/>{</highlight></codeline>
<codeline lineno="6499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nNumInput;<sp/>i++)</highlight></codeline>
<codeline lineno="6500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[i]<sp/>=<sp/>m_ApplyCurvePtrB[i]-&gt;Apply(Pixel[i]);</highlight></codeline>
<codeline lineno="6501"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6502"><highlight class="normal"></highlight></codeline>
<codeline lineno="6503"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CLUT)<sp/>{</highlight></codeline>
<codeline lineno="6504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(m_nNumInput)<sp/>{</highlight></codeline>
<codeline lineno="6505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>5:</highlight></codeline>
<codeline lineno="6506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;Interp5d(Pixel,<sp/>Pixel);</highlight></codeline>
<codeline lineno="6507"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>6:</highlight></codeline>
<codeline lineno="6509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;Interp6d(Pixel,<sp/>Pixel);</highlight></codeline>
<codeline lineno="6510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6512"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="6513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccApplyNDLutXform*<sp/>pNDApply<sp/>=<sp/>(CIccApplyNDLutXform*)pApply;</highlight></codeline>
<codeline lineno="6514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;InterpND(Pixel,<sp/>Pixel,<sp/>pNDApply-&gt;m_pApply);</highlight></codeline>
<codeline lineno="6515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6518"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6519"><highlight class="normal"></highlight></codeline>
<codeline lineno="6520"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrA)<sp/>{</highlight></codeline>
<codeline lineno="6521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[i]<sp/>=<sp/>m_ApplyCurvePtrA[i]-&gt;Apply(Pixel[i]);</highlight></codeline>
<codeline lineno="6523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6524"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6525"><highlight class="normal"></highlight></codeline>
<codeline lineno="6526"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6527"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6528"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrA)<sp/>{</highlight></codeline>
<codeline lineno="6529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_nNumInput;<sp/>i++)</highlight></codeline>
<codeline lineno="6530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[i]<sp/>=<sp/>m_ApplyCurvePtrA[i]-&gt;Apply(Pixel[i]);</highlight></codeline>
<codeline lineno="6531"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6532"><highlight class="normal"></highlight></codeline>
<codeline lineno="6533"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CLUT)<sp/>{</highlight></codeline>
<codeline lineno="6534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(m_nNumInput)<sp/>{</highlight></codeline>
<codeline lineno="6535"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>5:</highlight></codeline>
<codeline lineno="6536"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;Interp5d(Pixel,<sp/>Pixel);</highlight></codeline>
<codeline lineno="6537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>6:</highlight></codeline>
<codeline lineno="6539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;Interp6d(Pixel,<sp/>Pixel);</highlight></codeline>
<codeline lineno="6540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="6542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="6543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccApplyNDLutXform*<sp/>pNDApply<sp/>=<sp/>(CIccApplyNDLutXform*)pApply;</highlight></codeline>
<codeline lineno="6544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;m_CLUT-&gt;InterpND(Pixel,<sp/>Pixel,<sp/>pNDApply-&gt;m_pApply);</highlight></codeline>
<codeline lineno="6545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="6548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6549"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6550"><highlight class="normal"></highlight></codeline>
<codeline lineno="6551"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrM)<sp/>{</highlight></codeline>
<codeline lineno="6552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[i]<sp/>=<sp/>m_ApplyCurvePtrM[i]-&gt;Apply(Pixel[i]);</highlight></codeline>
<codeline lineno="6554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6555"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6556"><highlight class="normal"></highlight></codeline>
<codeline lineno="6557"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyMatrixPtr)<sp/>{</highlight></codeline>
<codeline lineno="6558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyMatrixPtr-&gt;Apply(Pixel);</highlight></codeline>
<codeline lineno="6559"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6560"><highlight class="normal"></highlight></codeline>
<codeline lineno="6561"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_ApplyCurvePtrB)<sp/>{</highlight></codeline>
<codeline lineno="6562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Pixel[i]<sp/>=<sp/>m_ApplyCurvePtrB[i]-&gt;Apply(Pixel[i]);</highlight></codeline>
<codeline lineno="6564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6565"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6566"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6567"><highlight class="normal"></highlight></codeline>
<codeline lineno="6568"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6569"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel[i]<sp/>=<sp/>Pixel[i];</highlight></codeline>
<codeline lineno="6570"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6571"><highlight class="normal"></highlight></codeline>
<codeline lineno="6572"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bDstPcsConversion)</highlight></codeline>
<codeline lineno="6573"><highlight class="normal"><sp/><sp/><sp/><sp/>CheckDstAbs(DstPixel);</highlight></codeline>
<codeline lineno="6574"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6575"><highlight class="normal"></highlight></codeline>
<codeline lineno="6590"><highlight class="normal"><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>CIccXformNDLut::ExtractInputCurves()</highlight></codeline>
<codeline lineno="6591"><highlight class="normal">{</highlight></codeline>
<codeline lineno="6592"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="6593"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="6594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesB)<sp/>{</highlight></codeline>
<codeline lineno="6595"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[m_pTag-&gt;m_nInput];</highlight></codeline>
<codeline lineno="6596"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;m_pTag-&gt;m_nInput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesB[i]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="6598"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6599"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrB<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6600"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="6601"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6602"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6603"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6604"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesA)<sp/>{</highlight></codeline>
<codeline lineno="6605"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[m_pTag-&gt;m_nInput];</highlight></codeline>
<codeline lineno="6606"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;m_pTag-&gt;m_nInput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6607"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesA[i]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="6608"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6609"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6610"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="6611"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6612"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6613"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6614"><highlight class="normal"></highlight></codeline>
<codeline lineno="6615"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="6616"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6617"><highlight class="normal"></highlight></codeline>
<codeline lineno="6632"><highlight class="normal"><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>CIccXformNDLut::ExtractOutputCurves()</highlight></codeline>
<codeline lineno="6633"><highlight class="normal">{</highlight></codeline>
<codeline lineno="6634"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_bInput)<sp/>{</highlight></codeline>
<codeline lineno="6635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_bInputMatrix)<sp/>{</highlight></codeline>
<codeline lineno="6636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesA)<sp/>{</highlight></codeline>
<codeline lineno="6637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[m_pTag-&gt;m_nOutput];</highlight></codeline>
<codeline lineno="6638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesA[i]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="6640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrA<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="6643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag-&gt;m_CurvesB)<sp/>{</highlight></codeline>
<codeline lineno="6647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>*<sp/>Curve<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="dd/de4/a01121" kindref="compound">LPIccCurve</ref>[m_pTag-&gt;m_nOutput];</highlight></codeline>
<codeline lineno="6648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i=0;<sp/>i&lt;m_pTag-&gt;m_nOutput;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="6649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Curve[i]<sp/>=<sp/>(<ref refid="da/d24/a00068_1a39a314ab7bc07c151871d9745ed17cae" kindref="member">LPIccCurve</ref>)(m_pTag-&gt;m_CurvesB[i]-&gt;NewCopy());</highlight></codeline>
<codeline lineno="6650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_ApplyCurvePtrB<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>Curve;</highlight></codeline>
<codeline lineno="6653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6655"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6656"><highlight class="normal"></highlight></codeline>
<codeline lineno="6657"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="6658"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6659"><highlight class="normal"></highlight></codeline>
<codeline lineno="6673"><highlight class="normal">CIccXformNamedColor::CIccXformNamedColor(<ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag,<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>csPcs,<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>csDevice,<sp/></highlight></codeline>
<codeline lineno="6674"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a852cf5d81aa3d65ff6a08c3eaafcd0dc" kindref="member">icSpectralColorSignature</ref><sp/>csSpectralPcs</highlight><highlight class="comment">/*<sp/>=icSigNoSpectralData<sp/>*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="6675"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>*pSpectralRange<sp/></highlight><highlight class="comment">/*<sp/>=<sp/>NULL<sp/>*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="6676"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="dd/d72/a00541" kindref="compound">icSpectralRange</ref><sp/>*pBiSpectralRange<sp/></highlight><highlight class="comment">/*<sp/>=<sp/>NULL<sp/>*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="6677"><highlight class="normal">{</highlight></codeline>
<codeline lineno="6678"><highlight class="normal"><sp/><sp/>m_nApplyInterface<sp/>=<sp/>icApplyPixel2Pixel;<sp/></highlight><highlight class="comment">//<sp/>was<sp/>uninitialized</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6679"><highlight class="normal"><sp/><sp/>m_pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6680"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="6681"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag-&gt;<ref refid="d7/dfd/a00969_1a0d6f4b6f857134bd87bfb0cd54025208" kindref="member">GetType</ref>()==<ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddeabd3b6889c64ac3ffb16f1c48be950dc8" kindref="member">icSigNamedColor2Type</ref>)<sp/>{</highlight></codeline>
<codeline lineno="6682"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag<sp/>=<sp/>(<ref refid="d7/d59/a01013" kindref="compound">CIccTagNamedColor2</ref>*)pTag;</highlight></codeline>
<codeline lineno="6683"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pArray<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6684"><highlight class="normal"></highlight></codeline>
<codeline lineno="6685"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag-&gt;SetColorSpaces(csPcs,<sp/>csDevice);</highlight></codeline>
<codeline lineno="6686"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6687"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag-&gt;<ref refid="d7/dfd/a00969_1acc454c2f425b8619187fc75f682d7aa4" kindref="member">GetTagArrayType</ref>()==<ref refid="d7/d46/a00002_1a97bb6c6d4e1859ba7290162215ac8beba58bd0f3ca3c177aacc2b9fd1cbc0009b" kindref="member">icSigNamedColorArray</ref>)<sp/>{</highlight></codeline>
<codeline lineno="6688"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/de0/a00465" kindref="compound">CIccTagArray</ref><sp/>*pArray<sp/>=<sp/>(<ref refid="db/de0/a00465" kindref="compound">CIccTagArray</ref>*)pTag;</highlight></codeline>
<codeline lineno="6689"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d5/d05/a00385" kindref="compound">CIccArrayNamedColor</ref><sp/>*pNamed<sp/>=<sp/>(<ref refid="d5/d05/a00385" kindref="compound">CIccArrayNamedColor</ref>*)pArray-&gt;<ref refid="db/de0/a00465_1ab040f1c5616c6b39dc92a5d2516f7709" kindref="member">GetArrayHandler</ref>();</highlight></codeline>
<codeline lineno="6690"><highlight class="normal"></highlight></codeline>
<codeline lineno="6691"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNamed)<sp/>{</highlight></codeline>
<codeline lineno="6692"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6693"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pArray<sp/>=<sp/>pNamed;</highlight></codeline>
<codeline lineno="6694"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pNamed-&gt;<ref refid="d5/d05/a00385_1a823d6f29347e6f86de07de8bfad1ba89" kindref="member">SetColorSpaces</ref>(csPcs,<sp/>csDevice,<sp/>csSpectralPcs,<sp/>pSpectralRange,<sp/>pBiSpectralRange);</highlight></codeline>
<codeline lineno="6695"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6696"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6697"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6698"><highlight class="normal"></highlight></codeline>
<codeline lineno="6699"><highlight class="normal"><sp/><sp/>m_nSrcSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref>;</highlight></codeline>
<codeline lineno="6700"><highlight class="normal"><sp/><sp/>m_nDestSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref>;</highlight></codeline>
<codeline lineno="6701"><highlight class="normal"><sp/><sp/>m_pArray<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="6702"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6703"><highlight class="normal"></highlight></codeline>
<codeline lineno="6704"><highlight class="normal"></highlight></codeline>
<codeline lineno="6713"><highlight class="normal">CIccXformNamedColor::~CIccXformNamedColor()</highlight></codeline>
<codeline lineno="6714"><highlight class="normal">{</highlight></codeline>
<codeline lineno="6715"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6716"><highlight class="normal"></highlight></codeline>
<codeline lineno="6727"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccXformNamedColor::Begin()</highlight></codeline>
<codeline lineno="6728"><highlight class="normal">{</highlight></codeline>
<codeline lineno="6729"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>status;</highlight></codeline>
<codeline lineno="6730"><highlight class="normal"></highlight></codeline>
<codeline lineno="6731"><highlight class="normal"><sp/><sp/>status<sp/>=<sp/>CIccXform::Begin();</highlight></codeline>
<codeline lineno="6732"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(status<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="6733"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>status;</highlight></codeline>
<codeline lineno="6734"><highlight class="normal"></highlight></codeline>
<codeline lineno="6735"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag==NULL<sp/>&amp;&amp;<sp/>m_pArray==NULL)<sp/>{</highlight></codeline>
<codeline lineno="6736"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a" kindref="member">icCmmStatProfileMissingTag</ref>;</highlight></codeline>
<codeline lineno="6737"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6738"><highlight class="normal"></highlight></codeline>
<codeline lineno="6739"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nSrcSpace==<ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref><sp/>||</highlight></codeline>
<codeline lineno="6740"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_nDestSpace==<ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="6741"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="6742"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6743"><highlight class="normal"></highlight></codeline>
<codeline lineno="6744"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nSrcSpace<sp/>!=<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="6745"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nDestSpace<sp/>!=<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="6746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_nApplyInterface<sp/>=<sp/>icApplyPixel2Pixel;</highlight></codeline>
<codeline lineno="6747"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6748"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6749"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_nApplyInterface<sp/>=<sp/>icApplyPixel2Named;</highlight></codeline>
<codeline lineno="6750"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6751"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6752"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6753"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nDestSpace<sp/>!=<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="6754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_nApplyInterface<sp/>=<sp/>icApplyNamed2Pixel;</highlight></codeline>
<codeline lineno="6755"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6756"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="6758"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6759"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6760"><highlight class="normal"></highlight></codeline>
<codeline lineno="6761"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag<sp/>&amp;&amp;<sp/>!m_pTag-&gt;InitFindCachedPCSColor())</highlight></codeline>
<codeline lineno="6762"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="6763"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pArray<sp/>&amp;&amp;<sp/>!m_pArray-&gt;Begin())</highlight></codeline>
<codeline lineno="6764"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="6765"><highlight class="normal"></highlight></codeline>
<codeline lineno="6766"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="6767"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6768"><highlight class="normal"></highlight></codeline>
<codeline lineno="6769"><highlight class="normal"></highlight></codeline>
<codeline lineno="6770"><highlight class="normal"></highlight></codeline>
<codeline lineno="6784"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccXformNamedColor::Apply(CIccApplyXform*<sp/>pApply,<sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref><sp/>*DstColorName,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="6785"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="6786"><highlight class="normal"></highlight></codeline>
<codeline lineno="6787"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pArray)<sp/>{</highlight></codeline>
<codeline lineno="6788"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d5/d05/a00385" kindref="compound">CIccArrayNamedColor</ref><sp/>*pArray<sp/>=<sp/>m_pArray;</highlight></codeline>
<codeline lineno="6789"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d7/d93/a00397" kindref="compound">CIccStructNamedColor</ref><sp/>*pColor;</highlight></codeline>
<codeline lineno="6790"><highlight class="normal"></highlight></codeline>
<codeline lineno="6791"><highlight class="normal"><sp/><sp/><sp/><sp/>std::string<sp/>NamedColor;</highlight></codeline>
<codeline lineno="6792"><highlight class="normal"></highlight></codeline>
<codeline lineno="6793"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(IsSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="6794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d3/df8/a00155_1a05df9b9a2f56c907e676a0efc3e9219d" kindref="member">IsSpaceSpectralPCS</ref>(m_nSrcSpace))<sp/>{</highlight></codeline>
<codeline lineno="6795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pColor<sp/>=<sp/>pArray-&gt;<ref refid="d5/d05/a00385_1a6c3143e1f5a2433144786f86e7d9becc" kindref="member">FindSpectralColor</ref>(SrcPixel);</highlight></codeline>
<codeline lineno="6796"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pColor)</highlight></codeline>
<codeline lineno="6797"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NamedColor<sp/>=<sp/>pColor-&gt;<ref refid="d7/d93/a00397_1a5e4aa1c33ed61d8d91ca597e57ab7177" kindref="member">getName</ref>();</highlight></codeline>
<codeline lineno="6798"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="6799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16" kindref="member">icCmmStatColorNotFound</ref>;</highlight></codeline>
<codeline lineno="6800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6801"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6802"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bSrcPcsConversion)</highlight></codeline>
<codeline lineno="6803"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SrcPixel<sp/>=<sp/>CheckSrcAbs(pApply,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="6804"><highlight class="normal"></highlight></codeline>
<codeline lineno="6805"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>pix[3];</highlight></codeline>
<codeline lineno="6806"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(pix,<sp/>SrcPixel,<sp/>3*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="6807"><highlight class="normal"></highlight></codeline>
<codeline lineno="6808"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nSrcSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a043048bd0c63d3bd54d35e8b5743d226" kindref="member">icSigLabPcsData</ref>)</highlight></codeline>
<codeline lineno="6809"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1ac5de02865f572ea243f6da8c144c02fa" kindref="member">icLabFromPcs</ref>(pix);</highlight></codeline>
<codeline lineno="6810"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6811"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a78841df2e0aea059520ce71944c4c3bb" kindref="member">icXyzFromPcs</ref>(pix);</highlight></codeline>
<codeline lineno="6812"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a4ff45349385af6c19d5b3f68150a27b5" kindref="member">icXYZtoLab</ref>(pix,<sp/>pix);</highlight></codeline>
<codeline lineno="6813"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6814"><highlight class="normal"></highlight></codeline>
<codeline lineno="6815"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pColor<sp/>=<sp/>pArray-&gt;<ref refid="d5/d05/a00385_1a94b8521face8ca8e1df119db8d7abeeb" kindref="member">FindPcsColor</ref>(pix);</highlight></codeline>
<codeline lineno="6816"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pColor)<sp/></highlight></codeline>
<codeline lineno="6817"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NamedColor<sp/>=<sp/>pColor-&gt;<ref refid="d7/d93/a00397_1a5e4aa1c33ed61d8d91ca597e57ab7177" kindref="member">getName</ref>();</highlight></codeline>
<codeline lineno="6818"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="6819"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16" kindref="member">icCmmStatColorNotFound</ref>;</highlight></codeline>
<codeline lineno="6820"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6821"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6822"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6823"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pColor<sp/>=<sp/>pArray-&gt;<ref refid="d5/d05/a00385_1a9425c5f4e45f89e119c7dd5add27f69a" kindref="member">FindDeviceColor</ref>(SrcPixel);</highlight></codeline>
<codeline lineno="6824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pColor)</highlight></codeline>
<codeline lineno="6825"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>NamedColor<sp/>=<sp/>pColor-&gt;<ref refid="d7/d93/a00397_1a5e4aa1c33ed61d8d91ca597e57ab7177" kindref="member">getName</ref>();</highlight></codeline>
<codeline lineno="6826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="6827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16" kindref="member">icCmmStatColorNotFound</ref>;</highlight></codeline>
<codeline lineno="6828"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6829"><highlight class="normal"></highlight></codeline>
<codeline lineno="6830"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(DstColorName,<sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/>NamedColor.c_str());</highlight></codeline>
<codeline lineno="6831"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6832"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag)<sp/>{</highlight></codeline>
<codeline lineno="6833"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d59/a01013" kindref="compound">CIccTagNamedColor2</ref><sp/>*pTag<sp/>=<sp/>m_pTag;</highlight></codeline>
<codeline lineno="6834"><highlight class="normal"></highlight></codeline>
<codeline lineno="6835"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>DevicePix[16],<sp/>PCSPix[3];</highlight></codeline>
<codeline lineno="6836"><highlight class="normal"><sp/><sp/><sp/><sp/>std::string<sp/>NamedColor;</highlight></codeline>
<codeline lineno="6837"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>i,<sp/>j;</highlight></codeline>
<codeline lineno="6838"><highlight class="normal"></highlight></codeline>
<codeline lineno="6839"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(IsSrcPCS())<sp/>{</highlight></codeline>
<codeline lineno="6840"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bSrcPcsConversion)</highlight></codeline>
<codeline lineno="6841"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SrcPixel<sp/>=<sp/>CheckSrcAbs(pApply,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="6842"><highlight class="normal"></highlight></codeline>
<codeline lineno="6843"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;3;<sp/>i++)</highlight></codeline>
<codeline lineno="6844"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>PCSPix[i]<sp/>=<sp/>SrcPixel[i];</highlight></codeline>
<codeline lineno="6845"><highlight class="normal"></highlight></codeline>
<codeline lineno="6846"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>j<sp/>=<sp/>pTag-&gt;<ref refid="d7/d59/a01013_1ac2fef9b4b97a913ce966f86d934c5ce4" kindref="member">FindCachedPCSColor</ref>(PCSPix);</highlight></codeline>
<codeline lineno="6847"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pTag-&gt;<ref refid="d7/d59/a01013_1a2a06050ccddbf173a2fe355cdf6fa098" kindref="member">GetColorName</ref>(NamedColor,<sp/>j);</highlight></codeline>
<codeline lineno="6848"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6849"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6850"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;m_pTag-&gt;GetDeviceCoords();<sp/>i++)</highlight></codeline>
<codeline lineno="6851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DevicePix[i]<sp/>=<sp/>SrcPixel[i];</highlight></codeline>
<codeline lineno="6852"><highlight class="normal"></highlight></codeline>
<codeline lineno="6853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>j<sp/>=<sp/>pTag-&gt;<ref refid="d7/d59/a01013_1a0149970e81173a7e6136404d07bf7f5f" kindref="member">FindDeviceColor</ref>(DevicePix);</highlight></codeline>
<codeline lineno="6854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pTag-&gt;<ref refid="d7/d59/a01013_1a2a06050ccddbf173a2fe355cdf6fa098" kindref="member">GetColorName</ref>(NamedColor,<sp/>j);</highlight></codeline>
<codeline lineno="6855"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6856"><highlight class="normal"></highlight></codeline>
<codeline lineno="6857"><highlight class="normal"><sp/><sp/><sp/><sp/>sprintf(DstColorName,<sp/></highlight><highlight class="stringliteral">&quot;%s&quot;</highlight><highlight class="normal">,<sp/>NamedColor.c_str());</highlight></codeline>
<codeline lineno="6858"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6859"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="6860"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="6861"><highlight class="normal"></highlight></codeline>
<codeline lineno="6862"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="6863"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6864"><highlight class="normal"></highlight></codeline>
<codeline lineno="6865"><highlight class="normal"></highlight></codeline>
<codeline lineno="6879"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccXformNamedColor::Apply(CIccApplyXform*<sp/>pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref><sp/>*SrcColorName,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>tint)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="6880"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="6881"><highlight class="normal"></highlight></codeline>
<codeline lineno="6882"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pArray)<sp/>{</highlight></codeline>
<codeline lineno="6883"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d5/d05/a00385" kindref="compound">CIccArrayNamedColor</ref><sp/>*pArray<sp/>=<sp/>m_pArray;</highlight></codeline>
<codeline lineno="6884"><highlight class="normal"></highlight></codeline>
<codeline lineno="6885"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d7/d93/a00397" kindref="compound">CIccStructNamedColor</ref><sp/>*pColor;</highlight></codeline>
<codeline lineno="6886"><highlight class="normal"></highlight></codeline>
<codeline lineno="6887"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nSrcSpace<sp/>!=<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)</highlight></codeline>
<codeline lineno="6888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="6889"><highlight class="normal"></highlight></codeline>
<codeline lineno="6890"><highlight class="normal"><sp/><sp/><sp/><sp/>pColor<sp/>=<sp/>pArray-&gt;<ref refid="d5/d05/a00385_1a1304a41486d0a0f39ce483c1efdc5664" kindref="member">FindColor</ref>(SrcColorName);</highlight></codeline>
<codeline lineno="6891"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pColor)</highlight></codeline>
<codeline lineno="6892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16" kindref="member">icCmmStatColorNotFound</ref>;</highlight></codeline>
<codeline lineno="6893"><highlight class="normal"></highlight></codeline>
<codeline lineno="6894"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(IsDestPCS())<sp/>{</highlight></codeline>
<codeline lineno="6895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d3/df8/a00155_1a05df9b9a2f56c907e676a0efc3e9219d" kindref="member">IsSpaceSpectralPCS</ref>(m_nDestSpace))<sp/>{</highlight></codeline>
<codeline lineno="6896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pArray-&gt;<ref refid="d5/d05/a00385_1a2aa8f9d61c012d05d22381c42d7c6b35" kindref="member">GetSpectralTint</ref>(DstPixel,<sp/>pColor,<sp/>tint))</highlight></codeline>
<codeline lineno="6897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6aacc0b85d049e6d79aa0704d2054e62be" kindref="member">icCmmStatBadTintXform</ref>;</highlight></codeline>
<codeline lineno="6898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pArray-&gt;<ref refid="d5/d05/a00385_1afd4f2f9a44dc33fa6f8d517f43949d09" kindref="member">GetPcsTint</ref>(DstPixel,<sp/>pColor,<sp/>tint))</highlight></codeline>
<codeline lineno="6901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6aacc0b85d049e6d79aa0704d2054e62be" kindref="member">icCmmStatBadTintXform</ref>;</highlight></codeline>
<codeline lineno="6902"><highlight class="normal"></highlight></codeline>
<codeline lineno="6903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nDestSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="6904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a5768271d491af79a433e52722ed0a189" kindref="member">icLabToPcs</ref>(DstPixel);</highlight></codeline>
<codeline lineno="6905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a4b4cfb7788c3a780f19f2f104677a5b8" kindref="member">icXyzToPcs</ref>(DstPixel);</highlight></codeline>
<codeline lineno="6908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bDstPcsConversion)</highlight></codeline>
<codeline lineno="6910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckDstAbs(DstPixel);</highlight></codeline>
<codeline lineno="6911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6912"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6913"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pArray-&gt;<ref refid="d5/d05/a00385_1af4f89dcbac98bad8077327211a88b096" kindref="member">GetDeviceTint</ref>(DstPixel,<sp/>pColor,<sp/>tint))</highlight></codeline>
<codeline lineno="6915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6aacc0b85d049e6d79aa0704d2054e62be" kindref="member">icCmmStatBadTintXform</ref>;</highlight></codeline>
<codeline lineno="6916"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6917"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6918"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag)<sp/>{</highlight></codeline>
<codeline lineno="6919"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d59/a01013" kindref="compound">CIccTagNamedColor2</ref><sp/>*pTag<sp/>=<sp/>m_pTag;</highlight></codeline>
<codeline lineno="6920"><highlight class="normal"></highlight></codeline>
<codeline lineno="6921"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a1663bd430c0c31a708d9a141fc6b6c45" kindref="member">icInt32Number</ref><sp/>j;</highlight></codeline>
<codeline lineno="6922"><highlight class="normal"></highlight></codeline>
<codeline lineno="6923"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nSrcSpace<sp/>!=<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)</highlight></codeline>
<codeline lineno="6924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="6925"><highlight class="normal"></highlight></codeline>
<codeline lineno="6926"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(IsDestPCS())<sp/>{</highlight></codeline>
<codeline lineno="6927"><highlight class="normal"></highlight></codeline>
<codeline lineno="6928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>j<sp/>=<sp/>pTag-&gt;<ref refid="d7/d59/a01013_1a2a76002d604136358d1adb711faf6e90" kindref="member">FindColor</ref>(SrcColorName);</highlight></codeline>
<codeline lineno="6929"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j&lt;0)</highlight></codeline>
<codeline lineno="6930"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16" kindref="member">icCmmStatColorNotFound</ref>;</highlight></codeline>
<codeline lineno="6931"><highlight class="normal"></highlight></codeline>
<codeline lineno="6932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nDestSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="6933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(DstPixel,<sp/>pTag-&gt;<ref refid="d7/d59/a01013_1acfa051e5560291e61af31c3ccf3b28e3" kindref="member">GetEntry</ref>(j)-&gt;<ref refid="d7/d06/a01005_1ad4725f789754651c67c722de12f52936" kindref="member">pcsCoords</ref>,<sp/>3*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="6934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(DstPixel,<sp/>pTag-&gt;<ref refid="d7/d59/a01013_1acfa051e5560291e61af31c3ccf3b28e3" kindref="member">GetEntry</ref>(j)-&gt;<ref refid="d7/d06/a01005_1ad4725f789754651c67c722de12f52936" kindref="member">pcsCoords</ref>,<sp/>3*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="6937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bDstPcsConversion)</highlight></codeline>
<codeline lineno="6939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckDstAbs(DstPixel);</highlight></codeline>
<codeline lineno="6940"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6941"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="6942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>j<sp/>=<sp/>pTag-&gt;<ref refid="d7/d59/a01013_1a2a76002d604136358d1adb711faf6e90" kindref="member">FindColor</ref>(SrcColorName);</highlight></codeline>
<codeline lineno="6943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j&lt;0)</highlight></codeline>
<codeline lineno="6944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16" kindref="member">icCmmStatColorNotFound</ref>;</highlight></codeline>
<codeline lineno="6945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(DstPixel,<sp/>pTag-&gt;<ref refid="d7/d59/a01013_1acfa051e5560291e61af31c3ccf3b28e3" kindref="member">GetEntry</ref>(j)-&gt;<ref refid="d7/d06/a01005_1a0a9b0ffa6221220cf476616062b5c928" kindref="member">deviceCoords</ref>,<sp/>pTag-&gt;<ref refid="d7/d59/a01013_1a6b6ed7f3550c3939ce66094d97173fdb" kindref="member">GetDeviceCoords</ref>()*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="6946"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="6947"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6948"><highlight class="normal"></highlight></codeline>
<codeline lineno="6949"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="6950"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6951"><highlight class="normal"></highlight></codeline>
<codeline lineno="6963"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccXformNamedColor::SetSrcSpace(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nSrcSpace)</highlight></codeline>
<codeline lineno="6964"><highlight class="normal">{</highlight></codeline>
<codeline lineno="6965"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pArray)<sp/>{</highlight></codeline>
<codeline lineno="6966"><highlight class="normal"></highlight></codeline>
<codeline lineno="6967"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6968"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag)<sp/>{</highlight></codeline>
<codeline lineno="6969"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d7/d59/a01013" kindref="compound">CIccTagNamedColor2</ref><sp/>*pTag<sp/>=<sp/>m_pTag;</highlight></codeline>
<codeline lineno="6970"><highlight class="normal"></highlight></codeline>
<codeline lineno="6971"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nSrcSpace!=pTag-&gt;<ref refid="d7/d59/a01013_1a2ea2db6f07f694b094360198c3fa3c8e" kindref="member">GetPCS</ref>())</highlight></codeline>
<codeline lineno="6972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nSrcSpace!=pTag-&gt;<ref refid="d7/d59/a01013_1ab6ec797d2fdea65e273f2c484fa260ce" kindref="member">GetDeviceSpace</ref>())</highlight></codeline>
<codeline lineno="6973"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nSrcSpace!=<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)</highlight></codeline>
<codeline lineno="6974"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="6975"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="6976"><highlight class="normal"></highlight></codeline>
<codeline lineno="6977"><highlight class="normal"><sp/><sp/>m_nSrcSpace<sp/>=<sp/>nSrcSpace;</highlight></codeline>
<codeline lineno="6978"><highlight class="normal"></highlight></codeline>
<codeline lineno="6979"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="6980"><highlight class="normal">}</highlight></codeline>
<codeline lineno="6981"><highlight class="normal"></highlight></codeline>
<codeline lineno="6993"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccXformNamedColor::SetDestSpace(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nDestSpace)</highlight></codeline>
<codeline lineno="6994"><highlight class="normal">{</highlight></codeline>
<codeline lineno="6995"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nSrcSpace<sp/>==<sp/>nDestSpace)</highlight></codeline>
<codeline lineno="6996"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="6997"><highlight class="normal"></highlight></codeline>
<codeline lineno="6998"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pArray)<sp/>{</highlight></codeline>
<codeline lineno="6999"><highlight class="normal"></highlight></codeline>
<codeline lineno="7000"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7001"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag)<sp/>{</highlight></codeline>
<codeline lineno="7002"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d7/d59/a01013" kindref="compound">CIccTagNamedColor2</ref><sp/>*pTag<sp/>=<sp/>(<ref refid="d7/d59/a01013" kindref="compound">CIccTagNamedColor2</ref>*)m_pTag;</highlight></codeline>
<codeline lineno="7003"><highlight class="normal"></highlight></codeline>
<codeline lineno="7004"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nDestSpace!=pTag-&gt;<ref refid="d7/d59/a01013_1a2ea2db6f07f694b094360198c3fa3c8e" kindref="member">GetPCS</ref>())</highlight></codeline>
<codeline lineno="7005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nDestSpace!=pTag-&gt;<ref refid="d7/d59/a01013_1ab6ec797d2fdea65e273f2c484fa260ce" kindref="member">GetDeviceSpace</ref>())</highlight></codeline>
<codeline lineno="7006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nDestSpace!=<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)</highlight></codeline>
<codeline lineno="7007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="7008"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7009"><highlight class="normal"></highlight></codeline>
<codeline lineno="7010"><highlight class="normal"><sp/><sp/>m_nDestSpace<sp/>=<sp/>nDestSpace;</highlight></codeline>
<codeline lineno="7011"><highlight class="normal"></highlight></codeline>
<codeline lineno="7012"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="7013"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7014"><highlight class="normal"></highlight></codeline>
<codeline lineno="7023"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccXformNamedColor::IsSrcPCS()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="7024"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="7025"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag)<sp/>{</highlight></codeline>
<codeline lineno="7026"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_nSrcSpace<sp/>==<sp/>m_pTag-&gt;<ref refid="d7/d59/a01013_1a2ea2db6f07f694b094360198c3fa3c8e" kindref="member">GetPCS</ref>();</highlight></codeline>
<codeline lineno="7027"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7028"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pArray)<sp/>{</highlight></codeline>
<codeline lineno="7029"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d3/df8/a00155_1af2bf8c7d947cb795089de5f391f91d4d" kindref="member">IsSpacePCS</ref>(m_nSrcSpace);</highlight></codeline>
<codeline lineno="7030"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7031"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="7032"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7033"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7034"><highlight class="normal"></highlight></codeline>
<codeline lineno="7035"><highlight class="normal"></highlight></codeline>
<codeline lineno="7044"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccXformNamedColor::IsDestPCS()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="7045"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="7046"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag)<sp/>{</highlight></codeline>
<codeline lineno="7047"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_nDestSpace<sp/>==<sp/>m_pTag-&gt;GetPCS();</highlight></codeline>
<codeline lineno="7048"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7049"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pArray)<sp/>{</highlight></codeline>
<codeline lineno="7050"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d3/df8/a00155_1af2bf8c7d947cb795089de5f391f91d4d" kindref="member">IsSpacePCS</ref>(m_nDestSpace);</highlight></codeline>
<codeline lineno="7051"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7052"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight></codeline>
<codeline lineno="7053"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7054"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7055"><highlight class="normal"></highlight></codeline>
<codeline lineno="7056"><highlight class="normal"></highlight></codeline>
<codeline lineno="7065"><highlight class="normal">CIccXformMpe::CIccXformMpe(<ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag)</highlight></codeline>
<codeline lineno="7066"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7067"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>pTag-&gt;<ref refid="d7/dfd/a00969_1a0d6f4b6f857134bd87bfb0cd54025208" kindref="member">GetType</ref>()==<ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481" kindref="member">icSigMultiProcessElementType</ref>)</highlight></codeline>
<codeline lineno="7068"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pTag<sp/>=<sp/>(<ref refid="d5/d54/a01213" kindref="compound">CIccTagMultiProcessElement</ref>*)pTag;</highlight></codeline>
<codeline lineno="7069"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7070"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="7071"><highlight class="normal"></highlight></codeline>
<codeline lineno="7072"><highlight class="normal"><sp/><sp/>m_bUsingAcs<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7073"><highlight class="normal"><sp/><sp/>m_pAppliedPCC<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="7074"><highlight class="normal"><sp/><sp/>m_bDeleteAppliedPCC<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7075"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7076"><highlight class="normal"></highlight></codeline>
<codeline lineno="7085"><highlight class="normal">CIccXformMpe::~CIccXformMpe()</highlight></codeline>
<codeline lineno="7086"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7087"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pAppliedPCC<sp/>&amp;&amp;<sp/>m_bDeleteAppliedPCC)</highlight></codeline>
<codeline lineno="7088"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_pAppliedPCC;</highlight></codeline>
<codeline lineno="7089"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7090"><highlight class="normal"></highlight></codeline>
<codeline lineno="7113"><highlight class="normal">CIccXform<sp/>*CIccXformMpe::Create(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bInput</highlight><highlight class="comment">/*<sp/>=true<sp/>*/</highlight><highlight class="normal">,<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nIntent</highlight><highlight class="comment">/*<sp/>=icUnknownIntent<sp/>*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="7114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913" kindref="member">icXformInterp</ref><sp/>nInterp</highlight><highlight class="comment">/*<sp/>=icInterpLinear<sp/>*/</highlight><highlight class="normal">,<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7b" kindref="member">icXformLutType</ref><sp/>nLutType</highlight><highlight class="comment">/*<sp/>=icXformLutColor<sp/>*/</highlight><highlight class="normal">,<sp/></highlight></codeline>
<codeline lineno="7115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccCreateXformHintManager<sp/>*pHintManager</highlight><highlight class="comment">/*<sp/>=NULL<sp/>*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7116"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7117"><highlight class="normal"><sp/><sp/>CIccXform<sp/>*rv<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="7118"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nTagIntent<sp/>=<sp/>nIntent;</highlight></codeline>
<codeline lineno="7119"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseSpectralPCS<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7120"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7121"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7b" kindref="member">icXformLutType</ref><sp/>nUseLutType<sp/>=<sp/>nLutType;</highlight></codeline>
<codeline lineno="7122"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseColorimeticTags<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7123"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseDToB<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7124"><highlight class="normal"></highlight></codeline>
<codeline lineno="7125"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nLutType<sp/>==<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262" kindref="member">icXformLutSpectral</ref>)<sp/>{</highlight></codeline>
<codeline lineno="7126"><highlight class="normal"><sp/><sp/><sp/><sp/>nUseLutType<sp/>=<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614" kindref="member">icXformLutColor</ref>;</highlight></codeline>
<codeline lineno="7127"><highlight class="normal"><sp/><sp/><sp/><sp/>bUseColorimeticTags<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7128"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7129"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nLutType<sp/>==<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013" kindref="member">icXformLutColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="7130"><highlight class="normal"><sp/><sp/><sp/><sp/>nUseLutType<sp/>=<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614" kindref="member">icXformLutColor</ref>;</highlight></codeline>
<codeline lineno="7131"><highlight class="normal"><sp/><sp/><sp/><sp/>bUseDToB<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7132"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7133"><highlight class="normal"></highlight></codeline>
<codeline lineno="7134"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1a0fbdbf76357f4ad739b1df71bd87ef8a" kindref="member">icUnknownIntent</ref>)</highlight></codeline>
<codeline lineno="7135"><highlight class="normal"><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref>;</highlight></codeline>
<codeline lineno="7136"><highlight class="normal"></highlight></codeline>
<codeline lineno="7137"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(nUseLutType)<sp/>{</highlight></codeline>
<codeline lineno="7138"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614" kindref="member">icXformLutColor</ref>:</highlight></codeline>
<codeline lineno="7139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bInput)<sp/>{</highlight></codeline>
<codeline lineno="7140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="7141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseDToB)<sp/>{</highlight></codeline>
<codeline lineno="7142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a703f1866ed4cc98f623090b38917bc8e" kindref="member">icSigDToB0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="7143"><highlight class="normal"></highlight></codeline>
<codeline lineno="7144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="7145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ae185d0e91c27dc49b2a4a328de2fbb92" kindref="member">icSigDToB1Tag</ref>);</highlight></codeline>
<codeline lineno="7146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="7147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="7148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>!=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="7150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a585329dfc33381a67de302149941bd38" kindref="member">icSigDToB3Tag</ref>);</highlight></codeline>
<codeline lineno="7151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="7152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="7153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7156"><highlight class="normal"></highlight></codeline>
<codeline lineno="7157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="7158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a703f1866ed4cc98f623090b38917bc8e" kindref="member">icSigDToB0Tag</ref>);</highlight></codeline>
<codeline lineno="7159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7161"><highlight class="normal"></highlight></codeline>
<codeline lineno="7162"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Unsupported<sp/>elements<sp/>cause<sp/>fall<sp/>back<sp/>behavior</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7163"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>!pTag-&gt;<ref refid="d7/dfd/a00969_1a3415307280dc7b871cc1797704008991" kindref="member">IsSupported</ref>())</highlight></codeline>
<codeline lineno="7164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="7165"><highlight class="normal"></highlight></codeline>
<codeline lineno="7166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.spectralPCS)<sp/>{</highlight></codeline>
<codeline lineno="7167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUseSpectralPCS<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7169"><highlight class="normal"></highlight></codeline>
<codeline lineno="7170"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseColorimeticTags)<sp/>{</highlight></codeline>
<codeline lineno="7171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="7172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)</highlight></codeline>
<codeline lineno="7173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="7174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a48a680ba3049e0c37a44da9f08e411c7" kindref="member">icSigAToB0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="7175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7176"><highlight class="normal"></highlight></codeline>
<codeline lineno="7177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="7178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a48a680ba3049e0c37a44da9f08e411c7" kindref="member">icSigAToB0Tag</ref>);</highlight></codeline>
<codeline lineno="7179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7181"><highlight class="normal"></highlight></codeline>
<codeline lineno="7182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="7183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseColorimeticTags<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.colorSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30" kindref="member">icSigRgbData</ref><sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.version<sp/>&lt;<sp/><ref refid="d7/d46/a00002_1a802c8f93248af9679280a8c10705807c" kindref="member">icVersionNumberV5</ref>)<sp/>{</highlight></codeline>
<codeline lineno="7184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccXformMatrixTRC();</highlight></codeline>
<codeline lineno="7185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="7188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag-&gt;<ref refid="d7/dfd/a00969_1a0d6f4b6f857134bd87bfb0cd54025208" kindref="member">GetType</ref>()==<ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481" kindref="member">icSigMultiProcessElementType</ref>)<sp/>{</highlight></codeline>
<codeline lineno="7190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccXformMpe(pTag);</highlight></codeline>
<codeline lineno="7191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="7193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pProfile-&gt;m_Header.colorSpace)<sp/>{</highlight></codeline>
<codeline lineno="7194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>:</highlight></codeline>
<codeline lineno="7195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>:</highlight></codeline>
<codeline lineno="7196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0ab090e1f79d31e78c006c6ab25933dd" kindref="member">icSigLuvData</ref>:</highlight></codeline>
<codeline lineno="7197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ae02a4b86c48a9b85be92fdfc2114e496" kindref="member">icSigYCbCrData</ref>:</highlight></codeline>
<codeline lineno="7198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917afc7f319f261280fc48d7510c3a8bc330" kindref="member">icSigYxyData</ref>:</highlight></codeline>
<codeline lineno="7199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30" kindref="member">icSigRgbData</ref>:</highlight></codeline>
<codeline lineno="7200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917afc7cddf72b4d83ee5cb3568143580828" kindref="member">icSigHsvData</ref>:</highlight></codeline>
<codeline lineno="7201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ad4a717752d16d5fcf92e1fdd892b8bd8" kindref="member">icSigHlsData</ref>:</highlight></codeline>
<codeline lineno="7202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917af20259a5702129c41fd08e21c7e94a74" kindref="member">icSigCmyData</ref>:</highlight></codeline>
<codeline lineno="7203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917afa0686ad8f20f604e7e52807087f04da" kindref="member">icSig3colorData</ref>:</highlight></codeline>
<codeline lineno="7204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccXform3DLut(pTag);</highlight></codeline>
<codeline lineno="7205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7206"><highlight class="normal"></highlight></codeline>
<codeline lineno="7207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661" kindref="member">icSigCmykData</ref>:</highlight></codeline>
<codeline lineno="7208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917addb4c9db388eda46c3ec7fdaa8824cf5" kindref="member">icSig4colorData</ref>:</highlight></codeline>
<codeline lineno="7209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccXform4DLut(pTag);</highlight></codeline>
<codeline lineno="7210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7211"><highlight class="normal"></highlight></codeline>
<codeline lineno="7212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccXformNDLut(pTag);</highlight></codeline>
<codeline lineno="7214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="7219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>NULL;<sp/></highlight></codeline>
<codeline lineno="7220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="7221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseDToB)<sp/>{</highlight></codeline>
<codeline lineno="7222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a0247611a0b2a3faa49a0df2dfc8420cc" kindref="member">icSigBToD0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="7223"><highlight class="normal"></highlight></codeline>
<codeline lineno="7224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="7225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a8a66e2d1402c9f9796a902cd2f0ac0eb" kindref="member">icSigBToD1Tag</ref>);</highlight></codeline>
<codeline lineno="7226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)</highlight></codeline>
<codeline lineno="7227"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="7228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag<sp/>&amp;&amp;<sp/>nTagIntent<sp/>!=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)<sp/>{</highlight></codeline>
<codeline lineno="7230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a740cafe42e07749bbe3b36d881325801" kindref="member">icSigBToD3Tag</ref>);</highlight></codeline>
<codeline lineno="7231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="7232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>;</highlight></codeline>
<codeline lineno="7233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bAbsToRel<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7236"><highlight class="normal"></highlight></codeline>
<codeline lineno="7237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="7238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a0247611a0b2a3faa49a0df2dfc8420cc" kindref="member">icSigBToD0Tag</ref>);</highlight></codeline>
<codeline lineno="7239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7241"><highlight class="normal"></highlight></codeline>
<codeline lineno="7242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Unsupported<sp/>elements<sp/>cause<sp/>fall<sp/>back<sp/>behavior</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>!pTag-&gt;<ref refid="d7/dfd/a00969_1a3415307280dc7b871cc1797704008991" kindref="member">IsSupported</ref>())</highlight></codeline>
<codeline lineno="7244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="7245"><highlight class="normal"></highlight></codeline>
<codeline lineno="7246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseColorimeticTags)<sp/>{</highlight></codeline>
<codeline lineno="7247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="7248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nTagIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref>)</highlight></codeline>
<codeline lineno="7249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nTagIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a64d6354071e8f3d7b461202675e755cb" kindref="member">icRelativeColorimetric</ref>;</highlight></codeline>
<codeline lineno="7250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a78413df8b7d634ae4e0ec02f006e5bd0" kindref="member">icSigBToA0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="7251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7252"><highlight class="normal"></highlight></codeline>
<codeline lineno="7253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="7254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a78413df8b7d634ae4e0ec02f006e5bd0" kindref="member">icSigBToA0Tag</ref>);</highlight></codeline>
<codeline lineno="7255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7257"><highlight class="normal"></highlight></codeline>
<codeline lineno="7258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="7259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseColorimeticTags<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.colorSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30" kindref="member">icSigRgbData</ref><sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.version&lt;<ref refid="d7/d46/a00002_1a802c8f93248af9679280a8c10705807c" kindref="member">icVersionNumberV5</ref>)<sp/>{</highlight></codeline>
<codeline lineno="7260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccXformMatrixTRC();</highlight></codeline>
<codeline lineno="7261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="7264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7265"><highlight class="normal"></highlight></codeline>
<codeline lineno="7266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>pTag-&gt;<ref refid="d7/dfd/a00969_1a0d6f4b6f857134bd87bfb0cd54025208" kindref="member">GetType</ref>()==<ref refid="d7/d46/a00002_1a7ac6c9395974f6a0dc5025b7c7417ddea3ea81b933efd50884a057a280227c481" kindref="member">icSigMultiProcessElementType</ref>)<sp/>{</highlight></codeline>
<codeline lineno="7267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccXformMpe(pTag);</highlight></codeline>
<codeline lineno="7268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="7270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pProfile-&gt;m_Header.pcs)<sp/>{</highlight></codeline>
<codeline lineno="7271"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>:</highlight></codeline>
<codeline lineno="7272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>:</highlight></codeline>
<codeline lineno="7273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccXform3DLut(pTag);</highlight></codeline>
<codeline lineno="7274"><highlight class="normal"></highlight></codeline>
<codeline lineno="7275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7281"><highlight class="normal"></highlight></codeline>
<codeline lineno="7282"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba0b1f2aadd55b74ea25adc32e3cadf4c0" kindref="member">icXformLutNamedColor</ref>:</highlight></codeline>
<codeline lineno="7283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="7284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ac9a9457a436bbfaa9212552f337d2beb" kindref="member">icSigNamedColor2Tag</ref>);</highlight></codeline>
<codeline lineno="7285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)</highlight></codeline>
<codeline lineno="7286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="7287"><highlight class="normal"></highlight></codeline>
<codeline lineno="7288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccXformNamedColor(pTag,<sp/>pProfile-&gt;m_Header.pcs,<sp/>pProfile-&gt;m_Header.colorSpace,</highlight></codeline>
<codeline lineno="7289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pProfile-&gt;m_Header.spectralPCS,</highlight></codeline>
<codeline lineno="7290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;pProfile-&gt;m_Header.spectralRange,</highlight></codeline>
<codeline lineno="7291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>&amp;pProfile-&gt;m_Header.biSpectralRange);</highlight></codeline>
<codeline lineno="7292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7294"><highlight class="normal"></highlight></codeline>
<codeline lineno="7295"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7baeb0501fdc1dcc7f1388f0fdca9b17356" kindref="member">icXformLutPreview</ref>:</highlight></codeline>
<codeline lineno="7296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="7297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ac5ae9a8a0d00acc2b7ec4f2da4ccc3f8" kindref="member">icSigPreview0Tag</ref><sp/>+<sp/>nTagIntent);</highlight></codeline>
<codeline lineno="7299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="7300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ac5ae9a8a0d00acc2b7ec4f2da4ccc3f8" kindref="member">icSigPreview0Tag</ref>);</highlight></codeline>
<codeline lineno="7301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="7303"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="7304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="7306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pProfile-&gt;m_Header.pcs)<sp/>{</highlight></codeline>
<codeline lineno="7307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>:</highlight></codeline>
<codeline lineno="7308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>:</highlight></codeline>
<codeline lineno="7309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccXform3DLut(pTag);</highlight></codeline>
<codeline lineno="7310"><highlight class="normal"></highlight></codeline>
<codeline lineno="7311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7317"><highlight class="normal"></highlight></codeline>
<codeline lineno="7318"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba6df311bd7dc6c9c9284ad186b15f53de" kindref="member">icXformLutGamut</ref>:</highlight></codeline>
<codeline lineno="7319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="7320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ad57d49a829f89f04159908e21ffe9d01" kindref="member">icSigGamutTag</ref>);</highlight></codeline>
<codeline lineno="7322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="7323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="7324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="7326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pProfile-&gt;m_Header.pcs)<sp/>{</highlight></codeline>
<codeline lineno="7327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>:</highlight></codeline>
<codeline lineno="7328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>:</highlight></codeline>
<codeline lineno="7329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccXform3DLut(pTag);</highlight></codeline>
<codeline lineno="7330"><highlight class="normal"></highlight></codeline>
<codeline lineno="7331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7337"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7338"><highlight class="normal"></highlight></codeline>
<codeline lineno="7339"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)<sp/>{</highlight></codeline>
<codeline lineno="7340"><highlight class="normal"><sp/><sp/><sp/><sp/>rv-&gt;SetParams(pProfile,<sp/>bInput,<sp/>nIntent,<sp/>nTagIntent,<sp/>bUseSpectralPCS,<sp/>nInterp,<sp/>pHintManager,<sp/>bAbsToRel);</highlight></codeline>
<codeline lineno="7341"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7342"><highlight class="normal"></highlight></codeline>
<codeline lineno="7343"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="7344"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7345"><highlight class="normal"></highlight></codeline>
<codeline lineno="7355"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccXformMpe::IsLateBinding()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="7356"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="7357"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag)</highlight></codeline>
<codeline lineno="7358"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_pTag-&gt;IsLateBinding();</highlight></codeline>
<codeline lineno="7359"><highlight class="normal"></highlight></codeline>
<codeline lineno="7360"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7361"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7362"><highlight class="normal"></highlight></codeline>
<codeline lineno="7372"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccXformMpe::IsLateBindingReflectance()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="7373"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="7374"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag)</highlight></codeline>
<codeline lineno="7375"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_pTag-&gt;IsLateBindingReflectance();</highlight></codeline>
<codeline lineno="7376"><highlight class="normal"></highlight></codeline>
<codeline lineno="7377"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7378"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7379"><highlight class="normal"></highlight></codeline>
<codeline lineno="7388"><highlight class="normal"><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*CIccXformMpe::GetConnectionConditions()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="7389"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="7390"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pAppliedPCC)</highlight></codeline>
<codeline lineno="7391"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_pAppliedPCC;</highlight></codeline>
<codeline lineno="7392"><highlight class="normal"></highlight></codeline>
<codeline lineno="7393"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_pConnectionConditions;</highlight></codeline>
<codeline lineno="7394"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7395"><highlight class="normal"></highlight></codeline>
<codeline lineno="7406"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccXformMpe::SetAppliedCC(<ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPCC)</highlight></codeline>
<codeline lineno="7407"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7408"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pPCC)<sp/>{</highlight></codeline>
<codeline lineno="7409"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pAppliedPCC<sp/>&amp;&amp;<sp/>m_bDeleteAppliedPCC)<sp/>{</highlight></codeline>
<codeline lineno="7410"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_pAppliedPCC;</highlight></codeline>
<codeline lineno="7411"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7412"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pAppliedPCC<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="7413"><highlight class="normal"><sp/><sp/><sp/><sp/>m_bDeleteAppliedPCC<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7414"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7415"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7416"><highlight class="normal"></highlight></codeline>
<codeline lineno="7417"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pTag)<sp/>{</highlight></codeline>
<codeline lineno="7418"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bReflectance<sp/>=<sp/>m_pTag-&gt;IsLateBindingReflectance();</highlight></codeline>
<codeline lineno="7419"><highlight class="normal"></highlight></codeline>
<codeline lineno="7420"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pPCC<sp/>!=<sp/>(<ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*)m_pProfile)<sp/>{</highlight></codeline>
<codeline lineno="7421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!bReflectance)<sp/>{</highlight></codeline>
<codeline lineno="7422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d8/dbf/a01109" kindref="compound">CIccTagSpectralViewingConditions</ref><sp/>*pViewPCC<sp/>=<sp/>pPCC<sp/>?<sp/>pPCC-&gt;<ref refid="db/d18/a00885_1a41d44184a1e66e1f7bd46e60fc69fda6" kindref="member">getPccViewingConditions</ref>()<sp/>:<sp/>NULL;</highlight></codeline>
<codeline lineno="7423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d8/dbf/a01109" kindref="compound">CIccTagSpectralViewingConditions</ref><sp/>*pViewProfile<sp/>=<sp/>m_pProfile<sp/>?<sp/>m_pProfile-&gt;<ref refid="db/d18/a00885_1a41d44184a1e66e1f7bd46e60fc69fda6" kindref="member">getPccViewingConditions</ref>()<sp/>:<sp/>NULL;</highlight></codeline>
<codeline lineno="7424"><highlight class="normal"></highlight></codeline>
<codeline lineno="7425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pViewPCC<sp/>&amp;&amp;<sp/>pViewProfile<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="7426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pViewPCC-&gt;<ref refid="d8/dbf/a01109_1a8877a21252b3f70c761e049765cfb10e" kindref="member">getStdIllumiant</ref>()<sp/>==<sp/>pViewProfile-&gt;<ref refid="d8/dbf/a01109_1a8877a21252b3f70c761e049765cfb10e" kindref="member">getStdIllumiant</ref>()<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="7427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pViewPCC-&gt;<ref refid="d8/dbf/a01109_1a339a66cb30a03163f17861f8c704df51" kindref="member">getIlluminantCCT</ref>()<sp/>==<sp/>pViewProfile-&gt;<ref refid="d8/dbf/a01109_1a339a66cb30a03163f17861f8c704df51" kindref="member">getIlluminantCCT</ref>()<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="7428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pViewPCC-&gt;<ref refid="d8/dbf/a01109_1a8877a21252b3f70c761e049765cfb10e" kindref="member">getStdIllumiant</ref>()<sp/>!=<sp/><ref refid="d7/d46/a00002_1a2146034a274143b2ffbb868845d93e17ab1c241e8a8bf7f4843c929227113ac84" kindref="member">icIlluminantUnknown</ref>)<sp/>{</highlight></codeline>
<codeline lineno="7429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pAppliedPCC<sp/>=<sp/>pPCC;</highlight></codeline>
<codeline lineno="7430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_bDeleteAppliedPCC<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="7433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pAppliedPCC<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="de/dc8/a00889" kindref="compound">CIccCombinedConnectionConditions</ref>(m_pProfile,<sp/>pPCC,<sp/>bReflectance);</highlight></codeline>
<codeline lineno="7434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_bDeleteAppliedPCC<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="7438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pAppliedPCC<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="de/dc8/a00889" kindref="compound">CIccCombinedConnectionConditions</ref>(m_pProfile,<sp/>pPCC,<sp/>bReflectance);</highlight></codeline>
<codeline lineno="7439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_bDeleteAppliedPCC<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7441"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7442"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="7443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pAppliedPCC<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="7444"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7445"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7446"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="7447"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pAppliedPCC<sp/>=<sp/>pPCC;</highlight></codeline>
<codeline lineno="7448"><highlight class="normal"><sp/><sp/><sp/><sp/>m_bDeleteAppliedPCC<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7449"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7450"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7451"><highlight class="normal"></highlight></codeline>
<codeline lineno="7452"><highlight class="normal"></highlight></codeline>
<codeline lineno="7464"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccXformMpe::Begin()</highlight></codeline>
<codeline lineno="7465"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7466"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>status;</highlight></codeline>
<codeline lineno="7467"><highlight class="normal"><sp/><sp/>status<sp/>=<sp/>CIccXform::Begin();</highlight></codeline>
<codeline lineno="7468"><highlight class="normal"></highlight></codeline>
<codeline lineno="7469"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(status<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="7470"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>status;</highlight></codeline>
<codeline lineno="7471"><highlight class="normal"></highlight></codeline>
<codeline lineno="7472"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pTag)<sp/>{</highlight></codeline>
<codeline lineno="7473"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096" kindref="member">icCmmStatInvalidLut</ref>;</highlight></codeline>
<codeline lineno="7474"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7475"><highlight class="normal"></highlight></codeline>
<codeline lineno="7476"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pTag-&gt;Begin(<ref refid="d7/d25/a00182_1ac2d11f72d4c98d21c3b2ca1509a52ee8adcc63bbed9191bd244da51839e152065" kindref="member">icElemInterpLinear</ref>,<sp/>GetProfileCC(),<sp/>GetConnectionConditions(),<sp/>GetCmmEnvVarLookup()))<sp/>{</highlight></codeline>
<codeline lineno="7477"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860" kindref="member">icCmmStatInvalidProfile</ref>;</highlight></codeline>
<codeline lineno="7478"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7479"><highlight class="normal"></highlight></codeline>
<codeline lineno="7480"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="7481"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7482"><highlight class="normal"></highlight></codeline>
<codeline lineno="7483"><highlight class="normal"></highlight></codeline>
<codeline lineno="7493"><highlight class="normal">CIccApplyXform<sp/>*CIccXformMpe::GetNewApply(<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>&amp;status)</highlight></codeline>
<codeline lineno="7494"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7495"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pTag)</highlight></codeline>
<codeline lineno="7496"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="7497"><highlight class="normal"></highlight></codeline>
<codeline lineno="7498"><highlight class="normal"><sp/><sp/>CIccApplyXformMpe<sp/>*rv=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccApplyXformMpe(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);<sp/></highlight></codeline>
<codeline lineno="7499"><highlight class="normal"></highlight></codeline>
<codeline lineno="7500"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!rv)<sp/>{</highlight></codeline>
<codeline lineno="7501"><highlight class="normal"><sp/><sp/><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="7502"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="7503"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7504"><highlight class="normal"></highlight></codeline>
<codeline lineno="7505"><highlight class="normal"><sp/><sp/>rv-&gt;m_pApply<sp/>=<sp/>m_pTag-&gt;GetNewApply();</highlight></codeline>
<codeline lineno="7506"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!rv-&gt;m_pApply)<sp/>{</highlight></codeline>
<codeline lineno="7507"><highlight class="normal"><sp/><sp/><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="7508"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="7509"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="7510"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7511"><highlight class="normal"></highlight></codeline>
<codeline lineno="7512"><highlight class="normal"><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="7513"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="7514"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7515"><highlight class="normal"></highlight></codeline>
<codeline lineno="7516"><highlight class="normal"></highlight></codeline>
<codeline lineno="7530"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccXformMpe::Apply(CIccApplyXform*<sp/>pApply,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="7531"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="7532"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d5/d54/a01213" kindref="compound">CIccTagMultiProcessElement</ref><sp/>*pTag<sp/>=<sp/>m_pTag;</highlight></codeline>
<codeline lineno="7533"><highlight class="normal"></highlight></codeline>
<codeline lineno="7534"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>temp[3];</highlight></codeline>
<codeline lineno="7535"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_bInput<sp/>||<sp/>m_bPcsAdjustXform)<sp/>{<sp/></highlight><highlight class="comment">//PCS<sp/>comming<sp/>in?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7536"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nIntent<sp/>!=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref><sp/>||<sp/>m_nIntent<sp/>!=<sp/>m_nTagIntent)<sp/>{<sp/><sp/></highlight><highlight class="comment">//B2D3<sp/>tags<sp/>don&apos;t<sp/>need<sp/>abs<sp/>conversion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bSrcPcsConversion)</highlight></codeline>
<codeline lineno="7538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SrcPixel<sp/>=<sp/>CheckSrcAbs(pApply,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="7539"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7540"><highlight class="normal"></highlight></codeline>
<codeline lineno="7541"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Since<sp/>MPE<sp/>tags<sp/>use<sp/>&quot;real&quot;<sp/>values<sp/>for<sp/>PCS<sp/>we<sp/>need<sp/>to<sp/>convert<sp/>from<sp/></highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7542"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//internal<sp/>encoding<sp/>used<sp/>by<sp/>IccProfLib</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7543"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(GetSrcSpace())<sp/>{</highlight></codeline>
<codeline lineno="7544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>:</highlight></codeline>
<codeline lineno="7545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(&amp;temp[0],<sp/>SrcPixel,<sp/>3*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="7546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a78841df2e0aea059520ce71944c4c3bb" kindref="member">icXyzFromPcs</ref>(temp);</highlight></codeline>
<codeline lineno="7547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SrcPixel<sp/>=<sp/>&amp;temp[0];</highlight></codeline>
<codeline lineno="7548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7549"><highlight class="normal"></highlight></codeline>
<codeline lineno="7550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>:</highlight></codeline>
<codeline lineno="7551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(&amp;temp[0],<sp/>SrcPixel,<sp/>3*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="7552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1ac5de02865f572ea243f6da8c144c02fa" kindref="member">icLabFromPcs</ref>(temp);</highlight></codeline>
<codeline lineno="7553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>SrcPixel<sp/>=<sp/>&amp;temp[0];</highlight></codeline>
<codeline lineno="7554"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7555"><highlight class="normal"></highlight></codeline>
<codeline lineno="7556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7558"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7559"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7560"><highlight class="normal"></highlight></codeline>
<codeline lineno="7561"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Note:<sp/>pApply<sp/>should<sp/>be<sp/>a<sp/>CIccApplyXformMpe<sp/>type<sp/>here</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7562"><highlight class="normal"><sp/><sp/>CIccApplyXformMpe<sp/>*pApplyMpe<sp/>=<sp/>(CIccApplyXformMpe<sp/>*)pApply;</highlight></codeline>
<codeline lineno="7563"><highlight class="normal"></highlight></codeline>
<codeline lineno="7564"><highlight class="normal"><sp/><sp/>pTag-&gt;<ref refid="d5/d54/a01213_1a8e6ad3114229992a0c1df3d1d30e02ef" kindref="member">Apply</ref>(pApplyMpe-&gt;m_pApply,<sp/>DstPixel,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="7565"><highlight class="normal"></highlight></codeline>
<codeline lineno="7566"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bInput)<sp/>{<sp/></highlight><highlight class="comment">//PCS<sp/>going<sp/>out?</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7567"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Since<sp/>MPE<sp/>tags<sp/>use<sp/>&quot;real&quot;<sp/>values<sp/>for<sp/>PCS<sp/>we<sp/>need<sp/>to<sp/>convert<sp/>to</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7568"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//internal<sp/>encoding<sp/>used<sp/>by<sp/>IccProfLib</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7569"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(GetDstSpace())<sp/>{</highlight></codeline>
<codeline lineno="7570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>:</highlight></codeline>
<codeline lineno="7571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a4b4cfb7788c3a780f19f2f104677a5b8" kindref="member">icXyzToPcs</ref>(DstPixel);</highlight></codeline>
<codeline lineno="7572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7573"><highlight class="normal"></highlight></codeline>
<codeline lineno="7574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>:</highlight></codeline>
<codeline lineno="7575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a5768271d491af79a433e52722ed0a189" kindref="member">icLabToPcs</ref>(DstPixel);</highlight></codeline>
<codeline lineno="7576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7577"><highlight class="normal"></highlight></codeline>
<codeline lineno="7578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7580"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7581"><highlight class="normal"></highlight></codeline>
<codeline lineno="7582"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nIntent<sp/>!=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77ae6136c556a175effd2e35cb1db5ff944" kindref="member">icAbsoluteColorimetric</ref><sp/>||<sp/>m_nIntent<sp/>!=<sp/>m_nTagIntent)<sp/>{<sp/></highlight><highlight class="comment">//D2B3<sp/>tags<sp/>don&apos;t<sp/>need<sp/>abs<sp/>conversion</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_bDstPcsConversion)</highlight></codeline>
<codeline lineno="7584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CheckDstAbs(DstPixel);</highlight></codeline>
<codeline lineno="7585"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7586"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7587"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7588"><highlight class="normal"></highlight></codeline>
<codeline lineno="7597"><highlight class="normal">CIccApplyXformMpe::CIccApplyXformMpe(CIccXformMpe<sp/>*pXform)<sp/>:<sp/>CIccApplyXform(pXform)</highlight></codeline>
<codeline lineno="7598"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7599"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pApply<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="7600"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7601"><highlight class="normal"></highlight></codeline>
<codeline lineno="7610"><highlight class="normal">CIccApplyXformMpe::~CIccApplyXformMpe()</highlight></codeline>
<codeline lineno="7611"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7612"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7613"><highlight class="normal"></highlight></codeline>
<codeline lineno="7614"><highlight class="normal"></highlight></codeline>
<codeline lineno="7626"><highlight class="normal">CIccApplyCmm::CIccApplyCmm(CIccCmm<sp/>*pCmm)</highlight></codeline>
<codeline lineno="7627"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7628"><highlight class="normal"><sp/><sp/>m_pCmm<sp/>=<sp/>pCmm;</highlight></codeline>
<codeline lineno="7629"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//m_pPCS<sp/>=<sp/>m_pCmm-&gt;GetPCS();</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7630"><highlight class="normal"></highlight></codeline>
<codeline lineno="7631"><highlight class="normal"><sp/><sp/>m_Xforms<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccApplyXformList;</highlight></codeline>
<codeline lineno="7632"><highlight class="normal"><sp/><sp/>m_Xforms-&gt;clear();</highlight></codeline>
<codeline lineno="7633"><highlight class="normal"></highlight></codeline>
<codeline lineno="7634"><highlight class="normal"><sp/><sp/>m_Pixel<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="7635"><highlight class="normal"><sp/><sp/>m_Pixel2<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="7636"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7637"><highlight class="normal"></highlight></codeline>
<codeline lineno="7646"><highlight class="normal">CIccApplyCmm::~CIccApplyCmm()</highlight></codeline>
<codeline lineno="7647"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7648"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Xforms)<sp/>{</highlight></codeline>
<codeline lineno="7649"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccApplyXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="7650"><highlight class="normal"></highlight></codeline>
<codeline lineno="7651"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=m_Xforms-&gt;begin();<sp/>i!=m_Xforms-&gt;end();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="7652"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i-&gt;ptr)</highlight></codeline>
<codeline lineno="7653"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="7654"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7655"><highlight class="normal"></highlight></codeline>
<codeline lineno="7656"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_Xforms;</highlight></codeline>
<codeline lineno="7657"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7658"><highlight class="normal"></highlight></codeline>
<codeline lineno="7659"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/>if<sp/>(m_pPCS)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7660"><highlight class="normal"></highlight><highlight class="comment">//<sp/><sp/><sp/><sp/><sp/>delete<sp/>m_pPCS;</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7661"><highlight class="normal"></highlight></codeline>
<codeline lineno="7662"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Pixel)</highlight></codeline>
<codeline lineno="7663"><highlight class="normal"><sp/><sp/><sp/><sp/>free(m_Pixel);</highlight></codeline>
<codeline lineno="7664"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Pixel2)</highlight></codeline>
<codeline lineno="7665"><highlight class="normal"><sp/><sp/><sp/><sp/>free(m_Pixel2);</highlight></codeline>
<codeline lineno="7666"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7667"><highlight class="normal"></highlight></codeline>
<codeline lineno="7668"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccApplyCmm::InitPixel()</highlight></codeline>
<codeline lineno="7669"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7670"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Pixel<sp/>&amp;&amp;<sp/>m_Pixel2)</highlight></codeline>
<codeline lineno="7671"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7672"><highlight class="normal"></highlight></codeline>
<codeline lineno="7673"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nSamples<sp/>=<sp/>16;</highlight></codeline>
<codeline lineno="7674"><highlight class="normal"><sp/><sp/>CIccApplyXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="7675"><highlight class="normal"></highlight></codeline>
<codeline lineno="7676"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=m_Xforms-&gt;begin();<sp/>i!=m_Xforms-&gt;end();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="7677"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i-&gt;ptr-&gt;GetXform())<sp/>{</highlight></codeline>
<codeline lineno="7678"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nXformSamples<sp/>=<sp/>i-&gt;ptr-&gt;GetXform()-&gt;GetNumDstSamples();</highlight></codeline>
<codeline lineno="7679"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nXformSamples&gt;nSamples)</highlight></codeline>
<codeline lineno="7680"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSamples=nXformSamples;</highlight></codeline>
<codeline lineno="7681"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7682"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7683"><highlight class="normal"><sp/><sp/>m_Pixel<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*)malloc(nSamples*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="7684"><highlight class="normal"><sp/><sp/>m_Pixel2<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*)malloc(nSamples*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="7685"><highlight class="normal"></highlight></codeline>
<codeline lineno="7686"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Pixel<sp/>||<sp/>!m_Pixel2)</highlight></codeline>
<codeline lineno="7687"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7688"><highlight class="normal"></highlight></codeline>
<codeline lineno="7689"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7690"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7691"><highlight class="normal"></highlight></codeline>
<codeline lineno="7692"><highlight class="normal"></highlight><highlight class="comment">//#define<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7693"><highlight class="normal"></highlight></codeline>
<codeline lineno="7694"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7695"><highlight class="normal"></highlight><highlight class="keyword">static</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>DumpCmmApplyPixel(</highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nCount,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*<sp/>pPixel,<sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nSamples)</highlight></codeline>
<codeline lineno="7696"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7697"><highlight class="normal"><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Xfm%d:&quot;</highlight><highlight class="normal">,<sp/>nCount);</highlight></codeline>
<codeline lineno="7698"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>i<sp/>=<sp/>0;<sp/>i<sp/>&lt;<sp/>nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="7699"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i)</highlight></codeline>
<codeline lineno="7700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;,&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="7701"><highlight class="normal"><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;<sp/>%.3f&quot;</highlight><highlight class="normal">,<sp/>pPixel[i]);</highlight></codeline>
<codeline lineno="7702"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7703"><highlight class="normal"><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="7704"><highlight class="normal"></highlight></codeline>
<codeline lineno="7705"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7706"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7707"><highlight class="normal"></highlight></codeline>
<codeline lineno="7720"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccApplyCmm::Apply(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight></codeline>
<codeline lineno="7721"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7722"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/>*pTmp;</highlight></codeline>
<codeline lineno="7723"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc;</highlight></codeline>
<codeline lineno="7724"><highlight class="normal"><sp/><sp/>CIccApplyXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="7725"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccXform<sp/>*pLastXform;</highlight></codeline>
<codeline lineno="7726"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j,<sp/>n<sp/>=<sp/>(int)m_Xforms-&gt;size();</highlight></codeline>
<codeline lineno="7727"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bNoClip;</highlight></codeline>
<codeline lineno="7728"><highlight class="normal"></highlight></codeline>
<codeline lineno="7729"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!n)</highlight></codeline>
<codeline lineno="7730"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="7731"><highlight class="normal"></highlight></codeline>
<codeline lineno="7732"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Pixel<sp/>&amp;&amp;<sp/>!InitPixel())<sp/>{</highlight></codeline>
<codeline lineno="7733"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="7734"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7735"><highlight class="normal"></highlight></codeline>
<codeline lineno="7736"><highlight class="normal"><sp/><sp/>pSrc<sp/>=<sp/>SrcPixel;</highlight></codeline>
<codeline lineno="7737"><highlight class="normal"><sp/><sp/>pDst<sp/>=<sp/>m_Pixel;</highlight></codeline>
<codeline lineno="7738"><highlight class="normal"></highlight></codeline>
<codeline lineno="7739"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7740"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nCount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="7741"><highlight class="normal"><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Start<sp/>ApplyCmm\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="7742"><highlight class="normal"><sp/><sp/>DumpCmmApplyPixel(nCount++,<sp/>pSrc,<sp/><ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(m_pCmm-&gt;m_nSrcSpace));</highlight></codeline>
<codeline lineno="7743"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7744"><highlight class="normal"></highlight></codeline>
<codeline lineno="7745"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n&gt;1)<sp/>{</highlight></codeline>
<codeline lineno="7746"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j=0,<sp/>i=m_Xforms-&gt;begin();<sp/>j&lt;n-1<sp/>&amp;&amp;<sp/>i!=m_Xforms-&gt;end();<sp/>i++,<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="7747"><highlight class="normal"></highlight></codeline>
<codeline lineno="7748"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>i-&gt;ptr-&gt;Apply(pDst,<sp/>pSrc);</highlight></codeline>
<codeline lineno="7749"><highlight class="normal"></highlight></codeline>
<codeline lineno="7750"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7751"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>DumpCmmApplyPixel(nCount++,<sp/>pDst,<sp/>i-&gt;ptr-&gt;GetXform()-&gt;GetNumDstSamples());</highlight></codeline>
<codeline lineno="7752"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7753"><highlight class="normal"></highlight></codeline>
<codeline lineno="7754"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pTmp<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*)pSrc;</highlight></codeline>
<codeline lineno="7755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pSrc<sp/>=<sp/>pDst;</highlight></codeline>
<codeline lineno="7756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTmp<sp/>==<sp/>SrcPixel)</highlight></codeline>
<codeline lineno="7757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pDst<sp/>=<sp/>m_Pixel2;</highlight></codeline>
<codeline lineno="7758"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pDst<sp/>=<sp/>pTmp;</highlight></codeline>
<codeline lineno="7760"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7761"><highlight class="normal"></highlight></codeline>
<codeline lineno="7762"><highlight class="normal"><sp/><sp/><sp/><sp/>pLastXform<sp/>=<sp/>i-&gt;ptr-&gt;GetXform();<sp/><sp/><sp/></highlight></codeline>
<codeline lineno="7763"><highlight class="normal"><sp/><sp/><sp/><sp/>i-&gt;ptr-&gt;Apply(DstPixel,<sp/>pSrc);</highlight></codeline>
<codeline lineno="7764"><highlight class="normal"><sp/><sp/><sp/><sp/>bNoClip<sp/>=<sp/>pLastXform-&gt;NoClipPCS();</highlight></codeline>
<codeline lineno="7765"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7766"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n==1)<sp/>{</highlight></codeline>
<codeline lineno="7767"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>m_Xforms-&gt;begin();</highlight></codeline>
<codeline lineno="7768"><highlight class="normal"></highlight></codeline>
<codeline lineno="7769"><highlight class="normal"><sp/><sp/><sp/><sp/>pLastXform<sp/>=<sp/>i-&gt;ptr-&gt;GetXform();</highlight></codeline>
<codeline lineno="7770"><highlight class="normal"><sp/><sp/><sp/><sp/>i-&gt;ptr-&gt;Apply(DstPixel,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="7771"><highlight class="normal"></highlight></codeline>
<codeline lineno="7772"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7773"><highlight class="normal"><sp/><sp/><sp/><sp/>DumpCmmApplyPixel(nCount++,<sp/>pDst,<sp/>i-&gt;ptr-&gt;GetXform()-&gt;GetNumDstSamples());</highlight></codeline>
<codeline lineno="7774"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7775"><highlight class="normal"></highlight></codeline>
<codeline lineno="7776"><highlight class="normal"><sp/><sp/><sp/><sp/>bNoClip<sp/>=<sp/>pLastXform-&gt;NoClipPCS();</highlight></codeline>
<codeline lineno="7777"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7778"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="7779"><highlight class="normal"><sp/><sp/><sp/><sp/>bNoClip<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7780"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7781"><highlight class="normal"></highlight></codeline>
<codeline lineno="7782"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//m_pPCS-&gt;CheckLast(DstPixel,<sp/>m_pCmm-&gt;m_nDestSpace,<sp/>bNoClip);</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7783"><highlight class="normal"></highlight></codeline>
<codeline lineno="7784"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7785"><highlight class="normal"><sp/><sp/>DumpCmmApplyPixel(nCount,<sp/>DstPixel,<sp/><ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(m_pCmm-&gt;m_nDestSpace));</highlight></codeline>
<codeline lineno="7786"><highlight class="normal"><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;End<sp/>ApplyCmm\n\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="7787"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7788"><highlight class="normal"></highlight></codeline>
<codeline lineno="7789"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="7790"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7791"><highlight class="normal"></highlight></codeline>
<codeline lineno="7804"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccApplyCmm::Apply(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel,<sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>nPixels)</highlight></codeline>
<codeline lineno="7805"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7806"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/>*pTmp;</highlight></codeline>
<codeline lineno="7807"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc;</highlight></codeline>
<codeline lineno="7808"><highlight class="normal"><sp/><sp/>CIccApplyXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="7809"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j,<sp/>n<sp/>=<sp/>(int)m_Xforms-&gt;size();</highlight></codeline>
<codeline lineno="7810"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>k;</highlight></codeline>
<codeline lineno="7811"><highlight class="normal"></highlight></codeline>
<codeline lineno="7812"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!n)</highlight></codeline>
<codeline lineno="7813"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="7814"><highlight class="normal"></highlight></codeline>
<codeline lineno="7815"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Pixel<sp/>&amp;&amp;<sp/>!InitPixel())<sp/>{</highlight></codeline>
<codeline lineno="7816"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="7817"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7818"><highlight class="normal"></highlight></codeline>
<codeline lineno="7819"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(k=0;<sp/>k&lt;nPixels;<sp/>k++)<sp/>{</highlight></codeline>
<codeline lineno="7820"><highlight class="normal"><sp/><sp/><sp/><sp/>pSrc<sp/>=<sp/>SrcPixel;</highlight></codeline>
<codeline lineno="7821"><highlight class="normal"><sp/><sp/><sp/><sp/>pDst<sp/>=<sp/>m_Pixel;</highlight></codeline>
<codeline lineno="7822"><highlight class="normal"></highlight></codeline>
<codeline lineno="7823"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n&gt;1)<sp/>{</highlight></codeline>
<codeline lineno="7824"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j=0,<sp/>i=m_Xforms-&gt;begin();<sp/>j&lt;n-1<sp/>&amp;&amp;<sp/>i!=m_Xforms-&gt;end();<sp/>i++,<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="7825"><highlight class="normal"></highlight></codeline>
<codeline lineno="7826"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i-&gt;ptr-&gt;Apply(pDst,<sp/>pSrc);</highlight></codeline>
<codeline lineno="7827"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTmp<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*)pSrc;</highlight></codeline>
<codeline lineno="7828"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pSrc<sp/>=<sp/>pDst;</highlight></codeline>
<codeline lineno="7829"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTmp==SrcPixel)</highlight></codeline>
<codeline lineno="7830"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pDst<sp/>=<sp/>m_Pixel2;</highlight></codeline>
<codeline lineno="7831"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="7832"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pDst<sp/>=<sp/>pTmp;</highlight></codeline>
<codeline lineno="7833"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7834"><highlight class="normal"></highlight></codeline>
<codeline lineno="7835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>i-&gt;ptr-&gt;Apply(DstPixel,<sp/>pSrc);</highlight></codeline>
<codeline lineno="7836"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7837"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n==1)<sp/>{</highlight></codeline>
<codeline lineno="7838"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>m_Xforms-&gt;begin();</highlight></codeline>
<codeline lineno="7839"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>i-&gt;ptr-&gt;Apply(DstPixel,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="7840"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7841"><highlight class="normal"></highlight></codeline>
<codeline lineno="7842"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel<sp/>+=<sp/>m_pCmm-&gt;GetDestSamples();</highlight></codeline>
<codeline lineno="7843"><highlight class="normal"><sp/><sp/><sp/><sp/>SrcPixel<sp/>+=<sp/>m_pCmm-&gt;GetSourceSamples();</highlight></codeline>
<codeline lineno="7844"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7845"><highlight class="normal"></highlight></codeline>
<codeline lineno="7846"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="7847"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7848"><highlight class="normal"></highlight></codeline>
<codeline lineno="7849"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccApplyCmm::AppendApplyXform(CIccApplyXform<sp/>*pApplyXform)</highlight></codeline>
<codeline lineno="7850"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7851"><highlight class="normal"><sp/><sp/>CIccApplyXformPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="7852"><highlight class="normal"><sp/><sp/>ptr.ptr<sp/>=<sp/>pApplyXform;</highlight></codeline>
<codeline lineno="7853"><highlight class="normal"></highlight></codeline>
<codeline lineno="7854"><highlight class="normal"><sp/><sp/>m_Xforms-&gt;push_back(ptr);</highlight></codeline>
<codeline lineno="7855"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7856"><highlight class="normal"></highlight></codeline>
<codeline lineno="7870"><highlight class="normal">CIccCmm::CIccCmm(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nSrcSpace<sp/></highlight><highlight class="comment">/*=icSigUnknownData*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="7871"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nDestSpace<sp/></highlight><highlight class="comment">/*=icSigUnknownData*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="7872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bFirstInput<sp/></highlight><highlight class="comment">/*=true*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7873"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7874"><highlight class="normal"><sp/><sp/>m_bValid<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7875"><highlight class="normal"></highlight></codeline>
<codeline lineno="7876"><highlight class="normal"><sp/><sp/>m_bLastInput<sp/>=<sp/>!bFirstInput;</highlight></codeline>
<codeline lineno="7877"><highlight class="normal"><sp/><sp/>m_nSrcSpace<sp/>=<sp/>nSrcSpace;</highlight></codeline>
<codeline lineno="7878"><highlight class="normal"><sp/><sp/>m_nDestSpace<sp/>=<sp/>nDestSpace;</highlight></codeline>
<codeline lineno="7879"><highlight class="normal"></highlight></codeline>
<codeline lineno="7880"><highlight class="normal"><sp/><sp/>m_nLastSpace<sp/>=<sp/>nSrcSpace;</highlight></codeline>
<codeline lineno="7881"><highlight class="normal"><sp/><sp/>m_nLastIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1a0fbdbf76357f4ad739b1df71bd87ef8a" kindref="member">icUnknownIntent</ref>;</highlight></codeline>
<codeline lineno="7882"><highlight class="normal"></highlight></codeline>
<codeline lineno="7883"><highlight class="normal"><sp/><sp/>m_Xforms<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccXformList;</highlight></codeline>
<codeline lineno="7884"><highlight class="normal"><sp/><sp/>m_Xforms-&gt;clear();</highlight></codeline>
<codeline lineno="7885"><highlight class="normal"></highlight></codeline>
<codeline lineno="7886"><highlight class="normal"><sp/><sp/>m_pApply<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="7887"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7888"><highlight class="normal"></highlight></codeline>
<codeline lineno="7897"><highlight class="normal">CIccCmm::~CIccCmm()</highlight></codeline>
<codeline lineno="7898"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7899"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Xforms)<sp/>{</highlight></codeline>
<codeline lineno="7900"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="7901"><highlight class="normal"></highlight></codeline>
<codeline lineno="7902"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=m_Xforms-&gt;begin();<sp/>i!=m_Xforms-&gt;end();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="7903"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i-&gt;ptr)</highlight></codeline>
<codeline lineno="7904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="7905"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="7906"><highlight class="normal"></highlight></codeline>
<codeline lineno="7907"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_Xforms;</highlight></codeline>
<codeline lineno="7908"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7909"><highlight class="normal"></highlight></codeline>
<codeline lineno="7910"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pApply)</highlight></codeline>
<codeline lineno="7911"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_pApply;</highlight></codeline>
<codeline lineno="7912"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7913"><highlight class="normal"></highlight></codeline>
<codeline lineno="7914"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref>*<sp/>CIccCmm::GetStatusText(<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>stat)</highlight></codeline>
<codeline lineno="7915"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7916"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(stat)<sp/>{</highlight></codeline>
<codeline lineno="7917"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6aa1b3e92b9f8f78ad52846a217a262f72" kindref="member">icCmmStatBad</ref>:</highlight></codeline>
<codeline lineno="7918"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Bad<sp/>CMM&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7919"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>:</highlight></codeline>
<codeline lineno="7920"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;OK&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7921"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a94a1cd52eec49dc84eac5993164c5be0" kindref="member">icCmmStatCantOpenProfile</ref>:</highlight></codeline>
<codeline lineno="7922"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Cannot<sp/>open<sp/>profile&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7923"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>:</highlight></codeline>
<codeline lineno="7924"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>space<sp/>link&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7925"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860" kindref="member">icCmmStatInvalidProfile</ref>:</highlight></codeline>
<codeline lineno="7926"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>profile&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7927"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>:</highlight></codeline>
<codeline lineno="7928"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>profile<sp/>transform&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7929"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096" kindref="member">icCmmStatInvalidLut</ref>:</highlight></codeline>
<codeline lineno="7930"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>Look-Up<sp/>Table&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7931"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a538815909eaa26a2bc0b6d165674df2a" kindref="member">icCmmStatProfileMissingTag</ref>:</highlight></codeline>
<codeline lineno="7932"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Missing<sp/>tag<sp/>in<sp/>profile&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7933"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab00af0b273a3b182b2d71bf17ef83c16" kindref="member">icCmmStatColorNotFound</ref>:</highlight></codeline>
<codeline lineno="7934"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Color<sp/>not<sp/>found&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7935"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>:</highlight></codeline>
<codeline lineno="7936"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Incorrect<sp/>Apply<sp/>object&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7937"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26" kindref="member">icCmmStatBadColorEncoding</ref>:</highlight></codeline>
<codeline lineno="7938"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>color<sp/>encoding<sp/>used&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7939"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>:</highlight></codeline>
<codeline lineno="7940"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Memory<sp/>allocation<sp/>error&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7941"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a0a3d499218e996db890cba097db15f3b" kindref="member">icCmmStatBadLutType</ref>:</highlight></codeline>
<codeline lineno="7942"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>Look-Up<sp/>Table<sp/>type&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7943"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10" kindref="member">icCmmStatIdentityXform</ref>:</highlight></codeline>
<codeline lineno="7944"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Identity<sp/>transform<sp/>used&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7945"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a78eb7da06c8ca285cea7998ed00bc281" kindref="member">icCmmStatUnsupportedPcsLink</ref>:</highlight></codeline>
<codeline lineno="7946"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Unsupported<sp/>PCS<sp/>Link<sp/>used&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7947"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9d8efd1c91aa512d46f51cd30a7927f5" kindref="member">icCmmStatBadConnection</ref>:</highlight></codeline>
<codeline lineno="7948"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>profile<sp/>connection&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7949"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6aacc0b85d049e6d79aa0704d2054e62be" kindref="member">icCmmStatBadTintXform</ref>:</highlight></codeline>
<codeline lineno="7950"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>tint<sp/>transform&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7951"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a4af396c1421581f2a51027630e4bfb42" kindref="member">icCmmStatTooManySamples</ref>:</highlight></codeline>
<codeline lineno="7952"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Too<sp/>many<sp/>samples<sp/>used&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7953"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a6bd126a39f8787a82bf08db1af1fcb9b" kindref="member">icCmmStatBadMCSLink</ref>:</highlight></codeline>
<codeline lineno="7954"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Invalid<sp/>MCS<sp/>link<sp/>connection&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7955"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="7956"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;Unknown<sp/>CMM<sp/>Status<sp/>value&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="7957"><highlight class="normal"></highlight></codeline>
<codeline lineno="7958"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="7959"><highlight class="normal">}</highlight></codeline>
<codeline lineno="7960"><highlight class="normal"></highlight></codeline>
<codeline lineno="7979"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::AddXform(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref><sp/>*szProfilePath,</highlight></codeline>
<codeline lineno="7980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nIntent<sp/></highlight><highlight class="comment">/*=icUnknownIntent*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="7981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913" kindref="member">icXformInterp</ref><sp/>nInterp<sp/></highlight><highlight class="comment">/*icXformInterp*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="7982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc</highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="7983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7b" kindref="member">icXformLutType</ref><sp/>nLutType<sp/></highlight><highlight class="comment">/*=icXformLutColor*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="7984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseD2BxB2DxTags<sp/></highlight><highlight class="comment">/*=true*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="7985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccCreateXformHintManager<sp/>*pHintManager<sp/></highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="7986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseSubProfile<sp/></highlight><highlight class="comment">/*=false*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="7987"><highlight class="normal">{</highlight></codeline>
<codeline lineno="7988"><highlight class="normal"><sp/><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile<sp/>=<sp/><ref refid="d0/dc2/a00104_1a97134bdd4b4bf5e8a43ef018bba0917e" kindref="member">OpenIccProfile</ref>(szProfilePath,<sp/>bUseSubProfile);</highlight></codeline>
<codeline lineno="7989"><highlight class="normal"></highlight></codeline>
<codeline lineno="7990"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pProfile)<sp/></highlight></codeline>
<codeline lineno="7991"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a94a1cd52eec49dc84eac5993164c5be0" kindref="member">icCmmStatCantOpenProfile</ref>;</highlight></codeline>
<codeline lineno="7992"><highlight class="normal"></highlight></codeline>
<codeline lineno="7993"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv<sp/>=<sp/>AddXform(pProfile,<sp/>nIntent,<sp/>nInterp,<sp/>pPcc,<sp/>nLutType,<sp/>bUseD2BxB2DxTags,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="7994"><highlight class="normal"></highlight></codeline>
<codeline lineno="7995"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="7996"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pProfile;</highlight></codeline>
<codeline lineno="7997"><highlight class="normal"></highlight></codeline>
<codeline lineno="7998"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="7999"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8000"><highlight class="normal"></highlight></codeline>
<codeline lineno="8001"><highlight class="normal"></highlight></codeline>
<codeline lineno="8023"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::AddXform(<ref refid="d7/d46/a00002_1a0462ca2992be7c80b056e640a192b325" kindref="member">icUInt8Number</ref><sp/>*pProfileMem,</highlight></codeline>
<codeline lineno="8024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>nProfileLen,</highlight></codeline>
<codeline lineno="8025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nIntent<sp/></highlight><highlight class="comment">/*=icUnknownIntent*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913" kindref="member">icXformInterp</ref><sp/>nInterp<sp/></highlight><highlight class="comment">/*icXformInterp*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc</highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7b" kindref="member">icXformLutType</ref><sp/>nLutType<sp/></highlight><highlight class="comment">/*=icXformLutColor*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseD2BxB2DxTags<sp/></highlight><highlight class="comment">/*=true*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccCreateXformHintManager<sp/>*pHintManager<sp/></highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseSubProfile<sp/></highlight><highlight class="comment">/*=false*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8032"><highlight class="normal">{</highlight></codeline>
<codeline lineno="8033"><highlight class="normal"><sp/><sp/><ref refid="da/d5b/a00905" kindref="compound">CIccMemIO</ref><sp/>*pFile<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="da/d5b/a00905" kindref="compound">CIccMemIO</ref>;</highlight></codeline>
<codeline lineno="8034"><highlight class="normal"></highlight></codeline>
<codeline lineno="8035"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pFile<sp/>||<sp/>!pFile-&gt;<ref refid="da/d5b/a00905_1ae20403295a31727fe9f77ce46ea57c8e" kindref="member">Attach</ref>(pProfileMem,<sp/>nProfileLen,<sp/>bUseSubProfile))</highlight></codeline>
<codeline lineno="8036"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a94a1cd52eec49dc84eac5993164c5be0" kindref="member">icCmmStatCantOpenProfile</ref>;</highlight></codeline>
<codeline lineno="8037"><highlight class="normal"></highlight></codeline>
<codeline lineno="8038"><highlight class="normal"><sp/><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref>;</highlight></codeline>
<codeline lineno="8039"><highlight class="normal"></highlight></codeline>
<codeline lineno="8040"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pProfile)</highlight></codeline>
<codeline lineno="8041"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a94a1cd52eec49dc84eac5993164c5be0" kindref="member">icCmmStatCantOpenProfile</ref>;</highlight></codeline>
<codeline lineno="8042"><highlight class="normal"></highlight></codeline>
<codeline lineno="8043"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pProfile-&gt;Attach(pFile))<sp/>{</highlight></codeline>
<codeline lineno="8044"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pFile;</highlight></codeline>
<codeline lineno="8045"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pProfile;</highlight></codeline>
<codeline lineno="8046"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a94a1cd52eec49dc84eac5993164c5be0" kindref="member">icCmmStatCantOpenProfile</ref>;</highlight></codeline>
<codeline lineno="8047"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8048"><highlight class="normal"></highlight></codeline>
<codeline lineno="8049"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv<sp/>=<sp/>AddXform(pProfile,<sp/>nIntent,<sp/>nInterp,<sp/>pPcc,<sp/>nLutType,<sp/>bUseD2BxB2DxTags,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="8050"><highlight class="normal"></highlight></codeline>
<codeline lineno="8051"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="8052"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pProfile;</highlight></codeline>
<codeline lineno="8053"><highlight class="normal"></highlight></codeline>
<codeline lineno="8054"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="8055"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8056"><highlight class="normal"></highlight></codeline>
<codeline lineno="8057"><highlight class="normal"></highlight></codeline>
<codeline lineno="8077"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::AddXform(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile,</highlight></codeline>
<codeline lineno="8078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nIntent<sp/></highlight><highlight class="comment">/*=icUnknownIntent*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8079"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913" kindref="member">icXformInterp</ref><sp/>nInterp<sp/></highlight><highlight class="comment">/*=icInterpLinear*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8080"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc</highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8081"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7b" kindref="member">icXformLutType</ref><sp/>nLutType<sp/></highlight><highlight class="comment">/*=icXformLutColor*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseD2BxB2DxTags<sp/></highlight><highlight class="comment">/*=true*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccCreateXformHintManager<sp/>*pHintManager<sp/></highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8084"><highlight class="normal">{</highlight></codeline>
<codeline lineno="8085"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nSrcSpace,<sp/>nDstSpace;</highlight></codeline>
<codeline lineno="8086"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bInput<sp/>=<sp/>!m_bLastInput;</highlight></codeline>
<codeline lineno="8087"><highlight class="normal"></highlight></codeline>
<codeline lineno="8088"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pProfile)</highlight></codeline>
<codeline lineno="8089"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860" kindref="member">icCmmStatInvalidProfile</ref>;</highlight></codeline>
<codeline lineno="8090"><highlight class="normal"></highlight></codeline>
<codeline lineno="8091"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pProfile-&gt;m_Header.deviceClass)<sp/>{</highlight></codeline>
<codeline lineno="8092"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0aeb74955777b1abe38df700474c7be5ce" kindref="member">icSigMaterialIdentificationClass</ref>:</highlight></codeline>
<codeline lineno="8093"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f" kindref="member">icSigMaterialVisualizationClass</ref>:</highlight></codeline>
<codeline lineno="8094"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a8b2deae24b9246ac33314b42ad02ac48" kindref="member">icSigMaterialLinkClass</ref>:</highlight></codeline>
<codeline lineno="8095"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref>;</highlight></codeline>
<codeline lineno="8096"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nLutType<sp/>=<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153" kindref="member">icXformLutMCS</ref>;</highlight></codeline>
<codeline lineno="8097"><highlight class="normal"></highlight></codeline>
<codeline lineno="8098"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="8099"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8100"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8101"><highlight class="normal"></highlight></codeline>
<codeline lineno="8102"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(nLutType)<sp/>{</highlight></codeline>
<codeline lineno="8103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614" kindref="member">icXformLutColor</ref>:</highlight></codeline>
<codeline lineno="8104"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013" kindref="member">icXformLutColorimetric</ref>:</highlight></codeline>
<codeline lineno="8105"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262" kindref="member">icXformLutSpectral</ref>:</highlight></codeline>
<codeline lineno="8106"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Check<sp/>pProfile<sp/>if<sp/>nIntent<sp/>and<sp/>input<sp/>can<sp/>be<sp/>found.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bInput)<sp/>{</highlight></codeline>
<codeline lineno="8109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="8110"><highlight class="normal"></highlight></codeline>
<codeline lineno="8111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nLutType<sp/>==<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262" kindref="member">icXformLutSpectral</ref><sp/>||<sp/>(bUseD2BxB2DxTags<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.spectralPCS<sp/>&amp;&amp;<sp/>nLutType<sp/>!=<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013" kindref="member">icXformLutColorimetric</ref>))</highlight></codeline>
<codeline lineno="8112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.spectralPCS;</highlight></codeline>
<codeline lineno="8113"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="8115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8117"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass<sp/>==<sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0af50c13fdfab9fcc0a7b831ac86d1fe3b" kindref="member">icSigLinkClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="8119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass<sp/>==<sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a200e4fc8dcec29c6d411cae0c9a0483c" kindref="member">icSigAbstractClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref>;<sp/></highlight><highlight class="comment">//<sp/>Note:<sp/>icPerceptualIntent<sp/>=<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8124"><highlight class="normal"></highlight></codeline>
<codeline lineno="8125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nLutType<sp/>==<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262" kindref="member">icXformLutSpectral</ref><sp/>||<sp/>(bUseD2BxB2DxTags<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.spectralPCS<sp/>&amp;&amp;<sp/>nLutType<sp/>!=<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013" kindref="member">icXformLutColorimetric</ref>))</highlight></codeline>
<codeline lineno="8126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.spectralPCS;</highlight></codeline>
<codeline lineno="8127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="8129"><highlight class="normal"></highlight></codeline>
<codeline lineno="8130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="8131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8132"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8133"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8134"><highlight class="normal"></highlight></codeline>
<codeline lineno="8135"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7baeb0501fdc1dcc7f1388f0fdca9b17356" kindref="member">icXformLutPreview</ref>:</highlight></codeline>
<codeline lineno="8136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="8137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="8138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8140"><highlight class="normal"></highlight></codeline>
<codeline lineno="8141"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba6df311bd7dc6c9c9284ad186b15f53de" kindref="member">icXformLutGamut</ref>:</highlight></codeline>
<codeline lineno="8142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="8143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1af63f30724bd4cfbb6b7e3e2d7b1b602e" kindref="member">icSigGamutData</ref>;</highlight></codeline>
<codeline lineno="8144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8145"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8146"><highlight class="normal"></highlight></codeline>
<codeline lineno="8147"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7baf26b30e0e73bf289c23075e2f6106e6d" kindref="member">icXformLutBRDFParam</ref>:</highlight></codeline>
<codeline lineno="8148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!bInput)</highlight></codeline>
<codeline lineno="8149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="8150"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="8151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1ab9fb37bd0a4bf923692592a8b0565043" kindref="member">icSigBRDFParameters</ref>;</highlight></codeline>
<codeline lineno="8152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8154"><highlight class="normal"></highlight></codeline>
<codeline lineno="8155"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba1109d56a39fd11938962b487d6f965b8" kindref="member">icXformLutBRDFDirect</ref>:</highlight></codeline>
<codeline lineno="8156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!bInput)</highlight></codeline>
<codeline lineno="8157"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="8158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1a11a26c7a39b8bcb49fe0468959d60a7c" kindref="member">icSigBRDFDirect</ref>;</highlight></codeline>
<codeline lineno="8159"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="8160"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8162"><highlight class="normal"></highlight></codeline>
<codeline lineno="8163"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba1765210771d77678d0600381557d8bba" kindref="member">icXformLutBRDFMcsParam</ref>:</highlight></codeline>
<codeline lineno="8164"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!bInput)</highlight></codeline>
<codeline lineno="8165"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="8166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.mcs;</highlight></codeline>
<codeline lineno="8167"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1ab9fb37bd0a4bf923692592a8b0565043" kindref="member">icSigBRDFParameters</ref>;</highlight></codeline>
<codeline lineno="8168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8169"><highlight class="normal"></highlight></codeline>
<codeline lineno="8170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153" kindref="member">icXformLutMCS</ref>:</highlight></codeline>
<codeline lineno="8171"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bInput)<sp/>{</highlight></codeline>
<codeline lineno="8172"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="8173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.mcs;</highlight></codeline>
<codeline lineno="8174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8175"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8176"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_Xforms-&gt;size())<sp/>{</highlight></codeline>
<codeline lineno="8177"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccXformList::iterator<sp/>prev<sp/>=<sp/>--(m_Xforms-&gt;end());</highlight></codeline>
<codeline lineno="8178"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="8179"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Make<sp/>sure<sp/>previous<sp/>profile<sp/>connects<sp/>with<sp/>an<sp/>icXformLutMCS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8180"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(prev-&gt;ptr-&gt;GetXformType()!=<ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153" kindref="member">icXformLutMCS</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8181"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//check<sp/>to<sp/>see<sp/>if<sp/>we<sp/>can<sp/>convert<sp/>previous<sp/>xform<sp/>to<sp/>connect<sp/>via<sp/>an<sp/>MCS</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8182"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!prev-&gt;ptr-&gt;GetProfile()-&gt;m_Header.mcs)<sp/>{</highlight></codeline>
<codeline lineno="8183"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a6bd126a39f8787a82bf08db1af1fcb9b" kindref="member">icCmmStatBadMCSLink</ref>;</highlight></codeline>
<codeline lineno="8184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8185"><highlight class="normal"></highlight></codeline>
<codeline lineno="8186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccXform<sp/>*pPrev<sp/>=<sp/>prev-&gt;ptr;</highlight></codeline>
<codeline lineno="8187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccXform<sp/>*pNew<sp/>=<sp/>CIccXform::Create(pPrev-&gt;GetProfilePtr(),<sp/>pPrev-&gt;IsInput(),<sp/>pPrev-&gt;GetIntent(),<sp/>pPrev-&gt;GetInterp(),</highlight></codeline>
<codeline lineno="8188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pPrev-&gt;GetConnectionConditions(),<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153" kindref="member">icXformLutMCS</ref>,<sp/>bUseD2BxB2DxTags,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="8189"><highlight class="normal"></highlight></codeline>
<codeline lineno="8190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pNew)<sp/>{</highlight></codeline>
<codeline lineno="8191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pPrev-&gt;DetachAll();</highlight></codeline>
<codeline lineno="8192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pPrev;</highlight></codeline>
<codeline lineno="8193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8194"><highlight class="normal"></highlight></codeline>
<codeline lineno="8195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>prev-&gt;ptr<sp/>=<sp/>pNew;</highlight></codeline>
<codeline lineno="8196"><highlight class="normal"></highlight></codeline>
<codeline lineno="8197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8199"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a6bd126a39f8787a82bf08db1af1fcb9b" kindref="member">icCmmStatBadMCSLink</ref>;</highlight></codeline>
<codeline lineno="8201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8202"><highlight class="normal"></highlight></codeline>
<codeline lineno="8203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.mcs;</highlight></codeline>
<codeline lineno="8204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass==<ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f" kindref="member">icSigMaterialVisualizationClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseD2BxB2DxTags<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.spectralPCS)<sp/>{</highlight></codeline>
<codeline lineno="8206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.spectralPCS;</highlight></codeline>
<codeline lineno="8207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="8210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass==<ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a8b2deae24b9246ac33314b42ad02ac48" kindref="member">icSigMaterialLinkClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="8214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8215"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="8217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8220"><highlight class="normal"></highlight></codeline>
<codeline lineno="8221"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="8222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a0a3d499218e996db890cba097db15f3b" kindref="member">icCmmStatBadLutType</ref>;</highlight></codeline>
<codeline lineno="8223"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8224"><highlight class="normal"></highlight></codeline>
<codeline lineno="8225"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Make<sp/>sure<sp/>colorspaces<sp/>match<sp/>with<sp/>previous<sp/>xforms</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8226"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Xforms-&gt;size())<sp/>{</highlight></codeline>
<codeline lineno="8227"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nSrcSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8228"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_nLastSpace<sp/>=<sp/>nSrcSpace;</highlight></codeline>
<codeline lineno="8229"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_nSrcSpace<sp/>=<sp/>nSrcSpace;</highlight></codeline>
<codeline lineno="8230"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8231"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d3/df8/a00155_1a1376d1bc8bb70237fde226cb6f49872c" kindref="member">IsCompatSpace</ref>(m_nSrcSpace,<sp/>nSrcSpace))<sp/>{</highlight></codeline>
<codeline lineno="8232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="8233"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8234"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8235"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d3/df8/a00155_1a1376d1bc8bb70237fde226cb6f49872c" kindref="member">IsCompatSpace</ref>(m_nLastSpace,<sp/>nSrcSpace))<sp/>{</highlight></codeline>
<codeline lineno="8236"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="8237"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8238"><highlight class="normal"></highlight></codeline>
<codeline lineno="8239"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nSrcSpace==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)</highlight></codeline>
<codeline lineno="8240"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="8241"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="8242"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Automatic<sp/>creation<sp/>of<sp/>intent<sp/>from<sp/>header/last<sp/>profile</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8243"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nIntent==<ref refid="d7/d46/a00002_1a0fbdbf76357f4ad739b1df71bd87ef8a" kindref="member">icUnknownIntent</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8244"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bInput)<sp/>{</highlight></codeline>
<codeline lineno="8245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/>(<ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref>)pProfile-&gt;m_Header.renderingIntent;</highlight></codeline>
<codeline lineno="8246"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8247"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/>m_nLastIntent;</highlight></codeline>
<codeline lineno="8249"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8250"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1a0fbdbf76357f4ad739b1df71bd87ef8a" kindref="member">icUnknownIntent</ref>)</highlight></codeline>
<codeline lineno="8251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref>;</highlight></codeline>
<codeline lineno="8252"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8253"><highlight class="normal"></highlight></codeline>
<codeline lineno="8254"><highlight class="normal"><sp/><sp/>CIccXformPtr<sp/>Xform;</highlight></codeline>
<codeline lineno="8255"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="8256"><highlight class="normal"><sp/><sp/>Xform.ptr<sp/>=<sp/>CIccXform::Create(pProfile,<sp/>bInput,<sp/>nIntent,<sp/>nInterp,<sp/>pPcc,<sp/>nLutType,<sp/>bUseD2BxB2DxTags,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="8257"><highlight class="normal"></highlight></codeline>
<codeline lineno="8258"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Xform.ptr)<sp/>{</highlight></codeline>
<codeline lineno="8259"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="8260"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8261"><highlight class="normal"></highlight></codeline>
<codeline lineno="8262"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass==<ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f" kindref="member">icSigMaterialVisualizationClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8263"><highlight class="normal"><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8264"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8265"><highlight class="normal"></highlight></codeline>
<codeline lineno="8266"><highlight class="normal"><sp/><sp/>m_nLastSpace<sp/>=<sp/>nDstSpace;</highlight></codeline>
<codeline lineno="8267"><highlight class="normal"><sp/><sp/>m_nLastIntent<sp/>=<sp/>nIntent;</highlight></codeline>
<codeline lineno="8268"><highlight class="normal"><sp/><sp/>m_bLastInput<sp/>=<sp/>bInput;</highlight></codeline>
<codeline lineno="8269"><highlight class="normal"></highlight></codeline>
<codeline lineno="8270"><highlight class="normal"><sp/><sp/>m_Xforms-&gt;push_back(Xform);</highlight></codeline>
<codeline lineno="8271"><highlight class="normal"></highlight></codeline>
<codeline lineno="8272"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="8273"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8274"><highlight class="normal"></highlight></codeline>
<codeline lineno="8294"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::AddXform(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile,</highlight></codeline>
<codeline lineno="8295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pXformTag,</highlight></codeline>
<codeline lineno="8296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nIntent</highlight><highlight class="comment">/*=<sp/>icUnknownIntent*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913" kindref="member">icXformInterp</ref><sp/>nInterp<sp/></highlight><highlight class="comment">/*=icInterpLinear*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc</highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseSpectralPCS<sp/></highlight><highlight class="comment">/*=false*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccCreateXformHintManager<sp/>*pHintManager<sp/></highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8301"><highlight class="normal">{</highlight></codeline>
<codeline lineno="8302"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nSrcSpace,<sp/>nDstSpace;</highlight></codeline>
<codeline lineno="8303"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bInput<sp/>=<sp/>!m_bLastInput;</highlight></codeline>
<codeline lineno="8304"><highlight class="normal"></highlight></codeline>
<codeline lineno="8305"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pProfile)</highlight></codeline>
<codeline lineno="8306"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a3318d1563e16011fd5d158ce1f1fd860" kindref="member">icCmmStatInvalidProfile</ref>;</highlight></codeline>
<codeline lineno="8307"><highlight class="normal"></highlight></codeline>
<codeline lineno="8308"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass)<sp/>{</highlight></codeline>
<codeline lineno="8309"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0aeb74955777b1abe38df700474c7be5ce" kindref="member">icSigMaterialIdentificationClass</ref>:</highlight></codeline>
<codeline lineno="8310"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f" kindref="member">icSigMaterialVisualizationClass</ref>:</highlight></codeline>
<codeline lineno="8311"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a8b2deae24b9246ac33314b42ad02ac48" kindref="member">icSigMaterialLinkClass</ref>:</highlight></codeline>
<codeline lineno="8312"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a0a3d499218e996db890cba097db15f3b" kindref="member">icCmmStatBadLutType</ref>;</highlight></codeline>
<codeline lineno="8313"><highlight class="normal"></highlight></codeline>
<codeline lineno="8314"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="8315"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8316"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8317"><highlight class="normal"></highlight></codeline>
<codeline lineno="8318"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Check<sp/>pProfile<sp/>if<sp/>nIntent<sp/>and<sp/>input<sp/>can<sp/>be<sp/>found.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8319"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bInput)<sp/>{</highlight></codeline>
<codeline lineno="8320"><highlight class="normal"><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="8321"><highlight class="normal"></highlight></codeline>
<codeline lineno="8322"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseSpectralPCS<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.spectralPCS)</highlight></codeline>
<codeline lineno="8323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.spectralPCS;</highlight></codeline>
<codeline lineno="8324"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="8326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>bUseSpectralPCS<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8327"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8328"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8329"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8330"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass<sp/>==<sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0af50c13fdfab9fcc0a7b831ac86d1fe3b" kindref="member">icSigLinkClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="8332"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8333"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass<sp/>==<sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a200e4fc8dcec29c6d411cae0c9a0483c" kindref="member">icSigAbstractClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref>;<sp/></highlight><highlight class="comment">//<sp/>Note:<sp/>icPerceptualIntent<sp/>=<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8336"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8337"><highlight class="normal"></highlight></codeline>
<codeline lineno="8338"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseSpectralPCS<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.spectralPCS)</highlight></codeline>
<codeline lineno="8339"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.spectralPCS;</highlight></codeline>
<codeline lineno="8340"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="8342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>bUseSpectralPCS<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8343"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8344"><highlight class="normal"></highlight></codeline>
<codeline lineno="8345"><highlight class="normal"><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="8346"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8347"><highlight class="normal"></highlight></codeline>
<codeline lineno="8348"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Make<sp/>sure<sp/>colorspaces<sp/>match<sp/>with<sp/>previous<sp/>xforms</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8349"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Xforms-&gt;size())<sp/>{</highlight></codeline>
<codeline lineno="8350"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nSrcSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8351"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_nLastSpace<sp/>=<sp/>nSrcSpace;</highlight></codeline>
<codeline lineno="8352"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_nSrcSpace<sp/>=<sp/>nSrcSpace;</highlight></codeline>
<codeline lineno="8353"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8354"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d3/df8/a00155_1a1376d1bc8bb70237fde226cb6f49872c" kindref="member">IsCompatSpace</ref>(m_nSrcSpace,<sp/>nSrcSpace))<sp/>{</highlight></codeline>
<codeline lineno="8355"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="8356"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8357"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8358"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d3/df8/a00155_1a1376d1bc8bb70237fde226cb6f49872c" kindref="member">IsCompatSpace</ref>(m_nLastSpace,<sp/>nSrcSpace))<sp/>{</highlight></codeline>
<codeline lineno="8359"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="8360"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8361"><highlight class="normal"></highlight></codeline>
<codeline lineno="8362"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nSrcSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)</highlight></codeline>
<codeline lineno="8363"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="8364"><highlight class="normal"></highlight></codeline>
<codeline lineno="8365"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Automatic<sp/>creation<sp/>of<sp/>intent<sp/>from<sp/>header/last<sp/>profile</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8366"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1a0fbdbf76357f4ad739b1df71bd87ef8a" kindref="member">icUnknownIntent</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8367"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bInput)<sp/>{</highlight></codeline>
<codeline lineno="8368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/>(<ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref>)pProfile-&gt;m_Header.renderingIntent;</highlight></codeline>
<codeline lineno="8369"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8370"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8371"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/>m_nLastIntent;</highlight></codeline>
<codeline lineno="8372"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8373"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1a0fbdbf76357f4ad739b1df71bd87ef8a" kindref="member">icUnknownIntent</ref>)</highlight></codeline>
<codeline lineno="8374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref>;</highlight></codeline>
<codeline lineno="8375"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8376"><highlight class="normal"></highlight></codeline>
<codeline lineno="8377"><highlight class="normal"><sp/><sp/>CIccXformPtr<sp/>Xform;</highlight></codeline>
<codeline lineno="8378"><highlight class="normal"></highlight></codeline>
<codeline lineno="8379"><highlight class="normal"><sp/><sp/>Xform.ptr<sp/>=<sp/>CIccXform::Create(pProfile,<sp/>pXformTag,<sp/>bInput,<sp/>nIntent,<sp/>nInterp,<sp/>pPcc,<sp/>bUseSpectralPCS,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="8380"><highlight class="normal"></highlight></codeline>
<codeline lineno="8381"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Xform.ptr)<sp/>{</highlight></codeline>
<codeline lineno="8382"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="8383"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8384"><highlight class="normal"></highlight></codeline>
<codeline lineno="8385"><highlight class="normal"><sp/><sp/>m_nLastSpace<sp/>=<sp/>nDstSpace;</highlight></codeline>
<codeline lineno="8386"><highlight class="normal"><sp/><sp/>m_nLastIntent<sp/>=<sp/>nIntent;</highlight></codeline>
<codeline lineno="8387"><highlight class="normal"><sp/><sp/>m_bLastInput<sp/>=<sp/>bInput;</highlight></codeline>
<codeline lineno="8388"><highlight class="normal"></highlight></codeline>
<codeline lineno="8389"><highlight class="normal"><sp/><sp/>m_Xforms-&gt;push_back(Xform);</highlight></codeline>
<codeline lineno="8390"><highlight class="normal"></highlight></codeline>
<codeline lineno="8391"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="8392"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8393"><highlight class="normal"></highlight></codeline>
<codeline lineno="8413"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::AddXform(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>&amp;Profile,</highlight></codeline>
<codeline lineno="8414"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nIntent<sp/></highlight><highlight class="comment">/*=icUnknownIntent*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8415"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913" kindref="member">icXformInterp</ref><sp/>nInterp<sp/></highlight><highlight class="comment">/*=icInterpLinear*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8416"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc</highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7b" kindref="member">icXformLutType</ref><sp/>nLutType<sp/></highlight><highlight class="comment">/*=icXformLutColor*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8418"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseD2BxB2DxTags<sp/></highlight><highlight class="comment">/*=true*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="8419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccCreateXformHintManager<sp/>*pHintManager<sp/></highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8420"><highlight class="normal">{</highlight></codeline>
<codeline lineno="8421"><highlight class="normal"><sp/><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref>(Profile);</highlight></codeline>
<codeline lineno="8422"><highlight class="normal"></highlight></codeline>
<codeline lineno="8423"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pProfile)<sp/></highlight></codeline>
<codeline lineno="8424"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="8425"><highlight class="normal"></highlight></codeline>
<codeline lineno="8426"><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>stat<sp/>=<sp/>AddXform(pProfile,<sp/>nIntent,<sp/>nInterp,<sp/>pPcc,<sp/>nLutType,<sp/>bUseD2BxB2DxTags,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="8427"><highlight class="normal"></highlight></codeline>
<codeline lineno="8428"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(stat<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="8429"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pProfile;</highlight></codeline>
<codeline lineno="8430"><highlight class="normal"></highlight></codeline>
<codeline lineno="8431"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>stat;</highlight></codeline>
<codeline lineno="8432"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8433"><highlight class="normal"></highlight></codeline>
<codeline lineno="8434"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::CheckPCSConnections(</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUsePCSConversions</highlight><highlight class="comment">/*=false*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8435"><highlight class="normal">{</highlight></codeline>
<codeline lineno="8436"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="8437"><highlight class="normal"></highlight></codeline>
<codeline lineno="8438"><highlight class="normal"><sp/><sp/>CIccXformList::iterator<sp/>last,<sp/>next;</highlight></codeline>
<codeline lineno="8439"><highlight class="normal"><sp/><sp/>CIccXformList<sp/>xforms;</highlight></codeline>
<codeline lineno="8440"><highlight class="normal"><sp/><sp/>CIccXformPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="8441"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUsesPcsXforms<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8442"><highlight class="normal"></highlight></codeline>
<codeline lineno="8443"><highlight class="normal"><sp/><sp/>next=m_Xforms-&gt;begin();</highlight></codeline>
<codeline lineno="8444"><highlight class="normal"></highlight></codeline>
<codeline lineno="8445"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(next!=m_Xforms-&gt;end())<sp/>{</highlight></codeline>
<codeline lineno="8446"><highlight class="normal"><sp/><sp/><sp/><sp/>last<sp/>=<sp/>next;</highlight></codeline>
<codeline lineno="8447"><highlight class="normal"><sp/><sp/><sp/><sp/>next++;</highlight></codeline>
<codeline lineno="8448"><highlight class="normal"></highlight></codeline>
<codeline lineno="8449"><highlight class="normal"><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>lastSpace<sp/>=<sp/>last-&gt;ptr-&gt;GetSrcSpace();</highlight></codeline>
<codeline lineno="8450"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!last-&gt;ptr-&gt;IsInput()<sp/>&amp;&amp;<sp/><ref refid="d3/df8/a00155_1aaacd6d45813e2697ad238b12befa5719" kindref="member">IsSpaceColorimetricPCS</ref>(lastSpace)<sp/>&amp;&amp;<sp/>(GetSourceSpace()<sp/>!=lastSpace<sp/>||<sp/>last-&gt;ptr-&gt;UseLegacyPCS()))<sp/>{</highlight></codeline>
<codeline lineno="8451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsXform*<sp/>pPcs<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsXform();</highlight></codeline>
<codeline lineno="8452"><highlight class="normal"></highlight></codeline>
<codeline lineno="8453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pPcs)<sp/>{</highlight></codeline>
<codeline lineno="8454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="8455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8456"><highlight class="normal"></highlight></codeline>
<codeline lineno="8457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pPcs-&gt;ConnectFirst(last-&gt;ptr,<sp/>GetSourceSpace());</highlight></codeline>
<codeline lineno="8458"><highlight class="normal"></highlight></codeline>
<codeline lineno="8459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref><sp/>&amp;&amp;<sp/>rv<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10" kindref="member">icCmmStatIdentityXform</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pPcs;</highlight></codeline>
<codeline lineno="8461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="8462"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8463"><highlight class="normal"></highlight></codeline>
<codeline lineno="8464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10" kindref="member">icCmmStatIdentityXform</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>pPcs;</highlight></codeline>
<codeline lineno="8466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xforms.push_back(ptr);</highlight></codeline>
<codeline lineno="8467"><highlight class="normal"></highlight></codeline>
<codeline lineno="8468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUsesPcsXforms<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8471"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pPcs;</highlight></codeline>
<codeline lineno="8472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8473"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8474"><highlight class="normal"></highlight></codeline>
<codeline lineno="8475"><highlight class="normal"><sp/><sp/><sp/><sp/>xforms.push_back(*last);</highlight></codeline>
<codeline lineno="8476"><highlight class="normal"></highlight></codeline>
<codeline lineno="8477"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;next!=m_Xforms-&gt;end();<sp/>last=next,<sp/>next++)<sp/>{</highlight></codeline>
<codeline lineno="8478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>((last-&gt;ptr-&gt;IsInput()<sp/>&amp;&amp;<sp/>last-&gt;ptr-&gt;IsMCS()<sp/>&amp;&amp;<sp/>next-&gt;ptr-&gt;IsMCS())<sp/>||</highlight></codeline>
<codeline lineno="8479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="d3/df8/a00155_1a05df9b9a2f56c907e676a0efc3e9219d" kindref="member">IsSpaceSpectralPCS</ref>(last-&gt;ptr-&gt;GetDstSpace())<sp/>||<sp/><ref refid="d3/df8/a00155_1a05df9b9a2f56c907e676a0efc3e9219d" kindref="member">IsSpaceSpectralPCS</ref>(next-&gt;ptr-&gt;GetSrcSpace()))<sp/>||</highlight></codeline>
<codeline lineno="8480"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(!bUsePCSConversions<sp/>&amp;&amp;<sp/></highlight></codeline>
<codeline lineno="8481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(<ref refid="d3/df8/a00155_1aaacd6d45813e2697ad238b12befa5719" kindref="member">IsSpaceColorimetricPCS</ref>(last-&gt;ptr-&gt;GetDstSpace())<sp/>||<sp/><ref refid="d3/df8/a00155_1aaacd6d45813e2697ad238b12befa5719" kindref="member">IsSpaceColorimetricPCS</ref>(next-&gt;ptr-&gt;GetSrcSpace()))))<sp/>{</highlight></codeline>
<codeline lineno="8482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>last-&gt;ptr-&gt;SetDstPCSConversion(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="8483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>next-&gt;ptr-&gt;SetSrcPCSConversion(</highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="8484"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsXform<sp/>*pPcs<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsXform();</highlight></codeline>
<codeline lineno="8485"><highlight class="normal"></highlight></codeline>
<codeline lineno="8486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pPcs)<sp/>{</highlight></codeline>
<codeline lineno="8487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="8488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8489"><highlight class="normal"></highlight></codeline>
<codeline lineno="8490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pPcs-&gt;Connect(last-&gt;ptr,<sp/>next-&gt;ptr);</highlight></codeline>
<codeline lineno="8491"><highlight class="normal"></highlight></codeline>
<codeline lineno="8492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref><sp/>&amp;&amp;<sp/>rv!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10" kindref="member">icCmmStatIdentityXform</ref>)</highlight></codeline>
<codeline lineno="8493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="8494"><highlight class="normal"></highlight></codeline>
<codeline lineno="8495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10" kindref="member">icCmmStatIdentityXform</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>pPcs;</highlight></codeline>
<codeline lineno="8497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xforms.push_back(ptr);</highlight></codeline>
<codeline lineno="8498"><highlight class="normal"></highlight></codeline>
<codeline lineno="8499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUsesPcsXforms<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8500"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pPcs;</highlight></codeline>
<codeline lineno="8503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xforms.push_back(*next);</highlight></codeline>
<codeline lineno="8506"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8507"><highlight class="normal"></highlight></codeline>
<codeline lineno="8508"><highlight class="normal"><sp/><sp/><sp/><sp/>lastSpace<sp/>=<sp/>last-&gt;ptr-&gt;GetDstSpace();</highlight></codeline>
<codeline lineno="8509"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(last-&gt;ptr-&gt;IsInput()<sp/>&amp;&amp;<sp/><ref refid="d3/df8/a00155_1aaacd6d45813e2697ad238b12befa5719" kindref="member">IsSpaceColorimetricPCS</ref>(lastSpace)<sp/>&amp;&amp;<sp/></highlight></codeline>
<codeline lineno="8510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>(last-&gt;ptr-&gt;NeedAdjustPCS()<sp/>||<sp/>GetDestSpace()<sp/>!=<sp/>lastSpace<sp/>||<sp/>last-&gt;ptr-&gt;UseLegacyPCS()))<sp/>{</highlight></codeline>
<codeline lineno="8511"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>CIccPcsXform*<sp/>pPcs<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccPcsXform();</highlight></codeline>
<codeline lineno="8512"><highlight class="normal"></highlight></codeline>
<codeline lineno="8513"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pPcs)<sp/>{</highlight></codeline>
<codeline lineno="8514"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="8515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pPcs-&gt;ConnectLast(last-&gt;ptr,<sp/>GetDestSpace());</highlight></codeline>
<codeline lineno="8517"><highlight class="normal"></highlight></codeline>
<codeline lineno="8518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref><sp/>&amp;&amp;<sp/>rv<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10" kindref="member">icCmmStatIdentityXform</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8519"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pPcs;</highlight></codeline>
<codeline lineno="8520"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="8521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8522"><highlight class="normal"></highlight></codeline>
<codeline lineno="8523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10" kindref="member">icCmmStatIdentityXform</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>pPcs;</highlight></codeline>
<codeline lineno="8525"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xforms.push_back(ptr);</highlight></codeline>
<codeline lineno="8526"><highlight class="normal"></highlight></codeline>
<codeline lineno="8527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUsesPcsXforms<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8530"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pPcs;</highlight></codeline>
<codeline lineno="8531"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8532"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8533"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8534"><highlight class="normal"></highlight></codeline>
<codeline lineno="8535"><highlight class="normal"></highlight></codeline>
<codeline lineno="8536"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUsesPcsXforms)<sp/>{</highlight></codeline>
<codeline lineno="8537"><highlight class="normal"><sp/><sp/><sp/><sp/>*m_Xforms<sp/>=<sp/>xforms;</highlight></codeline>
<codeline lineno="8538"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8539"><highlight class="normal"></highlight></codeline>
<codeline lineno="8540"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="8541"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8542"><highlight class="normal"></highlight></codeline>
<codeline lineno="8543"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::CheckPCSRangeConversions()</highlight></codeline>
<codeline lineno="8544"><highlight class="normal">{</highlight></codeline>
<codeline lineno="8545"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="8546"><highlight class="normal"></highlight></codeline>
<codeline lineno="8547"><highlight class="normal"><sp/><sp/>CIccXformList::iterator<sp/>last,<sp/>next;</highlight></codeline>
<codeline lineno="8548"><highlight class="normal"><sp/><sp/>CIccXformList<sp/>xforms;</highlight></codeline>
<codeline lineno="8549"><highlight class="normal"><sp/><sp/>CIccXformPtr<sp/>ptr;</highlight></codeline>
<codeline lineno="8550"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUsesRangeConversion<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8551"><highlight class="normal"></highlight></codeline>
<codeline lineno="8552"><highlight class="normal"><sp/><sp/>next<sp/>=<sp/>m_Xforms-&gt;begin();</highlight></codeline>
<codeline lineno="8553"><highlight class="normal"></highlight></codeline>
<codeline lineno="8554"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(next<sp/>!=<sp/>m_Xforms-&gt;end())<sp/>{</highlight></codeline>
<codeline lineno="8555"><highlight class="normal"><sp/><sp/><sp/><sp/>last<sp/>=<sp/>next;</highlight></codeline>
<codeline lineno="8556"><highlight class="normal"><sp/><sp/><sp/><sp/>next++;</highlight></codeline>
<codeline lineno="8557"><highlight class="normal"></highlight></codeline>
<codeline lineno="8558"><highlight class="normal"><sp/><sp/><sp/><sp/>xforms.push_back(*last);</highlight></codeline>
<codeline lineno="8559"><highlight class="normal"></highlight></codeline>
<codeline lineno="8560"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(;<sp/>next<sp/>!=<sp/>m_Xforms-&gt;end();<sp/>last<sp/>=<sp/>next,<sp/>next++)<sp/>{</highlight></codeline>
<codeline lineno="8561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Add<sp/>extended<sp/>PCS<sp/>to<sp/>standard<sp/>PCS<sp/>conversion<sp/>as<sp/>needed</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(last-&gt;ptr-&gt;IsInput()<sp/>&amp;&amp;<sp/>last-&gt;ptr-&gt;IsExtendedPCS()<sp/>&amp;&amp;<sp/><ref refid="d3/df8/a00155_1aaacd6d45813e2697ad238b12befa5719" kindref="member">IsSpaceColorimetricPCS</ref>(last-&gt;ptr-&gt;GetDstSpace())<sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="8563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>!next-&gt;ptr-&gt;IsExtendedPCS())<sp/>{</highlight></codeline>
<codeline lineno="8564"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref>*<sp/>pProfile<sp/>=<sp/>last-&gt;ptr-&gt;GetProfilePtr();</highlight></codeline>
<codeline lineno="8565"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref>*<sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a91088345233e12514ec483327a00dbe8" kindref="member">icSigHToS0Tag</ref><sp/>+<sp/>last-&gt;ptr-&gt;GetIntent());</highlight></codeline>
<codeline lineno="8566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="8567"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a91088345233e12514ec483327a00dbe8" kindref="member">icSigHToS0Tag</ref>);</highlight></codeline>
<codeline lineno="8568"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pTag)<sp/>{</highlight></codeline>
<codeline lineno="8569"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5a85d24fc4ed8a193b8718b540ecfd003d" kindref="member">icSigHToS1Tag</ref>);</highlight></codeline>
<codeline lineno="8570"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8571"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//If<sp/>we<sp/>find<sp/>the<sp/>HToSxTag<sp/>then<sp/>create<sp/>a<sp/>transform<sp/>for<sp/>it<sp/>and<sp/>inject<sp/>it<sp/>into<sp/>the<sp/>transform<sp/>list</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag)<sp/>{</highlight></codeline>
<codeline lineno="8574"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr<sp/>=<sp/>CIccXform::Create(pProfile,<sp/>pTag,<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">,<sp/>last-&gt;ptr-&gt;GetIntent(),<sp/>last-&gt;ptr-&gt;GetInterp(),</highlight></codeline>
<codeline lineno="8575"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>last-&gt;ptr-&gt;GetConnectionConditions(),<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="8576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ptr.ptr)<sp/>{</highlight></codeline>
<codeline lineno="8577"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr-&gt;ShareProfile();<sp/></highlight><highlight class="comment">//Indicate<sp/>that<sp/>profile<sp/>is<sp/>shared<sp/>(so<sp/>it<sp/>won&apos;t<sp/>be<sp/>deleted)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8578"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr-&gt;SetPcsAdjustXform();<sp/></highlight><highlight class="comment">//<sp/>Indicates<sp/>that<sp/>transform<sp/>should<sp/>be<sp/>treated<sp/>as<sp/>abstract</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8579"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr.ptr-&gt;AttachCmmEnvVarLookup(last-&gt;ptr-&gt;GetCmmEnvVarLookup());</highlight></codeline>
<codeline lineno="8580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>xforms.push_back(ptr);</highlight></codeline>
<codeline lineno="8581"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUsesRangeConversion<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8582"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8583"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8584"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8585"><highlight class="normal"></highlight></codeline>
<codeline lineno="8586"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>xforms.push_back(*next);</highlight></codeline>
<codeline lineno="8587"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8588"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8589"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="8590"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUsesRangeConversion)<sp/>{</highlight></codeline>
<codeline lineno="8591"><highlight class="normal"><sp/><sp/><sp/><sp/>*m_Xforms<sp/>=<sp/>xforms;</highlight></codeline>
<codeline lineno="8592"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8593"><highlight class="normal"></highlight></codeline>
<codeline lineno="8594"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="8595"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8596"><highlight class="normal"></highlight></codeline>
<codeline lineno="8597"><highlight class="normal"></highlight></codeline>
<codeline lineno="8608"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccCmm::SetLateBindingCC()</highlight></codeline>
<codeline lineno="8609"><highlight class="normal">{</highlight></codeline>
<codeline lineno="8610"><highlight class="normal"><sp/><sp/>CIccXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="8611"><highlight class="normal"><sp/><sp/>CIccXform<sp/>*pLastXform<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="8612"><highlight class="normal"></highlight></codeline>
<codeline lineno="8613"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=m_Xforms-&gt;begin();<sp/>i!=m_Xforms-&gt;end();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="8614"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i-&gt;ptr-&gt;IsInput())<sp/>{</highlight></codeline>
<codeline lineno="8615"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i-&gt;ptr-&gt;IsLateBinding())<sp/>{</highlight></codeline>
<codeline lineno="8616"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccXformList::iterator<sp/>j=i;</highlight></codeline>
<codeline lineno="8617"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j++;</highlight></codeline>
<codeline lineno="8618"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j!=m_Xforms-&gt;end())<sp/>{</highlight></codeline>
<codeline lineno="8619"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j-&gt;ptr-&gt;IsLateBinding())<sp/>{</highlight></codeline>
<codeline lineno="8620"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i-&gt;ptr-&gt;SetAppliedCC(i-&gt;ptr-&gt;GetConnectionConditions());</highlight></codeline>
<codeline lineno="8621"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j-&gt;ptr-&gt;SetAppliedCC(i-&gt;ptr-&gt;GetConnectionConditions());</highlight></codeline>
<codeline lineno="8622"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pLastXform<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="8623"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8624"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8625"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i-&gt;ptr-&gt;SetAppliedCC(i-&gt;ptr-&gt;GetConnectionConditions());</highlight></codeline>
<codeline lineno="8626"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j-&gt;ptr-&gt;SetAppliedCC(j-&gt;ptr-&gt;GetConnectionConditions());</highlight></codeline>
<codeline lineno="8627"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pLastXform<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="8628"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8629"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8630"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8631"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i-&gt;ptr-&gt;SetAppliedCC(i-&gt;ptr-&gt;GetConnectionConditions());</highlight></codeline>
<codeline lineno="8632"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pLastXform<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="8633"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8634"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8635"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(<ref refid="d3/df8/a00155_1a05df9b9a2f56c907e676a0efc3e9219d" kindref="member">IsSpaceSpectralPCS</ref>(i-&gt;ptr-&gt;GetDstSpace()))<sp/>{</highlight></codeline>
<codeline lineno="8636"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccXformList::iterator<sp/>j=i;</highlight></codeline>
<codeline lineno="8637"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j++;</highlight></codeline>
<codeline lineno="8638"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j!=m_Xforms-&gt;end())<sp/>{</highlight></codeline>
<codeline lineno="8639"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j-&gt;ptr-&gt;IsLateBinding())<sp/>{</highlight></codeline>
<codeline lineno="8640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j-&gt;ptr-&gt;SetAppliedCC(i-&gt;ptr-&gt;GetConnectionConditions());</highlight></codeline>
<codeline lineno="8641"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pLastXform<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="8642"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!j-&gt;ptr-&gt;IsAbstract()){</highlight></codeline>
<codeline lineno="8644"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>j-&gt;ptr-&gt;SetAppliedCC(j-&gt;ptr-&gt;GetConnectionConditions());</highlight></codeline>
<codeline lineno="8645"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pLastXform<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="8646"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8647"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8649"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8650"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pLastXform<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="8651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8652"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8653"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8654"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pLastXform)<sp/></highlight></codeline>
<codeline lineno="8655"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>i-&gt;ptr-&gt;SetAppliedCC(i-&gt;ptr-&gt;GetConnectionConditions());</highlight></codeline>
<codeline lineno="8656"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8657"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pLastXform<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="8658"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8659"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8660"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8661"><highlight class="normal"></highlight></codeline>
<codeline lineno="8662"><highlight class="normal"></highlight></codeline>
<codeline lineno="8673"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::Begin(</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bAllocApplyCmm</highlight><highlight class="comment">/*=true*/</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUsePCSConversions</highlight><highlight class="comment">/*=false*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="8674"><highlight class="normal">{</highlight></codeline>
<codeline lineno="8675"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pApply)</highlight></codeline>
<codeline lineno="8676"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="8677"><highlight class="normal"></highlight></codeline>
<codeline lineno="8678"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nDestSpace==<ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8679"><highlight class="normal"><sp/><sp/><sp/><sp/>m_nDestSpace<sp/>=<sp/>m_nLastSpace;</highlight></codeline>
<codeline lineno="8680"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8681"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d3/df8/a00155_1a1376d1bc8bb70237fde226cb6f49872c" kindref="member">IsCompatSpace</ref>(m_nDestSpace,<sp/>m_nLastSpace))<sp/>{</highlight></codeline>
<codeline lineno="8682"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="8683"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8684"><highlight class="normal"></highlight></codeline>
<codeline lineno="8685"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nSrcSpace==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref><sp/>||<sp/>m_nDestSpace==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8686"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="8687"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8688"><highlight class="normal"></highlight></codeline>
<codeline lineno="8689"><highlight class="normal"><sp/><sp/>CheckPCSRangeConversions();</highlight></codeline>
<codeline lineno="8690"><highlight class="normal"><sp/><sp/>SetLateBindingCC();</highlight></codeline>
<codeline lineno="8691"><highlight class="normal"></highlight></codeline>
<codeline lineno="8692"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv;</highlight></codeline>
<codeline lineno="8693"><highlight class="normal"><sp/><sp/>CIccXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="8694"><highlight class="normal"></highlight></codeline>
<codeline lineno="8695"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=m_Xforms-&gt;begin();<sp/>i!=m_Xforms-&gt;end();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="8696"><highlight class="normal"></highlight></codeline>
<codeline lineno="8697"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>i-&gt;ptr-&gt;Begin();</highlight></codeline>
<codeline lineno="8698"><highlight class="normal"></highlight></codeline>
<codeline lineno="8699"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="8700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="8701"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8702"><highlight class="normal"></highlight></codeline>
<codeline lineno="8703"><highlight class="normal"><sp/><sp/>rv<sp/>=<sp/>CheckPCSConnections(bUsePCSConversions);</highlight></codeline>
<codeline lineno="8704"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref><sp/>&amp;&amp;<sp/>rv!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10" kindref="member">icCmmStatIdentityXform</ref>)</highlight></codeline>
<codeline lineno="8705"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="8706"><highlight class="normal"></highlight></codeline>
<codeline lineno="8707"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bAllocApplyCmm)<sp/>{</highlight></codeline>
<codeline lineno="8708"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pApply<sp/>=<sp/>GetNewApplyCmm(rv);</highlight></codeline>
<codeline lineno="8709"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8710"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="8711"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="8712"><highlight class="normal"></highlight></codeline>
<codeline lineno="8713"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="8714"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8715"><highlight class="normal"></highlight></codeline>
<codeline lineno="8716"><highlight class="normal"></highlight></codeline>
<codeline lineno="8728"><highlight class="normal">CIccApplyCmm<sp/>*CIccCmm::GetNewApplyCmm(<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>&amp;status)</highlight></codeline>
<codeline lineno="8729"><highlight class="normal">{</highlight></codeline>
<codeline lineno="8730"><highlight class="normal"><sp/><sp/>CIccApplyCmm<sp/>*pApply<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccApplyCmm(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="8731"><highlight class="normal"></highlight></codeline>
<codeline lineno="8732"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pApply)<sp/>{</highlight></codeline>
<codeline lineno="8733"><highlight class="normal"><sp/><sp/><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="8734"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="8735"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8736"><highlight class="normal"></highlight></codeline>
<codeline lineno="8737"><highlight class="normal"><sp/><sp/>CIccXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="8738"><highlight class="normal"><sp/><sp/>CIccApplyXform<sp/>*pXform;</highlight></codeline>
<codeline lineno="8739"><highlight class="normal"></highlight></codeline>
<codeline lineno="8740"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=m_Xforms-&gt;begin();<sp/>i!=m_Xforms-&gt;end();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="8741"><highlight class="normal"><sp/><sp/><sp/><sp/>pXform<sp/>=<sp/>i-&gt;ptr-&gt;GetNewApply(status);</highlight></codeline>
<codeline lineno="8742"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pXform<sp/>||<sp/>status<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="8743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pApply;</highlight></codeline>
<codeline lineno="8744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="8745"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8746"><highlight class="normal"><sp/><sp/><sp/><sp/>pApply-&gt;AppendApplyXform(pXform);</highlight></codeline>
<codeline lineno="8747"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8748"><highlight class="normal"></highlight></codeline>
<codeline lineno="8749"><highlight class="normal"><sp/><sp/>m_bValid<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8750"><highlight class="normal"></highlight></codeline>
<codeline lineno="8751"><highlight class="normal"><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="8752"><highlight class="normal"></highlight></codeline>
<codeline lineno="8753"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pApply;</highlight></codeline>
<codeline lineno="8754"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8755"><highlight class="normal"></highlight></codeline>
<codeline lineno="8756"><highlight class="normal"></highlight></codeline>
<codeline lineno="8767"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::Apply(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight></codeline>
<codeline lineno="8768"><highlight class="normal">{</highlight></codeline>
<codeline lineno="8769"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_pApply-&gt;Apply(DstPixel,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="8770"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8771"><highlight class="normal"></highlight></codeline>
<codeline lineno="8772"><highlight class="normal"></highlight></codeline>
<codeline lineno="8783"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::Apply(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel,<sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>nPixels)</highlight></codeline>
<codeline lineno="8784"><highlight class="normal">{</highlight></codeline>
<codeline lineno="8785"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_pApply-&gt;Apply(DstPixel,<sp/>SrcPixel,<sp/>nPixels);</highlight></codeline>
<codeline lineno="8786"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8787"><highlight class="normal"></highlight></codeline>
<codeline lineno="8788"><highlight class="normal"></highlight></codeline>
<codeline lineno="8803"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::RemoveAllIO()</highlight></codeline>
<codeline lineno="8804"><highlight class="normal">{</highlight></codeline>
<codeline lineno="8805"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Valid())</highlight></codeline>
<codeline lineno="8806"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="8807"><highlight class="normal"></highlight></codeline>
<codeline lineno="8808"><highlight class="normal"><sp/><sp/>CIccXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="8809"><highlight class="normal"></highlight></codeline>
<codeline lineno="8810"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=m_Xforms-&gt;begin();<sp/>i!=m_Xforms-&gt;end();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="8811"><highlight class="normal"><sp/><sp/><sp/><sp/>i-&gt;ptr-&gt;RemoveIO();</highlight></codeline>
<codeline lineno="8812"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8813"><highlight class="normal"></highlight></codeline>
<codeline lineno="8814"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="8815"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8816"><highlight class="normal"></highlight></codeline>
<codeline lineno="8833"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccCmm::IsInGamut(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pInternal)</highlight></codeline>
<codeline lineno="8834"><highlight class="normal">{</highlight></codeline>
<codeline lineno="8835"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!((</highlight><highlight class="keywordtype">unsigned</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)((*pInternal)*255.0)))</highlight></codeline>
<codeline lineno="8836"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8837"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8838"><highlight class="normal">}</highlight></codeline>
<codeline lineno="8839"><highlight class="normal"></highlight></codeline>
<codeline lineno="8840"><highlight class="normal"></highlight></codeline>
<codeline lineno="8856"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::ToInternalEncoding(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nSpace,<sp/>icFloatColorEncoding<sp/>nEncode,</highlight></codeline>
<codeline lineno="8857"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pInternal,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pData,</highlight></codeline>
<codeline lineno="8858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bClip)</highlight></codeline>
<codeline lineno="8859"><highlight class="normal">{</highlight></codeline>
<codeline lineno="8860"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nSamples<sp/>=<sp/><ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(nSpace);</highlight></codeline>
<codeline lineno="8861"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!nSamples)</highlight></codeline>
<codeline lineno="8862"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26" kindref="member">icCmmStatBadColorEncoding</ref>;</highlight></codeline>
<codeline lineno="8863"><highlight class="normal"></highlight></codeline>
<codeline lineno="8864"><highlight class="normal"></highlight></codeline>
<codeline lineno="8865"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>i;</highlight></codeline>
<codeline lineno="8866"><highlight class="normal"><sp/><sp/><ref refid="d4/d53/a00429" kindref="compound">CIccPixelBuf</ref><sp/>pInput(nSamples);</highlight></codeline>
<codeline lineno="8867"><highlight class="normal"></highlight></codeline>
<codeline lineno="8868"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pInput.get())</highlight></codeline>
<codeline lineno="8869"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="8870"><highlight class="normal"></highlight></codeline>
<codeline lineno="8871"><highlight class="normal"><sp/><sp/>memcpy(pInput,<sp/>pData,<sp/>nSamples*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="8872"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bCLRspace<sp/>=<sp/><ref refid="d7/dce/a00143_1a2685f9528dab905cc6b2b071625709e1" kindref="member">icIsSpaceCLR</ref>(nSpace);</highlight></codeline>
<codeline lineno="8873"><highlight class="normal"></highlight></codeline>
<codeline lineno="8874"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(<ref refid="d7/d46/a00002_1a47e4f847bd0bc609907b5fea4daf3e75" kindref="member">icGetColorSpaceType</ref>(nSpace))</highlight></codeline>
<codeline lineno="8875"><highlight class="normal"><sp/><sp/>{</highlight></codeline>
<codeline lineno="8876"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1aa9cd4477816537fbf648a155f6b78eda" kindref="member">icSigReflectanceSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="8877"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1af5df74ebff3f8247e1c7c88844c1f140" kindref="member">icSigTransmissionSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="8878"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1ae84d222edd132ad7741c628c1d4729d9" kindref="member">icSigBiDirReflectanceSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="8879"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1b59192d9fcc1aee71b8cc523b4978ca" kindref="member">icSigSparseMatrixSpectralPcsData</ref>:</highlight></codeline>
<codeline lineno="8880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>bCLRspace<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8882"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="8883"><highlight class="normal"></highlight></codeline>
<codeline lineno="8884"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(nSpace)<sp/>{</highlight></codeline>
<codeline lineno="8885"><highlight class="normal"></highlight></codeline>
<codeline lineno="8886"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>:</highlight></codeline>
<codeline lineno="8887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8888"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(nEncode)<sp/>{</highlight></codeline>
<codeline lineno="8889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeValue:</highlight></codeline>
<codeline lineno="8890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a5768271d491af79a433e52722ed0a189" kindref="member">icLabToPcs</ref>(pInput);</highlight></codeline>
<codeline lineno="8892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8893"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeFloat:</highlight></codeline>
<codeline lineno="8895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8898"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode8Bit:</highlight></codeline>
<codeline lineno="8899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[0]<sp/>=<sp/><ref refid="d7/dce/a00143_1a0bb667680a93b0dec39e21647ffda760" kindref="member">icU8toF</ref>((<ref refid="d7/d46/a00002_1a0462ca2992be7c80b056e640a192b325" kindref="member">icUInt8Number</ref>)pInput[0])*100.0f;</highlight></codeline>
<codeline lineno="8901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1abf5738013ad9c2bafb3a0c7a810ecf19" kindref="member">icU8toAB</ref>((<ref refid="d7/d46/a00002_1a0462ca2992be7c80b056e640a192b325" kindref="member">icUInt8Number</ref>)pInput[1]);</highlight></codeline>
<codeline lineno="8902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1abf5738013ad9c2bafb3a0c7a810ecf19" kindref="member">icU8toAB</ref>((<ref refid="d7/d46/a00002_1a0462ca2992be7c80b056e640a192b325" kindref="member">icUInt8Number</ref>)pInput[2]);</highlight></codeline>
<codeline lineno="8903"><highlight class="normal"></highlight></codeline>
<codeline lineno="8904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a5768271d491af79a433e52722ed0a189" kindref="member">icLabToPcs</ref>(pInput);</highlight></codeline>
<codeline lineno="8905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode16Bit:</highlight></codeline>
<codeline lineno="8908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[0]<sp/>=<sp/><ref refid="d7/dce/a00143_1aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78" kindref="member">icU16toF</ref>((<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)pInput[0]);</highlight></codeline>
<codeline lineno="8910"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78" kindref="member">icU16toF</ref>((<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)pInput[1]);</highlight></codeline>
<codeline lineno="8911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78" kindref="member">icU16toF</ref>((<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)pInput[2]);</highlight></codeline>
<codeline lineno="8912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode16BitV2:</highlight></codeline>
<codeline lineno="8915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8916"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[0]<sp/>=<sp/><ref refid="d7/dce/a00143_1aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78" kindref="member">icU16toF</ref>((<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)pInput[0]);</highlight></codeline>
<codeline lineno="8917"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78" kindref="member">icU16toF</ref>((<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)pInput[1]);</highlight></codeline>
<codeline lineno="8918"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78" kindref="member">icU16toF</ref>((<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)pInput[2]);</highlight></codeline>
<codeline lineno="8919"><highlight class="normal"></highlight></codeline>
<codeline lineno="8920"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccPCSUtil::Lab2ToLab4(pInput,<sp/>pInput);</highlight></codeline>
<codeline lineno="8921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="8924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26" kindref="member">icCmmStatBadColorEncoding</ref>;</highlight></codeline>
<codeline lineno="8925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8926"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8928"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8929"><highlight class="normal"></highlight></codeline>
<codeline lineno="8930"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>:</highlight></codeline>
<codeline lineno="8931"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8932"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(nEncode)<sp/>{</highlight></codeline>
<codeline lineno="8933"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeValue:</highlight></codeline>
<codeline lineno="8934"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8935"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pInput[0];</highlight></codeline>
<codeline lineno="8936"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pInput[1];</highlight></codeline>
<codeline lineno="8937"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pInput[2];</highlight></codeline>
<codeline lineno="8938"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a4b4cfb7788c3a780f19f2f104677a5b8" kindref="member">icXyzToPcs</ref>(pInput);</highlight></codeline>
<codeline lineno="8939"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8940"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8941"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodePercent:</highlight></codeline>
<codeline lineno="8942"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8943"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pInput[0]<sp/>/<sp/>100.0);</highlight></codeline>
<codeline lineno="8944"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pInput[1]<sp/>/<sp/>100.0);</highlight></codeline>
<codeline lineno="8945"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pInput[2]<sp/>/<sp/>100.0);</highlight></codeline>
<codeline lineno="8946"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a4b4cfb7788c3a780f19f2f104677a5b8" kindref="member">icXyzToPcs</ref>(pInput);</highlight></codeline>
<codeline lineno="8947"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8948"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8949"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeFloat:</highlight></codeline>
<codeline lineno="8950"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8951"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a4b4cfb7788c3a780f19f2f104677a5b8" kindref="member">icXyzToPcs</ref>(pInput);</highlight></codeline>
<codeline lineno="8952"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8953"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8954"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="8955"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode16Bit:</highlight></codeline>
<codeline lineno="8956"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode16BitV2:</highlight></codeline>
<codeline lineno="8957"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8958"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[0]<sp/>=<sp/><ref refid="d7/dce/a00143_1aca284d408f443ba0b4161698077f88b1" kindref="member">icUSFtoD</ref>((<ref refid="d4/d81/a00110_1a37f1be5fcf46e05e4078a7f9e6b8b3a5" kindref="member">icU1Fixed15Number</ref>)pInput[0]);</highlight></codeline>
<codeline lineno="8959"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1aca284d408f443ba0b4161698077f88b1" kindref="member">icUSFtoD</ref>((<ref refid="d4/d81/a00110_1a37f1be5fcf46e05e4078a7f9e6b8b3a5" kindref="member">icU1Fixed15Number</ref>)pInput[1]);</highlight></codeline>
<codeline lineno="8960"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1aca284d408f443ba0b4161698077f88b1" kindref="member">icUSFtoD</ref>((<ref refid="d4/d81/a00110_1a37f1be5fcf46e05e4078a7f9e6b8b3a5" kindref="member">icU1Fixed15Number</ref>)pInput[2]);</highlight></codeline>
<codeline lineno="8961"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8962"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8963"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="8964"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="8965"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26" kindref="member">icCmmStatBadColorEncoding</ref>;</highlight></codeline>
<codeline lineno="8966"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8967"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8968"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8969"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8970"><highlight class="normal"></highlight></codeline>
<codeline lineno="8971"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>:</highlight></codeline>
<codeline lineno="8972"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26" kindref="member">icCmmStatBadColorEncoding</ref>;</highlight></codeline>
<codeline lineno="8973"><highlight class="normal"></highlight></codeline>
<codeline lineno="8974"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="8975"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(nEncode)<sp/>{</highlight></codeline>
<codeline lineno="8977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeValue:</highlight></codeline>
<codeline lineno="8978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!bCLRspace<sp/>||<sp/>nSamples&lt;3)<sp/>{</highlight></codeline>
<codeline lineno="8980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26" kindref="member">icCmmStatBadColorEncoding</ref>;</highlight></codeline>
<codeline lineno="8981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nSamples==3)</highlight></codeline>
<codeline lineno="8983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a5768271d491af79a433e52722ed0a189" kindref="member">icLabToPcs</ref>(pInput);</highlight></codeline>
<codeline lineno="8984"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="8985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8986"><highlight class="normal"></highlight></codeline>
<codeline lineno="8987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodePercent:</highlight></codeline>
<codeline lineno="8988"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="8989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bClip)<sp/>{</highlight></codeline>
<codeline lineno="8990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="8991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[i]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pInput[i]/100.0);</highlight></codeline>
<codeline lineno="8992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pInput[i]<sp/>&lt;<sp/>0.0)<sp/>pInput[i]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="8993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pInput[i]<sp/>&gt;<sp/>1.0)<sp/>pInput[i]<sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="8994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="8996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="8997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="8998"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[i]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pInput[i]/100.0);</highlight></codeline>
<codeline lineno="8999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeFloat:</highlight></codeline>
<codeline lineno="9005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bClip)<sp/>{</highlight></codeline>
<codeline lineno="9007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="9008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pInput[i]<sp/>&lt;<sp/>0.0)<sp/>pInput[i]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="9009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pInput[i]<sp/>&gt;<sp/>1.0)<sp/>pInput[i]<sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="9010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9012"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9013"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9014"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9015"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode8Bit:</highlight></codeline>
<codeline lineno="9016"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="9018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[i]<sp/>=<sp/><ref refid="d7/dce/a00143_1a0bb667680a93b0dec39e21647ffda760" kindref="member">icU8toF</ref>((<ref refid="d7/d46/a00002_1a0462ca2992be7c80b056e640a192b325" kindref="member">icUInt8Number</ref>)pInput[i]);</highlight></codeline>
<codeline lineno="9019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode16Bit:</highlight></codeline>
<codeline lineno="9024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode16BitV2:</highlight></codeline>
<codeline lineno="9025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="9027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[i]<sp/>=<sp/><ref refid="d7/dce/a00143_1aaa4f6d1ac0ca5b3c3dcf8fcb01e8da78" kindref="member">icU16toF</ref>((<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)pInput[i]);</highlight></codeline>
<codeline lineno="9028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9030"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9031"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="9033"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26" kindref="member">icCmmStatBadColorEncoding</ref>;</highlight></codeline>
<codeline lineno="9034"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9035"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9036"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9037"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9038"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9039"><highlight class="normal"></highlight></codeline>
<codeline lineno="9040"><highlight class="normal"><sp/><sp/>memcpy(pInternal,<sp/>pInput,<sp/>nSamples*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="9041"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="9042"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9043"><highlight class="normal"></highlight></codeline>
<codeline lineno="9044"><highlight class="normal"></highlight></codeline>
<codeline lineno="9060"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::ToInternalEncoding(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nSpace,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pInternal,</highlight></codeline>
<codeline lineno="9061"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a0462ca2992be7c80b056e640a192b325" kindref="member">icUInt8Number</ref><sp/>*pData)</highlight></codeline>
<codeline lineno="9062"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9063"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(nSpace)<sp/>{</highlight></codeline>
<codeline lineno="9064"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30" kindref="member">icSigRgbData</ref>:</highlight></codeline>
<codeline lineno="9065"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9066"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pInternal[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[0]<sp/>/<sp/>255.0);</highlight></codeline>
<codeline lineno="9067"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pInternal[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[1]<sp/>/<sp/>255.0);</highlight></codeline>
<codeline lineno="9068"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pInternal[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[2]<sp/>/<sp/>255.0);</highlight></codeline>
<codeline lineno="9069"><highlight class="normal"></highlight></codeline>
<codeline lineno="9070"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="9071"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9072"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661" kindref="member">icSigCmykData</ref>:</highlight></codeline>
<codeline lineno="9073"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9074"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pInternal[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[0]<sp/>/<sp/>255.0);</highlight></codeline>
<codeline lineno="9075"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pInternal[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[1]<sp/>/<sp/>255.0);</highlight></codeline>
<codeline lineno="9076"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pInternal[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[2]<sp/>/<sp/>255.0);</highlight></codeline>
<codeline lineno="9077"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pInternal[3]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[3]<sp/>/<sp/>255.0);</highlight></codeline>
<codeline lineno="9078"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="9079"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9080"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="9081"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9082"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>i;</highlight></codeline>
<codeline lineno="9083"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>nSamples<sp/>=<sp/><ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(nSpace);</highlight></codeline>
<codeline lineno="9084"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d53/a00429" kindref="compound">CIccPixelBuf</ref><sp/>FloatPixel(nSamples);</highlight></codeline>
<codeline lineno="9085"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!FloatPixel.get())</highlight></codeline>
<codeline lineno="9086"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="9087"><highlight class="normal"></highlight></codeline>
<codeline lineno="9088"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="9089"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>FloatPixel[i]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[i];<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9090"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9091"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ToInternalEncoding(nSpace,<sp/>icEncode8Bit,<sp/>pInternal,<sp/>FloatPixel);</highlight></codeline>
<codeline lineno="9092"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9093"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9094"><highlight class="normal"></highlight></codeline>
<codeline lineno="9095"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9096"><highlight class="normal"></highlight></codeline>
<codeline lineno="9097"><highlight class="normal"></highlight></codeline>
<codeline lineno="9113"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::ToInternalEncoding(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nSpace,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pInternal,</highlight></codeline>
<codeline lineno="9114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>*pData)</highlight></codeline>
<codeline lineno="9115"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9116"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(nSpace)<sp/>{</highlight></codeline>
<codeline lineno="9117"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30" kindref="member">icSigRgbData</ref>:</highlight></codeline>
<codeline lineno="9118"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pInternal[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[0]<sp/>/<sp/>65535.0);</highlight></codeline>
<codeline lineno="9120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pInternal[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[1]<sp/>/<sp/>65535.0);</highlight></codeline>
<codeline lineno="9121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pInternal[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[2]<sp/>/<sp/>65535.0);</highlight></codeline>
<codeline lineno="9122"><highlight class="normal"></highlight></codeline>
<codeline lineno="9123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="9124"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9125"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661" kindref="member">icSigCmykData</ref>:</highlight></codeline>
<codeline lineno="9126"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pInternal[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[0]<sp/>/<sp/>65535.0);</highlight></codeline>
<codeline lineno="9128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pInternal[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[1]<sp/>/<sp/>65535.0);</highlight></codeline>
<codeline lineno="9129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pInternal[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[2]<sp/>/<sp/>65535.0);</highlight></codeline>
<codeline lineno="9130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pInternal[3]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)((<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[3]<sp/>/<sp/>65535.0);</highlight></codeline>
<codeline lineno="9131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="9132"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9133"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="9134"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9135"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>i;</highlight></codeline>
<codeline lineno="9136"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>nSamples<sp/>=<sp/><ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(nSpace);</highlight></codeline>
<codeline lineno="9137"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d53/a00429" kindref="compound">CIccPixelBuf</ref><sp/>pFloatPixel(nSamples);</highlight></codeline>
<codeline lineno="9138"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pFloatPixel.get())</highlight></codeline>
<codeline lineno="9139"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="9140"><highlight class="normal"></highlight></codeline>
<codeline lineno="9141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="9142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pFloatPixel[i]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)pData[i];<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>ToInternalEncoding(nSpace,<sp/>icEncode16Bit,<sp/>pInternal,<sp/>pFloatPixel);</highlight></codeline>
<codeline lineno="9145"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9146"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9147"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9148"><highlight class="normal"></highlight></codeline>
<codeline lineno="9149"><highlight class="normal"></highlight></codeline>
<codeline lineno="9165"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::FromInternalEncoding(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nSpace,<sp/>icFloatColorEncoding<sp/>nEncode,</highlight></codeline>
<codeline lineno="9166"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pData,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pInternal,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bClip)</highlight></codeline>
<codeline lineno="9167"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9168"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nSamples<sp/>=<sp/><ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(nSpace);</highlight></codeline>
<codeline lineno="9169"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!nSamples)</highlight></codeline>
<codeline lineno="9170"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26" kindref="member">icCmmStatBadColorEncoding</ref>;</highlight></codeline>
<codeline lineno="9171"><highlight class="normal"></highlight></codeline>
<codeline lineno="9172"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>i;</highlight></codeline>
<codeline lineno="9173"><highlight class="normal"><sp/><sp/><ref refid="d4/d53/a00429" kindref="compound">CIccPixelBuf</ref><sp/>pInput(nSamples);</highlight></codeline>
<codeline lineno="9174"><highlight class="normal"></highlight></codeline>
<codeline lineno="9175"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pInput.get())</highlight></codeline>
<codeline lineno="9176"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="9177"><highlight class="normal"></highlight></codeline>
<codeline lineno="9178"><highlight class="normal"><sp/><sp/>memcpy(pInput,<sp/>pInternal,<sp/>nSamples*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="9179"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bCLRspace<sp/>=<sp/>(<ref refid="d7/dce/a00143_1a2685f9528dab905cc6b2b071625709e1" kindref="member">icIsSpaceCLR</ref>(nSpace)<sp/>||<sp/>(nSpace<sp/>==<sp/><ref refid="d4/d81/a00110_1a92d563abc2c24efa8ccad672a9dfd14f" kindref="member">icSigDevLabData</ref>)<sp/>||<sp/>(nSpace==<ref refid="d4/d81/a00110_1a550e980dd884839e33548afbd55b4277" kindref="member">icSigDevXYZData</ref>));</highlight></codeline>
<codeline lineno="9180"><highlight class="normal"></highlight></codeline>
<codeline lineno="9181"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(nSpace)<sp/>{</highlight></codeline>
<codeline lineno="9182"><highlight class="normal"></highlight></codeline>
<codeline lineno="9183"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a0925d8599ecad36e7cc572c5ba1cd07f" kindref="member">icSigLabData</ref>:</highlight></codeline>
<codeline lineno="9184"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9185"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(nEncode)<sp/>{</highlight></codeline>
<codeline lineno="9186"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeValue:</highlight></codeline>
<codeline lineno="9187"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9188"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1ac5de02865f572ea243f6da8c144c02fa" kindref="member">icLabFromPcs</ref>(pInput);</highlight></codeline>
<codeline lineno="9189"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9190"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9191"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeUnitFloat:</highlight></codeline>
<codeline lineno="9192"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeFloat:</highlight></codeline>
<codeline lineno="9193"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9194"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9195"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9196"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode8Bit:</highlight></codeline>
<codeline lineno="9197"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9198"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1ac5de02865f572ea243f6da8c144c02fa" kindref="member">icLabFromPcs</ref>(pInput);</highlight></codeline>
<codeline lineno="9199"><highlight class="normal"></highlight></codeline>
<codeline lineno="9200"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[0]<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a0462ca2992be7c80b056e640a192b325" kindref="member">icUInt8Number</ref>)(pInput[0]/100.0<sp/>*<sp/>255.0<sp/>+<sp/>0.5);</highlight></codeline>
<codeline lineno="9201"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1a9851a529e0246e58ba462a4c3074388d" kindref="member">icABtoU8</ref>(pInput[1]);</highlight></codeline>
<codeline lineno="9202"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1a9851a529e0246e58ba462a4c3074388d" kindref="member">icABtoU8</ref>(pInput[2]);</highlight></codeline>
<codeline lineno="9203"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9204"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9205"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode16Bit:</highlight></codeline>
<codeline lineno="9206"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9207"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[0]<sp/>=<sp/><ref refid="d7/dce/a00143_1a77b4912bd2106eaef10d32571c23a58a" kindref="member">icFtoU16</ref>(pInput[0]);</highlight></codeline>
<codeline lineno="9208"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1a77b4912bd2106eaef10d32571c23a58a" kindref="member">icFtoU16</ref>(pInput[1]);</highlight></codeline>
<codeline lineno="9209"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1a77b4912bd2106eaef10d32571c23a58a" kindref="member">icFtoU16</ref>(pInput[2]);</highlight></codeline>
<codeline lineno="9210"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9211"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9212"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode16BitV2:</highlight></codeline>
<codeline lineno="9213"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9214"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccPCSUtil::Lab4ToLab2(pInput,<sp/>pInput);</highlight></codeline>
<codeline lineno="9215"><highlight class="normal"></highlight></codeline>
<codeline lineno="9216"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[0]<sp/>=<sp/><ref refid="d7/dce/a00143_1a77b4912bd2106eaef10d32571c23a58a" kindref="member">icFtoU16</ref>(pInput[0]);</highlight></codeline>
<codeline lineno="9217"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1a77b4912bd2106eaef10d32571c23a58a" kindref="member">icFtoU16</ref>(pInput[1]);</highlight></codeline>
<codeline lineno="9218"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1a77b4912bd2106eaef10d32571c23a58a" kindref="member">icFtoU16</ref>(pInput[2]);</highlight></codeline>
<codeline lineno="9219"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9220"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9221"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="9222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26" kindref="member">icCmmStatBadColorEncoding</ref>;</highlight></codeline>
<codeline lineno="9223"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9224"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9225"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9226"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9227"><highlight class="normal"></highlight></codeline>
<codeline lineno="9228"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917a7030370eb0ee02671895978dc61858d8" kindref="member">icSigXYZData</ref>:</highlight></codeline>
<codeline lineno="9229"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(nEncode)<sp/>{</highlight></codeline>
<codeline lineno="9231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeValue:</highlight></codeline>
<codeline lineno="9232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a78841df2e0aea059520ce71944c4c3bb" kindref="member">icXyzFromPcs</ref>(pInput);</highlight></codeline>
<codeline lineno="9234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodePercent:</highlight></codeline>
<codeline lineno="9237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9238"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a78841df2e0aea059520ce71944c4c3bb" kindref="member">icXyzFromPcs</ref>(pInput);</highlight></codeline>
<codeline lineno="9239"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[0]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pInput[0]<sp/>*<sp/>100.0);</highlight></codeline>
<codeline lineno="9240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[1]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pInput[1]<sp/>*<sp/>100.0);</highlight></codeline>
<codeline lineno="9241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[2]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pInput[2]<sp/>*<sp/>100.0);<sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9243"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeFloat:</highlight></codeline>
<codeline lineno="9245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeUnitFloat:</highlight></codeline>
<codeline lineno="9246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a78841df2e0aea059520ce71944c4c3bb" kindref="member">icXyzFromPcs</ref>(pInput);</highlight></codeline>
<codeline lineno="9248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9250"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode16Bit:</highlight></codeline>
<codeline lineno="9252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode16BitV2:</highlight></codeline>
<codeline lineno="9253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a78841df2e0aea059520ce71944c4c3bb" kindref="member">icXyzFromPcs</ref>(pInput);</highlight></codeline>
<codeline lineno="9255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[0]<sp/>=<sp/><ref refid="d7/dce/a00143_1a48d114d730666238b19cefd80187a629" kindref="member">icDtoUSF</ref>(pInput[0]);</highlight></codeline>
<codeline lineno="9256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1a48d114d730666238b19cefd80187a629" kindref="member">icDtoUSF</ref>(pInput[1]);</highlight></codeline>
<codeline lineno="9257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1a48d114d730666238b19cefd80187a629" kindref="member">icDtoUSF</ref>(pInput[2]);</highlight></codeline>
<codeline lineno="9258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9261"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="9262"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26" kindref="member">icCmmStatBadColorEncoding</ref>;</highlight></codeline>
<codeline lineno="9263"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9264"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9265"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9267"><highlight class="normal"></highlight></codeline>
<codeline lineno="9268"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>:</highlight></codeline>
<codeline lineno="9269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26" kindref="member">icCmmStatBadColorEncoding</ref>;</highlight></codeline>
<codeline lineno="9270"><highlight class="normal"></highlight></codeline>
<codeline lineno="9271"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="9272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(nEncode)<sp/>{</highlight></codeline>
<codeline lineno="9274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeValue:</highlight></codeline>
<codeline lineno="9275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nSpace<sp/>==<sp/><ref refid="d4/d81/a00110_1a550e980dd884839e33548afbd55b4277" kindref="member">icSigDevXYZData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="9277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1a78841df2e0aea059520ce71944c4c3bb" kindref="member">icXyzFromPcs</ref>(pInput);</highlight></codeline>
<codeline lineno="9278"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9279"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bCLRspace<sp/>&amp;&amp;<sp/>nSamples<sp/>&gt;=3)<sp/>{</highlight></codeline>
<codeline lineno="9280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dce/a00143_1ac5de02865f572ea243f6da8c144c02fa" kindref="member">icLabFromPcs</ref>(pInput);</highlight></codeline>
<codeline lineno="9281"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9282"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9283"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9284"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodePercent:</highlight></codeline>
<codeline lineno="9285"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9286"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bClip)<sp/>{</highlight></codeline>
<codeline lineno="9287"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="9288"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pInput[i]<sp/>&lt;<sp/>0.0)<sp/>pInput[i]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="9289"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pInput[i]<sp/>&gt;<sp/>1.0)<sp/>pInput[i]<sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="9290"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[i]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pInput[i]*100.0);</highlight></codeline>
<codeline lineno="9291"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9292"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9293"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="9294"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="9295"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[i]<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>)(pInput[i]*100.0);</highlight></codeline>
<codeline lineno="9296"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9297"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9298"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9299"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9300"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9301"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeFloat:</highlight></codeline>
<codeline lineno="9302"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9303"><highlight class="normal"></highlight></codeline>
<codeline lineno="9304"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeUnitFloat:</highlight></codeline>
<codeline lineno="9305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9306"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bClip)<sp/>{</highlight></codeline>
<codeline lineno="9307"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="9308"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pInput[i]<sp/>&lt;<sp/>0.0)<sp/>pInput[i]<sp/>=<sp/>0.0;</highlight></codeline>
<codeline lineno="9309"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pInput[i]<sp/>&gt;<sp/>1.0)<sp/>pInput[i]<sp/>=<sp/>1.0;</highlight></codeline>
<codeline lineno="9310"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9311"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9312"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9313"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9314"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9315"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode8Bit:</highlight></codeline>
<codeline lineno="9316"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9317"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="9318"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[i]<sp/>=<sp/><ref refid="d7/dce/a00143_1a42317dad5efb1650fa709ab01309651f" kindref="member">icFtoU8</ref>(pInput[i]);</highlight></codeline>
<codeline lineno="9319"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9320"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9321"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9322"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9323"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode16Bit:</highlight></codeline>
<codeline lineno="9324"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode16BitV2:</highlight></codeline>
<codeline lineno="9325"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9326"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="9327"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pInput[i]<sp/>=<sp/><ref refid="d7/dce/a00143_1a77b4912bd2106eaef10d32571c23a58a" kindref="member">icFtoU16</ref>(pInput[i]);</highlight></codeline>
<codeline lineno="9328"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9329"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9330"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9331"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9332"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="9333"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7bfa92610b7d4aa6aa83ab9ead6d0c26" kindref="member">icCmmStatBadColorEncoding</ref>;</highlight></codeline>
<codeline lineno="9334"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9335"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9336"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9337"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9338"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9339"><highlight class="normal"></highlight></codeline>
<codeline lineno="9340"><highlight class="normal"><sp/><sp/>memcpy(pData,<sp/>pInput,<sp/>nSamples*</highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>));</highlight></codeline>
<codeline lineno="9341"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="9342"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9343"><highlight class="normal"></highlight></codeline>
<codeline lineno="9344"><highlight class="normal"></highlight></codeline>
<codeline lineno="9360"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::FromInternalEncoding(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nSpace,<sp/><ref refid="d7/d46/a00002_1a0462ca2992be7c80b056e640a192b325" kindref="member">icUInt8Number</ref><sp/>*pData,</highlight></codeline>
<codeline lineno="9361"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pInternal)</highlight></codeline>
<codeline lineno="9362"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9363"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(nSpace)<sp/>{</highlight></codeline>
<codeline lineno="9364"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30" kindref="member">icSigRgbData</ref>:</highlight></codeline>
<codeline lineno="9365"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9366"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pData[0]<sp/>=<sp/><ref refid="d7/dce/a00143_1a42317dad5efb1650fa709ab01309651f" kindref="member">icFtoU8</ref>(pInternal[0]);</highlight></codeline>
<codeline lineno="9367"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pData[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1a42317dad5efb1650fa709ab01309651f" kindref="member">icFtoU8</ref>(pInternal[1]);</highlight></codeline>
<codeline lineno="9368"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pData[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1a42317dad5efb1650fa709ab01309651f" kindref="member">icFtoU8</ref>(pInternal[2]);</highlight></codeline>
<codeline lineno="9369"><highlight class="normal"></highlight></codeline>
<codeline lineno="9370"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="9371"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9372"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661" kindref="member">icSigCmykData</ref>:</highlight></codeline>
<codeline lineno="9373"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9374"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pData[0]<sp/>=<sp/><ref refid="d7/dce/a00143_1a42317dad5efb1650fa709ab01309651f" kindref="member">icFtoU8</ref>(pInternal[0]);</highlight></codeline>
<codeline lineno="9375"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pData[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1a42317dad5efb1650fa709ab01309651f" kindref="member">icFtoU8</ref>(pInternal[1]);</highlight></codeline>
<codeline lineno="9376"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pData[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1a42317dad5efb1650fa709ab01309651f" kindref="member">icFtoU8</ref>(pInternal[2]);</highlight></codeline>
<codeline lineno="9377"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pData[3]<sp/>=<sp/><ref refid="d7/dce/a00143_1a42317dad5efb1650fa709ab01309651f" kindref="member">icFtoU8</ref>(pInternal[3]);</highlight></codeline>
<codeline lineno="9378"><highlight class="normal"></highlight></codeline>
<codeline lineno="9379"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="9380"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9381"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="9382"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>i;</highlight></codeline>
<codeline lineno="9384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>nSamples<sp/>=<sp/><ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(nSpace);</highlight></codeline>
<codeline lineno="9385"><highlight class="normal"></highlight></codeline>
<codeline lineno="9386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d53/a00429" kindref="compound">CIccPixelBuf</ref><sp/>pFloatPixel(nSamples);</highlight></codeline>
<codeline lineno="9387"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>convertStat;</highlight></codeline>
<codeline lineno="9388"><highlight class="normal"></highlight></codeline>
<codeline lineno="9389"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pFloatPixel.get())</highlight></codeline>
<codeline lineno="9390"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="9391"><highlight class="normal"></highlight></codeline>
<codeline lineno="9392"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>convertStat<sp/>=<sp/>FromInternalEncoding(nSpace,<sp/>icEncode8Bit,<sp/>pFloatPixel,<sp/>pInternal);</highlight></codeline>
<codeline lineno="9393"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(convertStat)</highlight></codeline>
<codeline lineno="9394"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>convertStat;</highlight></codeline>
<codeline lineno="9395"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="9396"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pData[i]<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a0462ca2992be7c80b056e640a192b325" kindref="member">icUInt8Number</ref>)(pFloatPixel[i]<sp/>+<sp/>0.5);<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9398"><highlight class="normal"></highlight></codeline>
<codeline lineno="9399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="9400"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9401"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9402"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9403"><highlight class="normal"></highlight></codeline>
<codeline lineno="9404"><highlight class="normal"></highlight></codeline>
<codeline lineno="9420"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccCmm::FromInternalEncoding(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nSpace,<sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>*pData,</highlight></codeline>
<codeline lineno="9421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pInternal)</highlight></codeline>
<codeline lineno="9422"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9423"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(nSpace)<sp/>{</highlight></codeline>
<codeline lineno="9424"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ad0e9fe12d5f79f3a3b8b15be31288a30" kindref="member">icSigRgbData</ref>:</highlight></codeline>
<codeline lineno="9425"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pData[0]<sp/>=<sp/><ref refid="d7/dce/a00143_1a77b4912bd2106eaef10d32571c23a58a" kindref="member">icFtoU16</ref>(pInternal[0]);</highlight></codeline>
<codeline lineno="9427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pData[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1a77b4912bd2106eaef10d32571c23a58a" kindref="member">icFtoU16</ref>(pInternal[1]);</highlight></codeline>
<codeline lineno="9428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pData[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1a77b4912bd2106eaef10d32571c23a58a" kindref="member">icFtoU16</ref>(pInternal[2]);</highlight></codeline>
<codeline lineno="9429"><highlight class="normal"></highlight></codeline>
<codeline lineno="9430"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="9431"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9432"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917ac5ad31bfd82d421d33be30f0a68b4661" kindref="member">icSigCmykData</ref>:</highlight></codeline>
<codeline lineno="9433"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pData[0]<sp/>=<sp/><ref refid="d7/dce/a00143_1a77b4912bd2106eaef10d32571c23a58a" kindref="member">icFtoU16</ref>(pInternal[0]);</highlight></codeline>
<codeline lineno="9435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pData[1]<sp/>=<sp/><ref refid="d7/dce/a00143_1a77b4912bd2106eaef10d32571c23a58a" kindref="member">icFtoU16</ref>(pInternal[1]);</highlight></codeline>
<codeline lineno="9436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pData[2]<sp/>=<sp/><ref refid="d7/dce/a00143_1a77b4912bd2106eaef10d32571c23a58a" kindref="member">icFtoU16</ref>(pInternal[2]);</highlight></codeline>
<codeline lineno="9437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pData[3]<sp/>=<sp/><ref refid="d7/dce/a00143_1a77b4912bd2106eaef10d32571c23a58a" kindref="member">icFtoU16</ref>(pInternal[3]);</highlight></codeline>
<codeline lineno="9438"><highlight class="normal"></highlight></codeline>
<codeline lineno="9439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="9440"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9441"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="9442"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="9443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>i;</highlight></codeline>
<codeline lineno="9444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>nSamples<sp/>=<sp/><ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(nSpace);</highlight></codeline>
<codeline lineno="9445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d4/d53/a00429" kindref="compound">CIccPixelBuf</ref><sp/>pFloatPixel(nSamples);</highlight></codeline>
<codeline lineno="9446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>convertStat;</highlight></codeline>
<codeline lineno="9447"><highlight class="normal"></highlight></codeline>
<codeline lineno="9448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pFloatPixel.get())</highlight></codeline>
<codeline lineno="9449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="9450"><highlight class="normal"></highlight></codeline>
<codeline lineno="9451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>convertStat<sp/>=<sp/>FromInternalEncoding(nSpace,<sp/>icEncode16Bit,<sp/>pFloatPixel,<sp/>pInternal);</highlight></codeline>
<codeline lineno="9452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(convertStat)</highlight></codeline>
<codeline lineno="9453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>convertStat;</highlight></codeline>
<codeline lineno="9454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal">(i=0;<sp/>i&lt;nSamples;<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="9455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pData[i]<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref>)(pFloatPixel[i]<sp/>+<sp/>0.5);<sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="9456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9457"><highlight class="normal"></highlight></codeline>
<codeline lineno="9458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="9459"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9460"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9461"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9462"><highlight class="normal"></highlight></codeline>
<codeline lineno="9463"><highlight class="normal"></highlight></codeline>
<codeline lineno="9478"><highlight class="normal"></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref>*<sp/>CIccCmm::GetFloatColorEncoding(icFloatColorEncoding<sp/>val)</highlight></codeline>
<codeline lineno="9479"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9480"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(val)<sp/>{</highlight></codeline>
<codeline lineno="9481"><highlight class="normal"></highlight></codeline>
<codeline lineno="9482"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeValue:</highlight></codeline>
<codeline lineno="9483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;icEncodeValue&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9484"><highlight class="normal"></highlight></codeline>
<codeline lineno="9485"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeFloat:</highlight></codeline>
<codeline lineno="9486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;icEncodeFloat&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9487"><highlight class="normal"></highlight></codeline>
<codeline lineno="9488"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodeUnitFloat:</highlight></codeline>
<codeline lineno="9489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;icEncodeUnitFloat&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9490"><highlight class="normal"></highlight></codeline>
<codeline lineno="9491"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncodePercent:</highlight></codeline>
<codeline lineno="9492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;icEncodePercent&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9493"><highlight class="normal"></highlight></codeline>
<codeline lineno="9494"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode8Bit:</highlight></codeline>
<codeline lineno="9495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;icEncode8Bit&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9496"><highlight class="normal"></highlight></codeline>
<codeline lineno="9497"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode16Bit:</highlight></codeline>
<codeline lineno="9498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;icEncode16Bit&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9499"><highlight class="normal"></highlight></codeline>
<codeline lineno="9500"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icEncode16BitV2:</highlight></codeline>
<codeline lineno="9501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;icEncode16BitV2&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9502"><highlight class="normal"></highlight></codeline>
<codeline lineno="9503"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="9504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="stringliteral">&quot;icEncodeUnknown&quot;</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9505"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9506"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9507"><highlight class="normal"></highlight></codeline>
<codeline lineno="9522"><highlight class="normal">icFloatColorEncoding<sp/>CIccCmm::GetFloatColorEncoding(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref>*<sp/>val)</highlight></codeline>
<codeline lineno="9523"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9524"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d5/d16/a00029_1a4e0be90a3757e352f42612d09a7d1aa5" kindref="member">stricmp</ref>(val,<sp/></highlight><highlight class="stringliteral">&quot;icEncodePercent&quot;</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline lineno="9525"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>icEncodePercent;</highlight></codeline>
<codeline lineno="9526"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9527"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d5/d16/a00029_1a4e0be90a3757e352f42612d09a7d1aa5" kindref="member">stricmp</ref>(val,<sp/></highlight><highlight class="stringliteral">&quot;icEncodeUnitFloat&quot;</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline lineno="9528"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>icEncodeUnitFloat;</highlight></codeline>
<codeline lineno="9529"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9530"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d5/d16/a00029_1a4e0be90a3757e352f42612d09a7d1aa5" kindref="member">stricmp</ref>(val,<sp/></highlight><highlight class="stringliteral">&quot;icEncodeFloat&quot;</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline lineno="9531"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>icEncodeFloat;</highlight></codeline>
<codeline lineno="9532"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9533"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d5/d16/a00029_1a4e0be90a3757e352f42612d09a7d1aa5" kindref="member">stricmp</ref>(val,<sp/></highlight><highlight class="stringliteral">&quot;icEncode8Bit&quot;</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline lineno="9534"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>icEncode8Bit;</highlight></codeline>
<codeline lineno="9535"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9536"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d5/d16/a00029_1a4e0be90a3757e352f42612d09a7d1aa5" kindref="member">stricmp</ref>(val,<sp/></highlight><highlight class="stringliteral">&quot;icEncode16Bit&quot;</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline lineno="9537"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>icEncode16Bit;</highlight></codeline>
<codeline lineno="9538"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9539"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d5/d16/a00029_1a4e0be90a3757e352f42612d09a7d1aa5" kindref="member">stricmp</ref>(val,<sp/></highlight><highlight class="stringliteral">&quot;icEncode16BitV2&quot;</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline lineno="9540"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>icEncode16BitV2;</highlight></codeline>
<codeline lineno="9541"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9542"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d5/d16/a00029_1a4e0be90a3757e352f42612d09a7d1aa5" kindref="member">stricmp</ref>(val,<sp/></highlight><highlight class="stringliteral">&quot;icEncodeValue&quot;</highlight><highlight class="normal">))<sp/>{</highlight></codeline>
<codeline lineno="9543"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>icEncodeValue;</highlight></codeline>
<codeline lineno="9544"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9545"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="9546"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>icEncodeUnknown;</highlight></codeline>
<codeline lineno="9547"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9548"><highlight class="normal"></highlight></codeline>
<codeline lineno="9549"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9550"><highlight class="normal"></highlight></codeline>
<codeline lineno="9562"><highlight class="normal"><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>CIccCmm::GetNumXforms()</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="9563"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="9564"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>(<ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref>)m_Xforms-&gt;size();</highlight></codeline>
<codeline lineno="9565"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9566"><highlight class="normal"></highlight></codeline>
<codeline lineno="9567"><highlight class="normal"></highlight></codeline>
<codeline lineno="9577"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccCmm::IterateXforms(<sp/>IXformIterator*<sp/>pIterater)</highlight><highlight class="keyword"><sp/>const</highlight></codeline>
<codeline lineno="9578"><highlight class="keyword"></highlight><highlight class="normal">{</highlight></codeline>
<codeline lineno="9579"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(</highlight><highlight class="keyword">auto</highlight><highlight class="normal"><sp/>x<sp/>=<sp/>m_Xforms-&gt;begin();<sp/>x<sp/>!=<sp/>m_Xforms-&gt;end();<sp/>x++)<sp/>{</highlight></codeline>
<codeline lineno="9580"><highlight class="normal"><sp/><sp/><sp/><sp/>pIterater-&gt;iterate(x-&gt;ptr);</highlight></codeline>
<codeline lineno="9581"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9582"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9583"><highlight class="normal"></highlight></codeline>
<codeline lineno="9584"><highlight class="normal"></highlight></codeline>
<codeline lineno="9596"><highlight class="normal"><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>CIccCmm::GetFirstXformSource()</highlight></codeline>
<codeline lineno="9597"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9598"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Xforms-&gt;size())</highlight></codeline>
<codeline lineno="9599"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_nSrcSpace;</highlight></codeline>
<codeline lineno="9600"><highlight class="normal"></highlight></codeline>
<codeline lineno="9601"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_Xforms-&gt;begin()-&gt;ptr-&gt;GetSrcSpace();</highlight></codeline>
<codeline lineno="9602"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9603"><highlight class="normal"></highlight></codeline>
<codeline lineno="9615"><highlight class="normal"><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>CIccCmm::GetLastXformDest()</highlight></codeline>
<codeline lineno="9616"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9617"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Xforms-&gt;size())</highlight></codeline>
<codeline lineno="9618"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_nDestSpace;</highlight></codeline>
<codeline lineno="9619"><highlight class="normal"></highlight></codeline>
<codeline lineno="9620"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>m_Xforms-&gt;rbegin()-&gt;ptr-&gt;GetDstSpace();</highlight></codeline>
<codeline lineno="9621"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9622"><highlight class="normal"></highlight></codeline>
<codeline lineno="9634"><highlight class="normal">CIccApplyNamedColorCmm::CIccApplyNamedColorCmm(CIccNamedColorCmm<sp/>*pCmm)<sp/>:<sp/>CIccApplyCmm(pCmm)</highlight></codeline>
<codeline lineno="9635"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9636"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9637"><highlight class="normal"></highlight></codeline>
<codeline lineno="9638"><highlight class="normal"></highlight></codeline>
<codeline lineno="9647"><highlight class="normal">CIccApplyNamedColorCmm::~CIccApplyNamedColorCmm()</highlight></codeline>
<codeline lineno="9648"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9649"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9650"><highlight class="normal"></highlight></codeline>
<codeline lineno="9651"><highlight class="normal"></highlight></codeline>
<codeline lineno="9664"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccApplyNamedColorCmm::Apply(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight></codeline>
<codeline lineno="9665"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9666"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/>*pTmp;</highlight></codeline>
<codeline lineno="9667"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc;</highlight></codeline>
<codeline lineno="9668"><highlight class="normal"><sp/><sp/>CIccApplyXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="9669"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j,<sp/>n<sp/>=<sp/>(int)m_Xforms-&gt;size();</highlight></codeline>
<codeline lineno="9670"><highlight class="normal"><sp/><sp/>CIccApplyXform<sp/>*pApply;</highlight></codeline>
<codeline lineno="9671"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccXform<sp/>*pApplyXform;</highlight></codeline>
<codeline lineno="9672"><highlight class="normal"><sp/><sp/>CIccXformNamedColor<sp/>*pXform;</highlight></codeline>
<codeline lineno="9673"><highlight class="normal"></highlight></codeline>
<codeline lineno="9674"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!n)</highlight></codeline>
<codeline lineno="9675"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="9676"><highlight class="normal"></highlight></codeline>
<codeline lineno="9677"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Pixel<sp/>&amp;&amp;<sp/>!InitPixel())<sp/>{</highlight></codeline>
<codeline lineno="9678"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="9679"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9680"><highlight class="normal"></highlight></codeline>
<codeline lineno="9681"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref><sp/>NamedColor[256];</highlight></codeline>
<codeline lineno="9682"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv;</highlight></codeline>
<codeline lineno="9683"><highlight class="normal"></highlight></codeline>
<codeline lineno="9684"><highlight class="normal"><sp/><sp/>pSrc<sp/>=<sp/>SrcPixel;</highlight></codeline>
<codeline lineno="9685"><highlight class="normal"><sp/><sp/>pDst<sp/>=<sp/>m_Pixel;</highlight></codeline>
<codeline lineno="9686"><highlight class="normal"></highlight></codeline>
<codeline lineno="9687"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9688"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>nCount<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="9689"><highlight class="normal"><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Start<sp/>ApplyNamedCmm\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="9690"><highlight class="normal"><sp/><sp/>DumpCmmApplyPixel(nCount++,<sp/>pSrc,<sp/><ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(m_pCmm-&gt;GetSourceSpace()));</highlight></codeline>
<codeline lineno="9691"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9692"><highlight class="normal"></highlight></codeline>
<codeline lineno="9693"><highlight class="normal"></highlight></codeline>
<codeline lineno="9694"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n&gt;1)<sp/>{</highlight></codeline>
<codeline lineno="9695"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j=0,<sp/>i=m_Xforms-&gt;begin();<sp/>j&lt;n-1<sp/>&amp;&amp;<sp/>i!=m_Xforms-&gt;end();<sp/>i++,<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="9696"><highlight class="normal"></highlight></codeline>
<codeline lineno="9697"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="9698"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="9699"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()==<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="9700"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform<sp/>=<sp/>(CIccXformNamedColor*)pApplyXform;</highlight></codeline>
<codeline lineno="9701"><highlight class="normal"></highlight></codeline>
<codeline lineno="9702"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pXform-&gt;GetInterface())<sp/>{</highlight></codeline>
<codeline lineno="9703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Pixel:</highlight></codeline>
<codeline lineno="9704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>pDst,<sp/>pSrc);</highlight></codeline>
<codeline lineno="9705"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9706"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DumpCmmApplyPixel(nCount++,<sp/>pDst,<sp/>pXform-&gt;GetNumDstSamples());</highlight></codeline>
<codeline lineno="9707"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9708"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9709"><highlight class="normal"></highlight></codeline>
<codeline lineno="9710"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Named:</highlight></codeline>
<codeline lineno="9711"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>NamedColor,<sp/>pSrc);</highlight></codeline>
<codeline lineno="9712"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9713"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;Xfm%d:<sp/>\&quot;%s\&quot;\n&quot;</highlight><highlight class="normal">,<sp/>nCount++,<sp/>NamedColor);</highlight></codeline>
<codeline lineno="9714"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9715"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9716"><highlight class="normal"></highlight></codeline>
<codeline lineno="9717"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyNamed2Pixel:</highlight></codeline>
<codeline lineno="9718"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j==0)<sp/>{</highlight></codeline>
<codeline lineno="9719"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="9720"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9721"><highlight class="normal"></highlight></codeline>
<codeline lineno="9722"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pXform-&gt;Apply(pApply,<sp/>pDst,<sp/>NamedColor);</highlight></codeline>
<codeline lineno="9723"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9724"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DumpCmmApplyPixel(nCount++,<sp/>pDst,<sp/>pXform-&gt;GetNumDstSamples());</highlight></codeline>
<codeline lineno="9725"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9726"><highlight class="normal"></highlight></codeline>
<codeline lineno="9727"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)<sp/>{</highlight></codeline>
<codeline lineno="9728"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="9729"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9730"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9731"><highlight class="normal"></highlight></codeline>
<codeline lineno="9732"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="9733"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9734"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9735"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9736"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="9737"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform-&gt;Apply(pApply,<sp/>pDst,<sp/>pSrc);</highlight></codeline>
<codeline lineno="9738"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9739"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DumpCmmApplyPixel(nCount++,<sp/>pDst,<sp/>pApplyXform-&gt;GetNumDstSamples());</highlight></codeline>
<codeline lineno="9740"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9741"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9742"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pTmp<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*)pSrc;</highlight></codeline>
<codeline lineno="9743"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pSrc<sp/>=<sp/>pDst;</highlight></codeline>
<codeline lineno="9744"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTmp==SrcPixel)</highlight></codeline>
<codeline lineno="9745"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pDst<sp/>=<sp/>m_Pixel2;</highlight></codeline>
<codeline lineno="9746"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9747"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pDst<sp/>=<sp/>pTmp;</highlight></codeline>
<codeline lineno="9748"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9749"><highlight class="normal"></highlight></codeline>
<codeline lineno="9750"><highlight class="normal"><sp/><sp/><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="9751"><highlight class="normal"><sp/><sp/><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="9752"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()==<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="9753"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pXform<sp/>=<sp/>(CIccXformNamedColor*)pApplyXform;</highlight></codeline>
<codeline lineno="9754"><highlight class="normal"></highlight></codeline>
<codeline lineno="9755"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pXform-&gt;GetInterface())<sp/>{</highlight></codeline>
<codeline lineno="9756"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Pixel:</highlight></codeline>
<codeline lineno="9757"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>DstPixel,<sp/>pSrc);</highlight></codeline>
<codeline lineno="9758"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9759"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DumpCmmApplyPixel(nCount++,<sp/>DstPixel,<sp/>pXform-&gt;GetNumDstSamples());</highlight></codeline>
<codeline lineno="9760"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9761"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9762"><highlight class="normal"></highlight></codeline>
<codeline lineno="9763"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Named:</highlight></codeline>
<codeline lineno="9764"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="9765"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="9766"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9767"><highlight class="normal"></highlight></codeline>
<codeline lineno="9768"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyNamed2Pixel:</highlight></codeline>
<codeline lineno="9769"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pXform-&gt;Apply(pApply,<sp/>DstPixel,<sp/>NamedColor);</highlight></codeline>
<codeline lineno="9770"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9771"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>DumpCmmApplyPixel(nCount++,<sp/>DstPixel,<sp/>pXform-&gt;GetNumDstSamples());</highlight></codeline>
<codeline lineno="9772"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9773"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)<sp/>{</highlight></codeline>
<codeline lineno="9774"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="9775"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9776"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9777"><highlight class="normal"></highlight></codeline>
<codeline lineno="9778"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9779"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9780"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="9781"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform-&gt;Apply(pApply,<sp/>DstPixel,<sp/>pSrc);</highlight></codeline>
<codeline lineno="9782"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9783"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>DumpCmmApplyPixel(nCount++,<sp/>DstPixel,<sp/>pApplyXform-&gt;GetNumDstSamples());</highlight></codeline>
<codeline lineno="9784"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9785"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9786"><highlight class="normal"></highlight></codeline>
<codeline lineno="9787"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9788"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n==1)<sp/>{</highlight></codeline>
<codeline lineno="9789"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>m_Xforms-&gt;begin();</highlight></codeline>
<codeline lineno="9790"><highlight class="normal"></highlight></codeline>
<codeline lineno="9791"><highlight class="normal"><sp/><sp/><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="9792"><highlight class="normal"><sp/><sp/><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="9793"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()==<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="9794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="9795"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9796"><highlight class="normal"></highlight></codeline>
<codeline lineno="9797"><highlight class="normal"><sp/><sp/><sp/><sp/>pApplyXform-&gt;Apply(pApply,<sp/>DstPixel,<sp/>pSrc);</highlight></codeline>
<codeline lineno="9798"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9799"><highlight class="normal"><sp/><sp/><sp/><sp/>DumpCmmApplyPixel(nCount++,<sp/>DstPixel,<sp/>pApplyXform-&gt;GetNumDstSamples());</highlight></codeline>
<codeline lineno="9800"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9801"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9802"><highlight class="normal"></highlight></codeline>
<codeline lineno="9803"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>DEBUG_CMM_APPLY</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9804"><highlight class="normal"><sp/><sp/>DumpCmmApplyPixel(nCount++,<sp/>DstPixel,<sp/><ref refid="d7/dce/a00143_1a719dc0d47f230294e78ac9c8cbc91a89" kindref="member">icGetSpaceSamples</ref>(m_pCmm-&gt;GetDestSpace()));</highlight></codeline>
<codeline lineno="9805"><highlight class="normal"><sp/><sp/>printf(</highlight><highlight class="stringliteral">&quot;End<sp/>ApplyNamedCmm\n\n&quot;</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="9806"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="9807"><highlight class="normal"></highlight></codeline>
<codeline lineno="9808"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="9809"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9810"><highlight class="normal"></highlight></codeline>
<codeline lineno="9811"><highlight class="normal"></highlight></codeline>
<codeline lineno="9824"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccApplyNamedColorCmm::Apply(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel,<sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>nPixels)</highlight></codeline>
<codeline lineno="9825"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9826"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst;</highlight></codeline>
<codeline lineno="9827"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc;</highlight></codeline>
<codeline lineno="9828"><highlight class="normal"><sp/><sp/>CIccApplyXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="9829"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j,<sp/>n<sp/>=<sp/>(int)m_Xforms-&gt;size();</highlight></codeline>
<codeline lineno="9830"><highlight class="normal"><sp/><sp/>CIccApplyXform<sp/>*pApply;</highlight></codeline>
<codeline lineno="9831"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccXform<sp/>*pApplyXform;</highlight></codeline>
<codeline lineno="9832"><highlight class="normal"><sp/><sp/>CIccXformNamedColor<sp/>*pXform;</highlight></codeline>
<codeline lineno="9833"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>k;<sp/></highlight></codeline>
<codeline lineno="9834"><highlight class="normal"></highlight></codeline>
<codeline lineno="9835"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!n)</highlight></codeline>
<codeline lineno="9836"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="9837"><highlight class="normal"></highlight></codeline>
<codeline lineno="9838"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Pixel<sp/>&amp;&amp;<sp/>!InitPixel())<sp/>{</highlight></codeline>
<codeline lineno="9839"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="9840"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9841"><highlight class="normal"></highlight></codeline>
<codeline lineno="9842"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref><sp/>NamedColor[255];</highlight></codeline>
<codeline lineno="9843"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv;</highlight></codeline>
<codeline lineno="9844"><highlight class="normal"></highlight></codeline>
<codeline lineno="9845"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(k=0;<sp/>k&lt;nPixels;<sp/>k++)<sp/>{</highlight></codeline>
<codeline lineno="9846"><highlight class="normal"></highlight></codeline>
<codeline lineno="9847"><highlight class="normal"><sp/><sp/><sp/><sp/>pSrc<sp/>=<sp/>SrcPixel;</highlight></codeline>
<codeline lineno="9848"><highlight class="normal"><sp/><sp/><sp/><sp/>pDst<sp/>=<sp/>m_Pixel;</highlight></codeline>
<codeline lineno="9849"><highlight class="normal"></highlight></codeline>
<codeline lineno="9850"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n&gt;1)<sp/>{</highlight></codeline>
<codeline lineno="9851"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j=0,<sp/>i=m_Xforms-&gt;begin();<sp/>j&lt;n-1<sp/>&amp;&amp;<sp/>i!=m_Xforms-&gt;end();<sp/>i++,<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="9852"><highlight class="normal"></highlight></codeline>
<codeline lineno="9853"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="9854"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="9855"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()==<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="9856"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform<sp/>=<sp/>(CIccXformNamedColor*)pApplyXform;</highlight></codeline>
<codeline lineno="9857"><highlight class="normal"></highlight></codeline>
<codeline lineno="9858"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pXform-&gt;GetInterface())<sp/>{</highlight></codeline>
<codeline lineno="9859"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Pixel:</highlight></codeline>
<codeline lineno="9860"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>pDst,<sp/>pSrc);</highlight></codeline>
<codeline lineno="9861"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9862"><highlight class="normal"></highlight></codeline>
<codeline lineno="9863"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Named:</highlight></codeline>
<codeline lineno="9864"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>NamedColor,<sp/>pSrc);</highlight></codeline>
<codeline lineno="9865"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9866"><highlight class="normal"></highlight></codeline>
<codeline lineno="9867"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyNamed2Pixel:</highlight></codeline>
<codeline lineno="9868"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j==0)<sp/>{</highlight></codeline>
<codeline lineno="9869"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="9870"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9871"><highlight class="normal"></highlight></codeline>
<codeline lineno="9872"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pXform-&gt;Apply(pApply,<sp/>pDst,<sp/>NamedColor);</highlight></codeline>
<codeline lineno="9873"><highlight class="normal"></highlight></codeline>
<codeline lineno="9874"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)<sp/>{</highlight></codeline>
<codeline lineno="9875"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="9876"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9877"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9878"><highlight class="normal"></highlight></codeline>
<codeline lineno="9879"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="9880"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9881"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9882"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9883"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="9884"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform-&gt;Apply(pApply,<sp/>pDst,<sp/>pSrc);</highlight></codeline>
<codeline lineno="9885"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9886"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pSrc<sp/>=<sp/>pDst;</highlight></codeline>
<codeline lineno="9887"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9888"><highlight class="normal"></highlight></codeline>
<codeline lineno="9889"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="9890"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="9891"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()==<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="9892"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform<sp/>=<sp/>(CIccXformNamedColor*)pApplyXform;</highlight></codeline>
<codeline lineno="9893"><highlight class="normal"></highlight></codeline>
<codeline lineno="9894"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pXform-&gt;GetInterface())<sp/>{</highlight></codeline>
<codeline lineno="9895"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Pixel:</highlight></codeline>
<codeline lineno="9896"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>DstPixel,<sp/>pSrc);</highlight></codeline>
<codeline lineno="9897"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9898"><highlight class="normal"></highlight></codeline>
<codeline lineno="9899"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Named:</highlight></codeline>
<codeline lineno="9900"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="9901"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="9902"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9903"><highlight class="normal"></highlight></codeline>
<codeline lineno="9904"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyNamed2Pixel:</highlight></codeline>
<codeline lineno="9905"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pXform-&gt;Apply(pApply,<sp/>DstPixel,<sp/>NamedColor);</highlight></codeline>
<codeline lineno="9906"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)<sp/>{</highlight></codeline>
<codeline lineno="9907"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="9908"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9909"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9910"><highlight class="normal"></highlight></codeline>
<codeline lineno="9911"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9912"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9913"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="9914"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform-&gt;Apply(pApply,<sp/>DstPixel,<sp/>pSrc);</highlight></codeline>
<codeline lineno="9915"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9916"><highlight class="normal"></highlight></codeline>
<codeline lineno="9917"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9918"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n==1)<sp/>{</highlight></codeline>
<codeline lineno="9919"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>i<sp/>=<sp/>m_Xforms-&gt;begin();</highlight></codeline>
<codeline lineno="9920"><highlight class="normal"></highlight></codeline>
<codeline lineno="9921"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="9922"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="9923"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()==<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="9924"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="9925"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9926"><highlight class="normal"></highlight></codeline>
<codeline lineno="9927"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform-&gt;Apply(pApply,<sp/>DstPixel,<sp/>pSrc);</highlight></codeline>
<codeline lineno="9928"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9929"><highlight class="normal"></highlight></codeline>
<codeline lineno="9930"><highlight class="normal"><sp/><sp/><sp/><sp/>SrcPixel<sp/>+=<sp/>m_pCmm-&gt;GetSourceSamples();</highlight></codeline>
<codeline lineno="9931"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel<sp/>+=<sp/>m_pCmm-&gt;GetDestSamples();</highlight></codeline>
<codeline lineno="9932"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9933"><highlight class="normal"></highlight></codeline>
<codeline lineno="9934"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="9935"><highlight class="normal">}</highlight></codeline>
<codeline lineno="9936"><highlight class="normal"></highlight></codeline>
<codeline lineno="9937"><highlight class="normal"></highlight></codeline>
<codeline lineno="9950"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccApplyNamedColorCmm::Apply(<ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref>*<sp/>DstColorName,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight></codeline>
<codeline lineno="9951"><highlight class="normal">{</highlight></codeline>
<codeline lineno="9952"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/>*pTmp;</highlight></codeline>
<codeline lineno="9953"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc;</highlight></codeline>
<codeline lineno="9954"><highlight class="normal"><sp/><sp/>CIccApplyXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="9955"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j,<sp/>n<sp/>=<sp/>(int)m_Xforms-&gt;size();</highlight></codeline>
<codeline lineno="9956"><highlight class="normal"><sp/><sp/>CIccApplyXform<sp/>*pApply;</highlight></codeline>
<codeline lineno="9957"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccXform<sp/>*pApplyXform;</highlight></codeline>
<codeline lineno="9958"><highlight class="normal"><sp/><sp/>CIccXformNamedColor<sp/>*pXform;</highlight></codeline>
<codeline lineno="9959"><highlight class="normal"></highlight></codeline>
<codeline lineno="9960"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!n)</highlight></codeline>
<codeline lineno="9961"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="9962"><highlight class="normal"></highlight></codeline>
<codeline lineno="9963"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Pixel<sp/>&amp;&amp;<sp/>!InitPixel())<sp/>{</highlight></codeline>
<codeline lineno="9964"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="9965"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="9966"><highlight class="normal"></highlight></codeline>
<codeline lineno="9967"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref><sp/>NamedColor[256];</highlight></codeline>
<codeline lineno="9968"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv;</highlight></codeline>
<codeline lineno="9969"><highlight class="normal"></highlight></codeline>
<codeline lineno="9970"><highlight class="normal"><sp/><sp/>pSrc<sp/>=<sp/>SrcPixel;</highlight></codeline>
<codeline lineno="9971"><highlight class="normal"><sp/><sp/>pDst<sp/>=<sp/>m_Pixel;</highlight></codeline>
<codeline lineno="9972"><highlight class="normal"></highlight></codeline>
<codeline lineno="9973"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n&gt;1)<sp/>{</highlight></codeline>
<codeline lineno="9974"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j=0,<sp/>i=m_Xforms-&gt;begin();<sp/>j&lt;n-1<sp/>&amp;&amp;<sp/>i!=m_Xforms-&gt;end();<sp/>i++,<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="9975"><highlight class="normal"></highlight></codeline>
<codeline lineno="9976"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="9977"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="9978"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()==<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="9979"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform<sp/>=<sp/>(CIccXformNamedColor*)pApplyXform;</highlight></codeline>
<codeline lineno="9980"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pXform-&gt;GetInterface())<sp/>{</highlight></codeline>
<codeline lineno="9981"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Pixel:</highlight></codeline>
<codeline lineno="9982"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>pDst,<sp/>pSrc);</highlight></codeline>
<codeline lineno="9983"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9984"><highlight class="normal"></highlight></codeline>
<codeline lineno="9985"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Named:</highlight></codeline>
<codeline lineno="9986"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>NamedColor,<sp/>pSrc);</highlight></codeline>
<codeline lineno="9987"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9988"><highlight class="normal"></highlight></codeline>
<codeline lineno="9989"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyNamed2Pixel:</highlight></codeline>
<codeline lineno="9990"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(j==0)<sp/>{</highlight></codeline>
<codeline lineno="9991"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="9992"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9993"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pXform-&gt;Apply(pApply,<sp/>pDst,<sp/>NamedColor);</highlight></codeline>
<codeline lineno="9994"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)<sp/>{</highlight></codeline>
<codeline lineno="9995"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="9996"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="9997"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="9998"><highlight class="normal"></highlight></codeline>
<codeline lineno="9999"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="10000"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10001"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10002"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10003"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10004"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform-&gt;Apply(pApply,<sp/>pDst,<sp/>pSrc);</highlight></codeline>
<codeline lineno="10005"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10006"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pTmp<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*)pSrc;</highlight></codeline>
<codeline lineno="10007"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pSrc<sp/>=<sp/>pDst;</highlight></codeline>
<codeline lineno="10008"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTmp==SrcPixel)</highlight></codeline>
<codeline lineno="10009"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pDst<sp/>=<sp/>m_Pixel2;</highlight></codeline>
<codeline lineno="10010"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10011"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pDst<sp/>=<sp/>pTmp;</highlight></codeline>
<codeline lineno="10012"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10013"><highlight class="normal"></highlight></codeline>
<codeline lineno="10014"><highlight class="normal"><sp/><sp/><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="10015"><highlight class="normal"><sp/><sp/><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="10016"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()==<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10017"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pXform<sp/>=<sp/>(CIccXformNamedColor*)pApplyXform;</highlight></codeline>
<codeline lineno="10018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pXform-&gt;GetInterface())<sp/>{</highlight></codeline>
<codeline lineno="10019"><highlight class="normal"></highlight></codeline>
<codeline lineno="10020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Named:</highlight></codeline>
<codeline lineno="10021"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>DstColorName,<sp/>pSrc);</highlight></codeline>
<codeline lineno="10022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10023"><highlight class="normal"></highlight></codeline>
<codeline lineno="10024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Pixel:</highlight></codeline>
<codeline lineno="10025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyNamed2Pixel:</highlight></codeline>
<codeline lineno="10026"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="10027"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="10028"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10029"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10030"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10031"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10032"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="10033"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10034"><highlight class="normal"></highlight></codeline>
<codeline lineno="10035"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10036"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n==1)<sp/>{</highlight></codeline>
<codeline lineno="10037"><highlight class="normal"><sp/><sp/><sp/><sp/>i<sp/>=<sp/>m_Xforms-&gt;begin();</highlight></codeline>
<codeline lineno="10038"><highlight class="normal"><sp/><sp/><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="10039"><highlight class="normal"><sp/><sp/><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="10040"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()!=<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10041"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="10042"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10043"><highlight class="normal"></highlight></codeline>
<codeline lineno="10044"><highlight class="normal"><sp/><sp/><sp/><sp/>pXform<sp/>=<sp/>(CIccXformNamedColor*)pApplyXform;</highlight></codeline>
<codeline lineno="10045"><highlight class="normal"><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>DstColorName,<sp/>pSrc);</highlight></codeline>
<codeline lineno="10046"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10047"><highlight class="normal"></highlight></codeline>
<codeline lineno="10048"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="10049"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10050"><highlight class="normal"></highlight></codeline>
<codeline lineno="10051"><highlight class="normal"></highlight></codeline>
<codeline lineno="10064"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccApplyNamedColorCmm::Apply(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref><sp/>*SrcColorName,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>tint</highlight><highlight class="comment">/*=1.0*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="10065"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10066"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/>*pTmp;</highlight></codeline>
<codeline lineno="10067"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc;</highlight></codeline>
<codeline lineno="10068"><highlight class="normal"><sp/><sp/>CIccApplyXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="10069"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j,<sp/>n<sp/>=<sp/>(int)m_Xforms-&gt;size();</highlight></codeline>
<codeline lineno="10070"><highlight class="normal"><sp/><sp/>CIccApplyXform<sp/>*pApply;</highlight></codeline>
<codeline lineno="10071"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccXform<sp/>*pApplyXform;</highlight></codeline>
<codeline lineno="10072"><highlight class="normal"><sp/><sp/>CIccXformNamedColor<sp/>*pXform;</highlight></codeline>
<codeline lineno="10073"><highlight class="normal"></highlight></codeline>
<codeline lineno="10074"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!n)</highlight></codeline>
<codeline lineno="10075"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="10076"><highlight class="normal"></highlight></codeline>
<codeline lineno="10077"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Pixel<sp/>&amp;&amp;<sp/>!InitPixel())<sp/>{</highlight></codeline>
<codeline lineno="10078"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="10079"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10080"><highlight class="normal"></highlight></codeline>
<codeline lineno="10081"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref><sp/>NamedColor[255];</highlight></codeline>
<codeline lineno="10082"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv;</highlight></codeline>
<codeline lineno="10083"><highlight class="normal"></highlight></codeline>
<codeline lineno="10084"><highlight class="normal"><sp/><sp/>i=m_Xforms-&gt;begin();</highlight></codeline>
<codeline lineno="10085"><highlight class="normal"><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="10086"><highlight class="normal"><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="10087"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()!=<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)</highlight></codeline>
<codeline lineno="10088"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="10089"><highlight class="normal"></highlight></codeline>
<codeline lineno="10090"><highlight class="normal"><sp/><sp/>pXform<sp/>=<sp/>(CIccXformNamedColor*)pApplyXform;<sp/><sp/></highlight></codeline>
<codeline lineno="10091"><highlight class="normal"></highlight></codeline>
<codeline lineno="10092"><highlight class="normal"><sp/><sp/>pDst<sp/>=<sp/>m_Pixel;</highlight></codeline>
<codeline lineno="10093"><highlight class="normal"></highlight></codeline>
<codeline lineno="10094"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n&gt;1)<sp/>{</highlight></codeline>
<codeline lineno="10095"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pXform-&gt;Apply(pApply,<sp/>pDst,<sp/>SrcColorName,<sp/>tint);</highlight></codeline>
<codeline lineno="10096"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)<sp/>{</highlight></codeline>
<codeline lineno="10097"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10098"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10099"><highlight class="normal"></highlight></codeline>
<codeline lineno="10100"><highlight class="normal"><sp/><sp/><sp/><sp/>pSrc<sp/>=<sp/>pDst;</highlight></codeline>
<codeline lineno="10101"><highlight class="normal"><sp/><sp/><sp/><sp/>pDst<sp/>=<sp/>m_Pixel2;</highlight></codeline>
<codeline lineno="10102"><highlight class="normal"></highlight></codeline>
<codeline lineno="10103"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j=0,<sp/>i++;<sp/>j&lt;n-2<sp/>&amp;&amp;<sp/>i!=m_Xforms-&gt;end();<sp/>i++,<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="10104"><highlight class="normal"></highlight></codeline>
<codeline lineno="10105"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="10106"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="10107"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()==<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10108"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccXformNamedColor<sp/>*pXform<sp/>=<sp/>(CIccXformNamedColor*)pApplyXform;</highlight></codeline>
<codeline lineno="10109"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pXform-&gt;GetInterface())<sp/>{</highlight></codeline>
<codeline lineno="10110"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Pixel:</highlight></codeline>
<codeline lineno="10111"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>pDst,<sp/>pSrc);</highlight></codeline>
<codeline lineno="10112"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10113"><highlight class="normal"></highlight></codeline>
<codeline lineno="10114"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Named:</highlight></codeline>
<codeline lineno="10115"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>NamedColor,<sp/>pSrc);</highlight></codeline>
<codeline lineno="10116"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10117"><highlight class="normal"></highlight></codeline>
<codeline lineno="10118"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyNamed2Pixel:</highlight></codeline>
<codeline lineno="10119"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pXform-&gt;Apply(pApply,<sp/>pDst,<sp/>NamedColor);</highlight></codeline>
<codeline lineno="10120"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)<sp/>{</highlight></codeline>
<codeline lineno="10121"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10122"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10123"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10124"><highlight class="normal"></highlight></codeline>
<codeline lineno="10125"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="10126"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10127"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10128"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10129"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10130"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform-&gt;Apply(pApply,<sp/>pDst,<sp/>pSrc);</highlight></codeline>
<codeline lineno="10131"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10132"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pTmp<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*)pSrc;</highlight></codeline>
<codeline lineno="10133"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pSrc<sp/>=<sp/>pDst;</highlight></codeline>
<codeline lineno="10134"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pDst<sp/>=<sp/>pTmp;</highlight></codeline>
<codeline lineno="10135"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10136"><highlight class="normal"></highlight></codeline>
<codeline lineno="10137"><highlight class="normal"><sp/><sp/><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="10138"><highlight class="normal"><sp/><sp/><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="10139"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()==<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10140"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pXform<sp/>=<sp/>(CIccXformNamedColor*)pApplyXform;</highlight></codeline>
<codeline lineno="10141"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pXform-&gt;GetInterface())<sp/>{</highlight></codeline>
<codeline lineno="10142"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Pixel:</highlight></codeline>
<codeline lineno="10143"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>DstPixel,<sp/>pSrc);</highlight></codeline>
<codeline lineno="10144"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10145"><highlight class="normal"></highlight></codeline>
<codeline lineno="10146"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Named:</highlight></codeline>
<codeline lineno="10147"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="10148"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="10149"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10150"><highlight class="normal"></highlight></codeline>
<codeline lineno="10151"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyNamed2Pixel:</highlight></codeline>
<codeline lineno="10152"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pXform-&gt;Apply(pApply,<sp/>DstPixel,<sp/>NamedColor);</highlight></codeline>
<codeline lineno="10153"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)<sp/>{</highlight></codeline>
<codeline lineno="10154"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10155"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10156"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10157"><highlight class="normal"></highlight></codeline>
<codeline lineno="10158"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10159"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10160"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10161"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform-&gt;Apply(pApply,<sp/>DstPixel,<sp/>pSrc);</highlight></codeline>
<codeline lineno="10162"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10163"><highlight class="normal"></highlight></codeline>
<codeline lineno="10164"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10165"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n==1)<sp/>{</highlight></codeline>
<codeline lineno="10166"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pXform-&gt;Apply(pApply,<sp/>DstPixel,<sp/>SrcColorName,<sp/>tint);</highlight></codeline>
<codeline lineno="10167"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)<sp/>{</highlight></codeline>
<codeline lineno="10168"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10169"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10170"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10171"><highlight class="normal"></highlight></codeline>
<codeline lineno="10172"><highlight class="normal"></highlight></codeline>
<codeline lineno="10173"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="10174"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10175"><highlight class="normal"></highlight></codeline>
<codeline lineno="10188"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccApplyNamedColorCmm::Apply(<ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref><sp/>*DstColorName,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref><sp/>*SrcColorName,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>tint</highlight><highlight class="comment">/*=1.0*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="10189"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10190"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pDst,<sp/>*pTmp;</highlight></codeline>
<codeline lineno="10191"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*pSrc;</highlight></codeline>
<codeline lineno="10192"><highlight class="normal"><sp/><sp/>CIccApplyXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="10193"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>j,<sp/>n<sp/>=<sp/>(int)m_Xforms-&gt;size();</highlight></codeline>
<codeline lineno="10194"><highlight class="normal"><sp/><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref><sp/>NamedColor[256];</highlight></codeline>
<codeline lineno="10195"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv;</highlight></codeline>
<codeline lineno="10196"><highlight class="normal"><sp/><sp/>CIccApplyXform<sp/>*pApply;</highlight></codeline>
<codeline lineno="10197"><highlight class="normal"><sp/><sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>CIccXform<sp/>*pApplyXform;</highlight></codeline>
<codeline lineno="10198"><highlight class="normal"><sp/><sp/>CIccXformNamedColor<sp/>*pXform;</highlight></codeline>
<codeline lineno="10199"><highlight class="normal"></highlight></codeline>
<codeline lineno="10200"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!n)</highlight></codeline>
<codeline lineno="10201"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="10202"><highlight class="normal"></highlight></codeline>
<codeline lineno="10203"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Pixel<sp/>&amp;&amp;<sp/>!InitPixel())<sp/>{</highlight></codeline>
<codeline lineno="10204"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="10205"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10206"><highlight class="normal"></highlight></codeline>
<codeline lineno="10207"><highlight class="normal"><sp/><sp/>i=m_Xforms-&gt;begin();</highlight></codeline>
<codeline lineno="10208"><highlight class="normal"></highlight></codeline>
<codeline lineno="10209"><highlight class="normal"><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="10210"><highlight class="normal"><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="10211"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()!=<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)</highlight></codeline>
<codeline lineno="10212"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="10213"><highlight class="normal"></highlight></codeline>
<codeline lineno="10214"><highlight class="normal"><sp/><sp/>pXform<sp/>=<sp/>(CIccXformNamedColor*)pApplyXform;</highlight></codeline>
<codeline lineno="10215"><highlight class="normal"></highlight></codeline>
<codeline lineno="10216"><highlight class="normal"><sp/><sp/>pDst<sp/>=<sp/>m_Pixel;</highlight></codeline>
<codeline lineno="10217"><highlight class="normal"></highlight></codeline>
<codeline lineno="10218"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n&gt;1)<sp/>{</highlight></codeline>
<codeline lineno="10219"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pXform-&gt;Apply(pApply,<sp/>pDst,<sp/>SrcColorName,<sp/>tint);</highlight></codeline>
<codeline lineno="10220"><highlight class="normal"></highlight></codeline>
<codeline lineno="10221"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)<sp/>{</highlight></codeline>
<codeline lineno="10222"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10223"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10224"><highlight class="normal"></highlight></codeline>
<codeline lineno="10225"><highlight class="normal"><sp/><sp/><sp/><sp/>pSrc<sp/>=<sp/>pDst;</highlight></codeline>
<codeline lineno="10226"><highlight class="normal"><sp/><sp/><sp/><sp/>pDst<sp/>=<sp/>m_Pixel2;</highlight></codeline>
<codeline lineno="10227"><highlight class="normal"></highlight></codeline>
<codeline lineno="10228"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(j=0,<sp/>i++;<sp/>j&lt;n-2<sp/>&amp;&amp;<sp/>i!=m_Xforms-&gt;end();<sp/>i++,<sp/>j++)<sp/>{</highlight></codeline>
<codeline lineno="10229"><highlight class="normal"></highlight></codeline>
<codeline lineno="10230"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="10231"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="10232"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()==<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10233"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform<sp/>=<sp/>(CIccXformNamedColor*)pApplyXform;</highlight></codeline>
<codeline lineno="10234"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pXform-&gt;GetInterface())<sp/>{</highlight></codeline>
<codeline lineno="10235"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Pixel:</highlight></codeline>
<codeline lineno="10236"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>pDst,<sp/>pSrc);</highlight></codeline>
<codeline lineno="10237"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10238"><highlight class="normal"></highlight></codeline>
<codeline lineno="10239"><highlight class="normal"></highlight></codeline>
<codeline lineno="10240"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Named:</highlight></codeline>
<codeline lineno="10241"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>NamedColor,<sp/>pSrc);</highlight></codeline>
<codeline lineno="10242"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10243"><highlight class="normal"></highlight></codeline>
<codeline lineno="10244"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyNamed2Pixel:</highlight></codeline>
<codeline lineno="10245"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pXform-&gt;Apply(pApply,<sp/>pDst,<sp/>NamedColor);</highlight></codeline>
<codeline lineno="10246"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)<sp/>{</highlight></codeline>
<codeline lineno="10247"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10248"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10249"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10250"><highlight class="normal"></highlight></codeline>
<codeline lineno="10251"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="10252"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10253"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10254"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10255"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10256"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pApplyXform-&gt;Apply(pApply,<sp/>pDst,<sp/>pSrc);</highlight></codeline>
<codeline lineno="10257"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10258"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pTmp<sp/>=<sp/>(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref>*)pSrc;</highlight></codeline>
<codeline lineno="10259"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pSrc<sp/>=<sp/>pDst;</highlight></codeline>
<codeline lineno="10260"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pDst<sp/>=<sp/>pTmp;</highlight></codeline>
<codeline lineno="10261"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10262"><highlight class="normal"></highlight></codeline>
<codeline lineno="10263"><highlight class="normal"><sp/><sp/><sp/><sp/>pApply<sp/>=<sp/>i-&gt;ptr;</highlight></codeline>
<codeline lineno="10264"><highlight class="normal"><sp/><sp/><sp/><sp/>pApplyXform<sp/>=<sp/>pApply-&gt;GetXform();</highlight></codeline>
<codeline lineno="10265"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pApplyXform-&gt;GetXformType()==<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10266"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>pXform<sp/>=<sp/>(CIccXformNamedColor*)pApplyXform;</highlight></codeline>
<codeline lineno="10267"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pXform-&gt;GetInterface())<sp/>{</highlight></codeline>
<codeline lineno="10268"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Named:</highlight></codeline>
<codeline lineno="10269"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;Apply(pApply,<sp/>DstColorName,<sp/>pSrc);</highlight></codeline>
<codeline lineno="10270"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10271"><highlight class="normal"></highlight></codeline>
<codeline lineno="10272"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyPixel2Pixel:</highlight></codeline>
<codeline lineno="10273"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/>icApplyNamed2Pixel:</highlight></codeline>
<codeline lineno="10274"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="10275"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="10276"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10277"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10278"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10279"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10280"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="10281"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10282"><highlight class="normal"></highlight></codeline>
<codeline lineno="10283"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10284"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(n==1)<sp/>{</highlight></codeline>
<codeline lineno="10285"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a7102c7110f9f15ed189ef44d9d548f29" kindref="member">icCmmStatIncorrectApply</ref>;</highlight></codeline>
<codeline lineno="10286"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10287"><highlight class="normal"></highlight></codeline>
<codeline lineno="10288"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="10289"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10290"><highlight class="normal"></highlight></codeline>
<codeline lineno="10304"><highlight class="normal">CIccNamedColorCmm::CIccNamedColorCmm(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nSrcSpace,<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nDestSpace,</highlight></codeline>
<codeline lineno="10305"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bFirstInput)<sp/>:<sp/>CIccCmm(nSrcSpace,<sp/>nDestSpace,<sp/>bFirstInput)</highlight></codeline>
<codeline lineno="10306"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10307"><highlight class="normal"><sp/><sp/>m_nApplyInterface<sp/>=<sp/>icApplyPixel2Pixel;</highlight></codeline>
<codeline lineno="10308"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10309"><highlight class="normal"></highlight></codeline>
<codeline lineno="10318"><highlight class="normal">CIccNamedColorCmm::~CIccNamedColorCmm()</highlight></codeline>
<codeline lineno="10319"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10320"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10321"><highlight class="normal"></highlight></codeline>
<codeline lineno="10322"><highlight class="normal"></highlight></codeline>
<codeline lineno="10340"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccNamedColorCmm::AddXform(</highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref><sp/>*szProfilePath,</highlight></codeline>
<codeline lineno="10341"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nIntent<sp/></highlight><highlight class="comment">/*=icUnknownIntent*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="10342"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913" kindref="member">icXformInterp</ref><sp/>nInterp<sp/></highlight><highlight class="comment">/*icXformInterp*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="10343"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc</highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="10344"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7b" kindref="member">icXformLutType</ref><sp/>nLutType<sp/></highlight><highlight class="comment">/*=icXformLutColor*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="10345"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseD2BxB2DxTags<sp/></highlight><highlight class="comment">/*=true*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="10346"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccCreateXformHintManager<sp/>*pHintManager<sp/></highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="10347"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseSubProfile<sp/></highlight><highlight class="comment">/*=false*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="10348"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10349"><highlight class="normal"><sp/><sp/><ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile<sp/>=<sp/><ref refid="d0/dc2/a00104_1a97134bdd4b4bf5e8a43ef018bba0917e" kindref="member">OpenIccProfile</ref>(szProfilePath,<sp/>bUseSubProfile);</highlight></codeline>
<codeline lineno="10350"><highlight class="normal"></highlight></codeline>
<codeline lineno="10351"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pProfile)<sp/></highlight></codeline>
<codeline lineno="10352"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a94a1cd52eec49dc84eac5993164c5be0" kindref="member">icCmmStatCantOpenProfile</ref>;</highlight></codeline>
<codeline lineno="10353"><highlight class="normal"></highlight></codeline>
<codeline lineno="10354"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv<sp/>=<sp/>AddXform(pProfile,<sp/>nIntent,<sp/>nInterp,<sp/>pPcc,<sp/>nLutType,<sp/>bUseD2BxB2DxTags,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="10355"><highlight class="normal"></highlight></codeline>
<codeline lineno="10356"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)</highlight></codeline>
<codeline lineno="10357"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pProfile;</highlight></codeline>
<codeline lineno="10358"><highlight class="normal"></highlight></codeline>
<codeline lineno="10359"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10360"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10361"><highlight class="normal"></highlight></codeline>
<codeline lineno="10380"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccNamedColorCmm::AddXform(<ref refid="d4/d3a/a00101_1a14e10b61df6e9ec7c90c5d3bc38c78d9" kindref="member">CIccProfile</ref><sp/>*pProfile,</highlight></codeline>
<codeline lineno="10381"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref><sp/>nIntent<sp/></highlight><highlight class="comment">/*=icUnknownIntent*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="10382"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a39ef4ca48f4dbb239b4e3ac0e9e8e913" kindref="member">icXformInterp</ref><sp/>nInterp<sp/></highlight><highlight class="comment">/*=icInterpLinear*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="10383"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="db/d18/a00885" kindref="compound">IIccProfileConnectionConditions</ref><sp/>*pPcc</highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="10384"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7b" kindref="member">icXformLutType</ref><sp/>nLutType<sp/></highlight><highlight class="comment">/*=icXformLutColor*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="10385"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUseD2BxB2DxTags<sp/></highlight><highlight class="comment">/*=true*/</highlight><highlight class="normal">,</highlight></codeline>
<codeline lineno="10386"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccCreateXformHintManager<sp/>*pHintManager<sp/></highlight><highlight class="comment">/*=NULL*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="10387"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10388"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nSrcSpace,<sp/>nDstSpace;</highlight></codeline>
<codeline lineno="10389"><highlight class="normal"><sp/><sp/>CIccXformPtr<sp/>Xform;</highlight></codeline>
<codeline lineno="10390"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bInput<sp/>=<sp/>!m_bLastInput;</highlight></codeline>
<codeline lineno="10391"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv;</highlight></codeline>
<codeline lineno="10392"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7b" kindref="member">icXformLutType</ref><sp/>nUseLutType<sp/>=<sp/>nLutType;</highlight></codeline>
<codeline lineno="10393"><highlight class="normal"></highlight></codeline>
<codeline lineno="10394"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pProfile-&gt;m_Header.deviceClass)<sp/>{</highlight></codeline>
<codeline lineno="10395"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0aeb74955777b1abe38df700474c7be5ce" kindref="member">icSigMaterialIdentificationClass</ref>:</highlight></codeline>
<codeline lineno="10396"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a8b2deae24b9246ac33314b42ad02ac48" kindref="member">icSigMaterialLinkClass</ref>:</highlight></codeline>
<codeline lineno="10397"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref>;</highlight></codeline>
<codeline lineno="10398"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nLutType<sp/>=<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153" kindref="member">icXformLutMCS</ref>;</highlight></codeline>
<codeline lineno="10399"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10400"><highlight class="normal"></highlight></codeline>
<codeline lineno="10401"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f" kindref="member">icSigMaterialVisualizationClass</ref>:</highlight></codeline>
<codeline lineno="10402"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nLutType<sp/>=<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153" kindref="member">icXformLutMCS</ref>;</highlight></codeline>
<codeline lineno="10403"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10404"><highlight class="normal"></highlight></codeline>
<codeline lineno="10405"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="10406"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10407"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10408"><highlight class="normal"></highlight></codeline>
<codeline lineno="10409"><highlight class="normal"><sp/><sp/>Xform.ptr<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="10410"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal"><sp/>(nUseLutType)<sp/>{</highlight></codeline>
<codeline lineno="10411"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Automatically<sp/>choose<sp/>which<sp/>one</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10412"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614" kindref="member">icXformLutColor</ref>:</highlight></codeline>
<codeline lineno="10413"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013" kindref="member">icXformLutColorimetric</ref>:</highlight></codeline>
<codeline lineno="10414"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262" kindref="member">icXformLutSpectral</ref>:</highlight></codeline>
<codeline lineno="10415"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba0b1f2aadd55b74ea25adc32e3cadf4c0" kindref="member">icXformLutNamedColor</ref>:</highlight></codeline>
<codeline lineno="10416"><highlight class="normal"><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="10417"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><ref refid="d7/dfd/a00969" kindref="compound">CIccTag</ref><sp/>*pTag<sp/>=<sp/>pProfile-&gt;FindTag(<ref refid="d7/d46/a00002_1ac82636cc27ba918bd737e94a62715af5ac9a9457a436bbfaa9212552f337d2beb" kindref="member">icSigNamedColor2Tag</ref>);</highlight></codeline>
<codeline lineno="10418"><highlight class="normal"></highlight></codeline>
<codeline lineno="10419"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pTag<sp/>&amp;&amp;<sp/>(pProfile-&gt;m_Header.deviceClass==<ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0ac1881705b3792813f8ef0745b7a12170" kindref="member">icSigNamedColorClass</ref><sp/>||<sp/>nLutType<sp/>==<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba0b1f2aadd55b74ea25adc32e3cadf4c0" kindref="member">icXformLutNamedColor</ref>))<sp/>{</highlight></codeline>
<codeline lineno="10420"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bInput)<sp/>{</highlight></codeline>
<codeline lineno="10421"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>;</highlight></codeline>
<codeline lineno="10422"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10423"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nLutType<sp/>==<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262" kindref="member">icXformLutSpectral</ref><sp/>||<sp/>((bUseD2BxB2DxTags<sp/>||<sp/>!pProfile-&gt;m_Header.pcs)<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.spectralPCS<sp/>&amp;&amp;<sp/>nLutType<sp/>!=<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013" kindref="member">icXformLutColorimetric</ref>))<sp/>{</highlight></codeline>
<codeline lineno="10424"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.spectralPCS;</highlight></codeline>
<codeline lineno="10425"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUseD2BxB2DxTags<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10426"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10427"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10428"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="10429"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10430"><highlight class="normal"></highlight></codeline>
<codeline lineno="10431"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Xforms-&gt;size())<sp/>{</highlight></codeline>
<codeline lineno="10432"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nSrcSpace==<ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10433"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_nSrcSpace<sp/>=<sp/>nSrcSpace;</highlight></codeline>
<codeline lineno="10434"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10435"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10436"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>m_nSrcSpace;</highlight></codeline>
<codeline lineno="10437"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10438"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10439"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10440"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nLastSpace==<ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10441"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_nLastSpace<sp/>=<sp/>nSrcSpace;</highlight></codeline>
<codeline lineno="10442"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10443"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10444"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>m_nLastSpace;</highlight></codeline>
<codeline lineno="10445"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10446"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10447"><highlight class="normal"></highlight></codeline>
<codeline lineno="10448"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nSrcSpace==<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10449"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nLutType<sp/>==<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262" kindref="member">icXformLutSpectral</ref><sp/>||<sp/>(bUseD2BxB2DxTags<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.spectralPCS<sp/>&amp;&amp;<sp/>nLutType<sp/>!=<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013" kindref="member">icXformLutColorimetric</ref>))<sp/>{</highlight></codeline>
<codeline lineno="10450"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.spectralPCS;<sp/></highlight></codeline>
<codeline lineno="10451"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUseD2BxB2DxTags<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10452"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10453"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10454"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="10455"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10456"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10457"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10458"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10459"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>;</highlight></codeline>
<codeline lineno="10460"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10461"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10462"><highlight class="normal"></highlight></codeline>
<codeline lineno="10463"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>Xform.ptr<sp/>=<sp/>CIccXform::Create(pProfile,<sp/>bInput,<sp/>nIntent,<sp/>nInterp,<sp/>pPcc,<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba0b1f2aadd55b74ea25adc32e3cadf4c0" kindref="member">icXformLutNamedColor</ref>,<sp/>bUseD2BxB2DxTags,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="10464"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Xform.ptr)<sp/>{</highlight></codeline>
<codeline lineno="10465"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="10466"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10467"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>CIccXformNamedColor<sp/>*pXform<sp/>=<sp/>(CIccXformNamedColor<sp/>*)Xform.ptr;</highlight></codeline>
<codeline lineno="10468"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pXform-&gt;SetSrcSpace(nSrcSpace);</highlight></codeline>
<codeline lineno="10469"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)</highlight></codeline>
<codeline lineno="10470"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10471"><highlight class="normal"></highlight></codeline>
<codeline lineno="10472"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>pXform-&gt;SetDestSpace(nDstSpace);</highlight></codeline>
<codeline lineno="10473"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv)</highlight></codeline>
<codeline lineno="10474"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10475"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10476"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10477"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//It<sp/>isn&apos;t<sp/>named<sp/>color<sp/>so<sp/>make<sp/>we<sp/>will<sp/>use<sp/>color<sp/>lut.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10478"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nUseLutType==<ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba0b1f2aadd55b74ea25adc32e3cadf4c0" kindref="member">icXformLutNamedColor</ref>)</highlight></codeline>
<codeline lineno="10479"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nUseLutType<sp/>=<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad77391d20e90bb2496733d3700589614" kindref="member">icXformLutColor</ref>;</highlight></codeline>
<codeline lineno="10480"><highlight class="normal"></highlight></codeline>
<codeline lineno="10481"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="comment">//Check<sp/>pProfile<sp/>if<sp/>nIntent<sp/>and<sp/>input<sp/>can<sp/>be<sp/>found.</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10482"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bInput)<sp/>{</highlight></codeline>
<codeline lineno="10483"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="10484"><highlight class="normal"></highlight></codeline>
<codeline lineno="10485"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nLutType<sp/>==<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262" kindref="member">icXformLutSpectral</ref><sp/>||<sp/>((bUseD2BxB2DxTags<sp/>||<sp/>!pProfile-&gt;m_Header.pcs)<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.spectralPCS<sp/>&amp;&amp;<sp/>nLutType<sp/>!=<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013" kindref="member">icXformLutColorimetric</ref>))<sp/>{</highlight></codeline>
<codeline lineno="10486"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.spectralPCS;</highlight></codeline>
<codeline lineno="10487"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUseD2BxB2DxTags<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10488"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10489"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10490"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="10491"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10492"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10493"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass<sp/>==<sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0af50c13fdfab9fcc0a7b831ac86d1fe3b" kindref="member">icSigLinkClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10494"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="10495"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10496"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass<sp/>==<sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a200e4fc8dcec29c6d411cae0c9a0483c" kindref="member">icSigAbstractClass</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10497"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10498"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref>;<sp/></highlight><highlight class="comment">//<sp/>Note:<sp/>icPerceptualIntent<sp/>=<sp/>0</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10499"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10500"><highlight class="normal"></highlight></codeline>
<codeline lineno="10501"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nLutType<sp/>==<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bae55f258edf2d7a66ac8c1e976baf9262" kindref="member">icXformLutSpectral</ref><sp/>||<sp/>((bUseD2BxB2DxTags<sp/>||<sp/>!pProfile-&gt;m_Header.pcs)<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.spectralPCS<sp/>&amp;&amp;<sp/>nLutType<sp/>!=<sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba8219eb535838b8ca78eef40401ec9013" kindref="member">icXformLutColorimetric</ref>))<sp/>{</highlight></codeline>
<codeline lineno="10502"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.spectralPCS;</highlight></codeline>
<codeline lineno="10503"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bUseD2BxB2DxTags<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10504"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10505"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10506"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="10507"><highlight class="normal"></highlight></codeline>
<codeline lineno="10508"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="10509"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10510"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10511"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10512"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10513"><highlight class="normal"></highlight></codeline>
<codeline lineno="10514"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7baeb0501fdc1dcc7f1388f0fdca9b17356" kindref="member">icXformLutPreview</ref>:</highlight></codeline>
<codeline lineno="10515"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="10516"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="10517"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10518"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10519"><highlight class="normal"></highlight></codeline>
<codeline lineno="10520"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba6df311bd7dc6c9c9284ad186b15f53de" kindref="member">icXformLutGamut</ref>:</highlight></codeline>
<codeline lineno="10521"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="10522"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1af63f30724bd4cfbb6b7e3e2d7b1b602e" kindref="member">icSigGamutData</ref>;</highlight></codeline>
<codeline lineno="10523"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10524"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10525"><highlight class="normal"></highlight></codeline>
<codeline lineno="10526"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7baf26b30e0e73bf289c23075e2f6106e6d" kindref="member">icXformLutBRDFParam</ref>:</highlight></codeline>
<codeline lineno="10527"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="10528"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref>;</highlight></codeline>
<codeline lineno="10529"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10530"><highlight class="normal"></highlight></codeline>
<codeline lineno="10531"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7ba1109d56a39fd11938962b487d6f965b8" kindref="member">icXformLutBRDFDirect</ref>:</highlight></codeline>
<codeline lineno="10532"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="10533"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/><ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref>;</highlight></codeline>
<codeline lineno="10534"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10535"><highlight class="normal"></highlight></codeline>
<codeline lineno="10536"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1a1ba790142ac961bedde2898273414a7bad49facb356230dc6f294d1dd7c1ed153" kindref="member">icXformLutMCS</ref>:</highlight></codeline>
<codeline lineno="10537"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">switch</highlight><highlight class="normal">(pProfile-&gt;m_Header.deviceClass)</highlight></codeline>
<codeline lineno="10538"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>{</highlight></codeline>
<codeline lineno="10539"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a787f32c0c9368bc8c4e85a670ae91c8d" kindref="member">icSigInputClass</ref>:</highlight></codeline>
<codeline lineno="10540"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0aeb74955777b1abe38df700474c7be5ce" kindref="member">icSigMaterialIdentificationClass</ref>:</highlight></codeline>
<codeline lineno="10541"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="10542"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.mcs;</highlight></codeline>
<codeline lineno="10543"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10544"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a349ff3baa7f838df9ba2e6a2200aa55f" kindref="member">icSigMaterialVisualizationClass</ref>:</highlight></codeline>
<codeline lineno="10545"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.mcs;</highlight></codeline>
<codeline lineno="10546"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bUseD2BxB2DxTags<sp/>&amp;&amp;<sp/>pProfile-&gt;m_Header.spectralPCS)<sp/>{</highlight></codeline>
<codeline lineno="10547"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.spectralPCS;</highlight></codeline>
<codeline lineno="10548"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10549"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10550"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>pProfile-&gt;m_Header.pcs;</highlight></codeline>
<codeline lineno="10551"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10552"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10553"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10554"><highlight class="normal"></highlight></codeline>
<codeline lineno="10555"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">case</highlight><highlight class="normal"><sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0a8b2deae24b9246ac33314b42ad02ac48" kindref="member">icSigMaterialLinkClass</ref>:</highlight></codeline>
<codeline lineno="10556"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nSrcSpace<sp/>=<sp/>(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref>)pProfile-&gt;m_Header.mcs;</highlight></codeline>
<codeline lineno="10557"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDstSpace<sp/>=<sp/>pProfile-&gt;m_Header.colorSpace;</highlight></codeline>
<codeline lineno="10558"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10559"><highlight class="normal"></highlight></codeline>
<codeline lineno="10560"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="10561"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a0a3d499218e996db890cba097db15f3b" kindref="member">icCmmStatBadLutType</ref>;</highlight></codeline>
<codeline lineno="10562"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10563"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">break</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10564"><highlight class="normal"></highlight></codeline>
<codeline lineno="10565"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">default</highlight><highlight class="normal">:</highlight></codeline>
<codeline lineno="10566"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a0a3d499218e996db890cba097db15f3b" kindref="member">icCmmStatBadLutType</ref>;</highlight></codeline>
<codeline lineno="10567"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10568"><highlight class="normal"></highlight></codeline>
<codeline lineno="10569"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Make<sp/>sure<sp/>color<sp/>spaces<sp/>match<sp/>with<sp/>previous<sp/>xforms</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10570"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Xforms-&gt;size())<sp/>{</highlight></codeline>
<codeline lineno="10571"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nSrcSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10572"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_nLastSpace<sp/>=<sp/>nSrcSpace;</highlight></codeline>
<codeline lineno="10573"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_nSrcSpace<sp/>=<sp/>nSrcSpace;</highlight></codeline>
<codeline lineno="10574"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10575"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d3/df8/a00155_1a1376d1bc8bb70237fde226cb6f49872c" kindref="member">IsCompatSpace</ref>(m_nSrcSpace,<sp/>nSrcSpace)<sp/>&amp;&amp;<sp/>!<ref refid="d3/df8/a00155_1ab304d4f0fe0c22e5b3e078e9ab1e7085" kindref="member">IsNChannelCompat</ref>(m_nSrcSpace,<sp/>nSrcSpace))<sp/>{</highlight></codeline>
<codeline lineno="10576"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="10577"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10578"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10579"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d3/df8/a00155_1a1376d1bc8bb70237fde226cb6f49872c" kindref="member">IsCompatSpace</ref>(m_nLastSpace,<sp/>nSrcSpace)<sp/>&amp;&amp;<sp/>!<ref refid="d3/df8/a00155_1ab304d4f0fe0c22e5b3e078e9ab1e7085" kindref="member">IsNChannelCompat</ref>(m_nSrcSpace,<sp/>nSrcSpace))<sp/><sp/>{</highlight></codeline>
<codeline lineno="10580"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="10581"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10582"><highlight class="normal"></highlight></codeline>
<codeline lineno="10583"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_Xforms-&gt;size())</highlight></codeline>
<codeline lineno="10584"><highlight class="normal"><sp/><sp/><sp/><sp/>m_nSrcSpace<sp/>=<sp/>nSrcSpace;</highlight></codeline>
<codeline lineno="10585"><highlight class="normal"></highlight></codeline>
<codeline lineno="10586"><highlight class="normal"><sp/><sp/>m_nDestSpace<sp/>=<sp/>nDstSpace;</highlight></codeline>
<codeline lineno="10587"><highlight class="normal"></highlight></codeline>
<codeline lineno="10588"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//Automatic<sp/>creation<sp/>of<sp/>intent<sp/>from<sp/>header/last<sp/>profile</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10589"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nIntent==<ref refid="d7/d46/a00002_1a0fbdbf76357f4ad739b1df71bd87ef8a" kindref="member">icUnknownIntent</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10590"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bInput)<sp/>{</highlight></codeline>
<codeline lineno="10591"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/>(<ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77" kindref="member">icRenderingIntent</ref>)pProfile-&gt;m_Header.renderingIntent;</highlight></codeline>
<codeline lineno="10592"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10593"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10594"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/>m_nLastIntent;</highlight></codeline>
<codeline lineno="10595"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10596"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nIntent<sp/>==<sp/><ref refid="d7/d46/a00002_1a0fbdbf76357f4ad739b1df71bd87ef8a" kindref="member">icUnknownIntent</ref>)</highlight></codeline>
<codeline lineno="10597"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>nIntent<sp/>=<sp/><ref refid="d7/d46/a00002_1ad596b62f264ef4846d435b494c8d2a77a300c7e86384819a2318614c61c20a112" kindref="member">icPerceptual</ref>;</highlight></codeline>
<codeline lineno="10598"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10599"><highlight class="normal"></highlight></codeline>
<codeline lineno="10600"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Xform.ptr)</highlight></codeline>
<codeline lineno="10601"><highlight class="normal"><sp/><sp/><sp/><sp/>Xform.ptr<sp/>=<sp/>CIccXform::Create(pProfile,<sp/>bInput,<sp/>nIntent,<sp/>nInterp,<sp/>pPcc,<sp/>nUseLutType,<sp/>bUseD2BxB2DxTags,<sp/>pHintManager);</highlight></codeline>
<codeline lineno="10602"><highlight class="normal"></highlight></codeline>
<codeline lineno="10603"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!Xform.ptr)<sp/>{</highlight></codeline>
<codeline lineno="10604"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="10605"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10606"><highlight class="normal"></highlight></codeline>
<codeline lineno="10607"><highlight class="normal"><sp/><sp/>m_nLastSpace<sp/>=<sp/>Xform.ptr-&gt;GetDstSpace();</highlight></codeline>
<codeline lineno="10608"><highlight class="normal"><sp/><sp/>m_nLastIntent<sp/>=<sp/>nIntent;</highlight></codeline>
<codeline lineno="10609"><highlight class="normal"></highlight></codeline>
<codeline lineno="10610"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pProfile-&gt;m_Header.deviceClass<sp/>==<sp/><ref refid="d7/d46/a00002_1a1cc0ddb4770d5695c83543b62afaa1a0af50c13fdfab9fcc0a7b831ac86d1fe3b" kindref="member">icSigLinkClass</ref>)</highlight></codeline>
<codeline lineno="10611"><highlight class="normal"><sp/><sp/><sp/><sp/>bInput<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10612"><highlight class="normal"><sp/><sp/>m_bLastInput<sp/>=<sp/>bInput;</highlight></codeline>
<codeline lineno="10613"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="10614"><highlight class="normal"><sp/><sp/>m_Xforms-&gt;push_back(Xform);</highlight></codeline>
<codeline lineno="10615"><highlight class="normal"></highlight></codeline>
<codeline lineno="10616"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="10617"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10618"><highlight class="normal"></highlight></codeline>
<codeline lineno="10629"><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccNamedColorCmm::Begin(</highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bAllocNewApply</highlight><highlight class="comment">/*<sp/>=true<sp/>*/</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bUsePcsConversion</highlight><highlight class="comment">/*=false*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="10630"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10631"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nDestSpace==<ref refid="d7/d46/a00002_1a80236e8e78fa1f2a6351cb0af0fed8da" kindref="member">icSigUnknownData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10632"><highlight class="normal"><sp/><sp/><sp/><sp/>m_nDestSpace<sp/>=<sp/>m_nLastSpace;</highlight></codeline>
<codeline lineno="10633"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10634"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!<ref refid="d3/df8/a00155_1a1376d1bc8bb70237fde226cb6f49872c" kindref="member">IsCompatSpace</ref>(m_nDestSpace,<sp/>m_nLastSpace)<sp/>&amp;&amp;<sp/>!<ref refid="d3/df8/a00155_1a95cfb076604d7bea59905ba50253b1d2" kindref="member">IsCompatSpacePCS</ref>(m_nDestSpace,<sp/>m_nLastSpace))<sp/>{</highlight></codeline>
<codeline lineno="10635"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="10636"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10637"><highlight class="normal"></highlight></codeline>
<codeline lineno="10638"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nSrcSpace<sp/>!=<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10639"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nDestSpace<sp/>!=<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10640"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_nApplyInterface<sp/>=<sp/>icApplyPixel2Pixel;</highlight></codeline>
<codeline lineno="10641"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10642"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10643"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_nApplyInterface<sp/>=<sp/>icApplyPixel2Named;</highlight></codeline>
<codeline lineno="10644"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10645"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10646"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10647"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_nDestSpace<sp/>!=<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10648"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_nApplyInterface<sp/>=<sp/>icApplyNamed2Pixel;</highlight></codeline>
<codeline lineno="10649"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10650"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10651"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_nApplyInterface<sp/>=<sp/>icApplyNamed2Named;</highlight></codeline>
<codeline lineno="10652"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10653"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10654"><highlight class="normal"></highlight></codeline>
<codeline lineno="10655"><highlight class="normal"><sp/><sp/>CheckPCSRangeConversions();</highlight></codeline>
<codeline lineno="10656"><highlight class="normal"><sp/><sp/>SetLateBindingCC();</highlight></codeline>
<codeline lineno="10657"><highlight class="normal"></highlight></codeline>
<codeline lineno="10658"><highlight class="normal"><sp/><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>rv;</highlight></codeline>
<codeline lineno="10659"><highlight class="normal"><sp/><sp/>CIccXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="10660"><highlight class="normal"></highlight></codeline>
<codeline lineno="10661"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=m_Xforms-&gt;begin();<sp/>i!=m_Xforms-&gt;end();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="10662"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/>i-&gt;ptr-&gt;Begin();</highlight></codeline>
<codeline lineno="10663"><highlight class="normal"></highlight></codeline>
<codeline lineno="10664"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10665"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10666"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10667"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10668"><highlight class="normal"></highlight></codeline>
<codeline lineno="10669"><highlight class="normal"><sp/><sp/>rv<sp/>=<sp/>CheckPCSConnections(bUsePcsConversion);</highlight></codeline>
<codeline lineno="10670"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref><sp/>&amp;&amp;<sp/>rv!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6abde204e63a929aa02c77393887f05b10" kindref="member">icCmmStatIdentityXform</ref>)</highlight></codeline>
<codeline lineno="10671"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10672"><highlight class="normal"></highlight></codeline>
<codeline lineno="10673"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bAllocNewApply)<sp/>{</highlight></codeline>
<codeline lineno="10674"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="10675"><highlight class="normal"></highlight></codeline>
<codeline lineno="10676"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pApply<sp/>=<sp/>GetNewApplyCmm(rv);</highlight></codeline>
<codeline lineno="10677"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10678"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="10679"><highlight class="normal"><sp/><sp/><sp/><sp/>rv<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="10680"><highlight class="normal"></highlight></codeline>
<codeline lineno="10681"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10682"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10683"><highlight class="normal"></highlight></codeline>
<codeline lineno="10694"><highlight class="normal"><sp/>CIccApplyCmm<sp/>*CIccNamedColorCmm::GetNewApplyCmm(<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>&amp;status)</highlight></codeline>
<codeline lineno="10695"><highlight class="normal"><sp/>{</highlight></codeline>
<codeline lineno="10696"><highlight class="normal"><sp/><sp/>CIccApplyCmm<sp/>*pApply<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccApplyNamedColorCmm(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="10697"><highlight class="normal"></highlight></codeline>
<codeline lineno="10698"><highlight class="normal"><sp/><sp/>CIccXformList::iterator<sp/>i;</highlight></codeline>
<codeline lineno="10699"><highlight class="normal"></highlight></codeline>
<codeline lineno="10700"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(i=m_Xforms-&gt;begin();<sp/>i!=m_Xforms-&gt;end();<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="10701"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccApplyXform<sp/>*pXform<sp/>=<sp/>i-&gt;ptr-&gt;GetNewApply(status);</highlight></codeline>
<codeline lineno="10702"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(status<sp/>!=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref><sp/>||<sp/>!pXform)<sp/>{</highlight></codeline>
<codeline lineno="10703"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pApply;</highlight></codeline>
<codeline lineno="10704"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="10705"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10706"><highlight class="normal"><sp/><sp/><sp/><sp/>pApply-&gt;AppendApplyXform(pXform);</highlight></codeline>
<codeline lineno="10707"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10708"><highlight class="normal"></highlight></codeline>
<codeline lineno="10709"><highlight class="normal"><sp/><sp/>m_bValid<sp/>=<sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10710"><highlight class="normal"></highlight></codeline>
<codeline lineno="10711"><highlight class="normal"><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="10712"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pApply;</highlight></codeline>
<codeline lineno="10713"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10714"><highlight class="normal"></highlight></codeline>
<codeline lineno="10715"><highlight class="normal"></highlight></codeline>
<codeline lineno="10728"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccNamedColorCmm::Apply(<ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref>*<sp/>DstColorName,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight></codeline>
<codeline lineno="10729"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10730"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((CIccApplyNamedColorCmm*)m_pApply)-&gt;Apply(DstColorName,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="10731"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10732"><highlight class="normal"></highlight></codeline>
<codeline lineno="10733"><highlight class="normal"></highlight></codeline>
<codeline lineno="10746"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccNamedColorCmm::Apply(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref><sp/>*SrcColorName,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>tint</highlight><highlight class="comment">/*=1.0*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="10747"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10748"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((CIccApplyNamedColorCmm*)m_pApply)-&gt;Apply(DstPixel,<sp/>SrcColorName,<sp/>tint);</highlight></codeline>
<codeline lineno="10749"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10750"><highlight class="normal"></highlight></codeline>
<codeline lineno="10751"><highlight class="normal"></highlight></codeline>
<codeline lineno="10764"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccNamedColorCmm::Apply(<ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref>*<sp/>DstColorName,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a706623de1338f49b9c9cf7bed2eab0f2" kindref="member">icChar</ref><sp/>*SrcColorName,<sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>tint</highlight><highlight class="comment">/*=1.0*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="10765"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10766"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>((CIccApplyNamedColorCmm*)m_pApply)-&gt;Apply(DstColorName,<sp/>SrcColorName,<sp/>tint);</highlight></codeline>
<codeline lineno="10767"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10768"><highlight class="normal"></highlight></codeline>
<codeline lineno="10769"><highlight class="normal"></highlight></codeline>
<codeline lineno="10781"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccNamedColorCmm::SetLastXformDest(<ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917" kindref="member">icColorSpaceSignature</ref><sp/>nDestSpace)</highlight></codeline>
<codeline lineno="10782"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10783"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>n<sp/>=<sp/>(int)m_Xforms-&gt;size();</highlight></codeline>
<codeline lineno="10784"><highlight class="normal"><sp/><sp/>CIccXformPtr<sp/>*pLastXform;</highlight></codeline>
<codeline lineno="10785"><highlight class="normal"></highlight></codeline>
<codeline lineno="10786"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!n)</highlight></codeline>
<codeline lineno="10787"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="10788"><highlight class="normal"></highlight></codeline>
<codeline lineno="10789"><highlight class="normal"><sp/><sp/>pLastXform<sp/>=<sp/>&amp;m_Xforms-&gt;back();</highlight></codeline>
<codeline lineno="10790"><highlight class="normal"><sp/><sp/></highlight></codeline>
<codeline lineno="10791"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pLastXform-&gt;ptr-&gt;GetXformType()==<ref refid="d6/d5b/a00026_1ae7ce272997e0752433886bd1019e180fab62b1740975a1ebc27bdf3b6c87003eb" kindref="member">icXformTypeNamedColor</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10792"><highlight class="normal"><sp/><sp/><sp/><sp/>CIccXformNamedColor<sp/>*pXform<sp/>=<sp/>(CIccXformNamedColor<sp/>*)pLastXform-&gt;ptr;</highlight></codeline>
<codeline lineno="10793"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(pXform-&gt;GetSrcSpace()<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="10794"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>nDestSpace<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10795"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="10796"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10797"><highlight class="normal"></highlight></codeline>
<codeline lineno="10798"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(nDestSpace<sp/>!=<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref><sp/>&amp;&amp;</highlight></codeline>
<codeline lineno="10799"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>pXform-&gt;GetDstSpace()<sp/>==<sp/><ref refid="d7/d46/a00002_1a61e8bac86860cdefe93533feac126917aa23b5cd6907746734b71b3a5eb2034f3" kindref="member">icSigNamedData</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10800"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a5df35fc61fbf87722e407534d009f4e6" kindref="member">icCmmStatBadSpaceLink</ref>;</highlight></codeline>
<codeline lineno="10801"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="10802"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight></codeline>
<codeline lineno="10803"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>pXform-&gt;SetDestSpace(nDestSpace);</highlight></codeline>
<codeline lineno="10804"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10805"><highlight class="normal"></highlight></codeline>
<codeline lineno="10806"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6a9e86bf6fd9802404765cfa5a679a6fc3" kindref="member">icCmmStatBadXform</ref>;</highlight></codeline>
<codeline lineno="10807"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10808"><highlight class="normal"></highlight></codeline>
<codeline lineno="10809"><highlight class="normal"></highlight></codeline>
<codeline lineno="10817"><highlight class="normal">CIccMruCmm::CIccMruCmm()</highlight></codeline>
<codeline lineno="10818"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10819"><highlight class="normal"><sp/><sp/>m_pCmm<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="10820"><highlight class="normal"><sp/><sp/>m_bDeleteCmm<sp/>=<sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10821"><highlight class="normal"><sp/><sp/>m_nCacheSize<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="10822"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10823"><highlight class="normal"></highlight></codeline>
<codeline lineno="10824"><highlight class="normal"></highlight></codeline>
<codeline lineno="10832"><highlight class="normal">CIccMruCmm::~CIccMruCmm()</highlight></codeline>
<codeline lineno="10833"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10834"><highlight class="normal"><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pCmm<sp/>&amp;&amp;<sp/>m_bDeleteCmm)</highlight></codeline>
<codeline lineno="10835"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_pCmm;</highlight></codeline>
<codeline lineno="10836"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10837"><highlight class="normal"></highlight></codeline>
<codeline lineno="10838"><highlight class="normal"></highlight></codeline>
<codeline lineno="10859"><highlight class="normal">CIccMruCmm*<sp/>CIccMruCmm::Attach(CIccCmm<sp/>*pCmm,<sp/><ref refid="d7/d46/a00002_1a0462ca2992be7c80b056e640a192b325" kindref="member">icUInt8Number</ref><sp/>nCacheSize</highlight><highlight class="comment">/*<sp/>=4<sp/>*/</highlight><highlight class="normal">,<sp/></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>bDeleteCmm</highlight><highlight class="comment">/*=true*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="10860"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10861"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pCmm<sp/>||<sp/>!nCacheSize)</highlight></codeline>
<codeline lineno="10862"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="10863"><highlight class="normal"></highlight></codeline>
<codeline lineno="10864"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!pCmm-&gt;Valid())<sp/>{</highlight></codeline>
<codeline lineno="10865"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(bDeleteCmm)</highlight></codeline>
<codeline lineno="10866"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>pCmm;</highlight></codeline>
<codeline lineno="10867"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="10868"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10869"><highlight class="normal"></highlight></codeline>
<codeline lineno="10870"><highlight class="normal"><sp/><sp/>CIccMruCmm<sp/>*rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccMruCmm();</highlight></codeline>
<codeline lineno="10871"><highlight class="normal"></highlight></codeline>
<codeline lineno="10872"><highlight class="normal"><sp/><sp/>rv-&gt;m_pCmm<sp/>=<sp/>pCmm;</highlight></codeline>
<codeline lineno="10873"><highlight class="normal"><sp/><sp/>rv-&gt;m_nCacheSize<sp/>=<sp/>nCacheSize;</highlight></codeline>
<codeline lineno="10874"><highlight class="normal"><sp/><sp/>rv-&gt;m_bDeleteCmm<sp/>=<sp/>bDeleteCmm;</highlight></codeline>
<codeline lineno="10875"><highlight class="normal"></highlight></codeline>
<codeline lineno="10876"><highlight class="normal"><sp/><sp/>rv-&gt;m_nSrcSpace<sp/>=<sp/>pCmm-&gt;GetSourceSpace();</highlight></codeline>
<codeline lineno="10877"><highlight class="normal"><sp/><sp/>rv-&gt;m_nDestSpace<sp/>=<sp/>pCmm-&gt;GetDestSpace();</highlight></codeline>
<codeline lineno="10878"><highlight class="normal"><sp/><sp/>rv-&gt;m_nLastSpace<sp/>=<sp/>pCmm-&gt;GetLastSpace();</highlight></codeline>
<codeline lineno="10879"><highlight class="normal"><sp/><sp/>rv-&gt;m_nLastIntent<sp/>=<sp/>pCmm-&gt;GetLastIntent();</highlight></codeline>
<codeline lineno="10880"><highlight class="normal"></highlight></codeline>
<codeline lineno="10881"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(rv-&gt;Begin()!=<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>)<sp/>{</highlight></codeline>
<codeline lineno="10882"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10883"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="10884"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10885"><highlight class="normal"></highlight></codeline>
<codeline lineno="10886"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10887"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10888"><highlight class="normal"></highlight></codeline>
<codeline lineno="10889"><highlight class="normal">CIccApplyCmm<sp/>*CIccMruCmm::GetNewApplyCmm(<ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>&amp;status)</highlight></codeline>
<codeline lineno="10890"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10891"><highlight class="normal"><sp/><sp/>CIccApplyMruCmm<sp/>*rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccApplyMruCmm(</highlight><highlight class="keyword">this</highlight><highlight class="normal">);</highlight></codeline>
<codeline lineno="10892"><highlight class="normal"></highlight></codeline>
<codeline lineno="10893"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!rv)<sp/>{</highlight></codeline>
<codeline lineno="10894"><highlight class="normal"><sp/><sp/><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae8556280eb83ef081abc996fcb06b81d" kindref="member">icCmmStatAllocErr</ref>;</highlight></codeline>
<codeline lineno="10895"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="10896"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10897"><highlight class="normal"></highlight></codeline>
<codeline lineno="10898"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!rv-&gt;Init(m_pCmm,<sp/>m_nCacheSize))<sp/>{</highlight></codeline>
<codeline lineno="10899"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10900"><highlight class="normal"><sp/><sp/><sp/><sp/>status<sp/>=<sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6aa1b3e92b9f8f78ad52846a217a262f72" kindref="member">icCmmStatBad</ref>;</highlight></codeline>
<codeline lineno="10901"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="10902"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10903"><highlight class="normal"></highlight></codeline>
<codeline lineno="10904"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10905"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10906"><highlight class="normal"></highlight></codeline>
<codeline lineno="10914"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="10915"><highlight class="normal">CIccMruCache&lt;T&gt;::CIccMruCache()</highlight></codeline>
<codeline lineno="10916"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10917"><highlight class="normal"><sp/><sp/>m_cache<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="10918"><highlight class="normal"><sp/><sp/>m_nNumPixel<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="10919"><highlight class="normal"><sp/><sp/>m_pixelData<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="10920"><highlight class="normal"><sp/><sp/>m_nSrcSamples<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="10921"><highlight class="normal"><sp/><sp/>m_pFirst<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="10922"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10923"><highlight class="normal"></highlight></codeline>
<codeline lineno="10931"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="10932"><highlight class="normal">CIccMruCache&lt;T&gt;::~CIccMruCache()</highlight></codeline>
<codeline lineno="10933"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10934"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_cache)</highlight></codeline>
<codeline lineno="10935"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal">[]<sp/>m_cache;</highlight></codeline>
<codeline lineno="10936"><highlight class="normal"></highlight></codeline>
<codeline lineno="10937"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pixelData)</highlight></codeline>
<codeline lineno="10938"><highlight class="normal"><sp/><sp/><sp/><sp/>free(m_pixelData);</highlight></codeline>
<codeline lineno="10939"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10940"><highlight class="normal"></highlight></codeline>
<codeline lineno="10955"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="10956"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccMruCache&lt;T&gt;::Init(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nSrcSamples,<sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nDstSamples,<sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nCacheSize)</highlight></codeline>
<codeline lineno="10957"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10958"><highlight class="normal"><sp/><sp/>m_nSrcSamples<sp/>=<sp/>nSrcSamples;</highlight></codeline>
<codeline lineno="10959"><highlight class="normal"><sp/><sp/>m_nSrcSize<sp/>=<sp/>nSrcSamples<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T);</highlight></codeline>
<codeline lineno="10960"><highlight class="normal"><sp/><sp/>m_nDstSize<sp/>=<sp/>nDstSamples<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T);</highlight></codeline>
<codeline lineno="10961"><highlight class="normal"></highlight></codeline>
<codeline lineno="10962"><highlight class="normal"><sp/><sp/>m_nTotalSamples<sp/>=<sp/>m_nSrcSamples<sp/>+<sp/>nDstSamples;</highlight></codeline>
<codeline lineno="10963"><highlight class="normal"></highlight></codeline>
<codeline lineno="10964"><highlight class="normal"><sp/><sp/>m_nNumPixel<sp/>=<sp/>0;</highlight></codeline>
<codeline lineno="10965"><highlight class="normal"><sp/><sp/>m_nCacheSize<sp/>=<sp/>nCacheSize;</highlight></codeline>
<codeline lineno="10966"><highlight class="normal"></highlight></codeline>
<codeline lineno="10967"><highlight class="normal"><sp/><sp/>m_pFirst<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="10968"><highlight class="normal"><sp/><sp/>m_cache<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccMruPixel&lt;T&gt;[nCacheSize];</highlight></codeline>
<codeline lineno="10969"><highlight class="normal"></highlight></codeline>
<codeline lineno="10970"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_cache)</highlight></codeline>
<codeline lineno="10971"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10972"><highlight class="normal"></highlight></codeline>
<codeline lineno="10973"><highlight class="normal"><sp/><sp/>m_pixelData<sp/>=<sp/>(T*)malloc((</highlight><highlight class="keywordtype">int</highlight><highlight class="normal">)nCacheSize<sp/>*<sp/>m_nTotalSamples<sp/>*<sp/></highlight><highlight class="keyword">sizeof</highlight><highlight class="normal">(T));</highlight></codeline>
<codeline lineno="10974"><highlight class="normal"></highlight></codeline>
<codeline lineno="10975"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pixelData)</highlight></codeline>
<codeline lineno="10976"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10977"><highlight class="normal"></highlight></codeline>
<codeline lineno="10978"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="10979"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10980"><highlight class="normal"></highlight></codeline>
<codeline lineno="10981"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="10982"><highlight class="normal">CIccMruCache&lt;T&gt;<sp/>*CIccMruCache&lt;T&gt;::NewMruCache(<ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nSrcSamples,<sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nDstSamples,<sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nCacheSize<sp/></highlight><highlight class="comment">/*<sp/>=<sp/>4<sp/>*/</highlight><highlight class="normal">)</highlight></codeline>
<codeline lineno="10983"><highlight class="normal">{</highlight></codeline>
<codeline lineno="10984"><highlight class="normal"><sp/><sp/>CIccMruCache&lt;T&gt;<sp/>*rv<sp/>=<sp/></highlight><highlight class="keyword">new</highlight><highlight class="normal"><sp/>CIccMruCache&lt;T&gt;;</highlight></codeline>
<codeline lineno="10985"><highlight class="normal"></highlight></codeline>
<codeline lineno="10986"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!rv-&gt;Init(nSrcSamples,<sp/>nDstSamples,<sp/>nCacheSize))<sp/>{</highlight></codeline>
<codeline lineno="10987"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10988"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>NULL;</highlight></codeline>
<codeline lineno="10989"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="10990"><highlight class="normal"></highlight></codeline>
<codeline lineno="10991"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/>rv;</highlight></codeline>
<codeline lineno="10992"><highlight class="normal">}</highlight></codeline>
<codeline lineno="10993"><highlight class="normal"></highlight></codeline>
<codeline lineno="11009"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="11010"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccMruCache&lt;T&gt;::Apply(T<sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/>T<sp/>*SrcPixel)</highlight></codeline>
<codeline lineno="11011"><highlight class="normal">{</highlight></codeline>
<codeline lineno="11012"><highlight class="normal"><sp/><sp/>CIccMruPixel&lt;T&gt;<sp/>*ptr,<sp/>*prev<sp/>=<sp/>NULL,<sp/>*last<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="11013"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordtype">int</highlight><highlight class="normal"><sp/>i;</highlight></codeline>
<codeline lineno="11014"><highlight class="normal"><sp/><sp/>T<sp/>*pixel;</highlight></codeline>
<codeline lineno="11015"><highlight class="normal"></highlight></codeline>
<codeline lineno="11016"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(ptr<sp/>=<sp/>m_pFirst,<sp/>i<sp/>=<sp/>0;<sp/>ptr;<sp/>ptr<sp/>=<sp/>ptr-&gt;pNext,<sp/>i++)<sp/>{</highlight></codeline>
<codeline lineno="11017"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!memcmp(SrcPixel,<sp/>ptr-&gt;pPixelData,<sp/>m_nSrcSize))<sp/>{</highlight></codeline>
<codeline lineno="11018"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>memcpy(DstPixel,<sp/>&amp;ptr-&gt;pPixelData[m_nSrcSamples],<sp/>m_nDstSize);</highlight></codeline>
<codeline lineno="11019"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(ptr<sp/>!=<sp/>m_pFirst)<sp/>{</highlight></codeline>
<codeline lineno="11020"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>last-&gt;pNext<sp/>=<sp/>ptr-&gt;pNext;</highlight></codeline>
<codeline lineno="11021"><highlight class="normal"></highlight></codeline>
<codeline lineno="11022"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>ptr-&gt;pNext<sp/>=<sp/>m_pFirst;</highlight></codeline>
<codeline lineno="11023"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/><sp/><sp/>m_pFirst<sp/>=<sp/>ptr;</highlight></codeline>
<codeline lineno="11024"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="11025"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="11026"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="11027"><highlight class="normal"><sp/><sp/><sp/><sp/>prev<sp/>=<sp/>last;</highlight></codeline>
<codeline lineno="11028"><highlight class="normal"><sp/><sp/><sp/><sp/>last<sp/>=<sp/>ptr;</highlight></codeline>
<codeline lineno="11029"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="11030"><highlight class="normal"></highlight></codeline>
<codeline lineno="11031"><highlight class="normal"><sp/><sp/></highlight><highlight class="comment">//If<sp/>we<sp/>get<sp/>here<sp/>SrcPixel<sp/>is<sp/>not<sp/>in<sp/>the<sp/>cache</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11032"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(i<sp/>&lt;<sp/>m_nCacheSize)<sp/>{</highlight></codeline>
<codeline lineno="11033"><highlight class="normal"><sp/><sp/><sp/><sp/>pixel<sp/>=<sp/>&amp;m_pixelData[i*m_nTotalSamples];</highlight></codeline>
<codeline lineno="11034"><highlight class="normal"></highlight></codeline>
<codeline lineno="11035"><highlight class="normal"><sp/><sp/><sp/><sp/>ptr<sp/>=<sp/>&amp;m_cache[i];</highlight></codeline>
<codeline lineno="11036"><highlight class="normal"><sp/><sp/><sp/><sp/>ptr-&gt;pPixelData<sp/>=<sp/>pixel;</highlight></codeline>
<codeline lineno="11037"><highlight class="normal"></highlight></codeline>
<codeline lineno="11038"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pFirst)<sp/>{</highlight></codeline>
<codeline lineno="11039"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>ptr-&gt;pNext<sp/>=<sp/>m_pFirst;</highlight></codeline>
<codeline lineno="11040"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="11041"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pFirst<sp/>=<sp/>ptr;</highlight></codeline>
<codeline lineno="11042"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="11043"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">else</highlight><highlight class="normal"><sp/>{<sp/><sp/></highlight><highlight class="comment">//Reuse<sp/>oldest<sp/>value<sp/>and<sp/>put<sp/>it<sp/>at<sp/>the<sp/>front<sp/>of<sp/>the<sp/>list</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11044"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(prev)</highlight></codeline>
<codeline lineno="11045"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>prev-&gt;pNext<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="11046"><highlight class="normal"><sp/><sp/><sp/><sp/>last-&gt;pNext<sp/>=<sp/>m_pFirst;</highlight></codeline>
<codeline lineno="11047"><highlight class="normal"></highlight></codeline>
<codeline lineno="11048"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pFirst<sp/>=<sp/>last;</highlight></codeline>
<codeline lineno="11049"><highlight class="normal"><sp/><sp/><sp/><sp/>pixel<sp/>=<sp/>last-&gt;pPixelData;</highlight></codeline>
<codeline lineno="11050"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="11051"><highlight class="normal"><sp/><sp/>T<sp/>*dest<sp/>=<sp/>&amp;pixel[m_nSrcSamples];</highlight></codeline>
<codeline lineno="11052"><highlight class="normal"></highlight></codeline>
<codeline lineno="11053"><highlight class="normal"><sp/><sp/>memcpy(pixel,<sp/>SrcPixel,<sp/>m_nSrcSize);</highlight></codeline>
<codeline lineno="11054"><highlight class="normal"></highlight></codeline>
<codeline lineno="11055"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="11056"><highlight class="normal">}</highlight></codeline>
<codeline lineno="11057"><highlight class="normal"></highlight></codeline>
<codeline lineno="11058"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal">&lt;</highlight><highlight class="keyword">class</highlight><highlight class="normal"><sp/>T&gt;</highlight></codeline>
<codeline lineno="11059"><highlight class="normal"></highlight><highlight class="keywordtype">void</highlight><highlight class="normal"><sp/>CIccMruCache&lt;T&gt;::Update(T*<sp/>DstPixel)</highlight></codeline>
<codeline lineno="11060"><highlight class="normal">{</highlight></codeline>
<codeline lineno="11061"><highlight class="normal"><sp/><sp/>memcpy(&amp;m_pFirst-&gt;pPixelData[m_nSrcSamples],<sp/>DstPixel,<sp/>m_nDstSize);</highlight></codeline>
<codeline lineno="11062"><highlight class="normal">}</highlight></codeline>
<codeline lineno="11063"><highlight class="normal"></highlight></codeline>
<codeline lineno="11064"><highlight class="normal"></highlight><highlight class="comment">//Make<sp/>sure<sp/>typedef<sp/>classes<sp/>get<sp/>built</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11065"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">CIccMruCache&lt;icFloatNumber&gt;;</highlight></codeline>
<codeline lineno="11066"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">CIccMruCache&lt;icUInt8Number&gt;;</highlight></codeline>
<codeline lineno="11067"><highlight class="normal"></highlight><highlight class="keyword">template</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">class<sp/></highlight><highlight class="normal">CIccMruCache&lt;icUInt16Number&gt;;</highlight></codeline>
<codeline lineno="11068"><highlight class="normal"></highlight></codeline>
<codeline lineno="11069"><highlight class="normal"></highlight></codeline>
<codeline lineno="11070"><highlight class="normal">CIccApplyMruCmm::CIccApplyMruCmm(CIccMruCmm<sp/>*pCmm)<sp/>:<sp/>CIccApplyCmm(pCmm)</highlight></codeline>
<codeline lineno="11071"><highlight class="normal">{</highlight></codeline>
<codeline lineno="11072"><highlight class="normal"><sp/><sp/>m_pCachedCmm<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="11073"><highlight class="normal"><sp/><sp/>m_pCache<sp/>=<sp/>NULL;</highlight></codeline>
<codeline lineno="11074"><highlight class="normal">}</highlight></codeline>
<codeline lineno="11075"><highlight class="normal"></highlight></codeline>
<codeline lineno="11083"><highlight class="normal">CIccApplyMruCmm::~CIccApplyMruCmm()</highlight></codeline>
<codeline lineno="11084"><highlight class="normal">{</highlight></codeline>
<codeline lineno="11085"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(m_pCache)</highlight></codeline>
<codeline lineno="11086"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keyword">delete</highlight><highlight class="normal"><sp/>m_pCache;</highlight></codeline>
<codeline lineno="11087"><highlight class="normal"></highlight></codeline>
<codeline lineno="11088"><highlight class="normal">}</highlight></codeline>
<codeline lineno="11089"><highlight class="normal"></highlight></codeline>
<codeline lineno="11104"><highlight class="normal"></highlight><highlight class="keywordtype">bool</highlight><highlight class="normal"><sp/>CIccApplyMruCmm::Init(CIccCmm<sp/>*pCachedCmm,<sp/><ref refid="d7/d46/a00002_1a13b7fe380f7b096933ceaaa7a1e1e3ef" kindref="member">icUInt16Number</ref><sp/>nCacheSize)</highlight></codeline>
<codeline lineno="11105"><highlight class="normal">{</highlight></codeline>
<codeline lineno="11106"><highlight class="normal"><sp/><sp/>m_pCachedCmm<sp/>=<sp/>pCachedCmm;</highlight></codeline>
<codeline lineno="11107"><highlight class="normal"></highlight></codeline>
<codeline lineno="11108"><highlight class="normal"><sp/><sp/>m_pCache<sp/>=<sp/>CIccMruCacheFloat::NewMruCache(m_pCmm-&gt;GetSourceSamples(),<sp/>m_pCmm-&gt;GetDestSamples(),<sp/>nCacheSize);</highlight></codeline>
<codeline lineno="11109"><highlight class="normal"></highlight></codeline>
<codeline lineno="11110"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pCache)</highlight></codeline>
<codeline lineno="11111"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">false</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="11112"><highlight class="normal"></highlight></codeline>
<codeline lineno="11113"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/></highlight><highlight class="keyword">true</highlight><highlight class="normal">;</highlight></codeline>
<codeline lineno="11114"><highlight class="normal">}</highlight></codeline>
<codeline lineno="11115"><highlight class="normal"></highlight></codeline>
<codeline lineno="11130"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccApplyMruCmm::Apply(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel)</highlight></codeline>
<codeline lineno="11131"><highlight class="normal">{</highlight></codeline>
<codeline lineno="11132"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>defined(_DEBUG)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11133"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pCache)</highlight></codeline>
<codeline lineno="11134"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096" kindref="member">icCmmStatInvalidLut</ref>;</highlight></codeline>
<codeline lineno="11135"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11136"><highlight class="normal"></highlight></codeline>
<codeline lineno="11137"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pCache-&gt;Apply(DstPixel,<sp/>SrcPixel))<sp/>{</highlight></codeline>
<codeline lineno="11138"><highlight class="normal"></highlight></codeline>
<codeline lineno="11139"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pCachedCmm-&gt;Apply(DstPixel,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="11140"><highlight class="normal"></highlight></codeline>
<codeline lineno="11141"><highlight class="normal"><sp/><sp/><sp/><sp/>m_pCache-&gt;Update(DstPixel);</highlight></codeline>
<codeline lineno="11142"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="11143"><highlight class="normal"></highlight></codeline>
<codeline lineno="11144"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="11145"><highlight class="normal">}</highlight></codeline>
<codeline lineno="11146"><highlight class="normal"></highlight></codeline>
<codeline lineno="11162"><highlight class="normal"><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6" kindref="member">icStatusCMM</ref><sp/>CIccApplyMruCmm::Apply(<ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*DstPixel,<sp/></highlight><highlight class="keyword">const</highlight><highlight class="normal"><sp/><ref refid="d4/d81/a00110_1a2879c29939ce675796753098691799b2" kindref="member">icFloatNumber</ref><sp/>*SrcPixel,<sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>nPixels)</highlight></codeline>
<codeline lineno="11163"><highlight class="normal">{</highlight></codeline>
<codeline lineno="11164"><highlight class="normal"><sp/><sp/><ref refid="d7/d46/a00002_1a63276cc6df51af4efa1945ecae93a182" kindref="member">icUInt32Number</ref><sp/>k;</highlight></codeline>
<codeline lineno="11165"><highlight class="normal"></highlight></codeline>
<codeline lineno="11166"><highlight class="normal"></highlight><highlight class="preprocessor">#if<sp/>defined(_DEBUG)</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11167"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pCache)</highlight></codeline>
<codeline lineno="11168"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ae59b42d2ffb7aa72502d7fa8d64b2096" kindref="member">icCmmStatInvalidLut</ref>;</highlight></codeline>
<codeline lineno="11169"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11170"><highlight class="normal"></highlight></codeline>
<codeline lineno="11171"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">for</highlight><highlight class="normal"><sp/>(k=0;<sp/>k&lt;nPixels;k++)<sp/>{</highlight></codeline>
<codeline lineno="11172"><highlight class="normal"><sp/><sp/><sp/><sp/></highlight><highlight class="keywordflow">if</highlight><highlight class="normal"><sp/>(!m_pCache-&gt;Apply(DstPixel,<sp/>SrcPixel))<sp/>{</highlight></codeline>
<codeline lineno="11173"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pCachedCmm-&gt;Apply(DstPixel,<sp/>SrcPixel);</highlight></codeline>
<codeline lineno="11174"><highlight class="normal"><sp/><sp/><sp/><sp/><sp/><sp/>m_pCache-&gt;Update(DstPixel);</highlight></codeline>
<codeline lineno="11175"><highlight class="normal"><sp/><sp/><sp/><sp/>}</highlight></codeline>
<codeline lineno="11176"><highlight class="normal"><sp/><sp/><sp/><sp/>SrcPixel<sp/>+=<sp/>m_pCmm-&gt;GetSourceSamples();</highlight></codeline>
<codeline lineno="11177"><highlight class="normal"><sp/><sp/><sp/><sp/>DstPixel<sp/>+=<sp/>m_pCmm-&gt;GetDestSamples();</highlight></codeline>
<codeline lineno="11178"><highlight class="normal"><sp/><sp/>}</highlight></codeline>
<codeline lineno="11179"><highlight class="normal"></highlight></codeline>
<codeline lineno="11180"><highlight class="normal"><sp/><sp/></highlight><highlight class="keywordflow">return</highlight><highlight class="normal"><sp/><ref refid="d6/d5b/a00026_1aa6d3f671e7ece0df89814eabf3fae3f6ab27f5c900f71e3f5206d8ac47fada099" kindref="member">icCmmStatOk</ref>;</highlight></codeline>
<codeline lineno="11181"><highlight class="normal">}</highlight></codeline>
<codeline lineno="11182"><highlight class="normal"></highlight></codeline>
<codeline lineno="11183"><highlight class="normal"></highlight></codeline>
<codeline lineno="11184"><highlight class="normal"></highlight><highlight class="preprocessor">#ifdef<sp/>USEREFICCMAXNAMESPACE</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11185"><highlight class="normal">}<sp/></highlight><highlight class="comment">//namespace<sp/>refIccMAX</highlight><highlight class="normal"></highlight></codeline>
<codeline lineno="11186"><highlight class="normal"></highlight><highlight class="preprocessor">#endif</highlight></codeline>
    </programlisting>
    <location file="IccProfLib/IccCmm.cpp"/>
  </compounddef>
</doxygen>
